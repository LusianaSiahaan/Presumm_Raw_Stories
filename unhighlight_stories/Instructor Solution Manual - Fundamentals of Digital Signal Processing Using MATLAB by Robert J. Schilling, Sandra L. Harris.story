An Instructor’s Solutions Manual to Accompany  Fundamentals of Digital Signal  Processing using MATLAB, 2nd Edition   Robert J. Schilling  Sandra L. Harris                                                             2012, 2005 Cengage Learning    ALL RIGHTS RESERVED. No part of this work covered by the  copyright herein may be reproduced, transmitted, stored, or  used in any form or by any means graphic, electronic, or  mechanical, including but not limited to photocopying,  recording, scanning, digitizing, taping, Web distribution,  information networks, or information storage and retrieval  systems, except as permitted under Section 107 or 108 of the  1976 United States Copyright Act, without the prior written  permission of the publisher except as may be permitted by the  license terms below.     For product information and technology assistance, contact us at   Cengage Learning Academic Resource Center,    1-800-423-0563.   For permission to use material from this text or product, submit   all requests online at www.cengage.com permissions.   Further permissions questions can be emailed to   permissionrequest@cengage.com.              ISBN-13: 978-1-1114-2603-3  ISBN-10: 1-111-42603-1    Cengage Learning  200 First Stamford Place, Suite 400  Stamford, CT 06902  USA    Cengage Learning is a leading provider of customized  learning solutions with office locations around the globe,  including Singapore, the United Kingdom, Australia,  Mexico, Brazil, and Japan. Locate your local office at:  international.cengage.com region.    Cengage Learning products are represented in  Canada by Nelson Education, Ltd.    For your course and learning solutions, visit  www.cengage.com engineering.    Purchase any of our products at your local college  store or at our preferred online store  www.cengagebrain.com.               NOTE: UNDER NO CIRCUMSTANCES MAY THIS MATERIAL OR ANY PORTION THEREOF BE SOLD, LICENSED, AUCTIONED,   OR OTHERWISE REDISTRIBUTED EXCEPT AS MAY BE PERMITTED BY THE LICENSE TERMS HEREIN.   READ IMPORTANT LICENSE INFORMATION   Dear Professor or Other Supplement Recipient:    Cengage  Learning  has  provided  you  with  this  product   the  “Supplement”  for your review and, to the extent that you adopt  the associated textbook for use in connection with your course   the  “Course” ,  you  and  your  students  who  purchase  the  textbook  may  use  the  Supplement  as  described  below.  Cengage  Learning  has  established  these  use  limitations  in  response to concerns raised by authors, professors, and other  users  regarding  the  pedagogical  problems  stemming  from  unlimited distribution of Supplements.    Cengage Learning hereby grants you a nontransferable license  to use the Supplement in connection with the Course, subject to  the  following  conditions.  The  Supplement  is  for  your  personal,  noncommercial  use  only  and  may  not  be  reproduced,  posted  electronically  or  distributed,  except  the  Supplement may be provided to your students IN PRINT FORM  ONLY in connection with your instruction of the Course, so long  as  such  students  are  advised  that  they  may  not  copy  or  distribute any portion of the Supplement to any third party. Test  banks and other testing materials may be made available in the  classroom  and  collected  at  the  end  of  each  class  session,  or   that  portions  of   to  protect   the  Supplement   posted  electronically  as  described  herein.  Any  material  posted  electronically  must  be  through  a  password-protected  site,  with  all  copy and download functionality disabled, and accessible solely by  your students who have purchased the associated textbook for the  Course. You may not sell, license, auction, or otherwise redistribute  the  Supplement  in  any  form.  We  ask  that  you  take  reasonable  steps  from  unauthorized  use,  reproduction, or distribution. Your use of the Supplement indicates  your acceptance of the conditions set forth in this Agreement. If you  do  not  accept  these  conditions,  you  must  return  the  Supplement  unused within 30 days of receipt.    All rights  including without limitation, copyrights, patents, and trade  secrets   in  the  Supplement  are  and  will  remain  the  sole  and  exclusive  property  of  Cengage  Learning  and or  its  licensors.  The  Supplement is furnished by Cengage Learning on an “as is” basis  without any warranties, express or implied. This Agreement will be  governed  by  and  construed  pursuant  to  the  laws  of  the  State  of  New York, without regard to such State’s conflict of law rules.    Thank you for your assistance in helping to safeguard the integrity  of the content contained in this Supplement. We trust you find the  Supplement a useful teaching tool.        Printed in the United States of America   1 2 3 4 5 6 7   14 13 12 11 10    INSTRUCTOR'S SOLUTIONS MANUAL    TO ACCOMPANY      FUNDAMENTALS OF   DIGITAL SIGNAL PROCESSING                 using MATLAB   SECOND EDITION  ROBERT J. SCHILLING  SANDRA L. HARRIS                             Contents       Chapter 1  Chapter 2   Chapter 3   Chapter 4   Chapter 5   Chapter 6   Chapter 7   Chapter 8  hapter 9                                                                                                                                                                                                   1  57  155  274  384  467  572  675  765    C                               Chapter 1  1.1 Suppose the input to an ampliﬁer is xa t  = sin 2πF0t  and the steady-state output is  ya t  = 100 sin 2πF0t + φ1  − 2 sin 4πF0t + φ2  + cos 6πF0t + φ3    a  Is the ampliﬁer a linear system or is it a nonlinear system?   b  What is the gain of the ampliﬁer?   c  Find the average power of the output signal.   d  What is the total harmonic distortion of the ampliﬁer?  Solution   a  The ampliﬁer is nonlinear because the steady-state output contains harmonics.   b  From  1.1.2 , the ampliﬁer gain is K = 100.   c  From  1.2.4 , the output power is   d  From  1.2.5   Py =  1  +  d2 0 4  2  cid:0 d2  1 + d+22 + d2 3 cid:1   = .5 1002 + 22 + 1  = 5002.5  THD =  100 Py − d2  1 2   Py  100 5002.5− 5000   =  5002.5  = .05%  1    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.2 Consider the following signum function that returns the sign of its argument.  sgn t   ∆  =    1 , 0 , −1 ,  t > 0 t = 0 t < 0   a  Using Appendix 1, ﬁnd the magnitude spectrum   b  Find the phase spectrum  Solution   a  From Table A2 in Appendix 1  Thus the magnitude spectrum is   b  The phase spectrum is  Xa f   =  1 jπf  Aa f   = Xa f    =  =  1  jπf 1 πf  φa f   = 6 Xa f   = −6 jπf = −sgn f   cid:16 π 2 cid:17   2    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.3 Parseval’s identity states that a signal and its spectrum are related in the following way.  Z ∞ −∞ xa t 2dt = Z ∞  −∞ Xa f  2df  Use Parseval’s identity to compute the following integral.  J = Z ∞  −∞  sinc2 2Bt dt  Solution  From Table A2 in Appendix 1 if  xa t  = sinc 2Bt   Xa f   =  µa f + B  − µa f − B   2B  then  Thus by Parseval’s identity  sin2 2Bt dt  −∞  J = Z ∞ = Z ∞ = Z ∞  =  = 1  −∞ xa t 2dt −∞ Xa f  2df 2B Z B 1  df  −B  3    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.4 Consider the causal exponential signal  xa t  = exp −ct µa t    a  Using Appendix 1, ﬁnd the magnitude spectrum.   b  Find the phase spectrum   c  Sketch the magnitude and phase spectra when c = 1.  Solution   a  From Table A2 in Appendix 1  Thus the magnitude spectrum is   b  The phase spectrum is  Xa f   =  1  c + j2πf  Aa f   = Xa f   1  =  =  1  c + j2πf pc2 +  2πf  2  Aa f   = Xa f    = 6 1 − 6  c + j2πf   = − tan−1 cid:18  2πf c  cid:19   4    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  a    f    φ  a  1  0.8  0.6  0.4  0.2  0 −5  2  1  0  −1  −2 −5  −4  −3  −2  −1  1  2  3  4  5  0  f  Hz   −4  −3  −2  −1  1  2  3  4  5  0  f  Hz   Problem 1.4  c  Magnitude and Phase Spectra, c = 1  5    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.5 If a real analog signal xa t  is square integrable, then the energy that the signal contains  within the frequency band [F0, F1] where F0 ≥ 0 can be computed as follows.  Consider the following double exponential signal with c > 0.  E F0, F1  = 2Z F1  F0  Xa f  2df  xa t  = exp −ct    a  Find the total energy, E 0, ∞ .  b  Find the percentage of the total energy that lies in the frequency range [0, 2] Hz.  Solution   a  From Table A2 in Appendix 1  Thus the total energy of xa t  is   b  Using part  a , the percentage of the total energy that lies in the frequency range [0, 2]  Hz is  Xa f   =  2c  c2 + 4π2f 2  0  2c  E 0, ∞  = 2Z ∞ Xa f  2df = 2Z ∞ 0  cid:20  c2 + 4π2f 2 cid:21  df c  cid:19  cid:12  cid:12  cid:12  cid:12  tan−1  cid:18  2πf π  cid:16  π 2 cid:17   4c 2πc 2  =  =  ∞  0  = 1  p =  100E 0, 2  E 0, ∞  = 100E 0, 2   =  =  2  0  200 π 200 π  c  cid:19  cid:12  cid:12  cid:12  cid:12  tan−1  cid:18  2πf c  cid:19  % tan−1 cid:18  4π  6    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.6 Let xa t  be a periodic signal with period T0. The average power of xa t  can be deﬁned as  follows.  Px =  1  T0 Z T0  0  xa t 2dt  Find the average power of the following periodic continuous-time signals.   a  xa t  = cos 2πF0t   b  xa t  = c  c  A periodic train of pulses of amplitude a, duration T , and period T0.  Solution   a  Using Appendix 2,  Px = F0Z 1 F0 2 Z 1 F0  F0  =  0  0  =  1 2  cos2 2πF0t dt  [1 + cos 4πF0t ]dt   b    c   Px =  1  T0 Z T0  0  c2dt  = c2  Px =  1  T0 Z T  0  a2dt  =  a2T T0  7    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.7 Consider the following discrete-time signal where the samples are represented using N bits.  x k  = exp −ckT  µ k    a  How many bits are needed to ensure that the quantization level is less than .001?   b  Suppose N = 8 bits. What is the average power of the quantization noise?   a  For k ≥ 0, the signal ranges over 0 ≤ x k  ≤ 1. Thus xmin = 0 and xmax = 1 and from  1.2.3   the quantization level is  Solution  Setting q = .001 yields  Taking the log of both sides, −N ln 2  = − ln 1000  or   b  From  1.2.8  the average power of the quantization noise using N = 8 bits is  q =  1 2N  1 2N =  1  1000  N = ceil cid:20  ln 1000  ln 2   cid:21   = ceil 9.966   = 10 bits  E[e2] =  q2 12  =  1  12 2N  2  = 1.271 × 10−6  8    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.8 Show that the spectrum of a causal signal xa t  can be obtained from the Laplace transform  Xa s  be replacing s by j2πf . Is this also true for noncausal signals?  Solution  For a causal signal xa t , the one-sided Laplace transform can be extended to a two-sided transform without changing the result.  Xa s  = Z ∞  −∞  xa t  exp −st dt  If s is now replaced by j2πf , this reduces to the Fourier transform Xa f   in  1.2.16 . Thus the spectrum of a causal signal can be obtained from the Laplace transform as follows.  Xa f   = Xa s s=j2πf  if  xa t  = 0 for t < 0  This is not true for a noncausal signal where xa t  6= 0 for t < 0.  9    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.9 Consider the following periodic signal.  xa t  = 1 + cos 10πt    a  Compute the magnitude spectrum of xa t .  b  Suppose xa t  is sampled with a sampling frequency of fs = 8 Hz. Sketch the magnitude  spectrum of xa t  and the sampled signal, ˆxa t .   c  Does aliasing occur when xa t  is sampled at the rate fs = 8 Hz? What is the folding   d  Find a range of values for the sampling interval T which ensures that aliasing will not   e  Assuming fs = 8 Hz, ﬁnd an alternative lower-frequency signal, xb t , that has the same  frequency in this case?  occur.  set of samples as xa t .  Solution   a  From the linearity property and Table A2 in Appendix 1  Xa f   = δa f   +  δa f + 5  + δa f − 5   2   c  Yes, aliasing does occur  see sketch . The folding frequency is   d  The signal xa t  is bandlimited to 5 Hz. From Proposition 1.1, to avoid aliasing, the  sampling rate must satisfy fs > 10. Thus 1 T > 10 or  fd =  fs 2  = 4 Hz  0 < T < .1 sec  10    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.5    f    A  a  0.5  1  0  1  0  −0.5  −15  1.5    f    A  a*  0.5  −0.5  −15  −10  −5  5  10  15  0  f  Hz   −10  −5  5  10  15  0  f  Hz   Problem 1.9  b  Magnitude Spectra   e  Using the trigonometric identities from Appendix 2 with fs = 8  x k  = 1 + cos 10πkT    = 1 + cos 1.25πk  = 1 + cos 2πk − .75πk  = 1 + cos 2πk  cos .75πk  + sin 2πk  sin .75πk   = 1 + cos .75πk   = 1 + cos 6πk 8   = 1 + cos 6πkT    Thus an alternative lower-frequency signal with the same set of samples is  xb t  = 1 + cos 6πt   11    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.10 Consider the following bandlimited signal.  xa t  = sin 4πt [1 + cos2 2πt ]   a  Using the trigonometric identities in Appendix 2, ﬁnd the maximum frequency present   b  For what range of values for the sampling interval T can this signal be reconstructed  in xa t .  from its samples?  Solution   a  From Appendix 2  xa t  = sin 4πt  + sin 4πt  cos2 2πt   = sin 4πt  + .5 sin 4πt [1 + cos 4πt ]  = sin 4πt  + .5 sin 4πt  + .5 sin 4πt  cos 4πt  = sin 4πt  + .5 sin 4πt  + .25 sin 8πt   Thus the highest frequency present in xa t  is F0 = 4 Hz.   b  From Proposition 1.1, to avoid aliasing fs > 8 Hz. Thus  0 < T < .125 sec  12    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.11 It is not uncommon for students to casually restate the sampling theorem in the following way: “A signal must be sampled at twice the highest frequency present to avoid aliasing”. Interesting enough, this informal formulation is not quite correct. To verify this, consider the following simple signal.  xa t  = sin 2πt    a  Find the magnitude spectrum of xa t , and verify that the highest frequency present is  F0 = 1 Hz.   b  Suppose xa t  is sampled at the rate fs = 2 Hz. Sketch the magnitude spectrum of xa t   and the sampled signal, ˆxa t . Do the replicated spectra overlap?   c  Compute the samples x k  = xa kT   using the sampling rate fs = 2 Hz. Is it possible to reconstruct xa t  from x k  using the reconstruction formula in Proposition 1.2 in this instance?   d  Restate the sampling theorem in terms of the highest frequency present, but this time  correctly.  Solution   a  From Table A2 in Appendix 2  Xa f   =  j[δa f + 1  − δa f − 1 ]  Thus the magnitude spectrum of xa t  is  Aa f   =  δa f + 1  + δa f − 1   2  2  Clearly, the highest frequency present is F0 = 1 Hz. See sketch.   b  Yes, the replicated spectra do overlap  see sketch . In this instance, the overlapping  spectra cancel one another.   c  When fs = 2, the samples are  No, it is not possible to reconstruct xa t  from these samples using Proposition 1.2.   d  A signal must be sampled at a rate that is higher than twice the highest frequency  present to avoid aliasing.  x k  = sin 2πkT    = sin πk  = 0  13    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1  0  1  0  0.5    f    A  a  −0.5  −4  0.5    f    A  a*  −0.5  −4  −3  −2  −1  1  2  3  4  0  f  Hz   −3  −2  −1  1  2  3  4  0  f  Hz   Problem 1.11  b  Magnitude Spectra  14    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.12 Why is it not possible to physically construct an ideal lowpass ﬁlter? Use the impulse response,  ha t , to explain your answer.  Solution  From Example 1.4, an ideal lowpass ﬁlter with gain one and cutoﬀ frequency B has the following impulse response  ha t  = 2Bsinc 2Bt   Therefore ha t  6= 0 for t < 0. This makes the impulse response a noncausal signal and the system that produced it a noncausal system. Noncausal systems are not physically realizable because the system would have to anticipate the input  an impulse at time t = 0  and respond to it before it occurred.  15    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.13 There are special circumstances where it is possible to reconstruct a signal from its samples even when the sampling rate is less than twice the bandwidth. To see this, consider a signal xa t  whose spectrum Xa f   has a hole in it as shown in Figure 1.45.   a  What is the bandwidth of the signal xa t  whose spectrum is shown in Figure 1.45? The   b  Suppose the sampling rate is fs = 750 Hz. Sketch the spectrum of the sampled signal  pulses are of radius 100 Hz.  ˆxa t .   c  Show that xa t  can be reconstructed from ˆxa t  by ﬁnding an idealized reconstruc- tion ﬁlter with input ˆxa t  and output xa t . Sketch the magnitude response of the reconstruction ﬁlter.   d  For what range of sampling frequencies below 2fs can the signal be reconstructed from  the samples using the type of reconstruction ﬁlter from part  c ?  Spectrum with a Hole in It  1.5  1  0.5     f    X   a  0  −1500  −1000  −500  500  1000  1500  0  f  Hz   Problem 1.45 A Signal Whose Spectrum has a Hole in It  Solution   a  From inspection of Figure 1.45, the bandwidth of xa t  is B = 600 Hz.  d  From inspection of the solution to part  c , the signal can be reconstructed from the  samples  no overlap of the spectra  for 700 < fs < 800 Hz.  16    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Sampled Spectrum  0  −1500  −1000  −500  500  1000  1500  0  f  Hz   Problem 1.13b  b  Magnitude Spectrum of Sampled Signal  −3  x 10  Ideal Reconstruction Filter  1000  800  600  400  200     f    X   a  2  1.8  1.6  1.4  1.2  1  0.8  0.6  0.4  0.2    f   A  0  −1500  −1000  −500  500  1000  1500  0  f  Hz   Problem 1.13c  c  Magnitude Response of Ideal Reconstruction Filter  17    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.14 Consider the problem of using an anti-aliasing ﬁlter as shown in Figure 1.46. Suppose the anti-aliasing ﬁlter is a lowpass Butterworth ﬁlter of order n = 4 with cutoﬀ frequency Fc = 2 kHz.   a  Find a lower bound fL on the sampling frequency that ensures that the aliasing error is  reduced by a factor of at least .005.   b  The lower bound fL represents oversampling by what factor?  xa t  e -  xb t   -  ADC  e x k   Anti-  aliasing  ﬁlter  Figure 1.46 Preprocessing with an Anti-Aliasing Filter  Solution   a  Suppose fs = 2αFc for some α > 1. Using  1.5.1  and evaluating Ha f   at the folding  frequency fd = fs 2 we have  Squaring both sides and taking reciprocals  Solving for α  Thus the lower bound on the cutoﬀ frequency is  1  √1 + α8  = .005  1 + α8 = 40000  α = 399991 8  = 3.761  fL = 2αFc  = 2 3.761 2000  = 15.044 kHz  18   b  This represents oversampling by a factor of factor α = 3.761.    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.15 Show that the transfer function of a linear continuous-time system is the Laplace transform  of the impulse response.  Solution  Let ya t  be the impulse response. Using Deﬁnition 1.8 and Table A4 in Appendix 1  L{ya t } = Ya s   = Ha s Xa s  = Ha s L{δa t } = Ha s   19    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.16 A bipolar DAC can be constructed from a unipolar DAC by inserting an operational ampliﬁer at the output as shown in Figure 1.47. Note that the unipolar N -bit DAC uses a reference voltage of 2VR, rather than −Vr as in Figure 1.34. This means that the unipolar DAC output is −2ya where ya is given in  1.6.4 . Analysis of the operational ampliﬁer section of the circuit reveals that the bipolar DAC output is then  za = 2ya − Vr   a  Find the range of values for za.  b  Suppose the binary input is b = bN −1bN −2 · · · b0. For what value of b is za = 0?  c  What is the quantization level of this bipolar DAC?  2Vr e  b e  Unipolar  @@ DAC  cid:0  cid:0   −2ya  R  R        eza  R  @ −  +  cid:0   @   cid:0   @  cid:0   e Vr  e  GND  Figure 1.47 A Bipolar N -bit DAC  Solution   a  From  1.6.5  we have 0 ≤ ya ≤  2N − 1 Vr 2N . When ya = 0, this yields za = −Vr. The  upper limit of za is  Thus the range of values for the bipolar DAC output is  za ≥  =  =  2N  2 2N − 1 Vr − Vr [2 2N − 1  − 2N ]Vr 2N  2N − 2 Vr  2N  −Vr ≤ za ≤  cid:18  2N − 2  2N  cid:19  Vr  20    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  If b = 10 · · · 0, then from  1.6.4  and  1.6.1  we have  The bipolar DAC output is then   c  From  1.2.3 , the quantization level of a bipolar DAC with output −Vr ≤ za < Vr is  ya =  cid:18  Vr =  cid:18  Vr =  cid:18  Vr  2N cid:19  x 2N cid:19  N −1 Xk=0 2N cid:19  2N −1  bk2k  =  Vr 2  za = 2ya − Vr  = 0  q =  Vr −  −Vr  Vr  2N  =  2N −1  21    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.17 Suppose a bipolar ADC is used with a precision of N = 12 bits, and a reference voltage of  Vr = 10 volts.   a  What is the quantization level q?   b  What is the maximum value of the magnitude of the quantization noise assuming the  ADC input-output characteristics is oﬀset by q 2 as in Figure 1.35.   c  What is the average power of the quantization noise?  Solution   a  From  1.6.7    b  The maximum quantization error, assuming rounding, is   c  From  1.2.8 , the average power of the quantization noise is  q =  =  Vr  2N −1 10 211  = .0049  Emax =  q 2  = .0024  E[e2] =  q2 12  = 1.9868 × 10−6  22    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.18 Suppose an 8-bit bipolar successive approximation ADC has reference voltage Vr = 10 volts.   a  If the analog input is xa = −3.941 volts, ﬁnd the successive approximations by ﬁlling in  the entries in Table 1.8.   b  If the clock rate is fclock = 200 kHz, what is the sampling rate of this ADC?  c  Find the quantization level of this ADC.  d  Find the average power of the quantization noise.  Table 1.8 Successive Approximations  bn−k  uk  yk  k 0 1 2 3 4 5 6 7  Solution   a  Applying Alg. 1.1, the successive approximations are as follows  Table 1.8 Successive Approximations   b  Since there are N = 8 bits, the successive approximation sampling rate is  k 0 1 2 3 4 5 6 7  bn−k  0 1 0 0 1 1 0 1  uk 0 1 0 0 1 1 0 1  yk  -10.0000 -5.0000 -5.0000 -5.0000 -4.3750 -4.0625 -4.0625 -3.9844  fs =  fclock  N 2 × 105 = 25 kHz  =  8  23    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  1.6.7 , the quantization level of this bipolar ADC is   d  Using  1.2.8  the average power of the quantization noise is  q =  10 27  = .0781  E[e2] =  q2 12  = 5.083 × 10−4  24    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.19 An alternative to the R-2R ladder DAC is the weighted-resistor DAC shown in Figure 1.48 for the case N = 4. Here the switch controlled by bit bk is open when bk = 0 and closed when bk = 1. Recall that the decimal equivalent of the binary input b is as follows.   a  Show that the current through the kth branch of an N -bit weighted-resistor DAC is  x =  N −1  Xk=0  bk2k  Ik = −Vrbk 2N −kR  ,  0 ≤ k < N   b  Show that the DAC output voltage is  ya =  cid:18  Vr  2N cid:19  x   c  Find the range of output values for this DAC.   d  Is this DAC unipolar, or is it bipolar?   e  Find the quantization level of this DAC.  2R  4R  8R  16R        ? I2     cid:1   cid:1   b2        ? I1     cid:1   cid:1   b1  ? I0     cid:1   cid:1   b0     -I    V  R  @ −  +  cid:0   @   cid:0   @  cid:0   ya e   Figure 1.48 A Four-Bit Weighted-Resistor DAC  −Vr  e     ? I3     cid:1   cid:1   b3  GND  e  Solution  25    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    a  The kth branch  starting from the right  has resistance 2N −kR. For an ideal op amp, the principle of the virtual short circuit says that the voltage drop between the noninverting terminal  +  and the inverting terminal −  is zero. Thus V = 0. Applying Ohm’s law, current through the kth branch is  Ik =   −Vr − V  bk  2N −kR  = −Vrbk 2N −kR  ,  0 ≤ k < N   b  For an ideal op amp, there is no current ﬂowing into the inverting input  inﬁnite input  impedance . Consequently, using V = 0 and Ik from part  a ,  ya = V − RI  −Vrbk 2N −kR  N −1  = −RI = −R  Ik  N −1  N −1  = −R  Xi=0 Xi=0 Xi=0 bk2k−N 2N cid:19  N −1 =  cid:18  Vr Xi=0 =  cid:18  Vr 2N cid:19  x  = Vr  bk2k  0 ≤ ya ≤  cid:18  2N −1  2N  cid:19  Vr  q =  =  Vr − 0 2N Vr 2N  26   c  Since x ranges from 0 to 2N −1, it follows from part  b  that   d  Since ya ≥ 0, this is a unipolar DAC.  e  For the unipolar DAC, 0 ≤ ya < Vr. Thus from  1.2.3 , the quantization level is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.20 Use GUI module g sample to plot the time signals and magnitude spectra of the square wave using f s = 10 Hz. On the magnitude spectra plot, use the Caliper option to display the amplitude and frequency of the third harmonic. Are there even harmonics present the square wave?  Solution  0  0    t   x  1.5  0.5  1  0  −0.5  −1  −1.5    0  x  a  Anti−  aliasing  filter  x  b  ADC  x  Time signals, square wave input: n=4, F  =4, N=8, V  =1, f  =10  c  r  s     x   t   x   t   a  b  x k   0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.20  a   27    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x  a a  Anti− Anti−  aliasing aliasing  filter filter  x x  b b  ADC ADC  x x  0 0  0 0  140  120  100  80  60  40  20     f   X     0 −20  Magnitude spectra, square wave input: n=4, F  =4, N=8, V  =1, f  =10  c  r  s     X   f   X   f   a  b  X f  Ideal filter     x,y  =  3.09,54.19   −15  −10  −5  5  10  15  20  0  f  Hz   Problem 1.20  b  There are no even harmonics  28    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.21 Use GUI module g sample to plot the magnitude spectra of the User-deﬁned signal in the ﬁle, u sample1. Set Fc = 1 and do the following two cases. For which ones is there noticeable aliasing?   a  f s = 2 Hz   b  f s = 10 Hz  Solution  x  a  Anti−  aliasing  filter  x  b  ADC  x  0  0  8  6  4  2    0 −4     f   X   Magnitude spectra, user−defined input from file u_sample1: n=4, F  =1, N=8, V  =1, f  =2  c  r  s     X   f   X   f   a  b  X f  Ideal filter  −3  −2  −1  1  2  3  4  0  f  Hz   Problem 1.21  a  Signiﬁcant aliasing, fs = 2 Hz  29    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x  a a  Anti− Anti−  aliasing aliasing  filter filter  x x  b b  ADC ADC  x x  0 0  0 0  40  30  20  10     f   X     0 −20  Magnitude spectra, user−defined input from file u_sample1: n=4, F  =1, N=8, V  =1, f  =10  c  r  s     X   f   X   f   a  b  X f  Ideal filter  −15  −10  −5  5  10  15  20  0  f  Hz   Problem 1.21  b  No signiﬁcant aliasing, fs = 10 Hz  30    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.22 Consider the following exponentially damped sine wave with c = 1 and F0 = 1.  xa t  = exp −ct  sin 2πF0t µa t    a  Write a MATLAB function called u sample2 that returns the value xa t .  b  Use the User-Deﬁned option in GUI module g sample to sample this signal at fs = 12   c  Adjust the sampling rate to fs = 4 Hz and set the cutoﬀ frequency to Fc = 2 Hz. Plot  Hz. Plot the time signals.  the magnitude spectra.  Solution   a  Write a MATLAB function called u sample2 that returns the value xa t .  function y = u_sample2  t   %U_SAMPLE2: User file for problem 1.22 % % Usage: y = u_sample2  t ; % % Inputs: t % % Outputs: y = vector of samples of analog signal evaluated at t  = vector of input times  y = exp -t  .* sin 2*pi*t ;  31    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x x  a a a  Anti− Anti− Anti−  aliasing aliasing aliasing  filter filter filter  x x x  b b b  ADC ADC ADC  x x x  0 0 0  0 0 0    t   x  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6    0  0 0 0 0  0 0 0 0  12  10  8  6  4  2     f   X     0 −15  Time signals, user−defined input from file u_sample2: n=4, F  =4, N=8, V  =1, f  =12  c  r  s     x   t   x   t   a  b  x k   0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.22  b  Time Plots  x x x x  a a a a  Anti− Anti− Anti− Anti−  aliasing aliasing aliasing aliasing  filter filter filter filter  x x x x  b b b b  ADC ADC ADC ADC  x x x x  Magnitude spectra, user−defined input from file u_sample2: n=4, F  =2, N=8, V  =1, f  =6  c  r  s     X   f   X   f   a  b  X f  Ideal filter  −10  −5  5  10  15  0  f  Hz   Problem 1.22  c  Spectra  32    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.23 Use GUI module g reconstruct to load the User-Deﬁned signal in the ﬁle, u reconstruct1.   a  Plot the time signals, and use the Caliper option to identify the amplitude and time of  Adjust f s to 12 Hz and set Vr = 4.  the peak output.   b  Plot the magnitude spectra.  Solution  y  DAC  y  b  Anti−  imaging filter  y  a  0  0    t   y  4  3  2  1  0  −1  −2    0  Time signals, user−defined input from file u_reconstruct1: N=8, V  =4, n=4, F  =4, f  =12  r  c  s     x,y  =  1.62,3.31      y   t   y   t   b  a  y  0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.23  a   33    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y y  DAC DAC  y y  b b  Anti− Anti−  imaging imaging filter filter  y y  a a  0 0  0 0  120  100  80  60  40  20     f   Y     0 −25  Magnitude spectra, user−defined input from file u_reconstruct1: N=8, V  =4, n=4, F  =4, f  =12  r  c  s    Y f  Y   f   Y   f   b  a  Ideal filter  −20  −15  −10  −5  5  10  15  20  25  0  f  Hz   Problem 1.23  b   34    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.24 Consider the exponentially damped sine wave in problem 1.22.   a  Write a MATLAB function that returns the value xa t .  b  Use the User-Deﬁned option in GUI module g reconstruct to sample this signal at fs = 8  Hz. Plot the time signals.   c  Adjust the sampling rate to fs = 4 Hz and set Fc = 2 Hz. Plot the magnitude spectra.  Solution   a  Write a MATLAB function that returns the value xa t .  function y = u_sample2  t   %U_SAMPLE2: User file for problem 1.24 % % Usage: y = u_sample2  t ; % % Inputs: t % % Outputs: y = vector of samples of analog signal evaluated at t  = vector of input times  y = exp -t  .* sin 2*pi*t ;  35    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0  0    t   y  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6    0  0 0  0 0     f   Y   10  8  6  4  2    0 −8  y  DAC  y  b  Anti−  imaging filter  y  a  Time signals, user−defined input from file u_sample2: N=8, V  =1, n=4, F  =4, f  =8  r  c  s     y   t   y   t   b  a  y  0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.24  b   y y  DAC DAC  y y  b b  Anti− Anti−  imaging imaging filter filter  y y  a a  Magnitude spectra, user−defined input from file u_sample2: N=8, V  =1, n=4, F  =2, f  =4  r  c  s     Y f  Y   f   Y   f   b  a  Ideal filter  −6  −4  −2  2  4  6  8  0  f  Hz   Problem 1.24  c   36    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.25 Use GUI module g sample to plot the magnitude responses of the following anti-aliasing ﬁlters.  What is the oversampling factor, α, in each case?   a  n = 2, Fc = 1, fs = 2  b  n = 6, Fc = 2, fs = 12  Solution  x  a  Anti−  aliasing  filter  x  b  ADC  x  0  0  1.5    f   A  1  0.5    0 −4  Anti−aliasing filter magnitude response: n=2, F  =1, N=8, V  =1, f  =2  c  r  s    Anti−aliasing filter Ideal filter  −3  −2  −1  1  2  3  4  0  f  Hz   Problem 1.25  a  Oversampling factor: α = fs  2Fc  = 1  37    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x  a a  Anti− Anti−  aliasing aliasing  filter filter  x x  b b  ADC ADC  x x  0 0  0 0  1.5    f   A  1  0.5  0     Anti−aliasing filter magnitude response: n=6, F  =2, N=8, V  =1, f  =12  c  r  s    Anti−aliasing filter Ideal filter  −20  −15  −10  −5  5  10  15  20  0  f  Hz   Problem 1.25  b  Oversampling factor: α = fs  2Fc  = 3  38    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.26 Use GUI module g reconstruct to plot the magnitude responses of the following anti-imaging  ﬁlters. What is the oversampling factor in each case?   a  n = 1, F c = 2, fs = 5  a  n = 8, F c = 4, fs = 16  Solution  y  DAC  y  b  Anti−  imaging filter  y  a  0  0    f   A  1  0.8  0.6  0.4  0.2    0 −15  DAC and anti−imaging filter magnitude responses: N=8, V  =1, n=1, F  =2, f  =5  r  c  s  DAC Anti−imaging filter     −10  −5  5  10  15  0  f  Hz   Problem 1.26  a  Oversampling factor: α = fs  2Fc  = 1.25  39    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y y  DAC DAC  y y  b b  Anti− Anti−  imaging imaging filter filter  y y  a a  0 0  0 0    f   A  1  0.8  0.6  0.4  0.2    0 −50  DAC and anti−imaging filter magnitude responses: N=8, V  =1, n=8, F  =4, f  =16  r  c  s  DAC Anti−imaging filter     −40  −30  −20  −10  10  20  30  40  50  0  f  Hz   Problem 1.26  b  Oversampling factor: α = fs  2Fc  = 2  40    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.27 Use the GUI module g reconstruct to plot the magnitude responses of a 12-bit DAC with reference voltage Vr = 10 volts, and a 6th order Butterworth anti-imaging ﬁlter with cutoﬀ frequency Fc = 2 Hz. Use oversampling by a factor of two.  Solution  0 0 0  0 0 0    f   A  1  0.8  0.6  0.4  0.2    0 −25  y y y  DAC DAC DAC  y y y  b b b  Anti− Anti− Anti−  imaging imaging imaging filter filter filter  y y y  a a a  DAC and anti−imaging filter magnitude responses: N=12, V  =10, n=6, F  =2, f  =8  r  c  s  DAC Anti−imaging filter     −20  −15  −10  −5  5  10  15  20  25  0  f  Hz   Problem 1.27  41    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.28 Use GUI module g sample with the damped exponential input to plot the time signals us- ing the following ADCs. For what cases does the ADC output saturate? Write down the quantization level on each time plot.   a  N = 4, Vr = 1  b  N = 8, Vr = .5  c  N = 8, Vr = 1  Solution  x x x x x x  a a a a a a  Anti− Anti− Anti− Anti− Anti− Anti−  aliasing aliasing aliasing aliasing aliasing aliasing  filter filter filter filter filter filter  x x x x x x  b b b b b b  ADC ADC ADC ADC ADC ADC  x x x x x x  0 0 0 0 0 0  0 0 0 0 0 0    t   x  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Time signals, damped exponential input: n=4, F  =4, N=4, V  =1, f  =20  c  r  s     x   t   x   t   a  b  x k   0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.28  a  No saturation, q = 1 8  42    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0 0 0 0  0 0 0 0 0 0 0    t   x  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0    t   x  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  x x x x x x x  a a a a a a a  Anti− Anti− Anti− Anti− Anti− Anti− Anti−  aliasing aliasing aliasing aliasing aliasing aliasing aliasing  filter filter filter filter filter filter filter  x x x x x x x  b b b b b b b  ADC ADC ADC ADC ADC ADC ADC  x x x x x x x  Time signals, damped exponential input: n=4, F  =4, N=8, V  =0.5, f  =20  c  r  s     x   t   x   t   a  b  x k      x   t   x   t   a  b  x k   0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.28  b  Saturation at 0.5, q = 1 256  x x x x x x x x  a a a a a a a a  Anti− Anti− Anti− Anti− Anti− Anti− Anti− Anti−  aliasing aliasing aliasing aliasing aliasing aliasing aliasing aliasing  filter filter filter filter filter filter filter filter  x x x x x x x x  b b b b b b b b  ADC ADC ADC ADC ADC ADC ADC ADC  x x x x x x x x  Time signals, damped exponential input: n=4, F  =4, N=8, V  =1, f  =20  c  r  s  0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.28  c  No saturation, q = 1 256  43    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.29 Use GUI module g reconstruct with the damped exponential input to plot the time signals  using the following DACs. What is the quantization level in each case?   a  N = 4, Vr = .5  b  N = 12, Vr = 2  Solution  y  DAC  y  b  Anti−  imaging filter  y  a  0  0    t   y  0.6  0.5  0.4  0.3  0.2  0.1  0  −0.1    0  Time signals, damped exponential input: N=4, V  =0.5, n=4, F  =4, f  =20  r  c  s     y   t   y   t   b  a  y  0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.29  a  q = 1 16  44    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y y  DAC DAC  y y  b b  Anti− Anti−  imaging imaging filter filter  y y  a a  0 0  0 0    t   y  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Time signals, damped exponential input: N=12, V  =2, n=4, F  =4, f  =20  r  c  s     y   t   y   t   b  a  y  0.5  1  1.5  2.5  3  3.5  4  2  t  sec   Problem 1.29  b  q = 1 1024  45    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.30 Write a MATLAB function called u sinc that returns the value of the sinc function  sinc x  =  sin x   x  Note that, by L’Hospital’s rule, sinc 0  = 1. Make sure your function works properly when x = 0. Plot sinc 2πt  for −1 ≤ t ≤ 1.  Solution  % Problem 1.30  f_header ’Problem 1.30’  p = 401; t = linspace  -1,1,p ; y = u_sinc 2*pi*t ; figure plot  t,y  f_labels  ’sinc 2t ’,’t  sec ’,’y t ’  set  gca,’FontSize’,11  hold on plot [-1 1],[0 0],’k’  plot [0 0],[-0.5 1.5],’k’  f_wait  function y = u_sinc  x   % U_SINC: Implement the sifting function sin pi*x   pi*x  % % Usage: y = u_sinc  x ; % % Inputs: x = input scalar or vector % % Outputs: y = sin pi*x   pi*x   for i = 1 : length x   if abs x i   < eps  y i  = 1;  else  end  end  y i  = sin pi*x i    pi*x i  ;  46    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.5  1  0    t   y  0.5  −0.5  −1  −0.5  0  t  sec   0.5  1  Problem 1.30 Sinc Function  sinc 2t   47    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.31 The purpose of this problem is to numerically verify the signal reconstruction formula in Proposition 1.2. Consider the following bandlimited periodic signal which can be thought of as a truncated Fourier series.  xa t  = 1 − 2 sin πt  + cos 2πt  + 3 cos 3πt   Write a MATLAB script which uses the function u sinc from problem 1.30 to approximately reconstruct xa t  as follows.  xp t  =  xa kT  sinc[fs t − kT  ]  p  Xk=−p  Use a sampling rate of fs = 6 Hz. Plot xa t  and xp t  on the same graph using 101 points equally spaced over the interval [−2, 2]. Using f prompt, prompt for the number p and do the following three cases.   a  p = 5   b  p = 10   c  p = 20;  Solution  % Problem 1.31  % Initialize  f_header ’Problem1.31’  x_a = inline  ’1-2*sin pi*t +cos 2*pi*t +3*cos 3*pi*t ’,’t’ ; fs = 6; T = 1 fs;  % Reconstruct x_a t  from it samples  p = f_prompt  ’Enter number of terms p’,0,40,10 ; t = linspace  -2,2,101 ; x_p = zeros size t  ; for i = 1 : length t   for k = -p : p  x_p i  = x_p i  + x_a k*T *u_sinc fs* t i  - k*T  ;  end  end figure  48    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   plot  t,x_a t ,t,x_p,’LineWidth’,1.0  caption = sprintf  ’Partial Reconstruction using p = %d’,p ; f_labels  caption,’t  sec ’,’x t ’  legend  ’x_a’,’x_p’  f_wait  Partial Reconstruction using p = 5     x  x  a  p    t   x  6  4  2  0  −2  −4  −6    −2  −1.5  −1  −0.5  0  0.5  1  1.5  2  t  sec   Problem 1.31  a   49    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6  4  2  0  6  4  2  0    t   x  −2  −4  −6    −2    t   x  −2  −4  −6    −2  Partial Reconstruction using p = 10     x  x  a  p     x  x  a  p  −1.5  −1  −0.5  0  0.5  1  1.5  2  t  sec   Problem 1.31  b   Partial Reconstruction using p = 20  −1.5  −1  −0.5  0  0.5  1  1.5  2  t  sec   Problem 1.31  c   50    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.32 The Butterworth ﬁlter is optimal in the sense that, for a given ﬁlter order, the magnitude response is as ﬂat as possible in the passband. If ripples are allowed in the passband, then an analog ﬁlter with a sharper cutoﬀ can be achieved. Consider the following Chebyshev I lowpass ﬁlter from Chapter 7.  Ha s  =  s5 + 6.1s4 + 67.8s3 + 251.5s2 + 934.3s + 1263.7  1263.7  Write a MATLAB script the uses the FDSP toolbox function f freqs to compute the magnitude response of this ﬁlter. Plot it over the range [0, 3] Hz. This ﬁlter is optimal in the sense that the passband ripples are all of the same size.  Solution  % Problem 1.32  % Initialize  f_header ’Problem 1.32’  N =100; fmax = 3; b = 1263.7 a = [1 6.1 67.8 251.5 934.3 1263.7]  % Compute and plot magnitude response  [H_a,f] = f_freqs  b,a,N,fmax ; A_a = abs H_a ; figure plot  f,A_a  f_labels  ’Magnitude Response of Chebyshev-I Filter’,’f  Hz ’,’A_a f ’  axis [0 3 0 1.4]  f_wait  51    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  a  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  Magnitude Response of Chebyshev−I Filter  0.5  1  2  2.5  3  1.5  f  Hz   Problem 1.32 Chebyshev-I Filter  52    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 1.33 Consider the following Chebyshev II lowpass ﬁlter from Chapter 7.  Ha s  =  s5 + 20s4 + 203s3 + 1341s2 + 5150s + 15747  3s4 + 499s2 + 15747  Write a MATLAB script the uses the FDSP toolbox function f freqs to compute the magnitude response of this ﬁlter. Plot it over the range [0, 3] Hz. This ﬁlter is optimal in the sense that the stopband ripples are all of the same size.  Solution  % Problem 1.33  % Initialize  f_header ’Problem 1.33’  N =100; fmax = 3; b = [3 0 499 0 15747] a = [1 20 203 1341 5150 15747]  % Compute and plot magnitude response  [H_a,f] = f_freqs  b,a,N,fmax ; A_a = abs H_a ; figure plot  f,A_a  f_labels  ’Magnitude Response of Chebyshev-II Filter’,’f  Hz ’,’A_a f ’  axis [0 3 0 1.4]  f_wait  53    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  a  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  Magnitude Response of Chebyshev−II Filter  0.5  1  2  2.5  3  1.5  f  Hz   Problem 1.33 Chebyshev-II Filter  54    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.34 Consider the following elliptic lowpass ﬁlter from Chapter 7.  Ha s  =  2.0484s2 + 171.6597  s3 + 6.2717s2 + 50.0487s + 171.6597  Write a MATLAB script the uses the FDSP toolbox function f freqs to compute the magnitude response of this ﬁlter. Plot it over the range [0, 3] Hz. This ﬁlter is optimal in the sense that the passband ripples and the stopband ripples are all of the same size.  Solution  % Problem 1.34  % Initialize  f_header ’Problem 1.34’  N =100; fmax = 3; b = [2.0484 0 171.6597] a = [1 6.2717 50.0487 171.6597]  % Compute and plot magnitude response  [H_a,f] = f_freqs  b,a,N,fmax ; A_a = abs H_a ; figure plot  f,A_a  f_labels  ’Magnitude Response of Elliptic Filter’,’f  Hz ’,’A_a f ’  axis [0 3 0 1.4]  f_wait  55    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  a  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  Magnitude Response of Elliptic Filter  0.5  1  2  2.5  3  1.5  f  Hz   Problem 1.34 Elliptic Filter  56    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.1 Classify each of the following signals as ﬁnite or inﬁnite. For the ﬁnite signals, ﬁnd the  Chapter 2  smallest integer N such that x k  = 0 for k > N .  a  x k  = µ k + 5  − µ k − 5   b  x k  = sin .2πk µ k   c  x k  = min k2 − 9, 0 µ k   d  x k  = µ k µ −k   1 + k2   e  x k  = tan √2πk [µ k  − µ k − 100 ]  f  x k  = δ k  + cos πk  −  −1 k  g  x k  = k−k sin .5πk   Solution   a  ﬁnite, N = 5   b  inﬁnite   c  ﬁnite, N = 2   d  ﬁnite, N = 1   e  ﬁnite, N = 99   f  ﬁnite, N = 0   g  inﬁnite  57    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.2 Classify each of the following signals as causal or noncausal.   a  x k  = max{k, 0}  b  x k  = sin .2πk µ −k   c  x k  = 1 − exp −k   d  x k  = mod k, 10   e  x k  = tan √2πk [µ k  + µ k − 100 ]  f  x k  = cos πk  +  −1 k  g  x k  = sin .5πk   1 + k2   Solution   a  causal   b  noncausal   c  noncausal   d  noncausal   e  causal   e  causal   f  noncausal  58    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.3 Classify each of the following signals as periodic or aperiodic. For the periodic signals, ﬁnd  the period, M .   a  x k  = cos .02πk    b  x k  = sin .1k  cos .2k   c  x k  = cos √3k   d  x k  = exp jπ 8    e  x k  = mod k, 10   f  x k  = sin2 .1πk µ k   g  x k  = j 2k  Solution   a  periodic, M = 100   b  nonperiodic,  τ = 20π   c  nonperiodic,  τ = 2π √3   d  periodic, M = 16   e  periodic, M = 10   f  nonperodic,  causal    g  periodic, M = 2  59    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.4 Classify each of the following signals as bounded or unbounded.   a  x k  = k cos .1πk   1 + k2   b  x k  = sin .1k  cos .2k δ k − 3   c  x k  = cos πk2   d  x k  = tan .1πk [µ k  − µ k − 10]  e  x k  = k2  1 + k2   f  x k  = k exp −k µ k   Solution   a  bounded   b  bounded   c  bounded   d  unbounded   e  bounded   f  bounded  60    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.5 For each of the following signals, determine whether or not it is bounded. For the bounded  signals, ﬁnd a bound, Bx.   a  x k  = [1 + sin 5πk ]µ k   b  x k  = k .5 kµ k    cid:21  µ k   c  x k  = cid:20   1 + k  sin 10k   d  x k  = [1 +  −1 k] cos 10k µ k   1 +  .5 k  Solution   a  bounded, Bx = 1   b  The following are the ﬁrst few values of x k .  Thus x k  is bounded with Bx = .5.   c  unbounded   d  bounded, Bx = 2.  k 0 1 2 3 4 5  x k  0 1 2 1 2 3 8 4 16 5 25  61    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.6 Consider the following sum of causal exponentials.  x k  = [c1 p1 k + c2 p2 k]µ k    a  Using the inequalities in Appendix 2, show that  x k  ≤ c1 · p1k + c2 · p2k   b  Show that x k  is absolutely summable if p1 < 1 and p2 < 1. Find an upper bound   c  Suppose p1 < 1 and p2 < 1. Find an upper bound on the energy Ex.  on kxk1  Solution   a  Using Appendix 2   b  Suppose p1 < 1 and p2 < 1. Then using  a  and the geometric series in  2.2.14   x k  = [c1 p1 k + c2 p2 k]µ k  = c1 p1 k + c2 p2 k · µ k  = c1 p1 k + c2 p2 k ≤ c1 p1 k + c2 p2 k = c1 · pk 1 + c2 · pk 2] = c1 · p1k + c2 · p2k  kxk1 =  x k   ∞  ∞  Xk=−∞ Xk=0 = c1  ≤  =  ∞  ∞  c1 · p1k + c2 · p2k Xk=0 c1 1 − p1  p1k + c2 + c2  1 − p2  Xk=0  p2k  62    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  b  and  2.2.7  through  2.2.9   2  Ex = kxk2 ≤ kxk2 c1 ≤  1  1 − p1  + c2  1 − p2  63    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   [a cos πk 8  + b sin πk 8 ]2 = a2 cos2 πk 8   + 2ab cos πk 8  sin πk i  + b2 sin2 πk 8   = a2 cid:20  1 + cos πk 4   2   cid:21  + ab sin πk 4  + b2 cid:20  1 − cos πk 4   2   cid:21   2.7 Find the average power of the following signals.   a  x k  = 10   b  x k  = 20µ k    c  x k  = mod k, 5    d  x k  = a cos πk 8  + b sin πk 8   e  x k  = 100[µ k + 10  − µ k − 10 ]  f  x k  = j k  Using  2.2.10 - 2.2.12  and Appendix 2   c  Px =  1 + 4 + 9 + 16  5 = 6  Solution   a  Px = 100   b  Px = 400   d   Thus   e  Px = 104  f   Px =  a2 + b2  2  Px = lim  2N + 1  = lim  2N + 1  1  1  1  j k2   jk 2  N  N  Xk=−N Xk=−N Xk=−N  N  = lim  2N + 1  1  = 1  64    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.8 Classify each of the following systems as linear or nonlinear.   a  y k  = 4[y k − 1  + 1]x k   b  y k  = 6kx k   c  y k  = −y k − 2  + 10x k + 3   d  y k  = .5y k  − 2y k − 1   e  y k  = .2y k − 1  + x2 k   f  y k  = −y k − 1 x k − 1  10   a  nonlinear  product term   Solution   b  linear   c  linear   d  linear   e  nonlinear  input term    f  nonlinear  product term   65    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.9 Classify each of the following systems as time-invariant or time-varying.   a  y k  = [x k  − 2y k − 1 ]2  b  y k  = sin[πy k − 1 ] + 3x k − 2   c  y k  =  k + 1 y k − 1  + cos[.1πx k ]  d  y k  = .5y k − 1  + exp −k 5 µ k   e  y k  = log[1 + x2 k − 2 ]  f  y k  = kx k − 1   Solution   a  time-invariant   b  time-invariant   c  time-varying   d  time-varying   e  time-invariant   f  time-varying  66    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.10 Classify each of the following systems as causal or noncausal.   a  y k  = [3x k  − y k − 1 ]3  b  y k  = sin[πy k − 1 ] + 3x k + 1   c  y k  =  k + 1 y k − 1  + cos[.1πx k2 ]  d  y k  = .5y k − 1  + exp −k 5 µ k   e  y k  = log[1 + y2 k − 1 x2 k + 2 ]  f  h k  = µ k + 3  − µ k − 3   Solution   a  causal   b  noncausal   c  causal   d  causal   e  noncausal   f  noncausal  67    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.11 Consider the following system that consists of a gain of A and a delay of d samples.  y k  = Ax k − d    a  Find the impulse response h k  of this system.   b  Classify this system as FIR or IIR.  c  Is this system BIBO stable? If so, ﬁnd khk1.  d  For what values of A and d is this a passive system?   e  For what values of A and d is this an active system?   f  For what values of A and d is this a lossless system?  Solution   a  h k  = Aδ k − d   b  FIR  c  Yes, it is BIBO stable with khk1 = A.  d   Ey =  ∞  ∞  y2 k   Xk=−∞ Xk=−∞ [Ax k − d ]2 Xk=−∞ Xi=−∞  x2 k − d   x2 i   ,  ∞  ∞  =  = A2  = A2  = A2Ex  i = k − d  This is a passive system for A < 1.  e  This is an active system for A > 1  f  This is a lossless system for A = 1  68    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.12 Consider the following linear time-invariant discrete-time system S.  y k  − y k − 2  = 2x k    a  Find the characteristic polynomial of S and express it in factored form.   b  Write down the general form of the zero-input response, yzi k .  c  Find the zero-input response when y −1  = 4 and y −2  = −1.  Solution   a    b    c  Evaluating part  b  at the two initial conditions yields  Adding the equations yields 2c1 = 3 or c1 = 1.5. Subtracting the ﬁrst equation from the second yields 2c2 = −5 or c2 = −2.5.. Thus the zero-input response is  a z  = z2 − 1  =  z − 1  z + 1   yzi k  = c1 p1 k + c2 p2 k  = c1 + c2 −1 k  c1 − c2 = 4 c1 + c2 = −1  yzi k  = 1.5 − 2.5 −1 k  69    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.13 Consider the following linear time-invariant discrete-time system S.  y k  = 1.8y k − 1  − .81y k − 2  − 3x k − 1    a  Find the characteristic polynomial a z  and express it in factored form.   b  Write down the general form of the zero-input response, yzi k .  c  Find the zero-input response when y −1  = 2 and y −2  = 2.  Solution   a    b   or   c  Evaluating part  b  at the two initial conditions yields  a z  = z2 − 1.8z + .81  =  z − .9 2  yzi k  =  c1 + c2k pk =  c1 + c2k .9k   c1 − c2 .9−1 = 2  c1 − 2c2 .9−2 = 2  c1 − c2 = 1.8 c1 − 2c2 = 1.62  yzi k  =  1.98 + .18k .9k  70  Subtracting the second equation from the ﬁrst yields c2 = .18. Subtracting the second equation from two times the ﬁrst yields c1 = 1.98. Thus the zero-input response is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.14 Consider the following linear time-invariant discrete-time system S.  y k  = −.64y k − 2  + x k  − x k − 2    a  Find the characteristic polynomial a z  and express it in factored form.   b  Write down the general form of the zero-input response, yzi k , expressing it as a real   c  Find the zero-input response when y −1  = 3 and y −2  = 1.  signal.  Solution   a   a z  = z2 + .64  =  z − .8j  z + .8j    b  In polar form the roots are z = .8 exp ±jπ 2 . Thus  yzi k  = rk[c1 cos kθ  + c2 sin kθ ]  = .8k[c1 cos kπ 2  + c2 sin πk 2 ]   c  Evaluating part  b  at the two initial conditions yields  Thus c2 = −3 .8  and c1 = −1 .64 . Hence the zero-input response is  yzi k  = − .8 k[.64 cos πk 2  + 2.4 sin πk 2 ]  .8−1c2 −1  = 3 .8−2c1 −1  = 1  71    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.15 Consider the following linear time-invariant discrete-time system S.  y k  − 2y k − 1  + 1.48y k − 2  − .416y k − 3  = 5x k    a  Find the characteristic polynomial a z . Using the MATLAB function roots, express it  in factored form.   b  Write down the general form of the zero-input response, yzi k .  c  Write the equations for the unknown coeﬃcient vector c ∈ R3 as Ac = y0 where y0 =  [y −1 , y −2 , y −3 ]T is the initial condition vector.  Solution   a   a = [1 -2 1.48 -.416] r = roots a   a z  = z3 − 2z2 + 1.48z − .416  a z  =  z − .8  z − .6 − .4j  z − .6 + .4j    b  The complex roots in polar form are p2,3 = r exp ±jθ  where  r = p.62 + .42 θ = arctan ±.4 .6   = .7211  = ±.588  Thus the form of the zero-input response is  yzi k  = c1 p1 k + rk[c2 cos kθ  + c3 sin kθ ]  = c1 .8 k + .7211k[c2 cos .588k  + c3 sin .588k ]   c  Let c ∈ R3 be the unknown coeﬃcient vector, and y0 = [y −1 , y −2 , y −3 ]T. Then  Ac = y0 or  .8−1 .8−2 .8−3     .7211−1 cos −.588  .7211−2 cos[−2 .588 ] .7211−3 cos[−3 .588 ]  .7211−1 sin −.588  .7211−2 sin[−2 .588 ] .7211−3 sin[−3 .588 ]     c = y0  72    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.16 Consider the following linear time-invariant discrete-time system S.  y k  − .9y k − 1  = 2x k  + x k − 1    a  Find the characteristic polynomial a z  and the input polynomial b z .  b  Write down the general form of the zero-state response, yzs k  when the input is x k  =  3 .4 kµ k .   c  Find the zero-state response.  Solution   a    b    c   a z  = z − .9 b z  = 2z + 1  yzs k  = [d0 p0 k + d1 p1 k]µ k  = [d0 .4 k + d1 .9 k]µ k   d0 =  =  Ab z   a z   cid:12  cid:12  cid:12  cid:12 z=p0  3[2 .4  + 1]  .4 − .9  = = −10.8  5.4 −.5 A z − p1 b z    z − p0 a z   cid:12  cid:12  cid:12  cid:12 z=p1  3[2 .9  + 1]  .5  d1 =  =  =  8.4 .5  = 16.8  Thus the zero-state response is  yzs k  = [−10.8 .4 k + 16.8 .9 k]µ k   73    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.17 Consider the following linear time-invariant discrete-time system S.  y k  = y k − 1  − .24y k − 2  + 3x k  − 2x k − 1    a  Find the characteristic polynomial a z  and the input polynomial b z .   b  Suppose the input is the unit step, x k  = µ k . Write down the general form of the  zero-state response, yzs k .   c  Find the zero-state response to the unit step input.  Solution   a    b  The factored form of a z  is  a z  = z2 − z + .24 b z  = 3z − 2  a z  =  z − .6  z − .4   Thus the form of the zero-state response to a unit step input is  yzs k  = [d0 + d1 .6 k + d2 .4 k]µ k   74    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c   Thus the zero-state response is  yzs k  = [4.167 + 2.5 .6 k + 6.667 .4 k]µ k   d0 =  =  =  =  d1 =  d2 =  Ab z   a z   cid:12  cid:12  cid:12  cid:12 z=p0  3 − 2   1 − .6  1 − .4  1 .24  = 4.167  A z − p1 b z    z − p0 a z   cid:12  cid:12  cid:12  cid:12 z=p1  3 .6  − 2   .6 − 1  .6 − .4   = −.2 −.08 = 2.5 A z − p2 b z    z − p0 a z   cid:12  cid:12  cid:12  cid:12 z=p2  3 .4  − 2   .4 − 1  .4 − .6   =  = −.8 −.12 = 6.667  75    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.18 Consider the following linear time-invariant discrete-time system S.  y k  = y k − 1  − .21y k − 2  + 3x k  + 2x k − 2    a  Find the characteristic polynomial a z  and the input polynomial b z . Express a z  in   b  Write down the general form of the zero-input response, yzi k .  c  Find the zero-input response when the initial condition is y −1  = 1 and y −2  = −1.  d  Write down the general form of the zero-state response when the input is x k  =  factored form.  2 .5 k−1µ k .   e  Find the zero-state response using the input in  d .   f  Find the complete response using the initial condition in  c  and the input in  d .  Solution   a    b  The general form of the zero-input response is   c  Using  b  and applying the initial conditions yields  Clearing the denominators,  a z  = z2 − z + .21  =  z − .3  z − .7   b z  = 3z2 + 2  yzi k  = c1 p1 k + c2 p2 k = c1 .3 k + c2 .7 k  c1 .3 −1 + c2 .7 −1 = 1 c1 .3 −2 + c2 .7 −2 = −1  .7c1 + .3c2 = .21  .49c1 + .09c2 = −.0441  76    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Subtracting the second equation from seven times the ﬁrst equation yields 2.01c2 = 1.51. Subtracting .3 times the ﬁrst equation from the second yields .28c1 = −.127. Thus the zero-input response is   d  First note that  yzi k  = −.454 .3 k + .751 .7 k  x k  = 2 .5 k−1µ k   = 4 .5 kµ k   The general form of the zero-state response is  yzs k  = [d0 .5 k + d1 .3 k + d2 .7 k]µ k    e   d0 =  d1 =  Ab z   a z   cid:12  cid:12  cid:12  cid:12 z=p0  4[3 .5 2 + 2]  =   .5 − .3  .5 − .7  4 2.75  = −.04 = −275 A z − p1 b z    z − p0 a z   cid:12  cid:12  cid:12  cid:12 z=p1  4[3 .3 2 + 2]  =   .3 − .5  .3 − .7  4 2.27   =  .08 = 113.5  d2 =  A z − p2 b z    z − p0 a z   cid:12  cid:12  cid:12  cid:12 z=p2  4[3 .7 2 + 2]   .7 − .5  .7 − .3  4 2.63   =  =  .08 = 131.5  77    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the zero-state response is  yzs k  = [−275 .5 k + 113.5 .3 k + 131.5 .7 k]µ k    f  By superposition, the complete response is  y k  = yzi k  + yzs k   = −.454 .3 k + .751 .7 k + [−275 .5 k + 113.5 .3 k + 131.5 .7 k]µ k   78    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.19 Consider the following linear time-invariant discrete-time system S. Sketch a block diagram  of this IIR system.  y k  = 3y k − 1  − 2y k − 2  + 4x k  + 5x k − 1   Solution  x k  e     0  ?  2  6   cid:15  cid:12  ? +  cid:14  cid:13  −  6  -  z−1  -  -  z−1  ?  4  -   cid:15  cid:12  ?   +  cid:14  cid:13   ey k   a = [1, −3, 2] b = [4, 5, 0]     5  ?  6   cid:15  cid:12  ? +  cid:14  cid:13  − −3    6  Problem 2.19  79    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.20 Consider the following linear time-invariant discrete-time system S. Sketch a block diagram  of this FIR system.  y k  = x k  − 2x k − 1  + 3x k − 2  − 4x k − 4   Solution  a = [1, 0, 0] b = [1, −2, 3, 0, −4]  x k  e - z−1  -  z−1     -  z−1  -  z−1     1  ?  ?  −2     3     0  ?  ?  ?  −4  -   cid:15  cid:12  ? +  cid:14  cid:13   -   cid:15  cid:12  ? +  cid:14  cid:13   -   cid:15  cid:12  ? +  cid:14  cid:13   -   cid:15  cid:12  ? +  cid:14  cid:13   ey k   Problem 2.20  80    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.21 Consider the following linear time-invariant discrete-time system S called an auto-regressive  system. Sketch a block diagram of this system.  y k  = x k  − .8y k − 1  + .6y k − 2  − .4y k − 3   Solution  x k  d     ? 0  ? m + −  6  .4  6  ? 1  -  z−1  -  z−1  -  z−1  -  ? m +     dy k   a = [1, .8, −.6, .4] b = [1, 0, 0, 0]     ? 0  -  ? m + −  6  −.6  6        ? 0  -  ? m + −  6  .8  6    Problem 2.21  81    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.22 Consider the block diagram shown in Figure 2.32.  ?  −.4  u2 k   -  z−1  -  u1 k   -  z−1  -   cid:15  cid:12  ?   +  cid:14  cid:13   ey k   x k  e     ?  1.8   cid:15  cid:12  ? +  cid:14  cid:13  − 2.1  6  6     ?  .9  6   cid:15  cid:12  ? +  cid:14  cid:13  − −1.5    6  Figure 2.32 A Block Diagram of the System in Problem 2.22   a  Write a single diﬀerence equation description of this system.   b  Write a system of diﬀerence equations for this system for ui k  and y k .  Solution   a  By inspection of Figure 2.32  y k  = −.4x k  + .9x k − 1  + 1.8x k − 2  + 1.5y k − 1  − 2.1y k − 2    b  The equivalent system of equations is  u2 k  = 1.8x k  − 2.1y k  u1 k  = .9x k  + 1.5y k  + u2 k − 1  y k  = −.4x k  + u1 k − 1   82    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.23 Consider the following linear time-invariant discrete-time system S.  y k  = .6y k − 1  + x k  − .7x k − 1    a  Find the characteristic polynomial and the input polynomial.   b  Write down the form of the impulse response, h k .   c  Find the impulse response.  Solution   a    b    c   a z  = z − .6 b z  = z − .7  h k  = d0δ k  + d1 .6 kµ k   d0 =  d1 =  b z   a z  cid:12  cid:12  cid:12  cid:12 z=0  = −.7  −.6  = 1.167  z − p1 b z   za z  .6 − .7   =  .6  = −.167   cid:12  cid:12  cid:12  cid:12 z=p1  Thus the impulse response is  h k  = 1.167δ k  − .167 .6 kµ k   83    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.24 Consider the following linear time-invariant discrete-time system S.  y k  = −.25y k − 2  + x k − 1    a  Find the characteristic polynomial and the input polynomial.   b  Write down the form of the impulse response, h k .   c  Find the impulse response. Use the identities in Appendix 2 to express h k  in real form.  Solution   a    b  First note that  a z  = z2 + .25 b z  = z  a z  =  z − .5j  z + .5j   Thus the form of the impulse response is  h k  = d0δ k  + [d1 .5j k + d2 −.5j k]µ k    c   d0 =  = 0  d1 =  b z   a z  cid:12  cid:12  cid:12  cid:12 z=0   z − p1 b z   za z   d2 =   z − p2 b z   =  .5j  .5j j   = −j  za z  −.5j  −.5j −j   =  = j   cid:12  cid:12  cid:12  cid:12 z=p1  cid:12  cid:12  cid:12  cid:12 z=p2  84    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus from Appendix 2 the impulse response is  h k  = [−j .5j k + j −.5j k]µ k   = 2Re[−j .5j k]µ k  = −2Re[ .5 k j k+1]µ k  = −2 .5 kRe{[exp jπ 2 ]k+1}µ k  = −2 .5 kRe[exp[j k + 1 π 2]µ k  = −2 .5 k cos[ k + 1 π 2]µ k   85    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.25 Consider the following linear time-invariant discrete-time system S. Suppose 0 < m ≤ n and  the characteristic polynomial a z  has simple nonzero roots.  y k  =  bix k − i  −  aiy k − i   m  Xi=0  n  Xi=1   a  Find the characteristic polynomial a z  and the input polynomial b z .   b  Find a constraint on b z  that ensures that the impulse response h k  does not contain  an impulse term.  a z  = zn + a1zn−1 + · · · + an b z  = b0zn + b + 1zn−1 + · · · + bmzn−m   b  The coeﬃcient of the impulse term is  Solution   a   Thus  d0 =  =  b z   a z  cid:12  cid:12  cid:12  cid:12 z=0  b 0  a 0   d 6= 0 ⇔ b 0  6= 0 ⇔ m = n  86    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.26 Consider the following linear time-invariant discrete-time system S. Compute and sketch the  impulse response of this FIR system.  y k  = u k − 1  + 2u k − 2  + 3u k − 3  + 2u k − 4  + u k − 5   Solution  By inspection, the impulse response is  h k  = [0, 1, 2, 3, 2, 1, 0, 0, . . .]  Impulse Response  2.5  3  2  1    k   h  1.5  0.5  0  0  1  2  3  4  5  6  7  k  Problem 2.26  87    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.27 Using Deﬁnition 2.3, show that for any signal h k   h k  ? δ k  = h k   Solution  From Deﬁnition 2.3 we have  h k  ? δ k  =  h i x k − i   ∞  ∞  Xi=−∞ Xi=−∞  = h k   =  h i δ k − i   88    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.28 Use Deﬁnition 2.3 and the commutative property to show that the linear convolution operator  is associative.  f  k  ? [g k  ? h k ] = [f  k  ? g k ] ? h k   Solution  From Deﬁnition 2.3 we have  d1 k  = f  k  ? [g k  ? h k ]  =  =  ∞  ∞  Xm=−∞ Xm=−∞  g i h k − m − i  f  m " ∞ Xi=−∞ Xi=−∞ f  m g i h k − m − i   ∞  Next, using the commutative property  d2 k  = [f  k  ? g k ] ? h k ]  = h k  ? [f  k  ? g k ]  =  =  =  =  ∞  ∞  ∞  Xi=−∞ Xi=−∞ Xn=−∞ Xm=−∞  f  m g k − i − m  h i " ∞ Xm=−∞ Xm=−∞ h i f  m g k − i − m  Xm=−∞ Xi=−∞  h k − n − m f  m g n   f  m g i h k − m − i   ∞  ∞  ∞  ∞  ,  n = k − i − m  ,  i = n  Thus d2 k  = d1 k .  89    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.29 Use Deﬁnition 2.3 to show that the linear convolution operator is distributive.  f  k  ? [g k  + h k ] = f  k  ? g k  + f  k  ? h k   Solution  d k  = f  k  ? [g k  + h k ]  =  =  =  ∞  ∞  Xi=−∞ Xi=−∞ Xi=−∞  ∞  f  i [g k − i  + h k − i ]  f  i g k − i  + f  i h k − i ]  f  i g k − i  +  f  i h k − i ]  ∞  Xi=−∞  = f  k  ? g k  + f  k  ? h k   90    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.30 Suppose h k  and x k  are deﬁned as follows.  h = [2, −1, 0, 4]T x = [5, 3, −7, 6]T   a  Let yc k  = h k ◦x k . Find the circular convolution matrix C x  such that yc = C x h.  b  Use C x  to ﬁnd yc k .  Solution   a  Using  2.7.9  and Example 2.14 as a guide, the 4 × 4 circular convolution matrix is   b  Using  2.7.10  and the results from part  a   C x  =   =    x 0  x 3  x 2  x 1  x 1  x 0  x 3  x 2  x 2  x 1  x 0  x 3  x 3  x 2  x 1  x 0   5 6 −7 3 3 5 6 −7 6 5 −7 3 6 −7 3 5         yc = C x h  2 −1 0 4           =   =    5 6 −7 3 3 5 6 −7 6 5 −7 3 6 −7 3 5   16 −27  7 39  91  This can be veriﬁed using the FDSP toolbox function f conv.    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.31 Suppose h k  and x k  are the following signals of length L and M , respectively.  h = [3, 6, −1]T x = [2, 0, −4, 5]T   a  Let hz and xz be zero-padded versions of h k  and x k  of length N = L + M − 1.  Construct hz and xz.   b  Let yc k  = hz k  ◦ xz k . Find the circular convolution matrix C xz   such that yc =  C xz hz.   c  Use C xz  to ﬁnd yc k .  d  Use yc k  to ﬁnd the linear convolution y k  = h k  ? x k  for 0 ≤ k < N .  Solution   a  Here  Thus the zero-padded versions of h k  and x k  are  N = L + M − 1 = 3 + 4 − 1 = 6  hz = [3, 6, −1, 0, 0, 0]T xz = [2, 0, −4, 5, 0, 0]T   b  Using  2.7.9  and the results from part  a , the N × N circular convolution matrix is         C xz  =  xz 0  xz 5  xz 4  xz 3  xz 2  xz 1  xz 1  xz 0  xz 5  xz 4  xz 3  xz 2  xz 2  xz 1  xz 0  xz 5  xz 4  xz 3  xz 3  xz 2  xz 1  xz 0  xz 5  xz 4  xz 4  xz 3  xz 2  xz 1  xz 0  xz 5  xz 5  xz 4  xz 3  xz 2  xz 1  xz 0       =  2 0 0 0 2 0 −4 0 2 5 −4 0 0 5 −4 0 0  0 5 −4 0 5 −4 5 0 0 0 0 2 0 2 0 0 2 5 −4      92    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  2.7.9 , the circular convolution of hz k  with xz k  is  5 −4 0 5 −4 0 5 0 0 0 0 2 0 2 0 2 0 5 −4  3 6 −1 0 0 0              yz k  = C xz hz  =  =         2 0 0 0 2 0 −4 0 2 5 −4 0 5 −4 0 0 0   6 12 −14 −9 34 −5     d  Using  2.7.14  and the results of part  c , the linear convolution y k  = h k  ? x k  is  y k  = hz k  ◦ xz k   = C xz hz = [6, 12, −14,−9, 34, 5]T  This can be veriﬁed using the FDSP toolbox function f conv.  93    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.32 Consider a linear discrete-time system S with input x and output y. Suppose S is driven by an input x k  for 0 ≤ k < L to produce a zero-state output y k . Use deconvolution to ﬁnd the impulse response h k  for 0 ≤ k < L if x k  and y k  are as follows.  x = [2, 0, −1, 4]T y = [6, 1, −4, 3]T  h 0  =  y 0  x 0  6 2 = 3  =  h 1  =  y 1  − h 0 x 1   x 0  1 − 3 0   2  =  = .5  Solution  Using  2.7.15  and Example 2.16 as a guide  Applying  2.7.18  with k = 1 yields  Applying  2.7.18  with k = 2 yields  Finally, applying  2.7.18  with k = 3 yields  h 2  =  y 2  − h 0 x 2  − h 1 x 1   x 0   = −4 − 3 −1  − .5 0  = −.5  2  h 3  =  y 3  − h 0 x 3  − h 1 x 2  − h 2 x 1   x 0   3 − 3 4  − .5 −1  + .5 0   = = −4.25  2  94    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the impulse response of the discrete-time system is  h k  = [3, .5, −.5,−4.25]T  ,  0 ≤ k < 4  This can be veriﬁed using the FDSP toolbox function f conv.  95    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.33 Suppose x k  and y k  are the following ﬁnite signals.  x = [5, 0, −4]T y = [10, −5, 7, 4,−12]T   a  Write the polynomials x z  and y z  whose coeﬃcient vectors are x and y, respectively.  The leading coeﬃcient corresponds to the highest power of z.   b  Using long division, compute the quotient polynomial q z  = y z  x z .  c  Deconvolve y k  = h k  ? x k  to ﬁnd h k  using  2.7.15  and  2.7.18 . Compare the  result with q z  from part  b .  Solution   a    b   x z  = 5z2 − 4 y z  = 10z4 − 5z3 + 7z2 + 4z − 12  5z2 − 4  2z2 − z + 3  10z4 − 5z3 + 7z2 + 4z − 12 10z4 − 0z3 − 8z2  −5z3 + 15z2 + 4z −5z3 − 0z2 + 4z  15z2 + 0z − 12 15z2 + 0z − 12  0  Thus the quotient polynomial is   c  Using  2.7.15  and Example 2.16 as a guide  q z  = 2z2 − z + 3  q 0  =  y 0  x 0  = −12 −4 = 3  96    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Applying  2.7.18  with k = 1 yields  Applying  2.7.18  with k = 2 yields  q 1  =  y 1  − q 0 x 1   x 0  4 − 3 0   = = −1  −4  q 2  =  y 2  − q 0 x 2  − q 1 x 1   x 0  7 − 3 5  −  −1 0  −4  =  = 2  Thus q = [2, −1, 3] and the quotient polynomial is  q z  = 2z2 − z + 3  This can be veriﬁed using the MATLAB function deconv.  97    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.34 Some books use the following alternative way to deﬁne the linear cross-correlation of an L point signal y k  with and M -point signal x k . Using a change of variable, show that this is equivalent to Deﬁnition 2.5  ryx k  =  y n + k x n   1 L  L−1−k  Xn=0  Solution  Consider the change of variable i = n + k. Then n = i − k and  ryx k  =  1 L  1 L  L−1−k  y n + k x n  cid:12  cid:12  cid:12  cid:12  cid:12 i=n+k  Xn=0 Xi=k y i x i − k   L−1  =  Since x n  = 0 for n < 0, the lower limit of the sum can be changed to zero without aﬀecting the result. Thus,  ryx k  =  y i x i − k   ,  0 ≤ k < L  1 L  L−1  Xi=0  This is identical to Deﬁnition 2.5.  98    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.35 Suppose x k  and y k  are deﬁned as follows.  x = [5, 0, −10]T y = [1, 0, −2, 4, 3]T   a  Find the linear cross-correlation matrix D x  such that ryx = D x y.  b  Use D x  to ﬁnd the linear cross-correlation ryx k .  c  Find the normalized linear cross-correlation ρyx k .  Solution   a  Using  2.8.2  and Example 2.18 as a guide, the linear cross-correlation matrix is   b  Using  2.8.3  and the results from part  a   D x  =       1 5  1 5     =  =     0 0  x 0  x 1  x 2  x 0  x 1  x 0   x 0  x 1  x 2   0  0 0  x 0  x 1  x 2   0 0 0 0 0 0 0 0 0 5 0 −10 0 0 5 0 −10 5 0 0 0 −10 0 5 0 0 0 5 0 0 0 0  0     0 1 0 −2 0 0 1 0 −2 0 0 −2 1 0 0 0 1 0 0 0 0 1 0 0 0     0 1 0 −2 0 0 1 0 −2 0 1 0 0 0 −2 0 1 0 0 0 0 1 0 0 0  1 0 −2 4 3           ryx = D x y  =  =       5 −8 −8 4 3     99    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   This can be veriﬁed using the FDSP toolbox function f corr.   c  Using  2.8.5  we have L = 5 and M = 3. Also from Deﬁnition 2.5  ryy 0  =  y2 i   1 L  L−1  Xi=0  1 + 0 + 4 + 16 + 9  =  = 6  5  rxx 0  =  x2 i   1 M  M −1  Xi=0  25 + 0 + 100  =  3  = 41.67  Finally, from  4.49  the normalized cross-correlation of x k  with y k  is  ρyx k  =  =  ryx k   ryx k   p M L rxx 0 ryy 0  p.6 6 41.67  = [.408, −.653,−.653, .327, .245]T  This can be veriﬁed using the FDSP toolbox function f corr.  100    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.36  Suppose y k  is as follows.  y = [5, 7, −2, 4, 8, 6, 1]T   a  Construct a 3-point signal x k  such that ryx k  reaches its peak positive value at k = 3   b  Construct a 4-point signal x k  such that ryx k  reaches its peak negative value at k = 4  and x 0  = 1.  and x 0  = 1.  Solution   a  Recall that the cross-correlation ryx k  measures the degree which x k  is similar to a subsignal of y k . In order for ryx k  to reach its maximum positive value at k = 3, one must have maximum positive correlation starting at k = 3. Thus for some positive constant α it is necessary that  The constraint, x 0  = 1, implies that the positive scale factor must be α = 1 4. Thus   b  In order for ryx k  to reach its maximum negative value at k = 2, one must have maximum negative correlation starting at k = 2. Thus for some positive constant α we need  The constraint, x 0  = 1, implies that the positive scale factor must be α = 1 2. Thus  The answers to  a  and  b  can be veriﬁed using the FDSP toolbox function f corr.  x = α[y 3 , y 4 , y 5 ]T  = α[4, 8, 6]T  x = [1, 2, 1.5]T  x = −α[y 2 , y 3 , y 4 , y 5 ]T  = α[2, −4, −8, −6]T  x = [1, −2, −4, −3]T  101    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.37 Suppose x k  and y k  are deﬁned as follows.  x = [4, 0, −12, 8]T y = [2, 3, 1,−1]T   a  Find the circular cross-correlation matrix E x  such that cyx = E x y.  b  Use E x  to ﬁnd the circular cross-correlation cyx k .   c  Find the normalized circular cross-correlation σyx k .  Solution   a  Using Deﬁnition 2.6, cyx k  is just 1 N times the dot product of y with x rotated right  by k samples. Thus the kth row of E x  is the vector x rotated right by k samples.   b  Using Deﬁnition 2.6 and the results from part  a   1 4  1 4       E x  =  x 0  x 1  x 2  x 3  x 3  x 0  x 1  x 2  x 2  x 3  x 0  x 1  x 1  x 2  x 3  x 0   8 −12 0 4  4 0 −12 8 0 4 −12 8 4 0 −12 8 1 0 −3 2 2 1 0 −3 −3 2 1 0 1 2 0 −3     =  =         cyx = E x y        2 3 1 −1     =   =    1 0 −3 2 2 1 0 −3 0 1 −3 2 0 −3 2 1  −3 10  1 −8  This can be veriﬁed using the FDSP toolbox function f corr.  102    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  2.8.7 , N = 4. Also from Deﬁnition 2.6  cyy 0  =  y2 i   4 + 9 + 1 + 1  =  = 3.75  4  1 N  N −1  Xi=0  1 N  N −1  Xi=0  16 + 0 + 144 + 64  =  = 56  4  cxx 0  =  x2 i   Finally, from  2.8.7  the normalized circular cross-correlation of y k  with x k  is  σyx k  =  =  cyx k   cyx k   pcxx 0 cyy 0  p3.75 56   = [−.207, .690, .069,−.552]T  This can be veriﬁed using the FDSP toolbox function f corr.  103    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.38 Suppose y k  is as follows.  y = [8, 2, −3, 4, 5, 7]T   a  Construct a 6-point signal x k  such that σyx 2  = 1 and x 0  = 6.  b  Construct a 6-point signal x k  such that σyx 3  = −1 and x 0  = 12.  Solution   a  Recall that normalized circular cross-correlation, −1 ≤ σyx k  ≤ 1, measures the degree which a rotated version of a signal x k  is similar to the signal y k . In order for σyx k  to reach its maximum positive value at k = 2, one must have maximum positive correlation starting at k = 2. Thus for some positive constant α it is necessary that  x = α[y 2 , y 3 , y 4 , y 5 , y 0 , y 1 ]T  = α[−3, 4, 5, 7, 8, 2]T  The constraint, x 0  = 6, implies that the positive scale factor must be α = 2. Thus  x = [−6, 8, 10, 14, 16, 4]T  Because y and x are of the same length, this will result is σyx 2  = 1 which can be veriﬁed by using the FDSP toolbox function f corr.   b  In order for σyx k  to reach its maximum negative value at k = 3, one must have  maximum negative correlation starting at k = 3. Thus for some positive constant α  x = −α[y 3 , y 4 , y 5 , y 0 , y 1 , y 2 ]T  = α[4, 5, 7, 8, 2,−3]T  The constraint, x 0  = 12, implies that the positive scale factor must be α = 3. Thus  Because y and x are of the same length, this will result is σyx 3  = −1 which can be veriﬁed by using the FDSP toolbox function f corr.  x = [12, 15, 21, 24, 6,−9]T  104    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.39 Let x k  be an N-point signal with average power Px.   a  Show that rxx 0  = cxx 0  = Px   b  Show that ρxx 0  = σxx 0  = 1  Solution   a  The average power of x k  is  From Deﬁnition 2.5, the auto-correlation of an N -point signal is  Px =  x2 k   1 N  N −1  Xk=0  rxx 0  =  x i x i − 0   1 N  1 N  N −1  N −1  Xi=0 Xi=0  = Px  =  x2 i   cxx 0  =  x i xp i − 0   1 N  1 N  1 N  N −1  N −1  Xi=0 Xi=0 Xi=0  N −1  =  =  = Px  x i xp i   x2 i   ρxx 0  =  rxx 0   p N N  rxx 0 rxx 0   = 1  105  From Deﬁnition 2.6, the circular auto-correlation of an N -point signal with periodic extension xp k  is   b  From  2.8.5 , the normalized auto-correlation of an N -point signal is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   From  2.8.7 , the normalized circular auto-correlation of an N -point signal is  σxx 0  =  cxx 0   pcxx 0 cxx 0   = 1  106    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.40 This problem establishes the normalized circular cross-correlation inequality, σyx k  ≤ 1. Let  x k  and y k  be sequences of length N where xp k  is the periodic extension of x k .   a  Consider the signal u i, k  = ay i  + xp i − k  where a is arbitrary. Show that  1 N  N −1  Xi=0  [ay i  + xp i − k ]2 = a2cyy 0  + 2acyx k  + cxx 0  ≥ 0   b  Show that the inequality in part  a  can be written in matrix form as  [a, 1] cid:20  cyy 0   cyx k   cyx k   cxx 0   cid:21  cid:20  a  1  cid:21  ≥ 0   c  Since the inequality in part  b  holds for any a, the 2 × 2 coeﬃcient matrix C k  is  positive semi-deﬁnite which means that det[C k ] ≥ 0. Use this fact to show that  c2 yx k  ≤ cxx 0 cyy 0   ,  0 ≤ k < N   d  Use the results from part  c  and the deﬁnition of normalized cross correlation to show  −1 ≤ σyx k  ≤ 1  ,  0 ≤ k < N  that  Solution   a   1 N  N −1  Xi=0  u2 i, k  =  [ay i  + xp i − k ]2  1 N  1 N  a2 N  N −1  N −1  Xi=0 Xi=0 Xi=0  N −1  =  =  a2y2 i  + 2ay i xp i − k  + x2  p i − k   y2 i  +  y i xp i − k  +  x2 p i − k   1 N  N −1  Xi=0  2a N  N −1  Xi=0  1 N  N −1  Xi=0  = a2cyy 0  + 2acyx k  +  x2 i   = a2cyy 0  + 2acyx k  + cxx 0  ≥ 0  107    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b   [a, 1] cid:20  cyy 0   cyx k   cyx k   cxx 0   cid:21  cid:20  a  acyx k  + cxx 0   cid:21  1  cid:21  = [a, 1] cid:20  acyy 0  + cyx k   = a2cyy 0  + acyx k  + acyx k  + cxx 0  = a2cyy 0  + 2acyx k  + cxx 0    c  The coeﬃcient matrix C k  from part  b  is positive semi-deﬁnite and therefore det[C k ] ≥  0. But  det[C k ] = det cid:26  cid:20  cyy 0  = cyy 0 cxx 0  − c2 ≥ 0  cyx k   cyx k   cxx 0   cid:21  cid:27   yx k   c2 yx k  ≤ cxx 0 cyy 0   ,  0 ≤ k < N   d  Using  2.8.7  and the results from part  c   Thus  Thus  cyx k   σyx k  =  cid:12  cid:12  cid:12  cid:12  cid:12  pcxx 0 cyy 0  cid:12  cid:12  cid:12  cid:12  cid:12  s c2 cxx 0 cyy 0  cid:12  cid:12  cid:12  cid:12  cid:12  =  cid:12  cid:12  cid:12  cid:12  cid:12   ≤ 1  yx k   −1 ≤ σyx k  ≤ 1  ,  0 ≤ k < N  108    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.41 Consider the following FIR system.  y k  =   1 + i 2x k − i   5  Xi=0  Let x k  be a bounded input with bound Bx. Show that y k  is bounded with bound By = cBx. Find the minimum scale factor, c.  Solution  Here  Thus  5  5  ≤   1 + i 2x k − i  cid:12  cid:12  cid:12  cid:12  cid:12   y k  =  cid:12  cid:12  cid:12  cid:12  cid:12  Xi=0 Xi=0  1 + i 2x k − i  Xi=0 Xi=0 ≤ Bx = khk1Bx   1 + i 2  =  5  5   1 + i 2 · x k − i   khk1 =   1 + i 2  5  Xi=0  = 93  = 1 + 4 + 9 + 16 + 25 + 36  By = 93Bx  109    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.42 Consider a linear time-invariant discrete-time system S with the following impulse response.  Find conditions on A and p that guarantee that S is BIBO stable.  h k  = A p kµ k   Solution  The system S is BIBO stable if an only if khk1 < ∞. Here  khk1 =  h k   =  A p k  = A  pk  ∞  ∞  Xk=−∞ Xk=0 Xk=0 A 1 − p  ∞  =  ,  p < 1  Thus S is BIBO stable if and only if p < 1. There is no constraint on A.  110    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.43 From Proposition 2.1, a linear time-invariant discrete-time system S is BIBO stable if and only if the impulse response h k  is absolutely summable, that is, khk1 < ∞. Show that khk1 < ∞ is necessary for stability. That is, suppose that S is stable but h k  is not absolutely summable. Consider the following input where h∗ k  denotes the complex conjugate of h k   Proakis and Manolakis,1992 .  h∗ k  h k   0  , h k  6= 0 , h k  = 0  x k  =     a  Show that x k  is bounded by ﬁnding a bound Bx.  b  Show that S is not is BIBO stable, by showing that y k  is unbounded at k = 0.  Solution   a  Since x 0  = 0 when h k  = 0, consider the case when h k  6= 0.  Thus x k  is bounded with Bx = 1.   b   y 0  = h k  ? x k k=0  x k  =  cid:12  cid:12  cid:12  cid:12   h∗ k   h k  cid:12  cid:12  cid:12  cid:12   = h∗ k  h k  = h k  h k   = 1  h i x −i  cid:12  cid:12  cid:12  cid:12  cid:12   h i h∗ −i  h −i    cid:12  cid:12  cid:12  cid:12  cid:12   h i  · h∗ −i   h −i   h i   ∞  ∞  ∞  =  =  cid:12  cid:12  cid:12  cid:12  cid:12  Xi=−∞ =  cid:12  cid:12  cid:12  cid:12  cid:12  Xi=−∞ Xi=−∞ Xi=−∞ = khk1 = ∞  =  ∞  111    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.44 Consider the following discrete-time system. Use GUI module g systime to simulate this system. Hint: You can enter the b vector in the edit box by using two statements on one line: i=0:8; b=cos pi*i 4   y k  =  cos πi 4 x k − i   8  Xi=0   a  Plot the polynomial roots   b  Plot and the impulse response using N = 40.  Solution  0 0  0 0  x k  x k   S S  y k  y k   Polynomial roots: ’x’=a z , ’o’=b z   Magnitude of b z  a z     z   m I  2  1  0  −1  −2  −2  −1  0  Re z   1  2  Problem 2.44  a  Polynomial Roots  0  Im z   −2  −2  0  −1  Re z   2  1    B d        z   a     z   b   20  10  0  −10  −20 2  112    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   S  y k   0  0  1    k   x  0.5  0  1  0    k   y  0  −1  0  5  5  Time signals, unit impulse input  10  15  20  25  30  35  10  15  25  30  35  20 k  Problem 2.44  b  Impulse Response  113    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.45 Consider a discrete-time system with the following characteristic and input polynomials. Use GUI module g systime to plot the step response using N = 100 points. The MATLAB poly function can be used to specify coeﬃcient vectors a and b in terms of their roots as discussed in Section 2.9.  a z  =  z + .5 ± j.6  z − .9  z + .75  b z  = 3z2 z − .5 2  Solution  0  0  1    k   x  0.5  0  5  0    k   y  0  −5  0  x k   S  y k   Time signals, unit step input  10  20  30  40  50  60  70  80  90  10  20  30  40  60  70  80  90  50 k  Problem 2.45 Step Response  114    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.46 Consider the following linear discrete-time system.  y k  = 1.7y k − 2  − .72y k − 4  + 5x k − 2  + 4.5x k − 4   Use GUI module g systime to plot the following damped cosine input and the zero-state response to it using N = 30. To determine F0, set 2πF0kT = .3πk and solve for F0 fs where T = 1 fs.  x k  = .97k cos .3πk   2πF0kT = .3πk  Thus 2F0T = .3 or F0 = .15fs. If fs = 2000, then F0 = 300.  x k   S  y k   Solution  0  0  1  0    k   x  −1  20  0    k   y  10  0  −10  0  Time signals, damped cosine input: c=0.97, F0=300  50  100  150  200  250  50  100  200  250  150 k  Problem 2.46 Input and Output  115    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.47 Consider the following linear discrete-time system.  y k  = −.4y k − 1  + .19y k − 2  − .104y k − 3  + 6x k  − 7.7x k − 1  + 2.5x k − 2   Create a MAT-ﬁle called prob2 47 that contains f s = 100, the appropriate coeﬃcient vectors a and b, and the following input samples where v k  is white noise uniformly distributed over [−.2, .2]. Uniform white noise can be generated with the MATLAB function rand.  x k  = k exp −k 50  + v k   ,  0 ≤ k < 500   a  Print the MATLAB program used to create prob2 47.mat.   b  Use GUI module g systime and the User-deﬁned option to plot the roots of the charac-  teristic polynomial and the input polynomial.   c  Plot the zero-state response on the input x k .  Solution   a  % Problem 2.47  f_header ’Problem 2.47: Create MAT file’  fs = 100; a = [1 .4 -.19 .104] b = [6 -7.7 2.5]; N = 500; v = -.2 + .4*rand 1,N ; k = 0:N-1; x = k .* exp -k 50  + v; save prob2_47 fs a b x what  116    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   S  y k   0  0  Polynomial roots: ’x’=a z , ’o’=b z   Magnitude of b z  a z     z   m I  2  1  0  −1  −2  −2  0 0  0 0    k   x  10  0  −10  0  20    k   y  10  0  −10  0  −1  0  Re z   1  2  Problem 2.47  b  Polynomial Roots  0  Im z   −2  −2  0  −1  Re z   2  1  x k  x k   S S  y k  y k   Time signals, user−defined input from file C:\rjs\books\book4\_2e\chap2\prob\prob2_47.mat 20  50  100  150  200  250  300  350  400  450  50  100  150  200  300  350  400  450  250 k  Problem 2.47  c  Input and Output    B d        z   a     z   b   50  0  −50  −100 2  117    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.48 Consider the following discrete-time system which is a narrow band resonator ﬁlter with  sampling frequency of fs = 800 Hz.  y k  = .704y k − 1  − .723y k − 2  + .141x k  − .141x k − 2   Use GUI module g systime to ﬁnd the zero-input response for the following initial conditions. In each chase plot N = 50 points.   a  y0 = [10, −3]T  b  y0 = [−5, −8]T  Solution  x k  x k  x k  x k  x k  x k   S S S S S S  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0  0 0 0 0 0 0  1  0  −1  10  0    k   x    k   y  −10  Time signals, zero input  0  5  10  15  20  25  30  35  40  45  0  5  10  15  20  25  30  35  40  45  k  Problem 2.48  a  Zero-input Response  118    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k   S S S S S  y k  y k  y k  y k  y k   0 0 0 0 0  0 0 0 0 0  1  0  −1  10  0    k   x    k   y  −10  Time signals, zero input  0  5  10  15  20  25  30  35  40  45  0  5  10  15  20  25  30  35  40  45  k  Problem 2.48  b  Zero-input Response  119    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.49 Consider the following discrete-time system which is a notch ﬁlter with sampling interval  T = 1 360 sec.  y k  = .956y k − 1  − .914y k − 2  + x k  − x k − 1  + x k − 2   Use GUI module g systime to ﬁnd the output corresponding to the sinusoidal input x k  = cos 2πF0kT  µ k . Do the following cases. Use the caliper option to estimate the steady state amplitude in each case.   a  Plot the output when F0 = 10 Hz.   b  Plot the output when F0 = 60 Hz.  Solution  x k  x k  x k  x k  x k  x k  x k   S S S S S S S  y k  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0 0  0 0 0 0 0 0 0  1  0    k   x  −1  0  2    k   y  0  −2  0  Time signals, damped cosine input: c=1, F0=10  50  100  150  200  250  50  100  200  250  150 k  Problem 2.49  a  F0 = 10 Hz  120    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k  x k  x k  x k   S S S S S S S S  y k  y k  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0  1  0    k   x  −1  0  1    k   y  0  −1  0  Time signals, damped cosine input: c=1, F0=60  50  100  150  200  250  50  100  200  250  150 k  Problem 2.49  b  F0 = 60 Hz  121    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.50 Consider the following two polynomials. Use g systime to compute, plot, and save in a data ﬁle, the coeﬃcients of the product polynomial c z  = a z b z . Then load the saved ﬁle and display the coeﬃcients of the product polynomial.  a z  = z2 − 2z + 3 b z  = 4z3 + 5z2 − 6z + 7  x k   S  y k   Solution  0  0  10  b , a  0  −10    −1  50  0  −50    −1  b * a   =   p  Convolution  2  conv a,b   3  2  3  k     a b  6    6  p = a*b  5  5  4  4  0  0  1  1  Problem 2.50 Polynomial Multiplication  product =  4  -3  -4  34  -32  21  122    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.51 Consider the following two polynomials. Use g systime to compute, plot, and save in a data ﬁle, the coeﬃcients of the quotient polynomial q z  and the remainder polynomial r z  where b z  = q z a z  + r z . Then load the saved ﬁle and display the coeﬃcients of the quotient and remainder polynomials.  a z  = z2 + 3z − 4 b z  = 4z4 − z2 − 8  x k   S  y k   Deconvolution  0  0  1  1  2  2 k  3  3  4  4  Problem 2.51 Polynomial Division  a b  q r     5    5  Solution  0  0  5  0  −5  b , a  −10    −1  200  0  −200  −400    −1  r   +   a * q   =   b  quotient =  remainder =  4  0  -12  51  0  0  -201  196  123    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.52 Use the GUI module g correlate to record the sequence of vowels “A”,“E”,“I”,  “O”,“U” in y. Play y to make sure you have a good recording of all ﬁve vowels. Then record the vowel “O” in x. Play x back to make sure you have a good recording of “O” that sounds similar to the “O” in y. Save this data in a MAT-ﬁle named my vowels.   a  Plot the inputs x and y showing the vowels.   b  Plot the normalized cross-correlation of y with x using the Caliper option to mark the  peak which should show the location of x in y.   c  Based on the plots in  a , estimate the lag d1 that would be required to get the “O” in x to align with the “O” in y. Compare this with the peak location d2 in  b . Find the percent error relative to the estimated lag d1. There will be some error due to the overlap of x with adjacent vowels and co-articulation eﬀects in creating y.  x k   Linear cross−  y k   correlation  ρ  yx   k   Solution  0  0  1  0    k   y  −1  0  1    k   x  0  −1  0  Inputs x and y: user−defined inputs from file C:\rjs\books\book4\_2e\chap2\prob\my_vowels.mat  2000  4000  6000  8000  10000  12000  14000  16000  2000  4000  6000  10000  12000  14000  16000  8000  k  Problem 2.52  a  The Vowels A, E, I, O, U  124    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   Linear cross−  y k   correlation  ρ  yx   k   0 0 0  0 0 0    k    x y  ρ  0.3  0.2  0.1  0  −0.1  −0.2  0  Normalized cross−correlation: user−defined inputs from file C:\rjs\books\book4\_2e\chap2\prob\my_vowels.mat     x,y  =  6807.14,0.25   2000  4000  6000  10000  12000  14000  16000  8000  k  Problem 2.52  b  Normalized Cross-correlation of x with y   c  From part  a , the start of O in x is approximately ox = 9000, and the start of O in y is approximately oy = 1800. Thus the translation of y required to get a match with x is  The peak in part  b  is at d2 = 6807. Thus the percent error in ﬁnding the location of O in x is  d1 = ox − oy  ≈ 9000 − 1800 = 7200  E =  100 d2 − d1   d1  100 6807 − 7200   = = −5.46 %  7200  125    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.53 The ﬁle prob2 53.mat contains two signals, x and y, and their sampling frequency f s. Use  the GUI module g correlate to load x, y, and f s.   a  Plot x k  and y k .   b  Plot the normalized linear cross-correlation ρyx k . Does y k  contain any scaled and shifted versions of x k ? Determine how many, and use the Caliper option to estimate the locations of x k  within y k .  x k   Linear cross−  y k   correlation  ρ  yx   k   Solution  0  0  5  0    k   y  −5  0  1    k   x  0  −1  0  Inputs x and y: user−defined inputs from file C:\rjs\books\book4\_2e\chap2\prob\prob2_53.mat  500  1000  1500  2000  2500  3000  3500  4000  4500  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 2.53  a   126    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   Linear cross−  y k   correlation   k   ρ yx  0 0  0 0  x y  0.25  0.2  0.15  0.1  0.05  0  −0.05  −0.1  0  Normalized cross−correlation: user−defined inputs from file C:\rjs\books\book4\_2e\chap2\prob\prob2_53.mat     x,y  =  387.72,0.19      x,y  =  1717.63,0.18      x,y  =  2850.67,0.18   500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 2.53  b   From the plot of ρxy k , there are three scaled and shifted versions of y k  within x k . They are located at  k = [388, 1718, 2851]  127    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.54 Consider the following discrete-time system.  y k  = .95y k − 1  + .035y k − 2  − .462y k − 3  + .351y k − 4  + .5x k  − .75x k − 1  − 1.2x k − 2  + .4x k − 3 − 1.2x k − 4   Write a MATLAB program that uses ﬁlter and plot to compute and plot the zero-state response of this system to the following input. Plot both the input and the output on the same graph.  x k  =  k + 1 2 .8 kµ k   ,  0 ≤ k ≤ 100  Solution  % Problem 2.54  % Initialize  f_header ’Problem 2.54’  a = [1 -.95 -.035 .462 -.351] b = [.5 -.75 -1.2 .4 -1.2] N =101; k = 0 : N-1; x =  k+1 .^2 .*  .8 .^k;  % Find zero-state response  y = filter  b,a,x ;  % Plot input and output  figure h = plot  k,x,k,y ; set  h 2 ,’LineWidth’,1.0  f_labels  ’’,’k’,’x k  and y k ’  legend  ’x’,’y’  f_wait  128    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   y   d n a     k   x  20  0  −20  −40  −60  −80  −100  −120  −140  −160    0     x y  20  40  60  80  100  k  Problem 2.54 Input and Zero-State Response  129    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.55 Consider the following discrete-time system.  a z  = z4 − .3z3 − .57z2 + .115z + .0168 b z  = 10 z + .5 3  This system has four simple nonzero roots. Therefore the zero-input response consists of a sum of the following four natural mode terms.  yzi k  = c1 p1 k + c2 p2 k + c3 p3 k + c4 p4 k  The coeﬃcients can be determined from the initial condition  y0 = [y −1 , y −2 , y −3 , y −4 ]T  Setting yzi −k  = y −k  for 1 ≤ k ≤ 4 yields the following linear algebraic system in the coeﬃcient vector c = [c1, c2, c3, c4]T .  1  1  p−1 p−2 p−3 p−4  1  1     2  2  p−1 p−2 p−3 p−4  2  2  3  3  p−1 p−2 p−3 p−4  3  3  4  4  p−1 p−2 p−3 p−4  4  4  c1 c2 c3 c4           = y0  Write a MATLAB program that uses roots to ﬁnd the roots of the characteristic polynomial and then solves this linear algebraic system for the coeﬃcient vector c using the MATLAB left division or \ operator when the initial condition is y0. Print the roots and the coeﬃcient vector c. Use stem to plot the zero-input response yzi k  for 0 ≤ k ≤ 40.  Solution  % Problem 2.55  % Initialize  f_header ’Problem 2.55’  a = [1 -.3 -.57 .115 .0168] y = [2 -1 0 3]’ n = 4;  130    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Construct coefficient matrix  p = roots a  A = zeros n,n ; for i = 1 : n  for k = 1 : n  A i,k  = p k ^ -i ;  end  end  c = A \ y  % Find coefficient vector c  % Compute zero-input response  N =41; k = 0 : N-1; y_0 = zeros 1,N ; for i = 1 : n  y_0 = y_0 + c i  .^ k;  end  % Plot it  figure stem  k,y_0,’filled’,’.’  f_labels  ’’,’k’,’y_0 k ’  f_wait  Program Output:  p =  c =  -.7000 .8000 .3000 -.1000  -.8195 .8720 -.0742 .0013  131    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k    y  0  3.5  2.5  1.5  4  3  2  1  0  0.5  −0.5  0  5  10  15  25  30  35  40  20 k  Problem 2.55 Zero-Input Response to Initial Condition  132    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.56 Consider the discrete-time system in Problem 2.55. Write a MATLAB program that uses the FDSP function f ﬁlter0 to compute the zero-input response to the following initial condition. Use stem to plot the zero-input response yzi k  for −4 ≤ k ≤ 40.  y0 = [y −1 , y −2 , y −3 , y −4 ]T  Solution  % Problem 2.56  % Initialize  f_header ’Problem 2.56’  a = [1 -.3 -.57 .115 .0168] b = 10*poly [-.5,-.5,-.5]  y0 = [2 -1 0 3]’ n = 4;  % Solve system  N = 41; x = zeros 1,N ; y_zi = f_filter0 b,a,x,y0 ;  % Plot it  figure k = [-n : N-1]; stem  k,y_zi,’filled’,’.’  f_labels  ’Zero-input Response’,’k’,’y_{zi} k ’  f_wait  133    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Zero−input Response    k    y  i z  2.5  3  2  1  0  1.5  0.5  −0.5  −1  −5  0  5  10  15  20  25  30  35  40  k  Problem 2.56 Zero-input Response  134    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.57 Consider the following running average ﬁlter. Write a MATLAB program that performs the  following tasks.  y k  =  x k − i   ,  0 ≤ k ≤ 100  1 10  9  Xi=0   a  Use ﬁlter and plot to compute and plot the zero-state response to the following input where v k  is a random white noise uniformly distributed over [−.1, .1]. Plot x k  and y k  below one another. Uniform white noise can be generated using the MATLAB function rand.  x k  = exp −k 20  cos πk 10 µ k  + v k    b  Add a third curve to the graph in part  a  by computing and plotting the zero-state  response using conv to perform convolution.  Solution  The transfer function of this FIR ﬁlter is  H z  = .1  z−i  9  Xi=0  % Problem 2.57  % Initialize  f_header ’Problem 2.57’  m = 9; b = .1*ones 1,m+1 ; a = 1; N =101; k = 0 : N-1; c = .1; x = exp -k 20  .* cos pi*k 10  + f_randu 1,N,-c,c ;  % Find zero-state response  y = filter  b,a,x ;  % Plot input and output  135    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   figure h = plot  k,x,k,y ; set  h 2 ,’LineWidth’,1.0  f_labels  ’Input and Output’,’k’,’x k  and y k ’  legend  ’x’,’y’  f_wait  Input and Output     x y    k   y   d n a     k   x  1.2  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8    0  20  40  60  80  100  k  Problem 2.57 Running Average Filter of Order m = 9  136    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.58 Consider the following FIR ﬁlter. Write a MATLAB program that performs the following  tasks.  y k  =   −1 ix k − i   10 + i2  20  Xi=0   a  Use the function ﬁlter to compute and plot the impulse response h k  for 0 ≤ k < N  where N = 50.   b  Compute and plot the following periodic input.  x k  = sin .1πk  − 2 cos .2πk  + 3 sin .3πk   ,  0 ≤ k < N   c  Use conv to compute the zero-state response to the input x k  using convolution. Also compute the zero-state response to x k  using ﬁlter. Plot both responses on the same graph using a legend.  Solution  % Problem 2.58  % Construct filter  f_header ’Problem 2.58’  i = 0 : 20; b =  -1 .^2 .   10 + i.^2 ; a = 1;  % Construct input  N = 50; k = 0 : N-1; x = sin .1*pi*k  - 2*cos .2*pi*k  + 3*sin .3*pi*k ;  % Compute and plot impulse response  delta = [1,zeros 1,N-1 ]; h = filter  b,a,delta ; figure plot  k,h  f_labels  ’Impulse Response’,’k’,’h k ’  f_wait  137    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Compute and plot zero-state response using convolution  figure plot  k,x  f_labels  ’Input’,’k’,’x k ’  f_wait circ = 0; y1 = f_conv  h,x,circ ; k1 = 0 : length y1 -1; y2 = filter  b,a,x ; k2 = 0 : N-1; hp = plot  k1,y1,k2,y2 ; set  hp 2 ,’LineWidth’,1.5  f_labels  ’Zero State Response’,’k’,’y k ’  legend  ’Using f\_conv’,’Using filter’  f_wait  Impulse Response    k   h  0.1  0.09  0.08  0.07  0.06  0.05  0.04  0.03  0.02  0.01  0  0  10  20  30  40  50  k  Problem 2.58  a  Impulse Response  138    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   x  4  3  2  1  0  −1  −2  −3  −4  −5  0    k   y  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8    0  Input  k  k  139  10  20  30  40  50  Problem 2.58  b  Periodic Input  Zero State Response     Using f_conv Using filter  20  40  60  80  100  Problem 2.58  c  Zero-State Response    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.59 Consider the following pair of signals.  h = [1, 2, 3, 4, 5, 4, 3, 2, 1]T x = [2, −1, 3, 4,−5, 0, 7, 9,−6]T  Verify that linear convolution and circular convolution produce diﬀerent results by writing a MATLAB program that uses the FDSP function f conv to compute the linear convolution y k  = h k  ? x k  and the circular convolution yc k  = h k ◦ x k . Plot y k  and yc k  below one another on the same screen.  Solution  % Problem 2.59  % Initialize  f_header ’Problem 2.59’  h = [1 2 3 4 5 4 3 2 1] x = [2 -1 3 4 -5 0 7 9 -6]  % Compute convolutions  y = f_conv  h,x,0 ; y_c = f_conv  h,x,1 ;  % Plot them  figure subplot  2,1,1  k = 0 : length y -1; plot  k,y  f_labels  ’Linear Convolution: y k  = h k  * x k ’,’k’,’y k ’  subplot  2,1,2  k = 0 : length y_c -1; plot  k,y_c  f_labels  ’Circular Convolution: y_c k  = h k  \circ x k ’,’k’,’y_c k ’  f_wait  140    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   y    k    y  c  −20  0  60  40  20  0  60  50  40  30  20  0  Linear Convolution: y k  = h k  * x k   2  4  6  10  12  14  16   k  = h k    x k  Circular Convolution: y c  1  2  3  5  6  7  8  Problem 2.59 Linear and Circular Convolution  8 k  4 k  141    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.60 Consider the following pair of signals.  h = [1, 2, 4, 8, 16, 8, 4, 2, 1]T x = [2, −1, −4, −4, −1, 2]T  Verify that linear convolution can be achieved by zero padding and circular convolution by writing a MATLAB program that pads these signals with an appropriate number of zeros, and uses the FDSP toolbox function f conv to compare the linear convolution y k  = h k  ? x k  with the circular convolution yzc k  = hz k  ◦ xz k . Plot the following.  a  The zero-padded signals hz k  and xz k  on the same graph using a legend.   b  The linear convolution y k  = h k  ? x k .  c  The zero-padded circular convolution yzc k  = hz k  ◦ xz k .  Solution  % Problem 2.60  % Initialize  f_header ’Problem 2.60’  h = [1 2 4 8 16 8 4 2 1]; x = [2 -1 -4 -4 -1 2];  % Construct and plot zero-padded signals  L = length h ; M = length x ; h_z = [h, zeros 1,M-1 ] x_z = [x, zeros 1,L-1 ] figure k = 0 : length h_z -1; hp = plot  k,h_z,k,x_z ; set  hp 1 ,’LineWidth’,1.5  f_labels  ’Zero-Padded Signals’,’k’,’Inputs’  legend  ’h_z k ’,’x_z k ’  f_wait  % Compute and plot convolutions  y = f_conv  h,x,0 ; y_zc = f_conv  h_z,x_z,1 ; figure plot  k,y   142    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’Linear Convolution: y k  = h k  * x k ’,’k’,’y k ’  f_wait figure plot  k,y_zc  f_labels  ’Circular Convolution: y_{zc} k  = h_z k  \circ x_z k ’,’k’,’y_{zc} k ’  f_wait  Zero−Padded Signals     h  k  z  k   x  z  s t u p n I  16  14  12  10  8  6  4  2  0  −2  −4    0  2  4  6  8  10  12  14  k  Problem 2.60  a  Zero-padded Signals  143    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Linear Convolution: y k  = h k  * x k     k   y  −40  20  0  −20  −60  −80  20  0  −20  −40  −60  −80    k    y  c z  −100  0  2  4  6  8  10  12  14  Problem 2.60  b  Linear Convolution  Circular Convolution: y   k  = h   k    x   k   zc  z  z  −100  0  2  4  6  8  10  12  14  Problem 2.60  c  Zero-padded Circular Convolution  k  k  144    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.61 Consider the following polynomials  a z  = z4 + 4z3 + 2z2 − z + 3 b z  = z3 − 3z2 + 4z − 1 c z  = a z b z   Let a ∈ R5, b ∈ R4 and c ∈ R8 be the coeﬃcient vectors of a z , b z  and c z , respectively.  a  Find the coeﬃcient vector of c z  by direct multiplication by hand.   b  Write a MATLAB program that uses conv to ﬁnd the coeﬃcient vector of c z  by com-  puting c as the linear convolution of a with b.   c  In the program, show that a can be recovered from b and c by using the MATLAB  function deconv to perform deconvolution.  Solution  % Problem 2.61  % Initialize  f_header ’Problem 2.61’  a = [1 4 2 -1 3] b = [1 -3 4 -1]  % Construct coefficient vector of product polynomial  c = conv  a,b   % Recover coefficients of a from b and c  [a,r] = deconv  c,a    a  Using direct multiplication, C z  = A z B z , we have  A z B z  = z4 + 4z3 + 2z2 − z + 3 z3 − 3z2 + 4z − 1  z7 + 4z6 + 2z5 − z4 + 3z3  −3z6 − 12z5 − 6z4 + 3z3 − 9z2  4z5 + 16z4 + 8z3 − 4z2 + 12z  −z4 − 4z3 − 2z2 + z − 3 z7 + z6 − 6z5 + 8z4 + 10z3 − 15z2 + 13z − 3  145    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the coeﬃcient vector of the product polynomial is  c = [1, 1, −6, 8, 10,−15, 13,−3]T   b  The program output for c using conv is  1  1  -6  8  10  -15  13  -3   c  The program output for a using deconv is  c =  a =  1  -3  4  -1  146    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.62 Consider the following pair of signals.  x = [2, −4, 3, 7, 6, 1, 9, 4,−3, 2, 7, 8]T y = [3, 2, 1, 0,−1,−2, −3,−2,−1, 0, 1, 2]T  Verify that linear cross-correlation and circular cross-correlation produce diﬀerent results by writing a MATLAB program that uses the FDSP function f corr to compute the linear cross- correlation, ryx k  and the circular cross-correlation, cyx k . Plot ryx k  and cyx k  below one another on the same screen.  Solution  % Problem 2.62  % Initialize  f_header ’Problem 2.62’  x = [3 2 1 0 -1 -2 -3 -2 -1 0 1 2] y = [2 -4 3 7 6 1 9 4 -3 2 7 8]  % Compute cross-correlations  r_xy = f_corr  x,y,0,0 ; c_xy = f_corr  x,y,1,0 ;  % Plot them  figure subplot  2,1,1  k = 0 : length r_xy -1; plot  k,r_xy  f_labels  ’Linear Cross-Correlation’,’k’,’r_{xy} k ’  subplot  2,1,2  k = 0 : length c_xy -1; plot  k,c_xy  f_labels  ’Circular Cross-Correlation ’,’k’,’c_{xy} k ’  f_wait  147    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Linear Cross−Corrlation  2  4  8  10  12  Circular Cross−Correlation     k    r  y x    k    c  y x  −2  −4  0  2  0  4  2  0  −2  −4  0  5  10  15  Problem 2.62 Linear and Circular Cross-Correlation  6 k  k  148    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 2.63 Consider the following pair of signals.  x = [2, −1, −4, −4, −1, 2]T y = [1, 2, 4, 8, 16, 8, 4, 2, 1]T  Verify that linear cross-correlation can be achieved by zero-padding and circular cross-correlation by writing a MATLAB program that pads these signals with an appropriate number of zeros, and uses the FDSP toolbox function f corr to compute the linear cross-correlation ryx k  and the circular cross-correlation cyz xz k . Plot the following.   a  The zero-padded signals xz k  and yz k  on the same graph using a legend.   b  The linear cross-correlation ryx k  and the scaled zero-padded circular cross-correlation   N L cyzxz  k  on the same graph using a legend.  Solution  % Problem 2.63  % Initialize  f_header ’Problem 2.63’  x = [1 2 4 8 16 8 4 2 1] y = [2 -1 -4 -4 -1 2]  % Construct and plot zero-padded signals  L = length x ; M = length y ; x_z = [x, zeros 1,M-1 ]; y_z = [y, zeros 1,L-1 ]; figure N = length x_z ; k = 0 : N-1; hp = plot  k,x_z,k,y_z ; set  hp 1 ,’LineWidth’,1.5  f_labels  ’Zero-Padded Signals’,’k’,’Inputs’  legend  ’x_z k ’,’y_z k ’  f_wait  % Compute and plot cross-correlations  r_xy = f_corr  x,y,0,0 ; R_xy =  N L *f_corr  x_z,y_z,1,0 ; kr = 0 : length r_xy -1;  149    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   kR = 0 : length R_xy -1; figure h = plot  kR,R_xy,kr,r_xy ; set  h 2 ,’LineWidth’,1.5  legend  ’ N L c_{x_zy_z} k ’, ’r_{xy} k ’  f_wait  Zero−Padded Signals     x  y   k  z  k  z  s t u p n I  16  14  12  10  8  6  4  2  0  −2  −4    0  2  4  6  8  10  12  14  k  Problem 2.63  a  Zero-Padded Signals  150    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2  0  −2  −4  −6  −8  −10  −12    0      N L c x z  y   k  z   k   r xy  5  10  15  Problem 2.63  b  Cross-Correlations  151    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2.64 Consider the following pair of signals of length N = 8.  x = [2, −4, 7, 3, 8,−6, 5, 1]T y = [3, 1, −5, 2, 4, 9, 7, 0]T  Write a MATLAB program that performs the following tasks.   a  Use the FDSP toolbox function f corr to compute and plot the circular cross-correlation,  cyx k .   b  Compute and print u k  = x −k  using the periodic extension, xp k .  c  Verify that cyx k  = [y k  ◦ x −k ] N by using the FDSP toolbox function f conv to compute and plot the scaled circular convolution, w k  = [u k  ◦ x k ] N . Plot cyx k  and w k  below one another on the same screen.  Solution  % Problem 2.64  % Initialize  f_header ’Problem 2.64’  x = [3 1 -5 2 4 9 7 0] y = [2 -4 7 3 8 -6 5 1]  % Compute and plot circular cross-correlation  c_xy = f_corr  x,y,1,0 ; figure kc = 0 : length c_xy -1; plot  kc,c_xy  f_labels  ’Circular Cross-Correlation’,’k’,’c_{xy} k ’  f_wait  % Construct v k  = y -k  using periodic extension y_p k   % Compute and plot scaled circular convolution  N = length y ; v = [y 1 , y N:-1:2 ]  w = f_conv  x,v,1  N; figure kw = 0 : length w -1; plot  kw,w   152    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’Scaled Circular Convolution’,’k’,’[x k  \circ y -k ] N’  f_wait  Circular Cross−Correlation    k    c  y x  14  12  10  8  6  4  2  0  −2  0  1  2  3  4  5  6  7  k  Problem 2.64  a  Circular Cross-Correlation   b  The signal v k  = y −k  using the periodic extension yp k  is  v =  2  1  5  -6  8  3  7  -4  153    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Scaled Circular Convolution  N   ]   k −   y         k   x [  14  12  10  8  6  4  2  0  −2  0  1  2  3  4  5  6  7  k  Problem 2.64  c  Scaled Circular Convolution  154    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.1 Consider the following ﬁnite causal signal where x 0  = 8.  Chapter 3  x = [8, −6, 4, −2, 0, 0,···]   a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using Deﬁnition 2.1   b  Since x k  is causal, X z  converges outside the outer-most pole. Thus  X z  = 8 − 6z−1 + 4z−2 − 2z−3  8z3 − 6z2 + 4z − 2  =  z3  ΩROC = {z ∈ C z > 0}  155    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.2 Consider the following ﬁnite anti-causal signal where x −1  = 4.  x = [· · · , 0, 0, 3,−7, 2, 9, 4]   a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using Deﬁnition 2.1  X z  = 3z4 − 7z3 + 2z2 + 9z + 4   b  Since x k  is anti-causal,  ΩROC = C  156    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.3 Consider the following ﬁnite noncausal signal where x 0  = 3.  x = [· · · , 0, 0, 1, 2, 3, 2, 1, 0, 0,··· ]   a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using Deﬁnition 2.1   b   X z  = z2 + 2z + 3 + 2z−1 + z−2 z4 + 2z3 + 3z2 + 2z + 1  =  z2  ΩROC = {z ∈ C z > 0}  157    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.4 Consider the following causal signal.  x k  = 2 .8 k−1µ k    a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using the geometric series  X z  =  2 .8 k−1µ k z−k  2 .8 k−1z−k   2 .8  .8 kz−k  = 2.5   .8 z k  ∞  ∞  Xk=−∞ Xk=0 Xk=0  ∞  ∞  2.5  Xk=0 1 − .8 z 2.5z z − .8 2.5z z − .8  =  =  =  =  =  ,  .8 z < 1  ,  ,  .8 z < 1 z > .8  ΩROC = {z ∈ C z > .8}  158   b     2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.5 Consider the following anti-causal signal.  x k  = 5 −.7 k+1µ −k − 1    a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using a change of variable and the geometric series  X z  =  5 −.7 k+1µ −k − 1 z−k  5 −.7 −iµ i zi+1  ,  i = − k + 1   ∞  0  5 −.7 −izi+1  ∞  −∞  Xk=−∞ Xi=∞ Xi=∞ Xi=0 5z −.7 −izi Xi=0 1 − z  −.7  ,  [z  −.7 ]i 5z  ∞  ,  =  =  =  =  = 5z  z  −.7  < 1  = −.35z −.7 − z .35z z + .7  =  ,  z .7  < 1 z < .7   b   ΩROC = {z ∈ C z < .7}  159    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.6 Consider the following noncausal signal.  x k  = 10 .6 kµ k + 2    a  Find the Z-transform X z , and express it as a ratio of two polynomials in z.   b  What is the region of convergence of X z ?  Solution   a  Using a change of variable and the geometric series  10 .6 i−2µ i z2−i  ,  i = k + 2  X z  =  10 .6 kµ k + 2 z−k  ∞  ∞  Xk=−∞ Xi=−∞ Xi=0  ∞  =  =  =  =  =  10 .6 z i−2  = 10 .6 z −2   .6 z i  = 10 z .6 2   .6 z i  ∞  ∞  Xi=0 Xi=0  ,  ,  ,  10z2 .36 1 − .6 z 27.78z2 1 − .6 z 27.78z3 z − .6  .6 z < 1  .6 z < 1  z > .6   b   ΩROC = {z ∈ C z > .6}  160    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.7 Consider the following noncausal signal. Show that X z  does not exist for any scalar c. That  is, show that the region of convergence of X z  is the empty set.  x k  = ck  Solution  Decomposing the sum into the anti-causal and causal parts.  Using the geometric series, the Z-transform of the casual part is  X z  =  ckz−k  ∞  −1  Xk=−∞ Xk=−∞  =  ckz−k +  ckz−k  = Xa z  + Xc z   ∞  Xk=0  Xc z  =  ckz−k   c z k  ∞  ∞  Xk=0 Xk=0 1 − c z z z − c  1  =  =  =  ,  c z < 1  ,  z > c  Ωc = {z ∈ C z > c}  161  Thus the region of convergence of the causal part is  Using the geometric series, the Z-transform of the anti-casual part is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Xa z  =  ckz−k   z c i  −1  1  ∞  =  =  Xk=−∞ Xi=∞ Xi=1 z c 1 − z c z = c − z = −z z − c  =  c−izi  ,  i = −k  ,  ,  ,  z c < 1 z c < 1 z < c  Thus the region of convergence of the anti-causal part is  Ωa = {z ∈ C z < c}  For the overall system to converge, both parts must converge. Thus the region of convergence for X z  is  ΩROC = Ωc ∩ Ωa  = ∅  Hence the Z-transform of x k  does not exist for any c ∈ C.  162    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.8 Consider the following discrete-time signal.  x k  = ak sin bk + θ µ k    a  Use Table 3.2 and the trigonometric identities in Appendix 2 to ﬁnd X z .   b  Verify that X z  reduces to an entry in Table 3.2 when θ = 0. Which one?   c  Verify that X z  reduces to another entry in Table 3.2 when θ = π 2. Which one?  Solution   a  From Table 3.2 and the sine of the sum trigonometric identity we have  X z  = Z{ak[sin bk  cos θ  + cos bk  sin θ ]}  = cos θ Z{ak sin bk } + sin θ Z{ak cos bk } sin θ [z − a cos b ]z = z2 − 2a cos b z + a2  z2 − 2a cos b z + a2 +  cos θ a sin b z  = {a cos θ  sin b  + sin θ [z − a cos b ]}z  z2 − 2a cos b z + a2   b  When θ = 0, part  a  reduces to the damped sine   c  When θ = π 2, part  a  reduces to the damped cosine  X z  =  a sin b z  z2 − 2a cos b z + a2  X z  =  [z − a cos b ]z  z2 − 2a cos b z + a2  163    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.9 The basic geometric series in  2.2.14  is often used to compute Z-transforms.  It can be  generalized in a number of ways.   a  Prove that the geometric series in  2.2.14  converges to 1  1 − z  for z < 1 by showing  that  lim N →∞   1 − z   zk = 1  ⇐⇒  z < 1  N  Xk=0   b  Use  2.2.14  to establish  3.2.3 . That is, show that  zk =  ∞  Xk=m  zm 1 − z  , m ≥ 0, z < 1   c  Use the results of part  b  to show the following. Hint: Write the sum as a diﬀerence of  two series.  zk =  n  Xk=m  zm − zn+1  1 − z  ,  n ≥ m ≥ 0, z < 1   d  Shows that the result in part  c  holds for all complex z by multiplying both sizes by  1 − z and simplifying the left-hand side.  Solution   a   Thus  lim N →∞   1 − z   zk = lim  N  Xk=0  = lim  zk −  N →∞  N Xk=0 N →∞  N Xk=0 zk −  1 − zN +1  ⇐⇒  = lim N →∞  = 1  zk+1! zk!  N  N +1  Xk=0 Xk=1  z < 1  zk =  ∞  Xk=0  1 1 − z  ,  z < 1   0.1   164    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Let m ≥ 0. Using  2.2.14    c  Let n ≥ m ≥ 0. Using part  a   zk = zm  zk−m  ∞  Xk=m  ∞  ∞  Xk=m Xi=0 zm 1 − z  = zm  zi  ,  i = k − m  =  ,  z < 1  zk =  n  Xk=m  zk  ∞  ∞  Xk=n+1 zn+1 1 − z  zm  zk −  Xk=m 1 − z − zm − zn+1 1 − z  ,  =  =  ,  z < 1  z < 1   d  Multiplying both sides of part  c  by 1 − z yields   1 − z   zk =  n  Xk=m  n  n  n  =  zi  n+1  zk+1  zk −  Xk=m Xk=m  Xk=m Xi=m+1 zk − = zm +" n Xk=m+1 zk − = zm − zn+1  i = k + 1  ,  n  zi − zn+1  Xi=m+1  165    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.10 Suppose X z  converges on Ωx = {z ∈ C z > Rx} and Y  z  converges on Ωy = {z ∈  C z < Ry}.  a  Classify x k  and y k  as to their type: causal, anti-causal, noncausal.   b  Find a subset of the region of convergence of ax k  + by k .  c  Find the region of convergence of ckx k .  d  Find the region of convergence of y −k .  Solution   a  Since Ωx = {z ∈ C  z > Rx}, x k  is causal. Since Ωy = {z ∈ C  z < Ry}, y k  is  anti-causal.   b  Since both X z  and Y  z  must converge, the region of convergence is   c  From the Z-scale property  Thus the region of convergence is   d  From the time-reversal property  Thus the region of convergence is  ΩROC = Ωx ∩ Ωy  = {z ∈ C Rx < z < Ry}  Z{ckx k } = X z c   ΩROC = {z ∈ C z c > Rx} = {z ∈ C z > cRx}  Z{y −k } = Y  1 z   ΩROC = {z ∈ C 1 z < Ry} = {z ∈ C z > 1 Ry}  166    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.11 Consider the following signal.  x k  =  cid:26  10,  0 ≤ k < 4 −2, 4 ≤ k < ∞   a  Write x k  as a diﬀerence of two step signals.   b  Use the time shift property to ﬁnd X z . Express your ﬁnal answer as a ratio of two  polynomials in z.   c  Find the region of convergence of X z .  Solution   a  If µ k  is the unit step, then   b  Using the delay property, Table 3.2, and part  a    c  Since x k  is causal, it converges outside the outer-most pole. Thus  x k  = 10µ k  − 12µ k − 4   X z  = 10U  z  − 12z−4U  z  =  10 − 12z−4 U  z   cid:18  z z − 1 cid:19  =  z4  10z4 − 12 2 5z4 − 6  z3 z − 1   =  ΩROC = {z   z > 1}  167    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.12 Consider the following signal.  x k  =  cid:26  2k,  0 ≤ k < 9 18, 9 ≤ k < ∞   a  Write x k  as a diﬀerence of two ramp signals.   b  Use the time shift property to ﬁnd X z . Express your ﬁnal answer as a ratio of two  polynomials in z.   c  Find the region of convergence of X z .  Solution   a  Let r k  = kµ k  denote the unit ramp. Then   b  Using the time shift property and Example 3.7  or Appendix 1    c  Since x k  is causal, X z  converges outside the outer-most pole.  x k  = 2r k  − 2r k − 9  = 2[r k  − r k − 9 ]  X z  = 2[R z  − z−9R z ]  z − 1 2 cid:21   = 2 1 − z−9 R z   cid:20  =  2 z9 − 1   z9  z  =  2 z9 − 1  z8 z − 1 2  ROC = {z   z > 1}  168    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.13 Use Appendix 1 and the properties of the Z-transform to ﬁnd the Z-transform of the following  cubic exponential signal. Simplify your ﬁnal answer as much as you can.  x k  = k3 c kµ k   Solution  From Table A6 in Appendix 1  Y  z  = Z{k2 c kµ k }  =  cz z + c   z − c 3  Using the time multiplication property of the Z transform  dY  z   X z  = −z = −z = −cz[ z − c  2z + c  − 3z z + c ]  dz  z − c 3 2cz + c2  − cz z + c 3 z − c 2   z − c 6   z − c 4  = −cz[2z2 − cz − c2 − 3z2 − 3cz]   z − c 4 = −cz[−z2 − 4cz − c2]   z − c 4  cz[ z + c 2 + 2cz]  =   z − c 4  ,  z > c  169    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.14 Let x∗ k  denote the complex conjugate of x k . Show that the Z-transform of x∗ k  can be expressed in terms of the Z-transform of x k  as follows. This is called the complex conjugate property.  Solution  Using Deﬁnition 3.1  Z{x∗ k } = X ∗ z∗   ∞  =  X ∗ z∗  = " ∞ Xk−∞ Xk−∞ Xk−∞ Xk−∞  =  =  ∞  ∞  x k  z∗ −k∗  [x k  z∗ −k]∗  [x k  z−k ∗]∗  x∗ k z−k  = Z{x∗ k }  170    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.15 Let h k  and x k  be the following pair of signals.  h k  = [1 −  .9 k]µ k  x k  =  −1 kµ k    a  Find H z  as a ratio of polynomials in z and its region of convergence.   b  Find X z  as a ratio of polynomials in z and its region of convergence.   c  Use the convolution property to ﬁnd the Z-transform of h k  ? x k  as a ratio of polyno-  mials in z and its region of convergence.  Solution   a  From Table 3.2 and the linearity property  H z  = Z{µ k } − Z{.9kµ k }  z  z  =  =  =  ,  z − .9  z − 1 − z z − .9  − z z − 1   z − 1  z − .9   .1z   z − 1  z − .9   z > 1, z > .9 ,  z > 1  ,  z > 1  X z  =  z  z  z + 1  z + 1  =  ,  ,  z >  − 1 z > 1   b  From Table 3.2   c  Using the convolution property and the results from parts  a  and  b   Z{h k  ? x k } = H z X z  .1z  =  =  z + 1 cid:19   z − 1  z − .9  cid:18  z  z − 1  z − .9  z + 1   .1z2  ,  z > 1  ,  z > 1  171    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.16 In problem 3.15 the region of convergence of the Z-transform of h k ?x k  is ΩROC = ΩH ∩ ΩX where ΩH is the region of convergence of H z , and ΩX is the region of convergence of X z . Is this true in general? If not, ﬁnd an example of an H z  and an X z  where ΩROC is larger than ΩH ∩ ΩX.  No, it is not always true that ΩROC = ΩH ∩ ΩX because there can be pole-zero cancellation between H z  and X z . For example.  Solution  Then  Here  H z  =  X z  =  z  z − .8 z − .8 z − .4  ,  ,  z > .8 z > .4  Z{h k  ?  k } = H z X z  ,  =  z  z − .4  z > .4  ΩROC = {z ∈ C z > .4} 6= {z ∈ C z > .8} = ΩH ∩ ΩX  172    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.17 Consider the following noncausal signal  x k  = ckµ −k    a  Using Deﬁnition 3.1 and the geometric series, ﬁnd X z  as a ratio of two polynomials in   b  Verify the results of part  a  by instead ﬁnding X z  using Table 3.2 and the time  z and its region of convergence.  reversal property.  Solution   a  Using Deﬁnition 3.1 and the geometric series  X z  =  ckµ −k z−k  ckz−k  ∞  0  0  ∞  =  =  Xk=−∞ Xk=−∞ Xi=∞ Xi=0 1 − z c c = c − z = −c z − c  =  =  1   z c i  c−izi  ,  i = −k  ,  z c < 1 z c < 1 z < c  ,  ,  y k  = x −k  = c−kµ k  =  1 c kµ k   Y  z  =  ,  z > 1 c  z  z − 1 c  173   b  Using time reversal, let  From Table 3.2    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Using the time reversal property  X z  = Y  1 z  1 z  ,  ,  1 z > 1 c  ,  1 z > 1 c  z < c  z < c z < c √  =  =  1 z − 1 c  1  1 − z c c = c − z = −c z − c  ,  ,  174    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.18 Consider the following pair of ﬁnite causal signals, each starting with sample k = 0.  x k  = [1, 2, 3]  y k  = [7, 2, 4, 6, 1]   a  Find X z  as a ratio of polynomials in z, and ﬁnd the region of convergence.  b  Find Y  z  as a ratio of polynomials in z, and ﬁnd the region of convergence.  c  Consider the cross-correlation of y k  with x k .  ryx k  =  y i x i − k   ,  0 ≤ k < 5  1 5  4  Xi=0  Using the correlation property, ﬁnd the Z-transform of the cross-correlation ryx k  as ratio of polynomials in z, and ﬁnd the region of convergence.  Solution   a  Using Deﬁnition 3.1   b  Using Deﬁnition 3.1  X z  = 1 + 2z−1 + 3z−2  =  z2 + 2z + 3  z2  ,  z > 0  Y  z  = 7 + 2z−1 + 4z−2 + 6z−3 + z−4  7z4 + 2z3 + 4z2 + 6z + 1  =  z4  ,  z > 0   c  Using the cross-correlation property  Ryz z  =  Y  z X 1 z   4  =  =  =  =  7z4 + 2z3 + 4z2 + 6z + 1  4z4   cid:18   1 z 2 + 2 1 z  + 3   1 z 2   cid:19    7z4 + 2z3 + 4z2 + 6z + 1 [ 1 z 2 + 2 1 z  + 3]   7z4 + 2z3 + 4z2 + 6z + 1  1 + 2z + 3z2    7z4 + 2z3 + 4z2 + 6z + 1  3z2 + 2z + 1   ,  z > 0  ,  z > 0  ,  ,  z > 0 z > 0  4z2  4z4  4z4  175    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.19 Consider the following Z-transform.  X z  =  10 z − 2 2 z + 1 3   z − .8 2 z − 1  z − .2 2   a  Find x 0  without inverting X z .  b  Find x ∞  without inverting X z .  c  Write down the form of x k  from inspection of X z . You can leave the coeﬃcients of  each term of X z  unspeciﬁed.  Solution   a  Applying the initial value theorem   b  Since  z − 1 X z  has no poles on or outside of the unit circle, one can apply the ﬁnal  value theorem.  x 0  = lim z→∞  X z   10 z − 2 2 z + 1 3   z − .8 2 z − 1  z − .2 2 10z5 z5  = lim z→∞  = lim z→∞  = 10  x ∞  = lim  z→1   z − 1 X z  10 z − 2 2 z + 1 3  z − .8 2 z − .2 2 10 1 − 2 2 1 + 1 3  1 − .8 2 1 − .2 2 80  = lim z→1  = lim z→1  =  .04 .64   = 3125   c  Each pole at z = p of multiplicity m generates a natural mode term of the form c k pkµ k  where c k  is a coeﬃcient polynomial of degree m − 1. Thus, the general form of x k  is  x k  = [ c1k + c2  .8 k + c3 +  c4k + c5  .2 k]µ k   176    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.20 A student attempts to apply the ﬁnal value theorem to the following Z-transform and gets the steady-state value x ∞  = −5. Is this correct? If not, what is the value of x k  as k → ∞? Explain your answer.  X z  =  10z3   z2 − z − 2  z − 1   ,  z > 2  Solution  For the ﬁnal value theorem to be applicable,  z − 1 X z  must not have any poles on or outside the unit circle. Here   z − 1 X z  =  10z3  z2 − z − 2 10z3  =   z − 2  z + 1   Since there is a pole at z = 2, the ﬁnal value theorem does not apply. Therefore z ∞  = −5 is not correct. Because of the pole at z = 2, x k  is unbounded, and x k  → ∞ as k → ∞.  177    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.21 Consider the following Z-transform.  X z  =  z4 + 1  z2 − 3z + 2  ,  z > 2   a  Find the causal part of x k    b  Find the anti-casual part of x k   Solution   a  Since X z  is not strictly proper, ﬁrst apply long division to get a quotient polynomial  and a remainder. Using the MATLAB function deconv this yields  b = [1 0 0 0 1] a = [1 -3 2] [q,r] = deconv b,a   Thus  q z  = z2 + 3z + 7 r z  = 15z − 13  X z  =  b z  a z   = q z  +  r z  a z   = z2 + 3z + 7 +  = z2 + 3z + 7 +  15z − 13 z2 − 3z + 2  15z − 13  z − 1  z − 2   The causal part of X z  is  Using the residue method, the initial value of xc k  is  Xc z  = 7 +  15z − 13   z − 1  z − 2   178    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The residues are  xc 0  = lim z→∞  Xc z   = 7  Res 1, k  =  Res 2, k  =   z − 1 r z zk−1  a z  15 1  − 13  =  = −2  1 − 2   z − 2 r z zk−1  a z   [15 2  − 13]zk−1  =   cid:12  cid:12  cid:12  cid:12 z=1  cid:12  cid:12  cid:12  cid:12 z=2  2 − 1   = 17 2 k−1  Thus the casual part of x k  is  xc k  = xc 0 δ k  + [Res 1, k  + Res 2, k ]µ k − 1   = 7δ k  + [−2 + 17 2  k − 1 ]µ k − 1    b  The anti-casual part of X z  is  Xa z  = z2 + 3z  Thus the anti-causal part of x k  is  xa k  = δ k + 2  + 3δ k + 1   179    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.22 Consider the following Z-transform.  X z  =  z4 + 2z3 + 3z2 + 2z + 1  z4  ,  z > 0   a  Rewrite X z  in terms negative powers of z.   b  Use Deﬁnition 3.1 to ﬁnd x k .   c  Verify that x k  is consistent with the initial value theorem.   d  Verify that x k  is consistent with the ﬁnal value theorem.  Solution   a  Multiplying the top and bottom by z−4 yields  X z  = 1 + 2z−1 + 3z−2 + 2z−3 + z−4   b  Using Deﬁnition 3.1,  x = {1, 2, 3, 2, 1, 0, 0,···}   c  From the initial value theorem   d  Since  z − 1 X z  has no poles on or outside the unit circle, the ﬁnal value of x k  is  X z   x 0  = lim z→∞ = lim z→∞ = 1 √  1 + 2z−1 + 3z−2 + 2z−3 + z−4  x ∞  = lim  z→1   z − 1 X z   z − 1  z4 + 2z3 + 3z2 + 2z + 10   z4  = lim z→1 = 0 √  180    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.23 Consider the following Z-transform.  X z  =  2z z2 − 1  ,  z > 1   a  Find x k  for 0 ≤ k ≤ 5 using the synthetic division method.  b  Find x k  using the partial fraction method.   c  Find x k  using the residue method.  Solution   a  Expressing X z  in terms of negative powers of z  X z  =  2z−1 1 − z−2  Using synthetic division,  1 − z−2  2z−1 + 2z−3 + 2z−5 + · · ·  2z−1 2z−1 − 2z−3 2z−3 2z−3 − 2z−5 2z−5 2z−5 − 2z−7 2z−7  Thus the ﬁrst six samples are   b  Expanding X z  into partial fractions  x = {0, 2, 0, 2, 0, 2,· ··}  2  2  z2 − 1  z − 1  z + 1  R1 R2 z − 1 z + 1  +  X z   z  =  =  =  181    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The partial fraction residues are  R1 =   z − 1 X z   z  =  = 1  2  z + 1 cid:12  cid:12  cid:12  cid:12 z=1  R2 =   z + 1 X z   z  =  2  z − 1 cid:12  cid:12  cid:12  cid:12 z=−1  = −1   cid:12  cid:12  cid:12  cid:12 z=1   cid:12  cid:12  cid:12  cid:12 z=−1  X z  =  z  z − 1 −  z  z + 1  x k  = [1 −  −1 k]µ k   x 0  = lim z→∞  X z   = lim z→∞  = 0  2z z2 − 1  X z  =  2z   z − 1  z + 1   Thus  Finally, from Table 3.2   c  Applying Algorithm 3.1, the initial value of x k  is  The factored form of X z  is  The residues of X z zk−1 for k ≥ 1 are  182    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res 1, k  =  z − 1 X z zk−1z=1  Res −1, k  =  z + 1 X z zk−1z=−1  =  = 1  2zk  z + 1 cid:12  cid:12  cid:12  cid:12 z=1 z − 1 cid:12  cid:12  cid:12  cid:12 z=−1  2zk  =  = − −1 k  Thus  x k  = x 0 δ k  + [Res 1, k  + Res −1, k ]µ k − 1   = [1 −  −1 k]µ k − 1  = [1 −  −1 k]µ k  √  183    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.24 Consider the following Z-transform. Find x k  using the time shift property and the residue  method.  Solution  X z  =  100  z2 z − .5 3  ,  z > .5  Applying Algorithm 3.1, X z  is already in factored form. Removing the r = 2 poles at z = 0 yields  The initial value of x k  is  X z  =  100   z − .5 3  x 0  = lim z→∞  X z   = 0  The pole at p1 = .5 is of multiplicity m1 = 3. Thus the residue is  Res .5, k  =  d2 1 dz2{ z − 1 3X z zk−1}z=.5 2! d2 1 dz2{100zk−1}z=.5 2  = = 50 k − 1  k − 2 zk−3z=.5 = 50 k − 1  k − 2  .5 k−3  Thus  Finally, one must delay by r = 2 samples.  x k  = x 0 δ k  + Res .5, k µ k − 1  =  k − 1  k − 2  .5 k−3µ k − 1   x k  =  k − 3  k − 4  .5 k−5µ k − 3   184    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.25 Consider the following Z-transform. Use Algorithm 3.1 to ﬁnd x k . Express your ﬁnal answer  as a real signal.  X z  =  1  z2 + 1  ,  z > 1  Solution  Applying Algorithm 3.1, the factored form of X z  is  X z  =  1   z − j  z + j   x 0  = lim z→∞  X z   = 0  The initial value of x k  is  The residue of the pole at z = j is  Res j, k  =  z − j X z zk−1z=j  =  =  zk−1  z + j cid:12  cid:12  cid:12  cid:12 z=j  j k−1 j2 j k−2  = 2 = −j k 2  Res −j, k  = Res j, k ∗ = − −j k  2  185  Since the pole at z = −j is the complex conjugate of the pole at z = j, its residue is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus x k  is  x k  = x 0 δ k  + [Res j, k  + Res −j, k ]µ k − 1   =  cid:20 −j k −  −j k  2   cid:21  µ k − 1   Using Euler’s identity from Appendix 2, exp ±jπ 2  = ±j. Thus  2  x k  =  cid:20 − exp jπ 2 k −  exp −jπ 2 k =  cid:20 − exp jkπ 2  −  exp −jkπ 2  =  cid:20 − cos kπ 2  − j sin kπ 2  − cos kπ 2  + j sin kπ 2 = − cos kπ 2 µ k − 1    cid:21  µ k − 1   cid:21  µ k − 1   2  2   cid:21  µ k − 1   186    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.26 Repeat problem 3.25, but use Table 3.2 and the Z-transform properties.  Solution  Note that X z  is generally similar to one of the entries in Table 3.2 except for the numerator. If one multiplies and divide by z this yields  Here Y  z  = z  z2 + 1 . Note that x k  can be recovered from y k  using the time shift property. From row three of Table 3.2 with a = 1 and b = π 2  X z  =  z  1 z  z2 + 1 = z−1Y  z   y k  = sin kπ 2 µ k   Using the sine of the diﬀerence trigonometric identity from Appendix 2 yields  x k  = y k − 1   = sin[ k − 1 π 2 µ k − 1  = [sin kπ 2  cos π 2  − cos kπ 2  sin π 2 ]µ k − 1  = − cos kπ 2 µ k − 1   This is consistent with problem 3.25.  187    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.27 Consider the following Z-transform. Find x k .  X z  =  5z3   z2 − z + .25  z + 1   ,  z > 1  Solution  The factored form of X z  is  Using the residue method, the initial value of x k  is  X z  =  5z3   z − .5 2 z + 1   x 0  = lim z→∞  X z   = 5  The residues of X z zk−1 at the two poles are  Res .5, k  =  d dz{ z − .5 2X z zk−1}z=.5 dz  cid:26  5zk+2 z + 1 cid:27  cid:12  cid:12  cid:12  cid:12 z=.5 d  z + 1 5 k + 2 zk+1 − 5zk+2   z + 1 2  7.5 k + 2  .5 k+1 − 5 .5 k+2   1.5 2   cid:12  cid:12  cid:12  cid:12 z=.5  =  =  =  =  2.25  2.5 .5 k+1[3 k + 2  − 1] 9  cid:19   3k + 5  .5 k+1  =  cid:18  10  Res −1, k  =  z + 1 X z zk−1z=−1  =  =  5zk+2   z − .5 2 cid:12  cid:12  cid:12  cid:12 z=−1 5 −1 k+2  −1.5 2 =  cid:18  20 9  cid:19   −1 k+2  188    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus  x k  = x 0 δ k  + [Res .5, k  + Res −1, k ]µ k − 1   9  cid:19  [ 3k + 5  .5 k+1 + 2 −1 k+2]µ k − 1   = 5δ k  + cid:18  10 =  cid:18  10  9  cid:19  [ 3k + 5  .5 k+1 + 2 −1 k+2]µ k   189    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.28 The formulation of the inverse Z-transform using the contour integral in  3.4.20  is based on the Cauchy integral theorem. This theorem states if C is any counter-clockwise contour that encircles the origin then  Use Deﬁnition 3.1 and the Cauchy integral theorem to show that the Z-transform can be inverted as in  3.4.20 . That is, show that  1  j2πIC  zk−1−idz =  cid:26  1 ,  0 ,  i = k i 6= k  x k  =  X z zk−1dz  1  j2π IC  Let C be a contour in the region of convergence. In general, the region of convergence is an annular ring around the origin, so C will encircle the origin. Using Deﬁnition 3.1, and the Cauchy integral theorem,  Solution  Thus  IC  ∞  ∞  X z zk−1dz = IC Xi=−∞ = IC Xi=−∞ x i IC Xi=−∞  =  ∞  = x k  j2π   x i z−izk−1dz  x i zk−1−idz  zk−1−idz  x k  =  X z zk−1dz  1  j2π IC  190    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.29 Consider the following Z-transform.  X z  =  z z − 1   a  Find x k  if the region of convergence is z > 1.  b  Find x k  if the region of convergence is z < 1.  Solution   a  If the region or convergence is of the form z > 1, then x k  is causal. From Table 3.2   b  If the region or convergence is of the form z < 1, then x k  is noncausal. Consider  Then  x k  = µ k   y k  = µ −k   Y  z  =  z−k  0  0  ∞  =  Xk=−∞ Xi=∞ Xi=0 1 = 1 − z = −1 z − 1  =  zi  zi  ,  i = −k  ,  ,  z < 1 z < 1  Thus from the delay property  X z  = −1  z  cid:18  z  z − 1 cid:19   ,  z < 1  191    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Therefore  x k  = −y k − 1  = −µ −k − 1   192    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.30 When two signals are multiplied, this corresponds to one signal amplitude modulating the  other signal. The following property of the Z-transform is called the modulation property.  Z{h k x k } =  1  j2π IC  H u X cid:16  z  u cid:17  u−1du  Use the Cauchy integral representation of a time signal in Problem 3.28 to verify the modu- lation property.  Solution  Let  y k  = h k x k   Then, using the Cauchy integral representation of h k   ∞  ∞  =  =  Z{h k x k } = Y  z  Xk=−∞ Xk=−∞ cid:20  1 j2πIC j2πIC j2πIC  =  =  =  1  1  1  h k x k z−k  H u uk−1du cid:21  x k z−k j2πIC H u " ∞ uk−1x k z−k du Xk=−∞ H u " ∞ u cid:17 −k u−1du x k  cid:16  z Xk=−∞ H u X cid:16  z u cid:17  u−1du  193    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.31 Consider a running average ﬁlter of order M − 1.   a  Find the transfer function H z . Express it as a ratio of two polynomials in z.   b  Use the geometric series in  3.2.3  to show that an alternative form of the transfer  function is as follows. Hint: Express y k  as a diﬀerence of two sums.  y k  =  1 M  M −1  Xi=0  x k − i   H z  =  zM − 1  M  z − 1 zM −1   c  Convert the transfer function in part  b  to a diﬀerence equation.  Solution   a  Using the delay property  Thus the transfer function is   b  Starting with the hint  Y  z  =  z−iX z   1 M  M −1  Xi=0  H z  =  Y  z X z   =  =  =  M −1  z−i  Xi=0  1 M 1 + z−1 + · · · + z−M +1 zM −1 + zM −2 + · · · + 1  M  M zM −1  y k  =  =  M −1  1 M  Xi=0 x k − i  M " ∞ Xi=0  1  x k − i  −  194  x k − i   ∞  Xi=M    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Using the delay property and  3.2.3   Y  z  =  z−iX z   1  1  ∞  ∞  M " ∞ Xi=M Xi=0 z−iX z  − M " ∞ z−i X z  Xi=0 Xi=M M  cid:20  1 − z−1 cid:21  X z  1 − z−1 − M  cid:20  1 − z−M 1 − z−1  cid:21  X z   z−i − 1   z−1 M  1  1  =  =  =  Thus the transfer function is   c  Writing H z  from part  b  in terms of negative powers of z we have  Thus by inspection the diﬀerence equation is  y k  = y k − 1  +  x k  − x k − M    M  H z  =  Y  z X z  1 − z−M M  1 − z−1  zM − 1  M  z − 1 zM −1  H z  =  1 − z−M M  1 − z−1  [1 − z−M ]  M    1 − z−1  =  =  =  195    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.32 Consider a discrete-time system described by the following diﬀerence equation.  y k  = y k − 1  − .24y k − 2  + 2x k − 1  − 1.6x k − 2    a  Find the transfer function H z .   b  Write down the form of the natural mode terms of this system.   c  Find the zero-state response to the step input x k  = 10µ k .  d  Find the zero-state response to the causal exponential input x k  = .8kµ k . Does a  forced mode term appear in y k ? If not, why not?   e  Find the zero state response to the causal exponential input x k  = .4kµ k . Is this an  example of harmonic forcing? Why or why not?  Solution   a  By inspection, the transfer function is’   b  From part  a , the form of the natural response is   c  The Z-transform of the zero-state response is  H z  =  2z−1 − 1.6z−2 1 − z−1 + .24z−2 2z − 1.6 z2 − z + .24 2 z − .8   z − .6  z − .4   =  =  y k  = [c1 .6 k + c2 .4 k]µ k   =  Y  z  = H z X z  2 z − .8   z − .6  z − .4   cid:18  10z z − 1 cid:19   z − .6  z − .4  z − 1   20z z − .8   =  196  From the initial value theorem y 0  = 0. The residues of Y  z zk−1 are    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res .6, k  =  z − .6 Y  z zk−1z=.6  =  =  20 z − .8 zk   z − .4  z − 1  cid:12  cid:12  cid:12  cid:12 z=.6  20 −.2  .6 k  .2  −.4   = 50 .6 k  Res .4, k  =  z − .4 Y  z zk−1z=.4  =  =  20 z − .8 zk   z − .6  z − 1  cid:12  cid:12  cid:12  cid:12 z=.4 20 −.4  .4 k  −.2  −.6  = − cid:18  200 3  cid:19   .4 k  z − .6  z − .4  cid:12  cid:12  cid:12  cid:12 z=1  20 z − .8 zk  =  =  20 .2   .4  .6  50 3  =  Res 1, k  =  z − 1 Y  z zk−1z=1  Thus the zero-state response is  y k  = [Res .6, k  + Res .4, k  + Res 1, k ]µ k − 1   =  cid:18  50  3  cid:19  [3 .6 k − 4 .4 k + 1]µ k − 1    d  The Z-transform of the zero-state response is  From the initial value theorem y 0  = 0. The residues of Y  z zk−1 are  Y  z  = H z X z   =  =  2 z − .8   z − .6  z − .4   cid:18  z  z − .6  z − .4   2z  z − .8 cid:19   197    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res .6, k  =  z − .6 Y  z zk−1z=.6  Res .4, k  =  z − .4 Y  z zk−1z=.4  =  =  2zk   z − .4  cid:12  cid:12  cid:12  cid:12 z=.6  2 .6 k  .2  = 10 .6 k  =  2zk   z − .6  cid:12  cid:12  cid:12  cid:12 z=.4  2 .4 k −.2  = = −10 .4 k  Y  z  = H z X z  2 z − .8   =  z   z − .6  z − .4   z − .4  2z z − .8    z − .6  z − .4 2  =  Res .6, k  =  z − .6 Y  z zk−1z=.6  2 z − .8 zk   z − .4 2  cid:12  cid:12  cid:12  cid:12 z=.6  2 −.2  .6 k  =  =   .2 2 = −10 .6 k  198  Thus the zero-state response is  y k  = [Res .6, k  + Res .4, k ]µ k − 1   = 10[.6 k −  .4 k]µ k − 1   No, the forced mode term does not appear in y k  because it is canceled by the zero of H z  at z = .8.   e  The Z-transform of the zero-state response is  From the initial value theorem y 0  = 0. The residues of Y  z zk−1 are    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res .4, k  =  d dz{ z − .4 2Y  z zk−1}z=.4 dz  cid:26  2 z − .8 zk d  z − .6 [2 k + 1 zk − 1.6kzk−1] − 2 z − .8 zk  z − .6  cid:27  cid:12  cid:12  cid:12  cid:12 z=.4   −.2 [2 k + 1  .4 k − 1.6k .4 k−1] − 2 −.4  .4 k   cid:12  cid:12  cid:12  cid:12 z=.4   z − .6 2   −.2 2  =  =  =  = −[2 k + 1  .4 k − 1.6k .4 k−1] + 4 .4 k = [−10 k + 1  − 20k + 20] .4 k =  10 − 30k  .4 k  .2  Thus the zero-state response is  y k  = [Res .6, k  + Res .4, k ]µ k − 1   = [ 10 − 30k  .4 k − 10 .6 k]µ k − 1   Yes, this is an example of harmonic forcing because X z  has a pole at z = .4 that matches the pole of H z  at z = .4. Thus the natural mode term associated with the pole at z = .4 has a polynomial coeﬃcient that grows with time.  199    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.33 Consider a discrete-time system described by the following transfer function.  H z  =  z + .5 z − .7   a  Find an input x k  that creates a forced mode of the form c .3 k and causes the natural  mode term to disappear in the zero-state response.   b  Find an input x k  that has no zeros and creates a forced mode of the form  c1k+c2  .7 k  in the zero-state response.  Solution   a  The input must have a pole at z = .3 and a zero at z = .7. Thus  X z  =   z − .7  z − .3  x 0  = lim z→∞  X z  = 1  Using the residue method  The residue of the pole at z = −.3 is  Thus the input is  Res .3, k  =   z − .3 X z zk−1    z=.3  =  .3 − .7  .3 k−1 = −.4 .3 k−1  x k  = x 0 δ k  + Res .3, k µ k − 1   = δ k  − .4 −.3 k−1µ k − 1   200    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  The input must have a pole at z = .7. Thus  X z  =  1  z − .7  x 0  = lim z→∞  X z  = 0  Using the residue method  The residue of the pole at z = .7 is  Thus the input is  Res .7, k  =  z − .7 X z zk−1 cid:12  cid:12  cid:12 z=.7  = .7k−1  x k  = x 0 δ k  + Res .7, k µ k − 1   =  . k−1µ k − 1   201    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.34 Consider a discrete-time system described by the following transfer function.  H z  =  3 z − .4  z + .8   a  Suppose the zero-state response to an input x k  is y k  = µ k . Find X z .   b  Find x k .  Solution  Thus   a  The Z-transform of the zero-state response is  Y  z  = H z X z   X z  =  Y  z  H z   =  =  z  z + .8   cid:21 −1 z − 1 cid:20  3 z − .4  3 z − 1  z − .4   z z + .8    b  Using the residue method  x 0  = lim z→∞  X z  = 1 3  The residue of the pole at z = .4 is  Res .4, k  =  z − .4 X z zk−1z=.4  =   .4 + .8 .4k 3 .4 − 1  1.2 .4 k −1.8  = = − 2 3  .4 k  202    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The residue of the pole at z = 1 is  Res 1, k  =  z − 1 X z zk−1z=1  =  =   1 + .8  1 k 3 1 − .4  1.8 1.8  = 1  Thus the input is  x k  = x 0 δ k  + [Res .4, k  + Res 1, k ]µ k − 1   =  1 3 δ k  + [−2 3 .4 k + 1]µ k − 1  =  1 3 δ k  + [1 − 2 3 .4 k]µ k − 1   203    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.35 Find the transfer function H z  = Y  z  X z  of the system whose signal ﬂow graph is shown  in Figure 3.31. This is called a cascade conﬁguration of H1 z  and H2 z .  x    H1 z  -  H2 z  -  v    y     Figure 3.31 Signal Flow Graph of a Cascade Conﬁguration  Solution  Starting from the output of Figure 3.31 and working backwards  Thus the composite cascade transfer function is  Y  z  = H2 z V  z   = H2 z H1 z X z   H z  = H2 z H1 z   204    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.36 Find the overall transfer function H z  = Y  z  X z  of the system whose signal ﬂow graph  is shown in Figure 3.32. This is called a parallel conﬁguration of H1 z  and H2 z .  x    -     -     y     H1 z  -  H2 z  -  Figure 3.32 Signal Flow Graph of a Parallel Conﬁguration  Solution  Starting from the output of Figure 3.32 and working backwards  Y  z  = H1 z X z  + H2 z X z    = [H1 z  + H2 z ]X z   Thus the composite parallel transfer function is  H z  = H1 z  + H2 z   205    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.37 Find the overall transfer function H z  = Y  z  X z  of the system whose signal ﬂow graph  is shown in Figure 3.33. This is called a feedback conﬁguration of H1 z  and H2 z .  x    -     -     y     H1 z  -  H2 z   cid:27   Figure 3.33 Signal Flow Graph of a Feedback Conﬁguration  Solution  Let e be the output of the summing junction. Then from Figure 3.33  E z  = X z  + H2 z Y  z   = X z  + H2 z H1 z E z   Solving for the summing junction output  Starting from the output of Figure P2.19 and working backwards  Thus the composite positive feedback transfer function is  E z  =  X z   1 − H2 z H1 z   Y  z  = H1 z E z   =  H1 z X z   1 − H2 z H1 z   H z  =  H1 z   1 − H2 z H1 z   206    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.38 Consider a discrete-time system described by the following diﬀerence equation.  y k  = .6y k − 1  + .16y k − 2  + 10x k − 1  + 5x k − 2    a  Find the transfer function H z .  b  Find the impulse response h k .  c  Sketch the signal ﬂow graph.  Solution   a  From inspection   b  The factored form of H z  is  By the initial value theorem h 0  = 0. The residues of H z zk−1 are  H z  =  10z−1 + 5z−2  1 − .6z−1 − .16z−2  H z  =  =  10z + 5  z2 − .6z − .16 10 z + .5   z − .8  z + .2   Res .8, k  =  z − .8 H z zk−1z=.8  10 z + .5 zk−1  =  z + .2 = 13 .8 k−1   cid:12  cid:12  cid:12  cid:12 z=.8  Res −.2, k  =  z + .2 H z zk−1z=−.2  10 z + .5 zk−1  =  z − .8 = −3 −.2 k−1   cid:12  cid:12  cid:12  cid:12 z=−.2  h k  = [Res .8, k  + Res −.2, k ]µ k − 1  = [13 .8 k−1 − 3 −.2 k−1]µ k − 1   207  Thus the impulse response is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x    -  -  -  y           6        6  0 -  z−1 ?  z−1 ?  v          .6  cid:27   10 -  .16  cid:27   5 -  Problem 3.38  c  Signal Flow Graph  208    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.39 Consider a discrete-time system described by the following transfer function.  H z  =  4z2 + 1  z2 − 1.8z + .81   a  Find the diﬀerence equation.  b  Find the impulse response h k .  c  Sketch the signal ﬂow graph.  Solution   a  The transfer function in terms of negative powers of z is  H z  =  4 + z−2  1 − 1.8z−1 + .81z−2  By inspection, the diﬀerence equation is  y k  = 1.8y k − 1  − .81y k − 2  + 4x k  + x k − 2    b  The factored form of H z  is  H z  =  4z2 + 1  z − .9 2  By the initial value theorem h 0  = 4. The residues of H z zk−1 are  Res .9, k  =  d dz{ z − .9 2H z zk−1}z=.9 d dz{ 4z2 + 1 zk−1}z=.9  = = [4 k + 1 zk +  k − 1 zk−2]z=.9 = 4 k + 1  .9 k +  k − 1  .9 k−2  Thus the impulse response is  h k  = h 0 δ k  + Res .9, k µ k − 1   = 4δ k  + [4 k + 1  .9 k +  k − 1  .9 k−2]µ k − 1   209    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x    -  -  -  y           6        6  1.8  cid:27   −.81   cid:27   4 -  0 -  1 -  z−1 ?  z−1 ?  v          Problem 3.39  c  Signal Flow Graph  210    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.40 Consider a discrete-time system described by the following impulse response.  h k  = [2 − .5k + .2k−1]µ k    a  Find the transfer function H z .   b  Find the diﬀerence equation.   c  Sketch the signal ﬂow graph.  Solution   a  Using Table 3.2, the transfer function is  z  =  =  +  2z  z − .5  5z z − .2  z − 1  z − .5  z − .2   H z  = Z{h k } z − 1 − 2z z − .5  z − .2  − z z − 1  z − .2  + 5z z − 1  z − .5  z[2 z2 − .7z + .1  −  z2 − 1.2z + .2  + 5 z2 − 1.5z + .5 ] z 6z2 − 7.7z + 2.5   z − 1  z − .5  z − .2    z − 1  z − .5  z − .2   =  =   b  Expanding the denominator and converting to negative powers of z yields  H z  =  6z3 − 7.7z2 + 2.5z  z − 1  z2 − .7z + .1   6z3 − 7.7z2 + 2.5z  z3 − .7z2 + .1z − z2 + .7z − .1 6z3 − 7.7z2 + 2.5z z3 − 1.7z2 + .8z − .1 1 − 1.7z−1 + .8z−2 − .1z−3  6 − 7.7z−1 + 2.5z−2  =  =  =  Thus, by inspection, the diﬀerence equation is  y k  = 1.7y k − 1  − .8y k − 2  + .1y k − 3  + 6x k  − 7.7x k − 1  + 2.5x k − 2   211    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x    -  -  6 -  -  y              6  6           6  6  z−1 ?  z−1 ?  z−1 ?  v             1.7  cid:27   −7.7  -  −.8   cid:27   2.5 -  .1  cid:27   0 -  Problem 3.40  c  Signal Flow Graph  212    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.41 Consider a discrete-time system described by the signal ﬂow graph shown in Figure 3.34.   a  Find the transfer function H z .   b  Find the impulse response h k .   c  Find the diﬀerence equation.  x    -  -  -  y           6        6  4 -  z−1 ?  z−1 ?  r          −1.4   cid:27   −8  -  −.49   cid:27   3 -  Figure 3.34 Signal Flow Graph of System in Problem 3.41  Solution   a  From inspection of Figure 3.34, the transfer function is   b  The factored form of H z  is  H z  =  4 − 8z−1 + 3z−2 1 + 1.4z−1 + .49z−2  H z  =  4z2 − 8z + 3 z2 + 1.4z + .49 4z2 − 8z + 3  z + .7 2  =  By the initial value theorem h 0  = 4. The residues of H z zk−1 are  d dz{ z + .7 2H z zk−1}z=−.7 d dz{ 4z2 − 8z + 3 zk−1}z=−.7  Res −.7, k  = = = [4 k + 1 zk − 8kzk−1 + 3 k − 1 zk−2]z=−.7 = 4 k + 1  −.7 k − 8k −.7 k−1 + 3 k − 1  −.7 k−2  213    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the impulse response is  h k  = h 0 δ k  + Res −.7, k µ k − 1   = 4δ k  + [4 k + 1  −.7 k − 8k −.7 k−1 + 3 k − 1  −.7 k−2]µ k − 1    c  From inspection of the transfer function the diﬀerence equation is  y k  = −1.4y k − 1  − .49y k − 2  + 4x k  − 8x k − 1  + 3x k − 2   214    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.42 A discrete time system has poles at z = ±.5 and zeros at z = ±j2. The system has a DC  gain of 20.   a  Find the transfer function H z .   b  Find the impulse response h k .   c  Find the diﬀerence equation.   d  Sketch the signal ﬂow graph.  Solution   a  The form of the transfer function is  The gain factor α is determined from the DC gain constraint, H 1  = 20. Thus  Solving for α,  H z  =  α z − j2  z + j2   z − .5  z + .5  α z2 + 4  z2 − .25  =  5α .75  = 20  20 3 4   5  α =  = 3  Hence the transfer function is  H z  =  3 z2 + 4    z − .5  z + .5    b  From the initial value theorem h 0  = 3. The residues of H z zk−1 are  215    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res .5, k  =  z − .5 H z zk−1z=.5  3 z2 + 4 zk−1  z + .5  = 12.75 .5 k−1   cid:12  cid:12  cid:12  cid:12 z=.5  Res −.5, k  =  z + .5 H z zk−1z=−.5  3 z2 + 4 zk−1  z − .5  = −12.75 −.5 k−1   cid:12  cid:12  cid:12  cid:12 z=−.5  =  =  Thus the impulse response is  h k  = h 0 δ k  + [Res .5, k  + Res −.5, k ]µ k − 1   = 3δ k  + 12.75[ .5 k−1 −  −.5 k−1]µ k − 1    c  Writing H z  in terms of negative powers of z  H z  =  =  3 z2 + 4  z2 − .25 3 + 12z−2 1 − .25z−2  By inspection, the diﬀerence equation is  y k  = .25y k − 2  + 3x k  + 12x k − 2   216    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x    -  -  -  y           6  0  cid:27         6  3 -  0 -  z−1 ?  z−1 ?  v          −.25   cid:27   12 -  Problem 3.42  d  Signal Flow Graph  217    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.43 Consider a discrete-time described by the signal ﬂow graph shown in Figure 3.35.   a  Find the transfer function H z .  b  Write the diﬀerence equations as a system of two equations.  c  Write the diﬀerence equation as a single equation.  x    -  -  - -  -  2 -  -  y           6  0  cid:27   u         1 -  1 -  z−1 ?  z−1 ?                   6  6  −1.2   cid:27   1.8 -        6  z−1 ?  z−1 ?           −.49   cid:27   −6  -  .32  cid:27   .36 -  Figure 3.35 Signal Flow Graph of System in Problem 3.43  Solution   a  From inspection of Figure 3.35, the transfer function of each subsystem is  H1 s  =  H2 s  =  1 + .49z−2  U  s  X s  1 + z−1 − 6z−2 z2 + z − 6 z2 + .49 Y  s  U  s  2 + 1.8z−1 + .36z−2 1 + 1.2z−1 − .32z−2 2z2 + 1.8z + .36 z2 + 1.2z − .32  =  =  =  =  =  = H1 s H2 s  z2 + .49  cid:20  2z2 + 1.8z + .36 z2 + z − 6 z2 + 1.2z − .32  cid:21   z2 + z − 6  2z2 + 1.8z + .36   z2 + .49  z2 + 1.2z − .32   =  218  Thus the overall transfer function is  H s  =  Y  s  X s     2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Writing one equation for each subsystem  u k  = x k  + x k − 1  − 6x k − 2  − .49u k − 2  y k  = 2u k  + 1.8u k − 1  + .36u k − 2  + 1.2y k − 1  − .32y k − 2 y k − 2    c  Using the overall transfer function  H z  =  2 z2 + z − 6  z2 + .9z + .18   z2 + .49  z2 + 1.2z − .32  2 z4 + .9z3 + .18z2 + z3 + +.9z2 + .18z − 6z2 − 5.4z − 1.08  2 z4 + 1.9z3 − 5.73z2 − .522z − 1.08  z4 + 1.2z3 + .07z2 + .588z − .1568 2 1 + 1.9z−1 − 5.73z−2 − .522z−3 − 1.08z−4  1 + 1.2z−1 + .07z−2 + .588z−3 − .1568z−4  z4 + 1.2z3 − .32z2 + .49z2 + .588z − .1568  =  =  =  Thus the overall diﬀerence equation is  y k  = 2[x k  + 1.9x k − 1  − 5.7x k − 2  − .522x k − 3  − 1.08x k − 4 ] −  1.2y k − 1  − .07y k − 2  − .588y k − 3  + .1568y k − 4   219    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.44 Consider a system with the following impulse response.  h k  =  −1 kµ k    a  Find the transfer function, H z .   b  Find a bounded input x k  such that the zero-state response is unbounded.   c  Find a bound for x k .   d  Show that the zero-state response y k  is unbounded.   b  One needs to use harmonic forcing to create a double pole in Y  z  on the unit circle at  x k  =  −1 kµ k    0.2    c  The input x k  is bounded with  Solution   a  From Table 3.2  z = −1. Try  Then  Thus Bx = 1.  H z  =  z  z + 1  X z  =  z  z + 1  x k  =  −1 kµ k   ≤ 1  220    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  The zero-state response is  Using the residue method  Y  z  = H z X z   =  z2   z + 1 2  y 0  = lim z→∞  Y  z  = 1  The residue of the double pole at z = −1 is  d  d  dz h z + 1 2X z zk−1iz=−1 Res −1, k  = dz hzk+1iz=−1 = =  k + 1 zkz = −1 =  k + 1  −1 k  Thus the zero-state output is  y k  = y 0 δ k  + Res −1, k  −1 kµ k − 1   = δ k  +  k + 1  −1 kµ k − 1   It is clear that y k  is not bounded since y k  = k + 1.  221    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.45 Consider a discrete-time system described by the following transfer function.  H z  =  1  z2 + 1   a  Show that this system is BIBO unstable.   b  Find a bounded x k  with bound Bx = 1 that produces an unbounded zero-state output.   c  Find the Z-transform of the zero-state output when the input in part  b  is applied.  Solution   a  The factored form of the transfer function is  H z  =  z + 1   z − j  z + j   Since H z  has poles at z = ±j and j = 1, the poles of H z  are not strictly inside the unit circle. Therefore, this system is BIBO unstable.   b  One needs to use harmonic forcing to create a double pole in Y  z  on the unit circle.  Try  X z  =  z  z2 + 1   0.3   Then from Table 3.2 with d = π 2  x k  = sin kπ 2 µ k   Clearly, x k  is bounded with Bx = 1.   c  The zero-state response is  Y  z  = H z X z   =  z   z2 + 1 2  222    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.46 Is the following system BIBO stable? Show your work.  H z  =  5z2 z + 1    z − .8  z2 + .2z − .8   Solution  The factored form of H z  is  H z  =  5z2 z + 1    z − .8  z + 1  z − .8   =  5z2   z − .8 2  Since all the poles of H z  all lie strictly inside the unit circle, H z  is stable.  223    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.47 Consider the following transfer function with parameter α.  H z  =  z2   z − .8  z2 − z + α    a  Sketch the stability triangle from Figure 3.20. Use the sketch to ﬁnd the maximum range  of values for α over which H z  is stable.   b  Find the poles of H z  corresponding to the two stability limits in part  a .  Solution   a  Since the pole at z = .8 is stable, it is suﬃcient to examine the quadratic factor. If a z  = z2 + a1z + a2 as in  3.7.9 , then a1 = −1 and a2 = α. Thus from the stability triangle in a2 versus a1 space, the stable range for α is  Region of stable second−order parameters  1.5  0.5  1  0  −0.5  −1  α =  a  2  0 < α < 1  Complex  poles  Real  poles  0 =−1  a  1  224  −1.5  −2.5  −2  −1.5  −1  −0.5  0.5  1  1.5  2  2.5  Problem 3.47  a  Stability Triangle   b  The two stability limits are α = 0 and α = 1. At α = 0,    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the poles are  At α = 1,  where  a z  =  z − .8  z2 − z  =  z − .8 z z − 1   p = [0, .8, 1]T  a z  =  z − .8  z2 − z + 1   =  z − .8  z − p2  z − p3   p2,3 =  =  1 ± √1 − 4 1 ± j√3  2  2  Thus the poles are  p = [.8, .5 + j.5√3, .5 − j.5√3]T  225    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.48 Consider the following transfer function with parameter β.  H z  =   z + .7  z2 + βz + .5   z2   a  Sketch the stability triangle from Figure 3.20. Use the sketch to ﬁnd the maximum range  of values for β over which H z  is stable.   b  Find the poles of H z  corresponding to the two stability limits in part  a .  Solution   a  Since the pole at z = −.7 is stable, it is suﬃcient to examine the quadratic factor. If a z  = z2 + a1z + a2 as in  3.7.9 , then a1 = β and a2 = .5. Thus from the stability triangle in a2 versus a1 space, the stable range for β is  Region of stable second−order parameters  −1.5 < α < 1.5  Complex  poles  Real  poles  1.5  0.5  1  0  −0.5  −1  5 . =  a  2  −1.5  −2.5  −2  −1.5  −1  −0.5  0.5  1  1.5  2  2.5  Problem 3.48  a  Stability Triangle   b  The two stability limits are β = −1.5 and β = 1.5. At β = −1.5,  0 =β  a  1  226    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the poles are  At β = 1.5,  Thus the poles are  a z  =  z + .7  z2 − 1.5z + .5  =  z + .7  z − 1  z − .5   p = [−.7, .5, 1]T  a z  =  z + .7  z2 + 1.5z + .5  =  z + .7  z + 1  z + .5   p = [−1, −.7, −.5]T  227    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.49 Consider the following discrete-time system.  H z  =  10z  z2 − 1.5z + .5   a  Find the poles and zeros of H z .   b  Show that this system is BIBO unstable.   c  Find a bounded input x k  that produces and unbounded output. Show that x k  is  bounded. Hint: Use harmonic forcing.   d  Find the zero-state response produced by the input in part  c  and show that it is  unbounded.  Solution   a  The factored form of H z  is  Thus H z  has a zero at z = 0, and poles at z = 1 and z = .5.   b  From part  a , H z  has a pole on the unit circle at z = 1. Therefore by Proposition  3.1, H z  is BIBO unstable.   c  Using the hint, an input with a pole at z = 1 is required. For example, try the unit step.  This is clearly bounded with x k  ≤ 1.   d  The Z-transform of the zero-state response to the step input from part  c  is  H z  =  10z   z − 1  z − .5   x k  = µ k   Y  z  = H z U  z  10z  =  cid:20   =   z − 1  z − .5  cid:21   z − 1 2 z − .5   10z2  z z − 1  228  To ﬁnd y k , note from the initial value theorem that y 0  = 0. The residues of Y  z zk−1 are    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Res 1, k  =  d dz{ z − 1 2H z zk−1}z=1 dz  cid:26  10zk+1 z − .5  cid:27  cid:12  cid:12  cid:12  cid:12 z=1 d  z − .5 10 k + 1 zk − 10zk+1   z − .5 2  .5 10 k + 1  − 10   .5 2   cid:12  cid:12  cid:12  cid:12 z=1  =  =  =  =  =  = 20 k + 1  − 40  10zk+1   z − 1 2 cid:12  cid:12  cid:12  cid:12 z=.5  10 .5 k+1  −.5 2  = 40 −.5 k+1  Res .5, k  =  z − .5 H z zk−1z=.5  Thus the zero-state response is  y k  = [Res 1, k  + Res .5, k ]µ k − 1   = [20 k + 1  − 40 + 40 −.5 k+1]µ k − 1   This is clearly unbounded due to the presence of the 20 k + 1  term generated by the double pole at z = 1.  229    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.50 Consider the following system that consists of a gain of A and a delay of d samples  y k  = Ax k − d    a  Find the transfer function, the poles, the zeros, and the DC gain.   b  Is this system BIBO stable?. Why or why not?   c  Find the impulse response of this system.   d  Find the frequency response of this system.   e  Find the magnitude response,.   f  Find the phase response.  Solution   a  By inspection the transfer function is  There a no zeros, and d poles at z = 0. The DC gain is   b  Yes, it is BIBO stable because all of the poles are strictly inside the unit circle.   c  The impulse response is   d  The frequency response is  H z  = Az−d  =  A zd  H 1  = A  h k  = Z−1{H z } = Z−1{Az−d} = Aδ k − d   H f   = H z z=exp j2πf T   = A[exp j2πf T  ]−d = A exp −j2πdf T    230    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    e  The magnitude response is   f  The phase response is  A f   = H f    = A exp −j2πdf T   = A · exp −j2πdf T   = A  φ f   = 6 H f    = 6 A exp −j2πdf T   = 6 A + 6 exp −j2πdf T   = π[1 − µ A ] − 2df T  231    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.51 Consider the following ﬁrst-order IIR system.  H z  =  z + .5 z − .5   a  Find the frequency response H f  .   b  Find and sketch the magnitude response A f  .   c  Find and sketch the phase response φ f  .  Solution  response is   a  Let θ = 2πf T . Then applying Deﬁnition 3.3 and using Euler’s identity, the frequency  =  H f   = H z z=exp jθ  exp jθ  + .5 exp jθ  − .5 cos θ  + j sin θ  + .5 cos θ  + j sin θ  − .5 cos θ  + .5 + j sin θ  cos θ  − .5 + j sin θ   =  =  ,  θ = 2πf T   b  The magnitude response is  A f   = H f    =  cos θ  + .5 + j sin θ   cos θ  − .5 + j sin θ  = p[cos θ  + .5]2 + sin2 θ  p[cos θ  − .5]2 + sin2 θ  = p1.25 + cos θ ] p1.25 − cos θ  = p1.25 + cos 2πf T   p1.25 − cos 2πf T    232    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response  2.5  3  2  1    f   A  1.5  0.5  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.51  b  Magnitude Response   c  The phase response is  φ f   = 6 H f    sin θ   = 6 {cos θ  + .5 + j sin θ } − 6 {cos θ  − .5 + j sin θ } = tan−1 cid:20  = tan−1 cid:20   cos θ  + .5 cid:21  − tan−1 cid:20  cos 2πf T   + .5 cid:21  − tan−1 cid:20   cos 2πf T   − .5 cid:21   cos θ  − .5 cid:21   sin 2πf T    sin 2πf T    sin θ   233    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Phase Response    f   φ  0  −0.1  −0.2  −0.3  −0.4  −0.5  −0.6  −0.7  −0.8  −0.9  −1  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.51  c  Phase Response  234    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.52 Consider the following ﬁrst-order FIR system which is called a backwards Euler diﬀerentiator.  H z  =  z − 1 T z   a  Find the frequency response H f  .   b  Find and sketch the magnitude response A f  .   c  Find and sketch the phase response φ f  .   d  Find the steady state response to the following periodic input.  x k  = 2 cos .8πk  − sin .5πk   Solution  response is   a  Let θ = 2πf T . Then applying Deﬁnition 3.3 and using Euler’s identity, the frequency  H f   = H z z=exp jθ   =  =  =  exp jθ  − 1 T exp jθ  cos θ  + j sin θ  − 1 T [cos θ  + j sin θ ] cos θ  − 1 + j sin θ  T [cos θ  + j sin θ ]  ,  θ = 2πf T   b  The magnitude response is  A f   = H f    =  cos θ  − 1 + j sin θ  T cos θ  + j sin θ  = p[cos θ  − 1]2 + sin2 θ  = p2[1 − cos θ ] = p2[1 − cos 2πf T  ]  T  T  T  235    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response    f   A  2  1.8  1.6  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.52  b  Magnitude Response   c  The phase response is  φ f   = 6 H f    = 6 {[cos θ  − 1 + j sin θ ]} − 6 {T [cos θ  + j sin θ ]} cos θ  − 1 cid:21  − tan−1 cid:20  sin θ  = tan−1 cid:20  sin θ  cos θ  cid:21  = tan−1 cid:20  sin θ  cos θ  − 1 cid:21  − θ = tan−1 cid:20  sin 2πf T   cos 2πf T   − 1 cid:21  − 2πf T  Note that by L’Hospital’s rule, φ 0  = −π 2.  236    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Phase Response    f   φ  0.8  1.6  1.4  1.2  1  0.6  0.4  0.2  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.52  c  Phase Response   d  Since fsT = 1, the input can be rewritten as  x k  = 2 cos .8πk  − sin .5πk   = 2 cos[2π .4 kfsT ] − sin[2π .25 kfsT ] = 2 cos 2πF1kT   − sin 2πF2kT     Thus the two frequencies, expressed as fractions of fs, are F1 = .4fs and F2 = .25fs. Since H z  is BIBO stable, it follows that the steady-state output is  yss k  = 2A F1  cos[.8πk + φ F1 ] − A F2  sin[.5πk + φ F2 ]  = 2A .4fs  cos[.8πk + φ .4fs ] − A .25fs  sin[.5πk + φ .25fs ]  237    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.53 Consider the following second-order system.  H z  =  3 z + 1  z2 − .81   a  Find the frequency response H f  .   b  Find and sketch the magnitude response A f  .   c  Find and sketch the phase response φ f  .   d  Find the steady state response to the following periodic input.  x k  = 10 cos .6πk   Solution  response is   a  Let θ = 2πf T . Then applying Deﬁnition 2.8 and using Euler’s identity, the frequency  =  H f   = H z z=exp jθ  3[exp jθ  + 1] exp 2jθ  − .81 3[cos θ  + j sin θ  + 1] [cos 2θ  + j sin 2θ  − .81] 3[cos θ  + 1 + j sin θ ] [cos 2θ  − .81 + j sin 2θ ]  =  =  ,  θ = 2πf T   b  The magnitude response is  A f   = H f    =  =  =  =  3 cos θ  + 1 + j sin θ   cos 2θ  − .81 + j sin 2θ  3p[cos θ  + 1]2 + sin2 θ  p[cos 2θ  − .81]2 + sin2 2θ  3p2[1 + cos θ ] p[cos 2θ  − .81]2 + sin2 2θ  3p2[1 + cos 2πf T  ] p[cos 4πf T   − .81]2 + sin2 4πf T    238    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response    f   A  35  30  25  20  15  10  5  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.53  b  Magnitude Response   c  The phase response is  φ f   = 6 H f    = 6 {3[cos θ  + 1 + j sin θ ]} − 6 {[cos 2θ  − .81 + j sin 2θ ]} = tan−1 cid:20  sin θ  = tan−1 cid:20  sin 2πf T    cos θ  + 1 cid:21  − tan−1 cid:20  cos 2πf T   + 1 cid:21  − tan−1 cid:20   cos 4πf T   − .81 cid:21   cos 2θ  − .81 cid:21   sin 4πf T    sin 2θ   239    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Phase Response    f   φ  −0.8  0  −0.2  −0.4  −0.6  −1  −1.2  −1.4  −1.6  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 3.53  c  Phase Response   d  Since fsT = 1, the input can be rewritten as  x k  = 10 cos .6πk   = 10 cos[2π .3 kfsT ] = 10 cos 2πF1kT    Thus the frequency of x k , expressed as a fraction of fs, is F1 = .3fs. Since H z  is BIBO stable, it follows that the steady-state output is  yss k  = 10A F1  cos[.6πk + φ F1 ]  = 10A .3fs  cos[.6πk + φ .3fs ]  240    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.54 Consider a system with the following impulse response.  h k  = 10 .5 kµ k    a  Find the transfer function.   b  Find the magnitude and phase responses.   c  Find the fundamental frequency F0, expressed as a fraction of fs, of the following periodic  input.  x k  =  cos .1πik   1  1 + i  9  Xi=0   d  Find the steady-state response yss k  to the periodic input in part  c . Express your  ﬁnal answer in terms of F0.  Solution   a  From Table 3.2, the transfer function is   b  Let θ = 2πf T . The frequency response is  Thus the magnitude response is  H z  = Z{h k }  =  10z z − .5  H f   = H z z=exp jθ   =  10 exp jθ  exp jθ  − .5  241    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   A f   = H f    =  =  10  10 exp jθ   10 exp jθ   =  cid:12  cid:12  cid:12  cid:12  cos θ  + j sin θ  − .5 cid:12  cid:12  cid:12  cid:12   cos θ  + j sin θ  − .5 p[cos θ  − .5] 2 + sin2 θ  p[cos 2πf T   − .5] 2 + sin2 2πf T   p[cos2 2πf T   − cos 2πf T   + .25 + sin2 2πf T   p1.25 − cos 2πf T    10  10  10  =  =  =  φ f   = 6 H f    10 exp jθ   cos θ  + j sin θ  − .5 cid:27  cos θ  − .5 cid:21   = 6  cid:26  = 6 f rac10 exp jθ  − 6 cos θ  + j sin θ  − .5 = θ − arctan cid:20  = 2πf T − arctan cid:20   cos 2πf T   − .5 cid:21   sin 2πf T    sin θ   Thus phase response is   c  The fundamental harmonic is the i = 1 term. Set  Then  2πF0kT = .1πk  F0 =  .1 2T  = .05fs  242    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  Using the linearity of the system as in  3.8.15 , the steady-state response is  yss k  =  A iF0   cos[.1πik + φ iF0 ]  1  1 + i  =  cos[2πikF0T + φ iF0 ]  A iF0  1 + i  9  9  Xi=0 Xi=0  243    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.55 For the system in problem 3.54, consider the following following complex sinusoidal input.  x k  = cos πk 3  + j sin πk 3    a  Find the frequency F0 of x k , expressed as a fraction of fs.  b  Find the steady-state output yss k .  Solution   a  Here  Thus   b  Let θ = 2πf T . The frequency response is  2πF0kT =  πk 3  F0 =  =  1 6T fs 6  H f   = H z z=exp jθ   =  =  =  10z  z − .5 cid:12  cid:12  cid:12  cid:12 z=exp jθ   10 exp jθ  exp jθ  − .5 10 exp j2πf T   exp j2πf T   − .5  Thus the complex steady-state response is  yss k  = H F0  exp jπk 3  10 exp j2πF0T    =  =  =  10 exp j2π 6   exp j2πF0T   − .5 · exp jπk 3  exp j2π 6  − .5 · exp j2πk 6  10 exp j2π 3  exp j2π 6  − .5  244    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.56 An alternative to using an AR model for system identiﬁcation is to use a MA model. One  important advantage of an MA model is that it is always stable.   a  Let D be the input-output data in  3.9.3 . Suppose y = [y 0 , . . ., y N − 1 ]T , and let b ∈ Rm+1 be the parameter vector. Find a N ×  m + 1  coeﬃcient matrix U , analogous to Y in  3.9.5 , such that the MA model agrees with the data D when N = m + 1 and  H z  =  biz−i  m  Xi=0  U b = y   b  Find an expression for the optimal least-squares b when N > m + 1.  Solution   a  Given the input-output date in D, the MA model will precisely ﬁt the data if  y k  =  bix k − i   ,  0 ≤ k < N  m  Xi=0  Let U be the N ×  m + 1  matrix whose kth row is [x k , x k − 1 , . . ., x k − m ] for 0 ≤ k < N . That is,  U =    x 0  x 1  ...  x −1  x 0  ...  x N − 1  x N − 2   x −m  x 1 − m   · · · · · · .. . · · · x N − 1 − m   ...     Then the N equations can be written in vector form as  U b = y  245    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Suppose N >  m + 1 . Premultiply both sides of U b = y by the  m + 1 × N matrix U T .  This is the vector form of the normal equations. If the input x k  is selected such that U has full rank, then the square matrix U T U will be nonsingular. Thus the optimal least-squares b is  U T U b = U T y  b =  U T U  −1U T y  The matrix U +1 =  U T U  −1U T is the pseudo-inverse or Moore-Penrose inverse of U .  246    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.57 Consider the system in Problem 3.53. Use GUI module g sysfreq to perform the following   a  Plot the pole-zero pattern. Is this system BIBO stable?   b  Plot the response to white noise. Use Caliper to mark the minimum point.  tasks.  Solution  Rewriting H z  in terms of negative powers of z yields  H z  =  =  3 z + 1  z2 − .81 3z−1 + 3z−2 1 − .81z−2  By inspection of the pole-zero plot, this system is BIBO stable.  x  H z   y  0  0    z   m I  2  1  0  −1  −2  −2  Pole−zero plot  Magnitude of transfer function  −1  0  Re z   1  2  Problem 3.57  a  Poles and Zeros  Stable System   0  Im z   −2  −2  0  −1  Re z   2  1     z   a     z   b   10  5  0 2  247    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x x x  H z  H z  H z  H z   y y y y  0 0 0 0  0 0 0 0  1  0  0  −1  10  0    k   x    k   y  −10  0  Time signals, white noise input  50  100  150  200  250  300  50  100  200  250  300  150  k     x,y  =  226.21,−8.21   Problem 3.57  b  Response to White Noise  248    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.58 Consider the system in Problem 3.53. Use GUI module g sysfreq to plot the step response.  Estimate the DC gain from the step response using the Caliper option.  Solution  Rewriting H z  in terms of negative powers of z yields  H z  =  3 z + 1  z2 − .81 3z−1 + 3z−2 1 − .81z−2  =  x x x x x x  H z  H z  H z  H z  H z  H z   y y y y y y  0 0 0 0 0 0  0 0 0 0 0 0  2  1    k   x  0  0  40    k   y  20  0  0  Time signals, unit step input  50  100  150  200  250  300     x,y  =  250.31,31.48   50  100  200  250  300  150  k  Problem 3.58 Step Response: DC Gain ≈ 31.5  249    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.59 Consider the following linear discrete-time system.  Use GUI module g sysfreq to plot the following damped cosine input and the zero-state response to it.  H z  =  5z−2 + 4.5z−4  1 − 1.8z−2 + .81z−4  x k  = .96k cos .4πk   Solution  The default value for the sampling rate is fs = 2000 Hz. To achieve cos .4πk  set .4πk = 2πF0kT . Solving for F0  F0 =  .2 T  = .2fs = 400  250    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x  H z   y  0  0  1  0    k   x  −1  20  0    k   y  10  0  −10  0  Time signals, damped cosine input: c=0.96, F  =400  0  50  100  150  200  250  300  50  100  200  250  300  150  k  Problem 3.59 Damped Cosine Input and the Zero-state Response  251    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.60 Consider the following linear discrete-time system.  H z  =  6 − 7.7z−1 + 2.5z−2  1 − 1.7z−1 + .8z−2 − .1z−3  Create a MAT-ﬁle called prob3 60 that contains f s = 100, the appropriate coeﬃcient vectors a and b, and the following input samples where v k  is white noise uniformly distributed over [−.5, .5].  x k  = k exp −k 50  + v k   ,  0 ≤ k < 500  Use GUI module g sysfreq and the User-deﬁned option to plot this input and the zero-state response to this input.  x  H z   y  Solution  0  0    k   x  10  0  −10  0  6000    k   y  4000  2000  0  0  Time signals, user−defined input from file C:\rjs\books\book4\_2e\chap3\prob\prob3_60.mat 20  50  100  150  200  250  300  350  400  450  500  50  100  150  200  300  350  400  450  500  250  k  Problem 3.60 User-Deﬁned Input and the Zero-state Response  252    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.61 Consider the following linear discrete-time system. Suppose the sampling frequency is fs = 1000 Hz. Use GUI module g sysfreq with to plot the magnitude response using the linear scale and the phase response.  H z  =  10 z2 + .8    z2 + .9  z2 + .7   Solution  Expressing the transfer function in terms of negative powers of z yields  H z  =  10 z2 + .8   z4 + 1.6z2 + .63 10z−2 + 8z−4  =  1 + 1.6z−2 + .63z−4  x  H z   y  0  0    f   A  70  60  50  40  30  20  10  0  0  Magnitude response  253  50  100  150  200  300  350  400  450  500  250  f  Hz   Problem 3.61  a  Magnitude Response    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x  H z  H z   y y  Phase response  0 0  0 0  3  2  1  0  −1  −2  −3  −4  0  φ  50  100  150  200  300  350  400  450  500  250  f  Hz   Problem 3.61  b  Phase Response  254    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.62 Consider the following linear discrete-time system. Use GUI module g sysfreq to plot the magnitude response and the phase response. Use fs = 100 Hz, and use the dB scale for the magnitude response.  H z  =  5 z2 + .9   z2 − .9 2  Solution  Expressing the transfer function in terms of negative powers of z yields  H z  =  5 z2 + .9   z4 − 1.8z2 + .81 5z−2 + 4.5z−4 1 − 1.8z−2 + .81z−4  =  x x x  H z  H z  H z   y y y  0 0 0  0 0 0  60  40  20  0    B d       f   A  −20  0  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 3.62  a  Magnitude Response  Magnitude response  255    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x x x  H z  H z  H z  H z   y y y y  Phase response  0 0 0 0  0 0 0 0  4  2  φ  0  −2  −4  0  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 3.62  b  Phase Response  256    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.63 Consider the running average ﬁlter in Problem 3.31. Suppose M = 10. Use GUI module  g sysfreq to perform the following tasks.   a  Plot the impulse response using N = 100 and stem plots.   b  Plot the magnitude response using the linear scale.   c  Plot the magnitude response using the dB scale.   d  Plot the phase response.  x x x x x  H z  H z  H z  H z  H z   y y y y y  Solution  0 0 0 0 0  0 0 0 0 0  1    k   x  0.5  0  0  0.1    k   y  0.05  0  0  Time signals, unit impulse input  10  20  30  40  50  60  70  80  90  100  10  20  30  40  60  70  80  90  100  50 k  Problem 3.63  a  Impulse Response  257    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0 0 0  0 0 0 0 0 0    f   A  1  0.8  0.6  0.4  0.2  0  0  0 0 0 0 0 0 0  0 0 0 0 0 0 0    B d       f   A  0  −50  −100  −150  −200  −250  −300  −350  0  x x x x x x  H z  H z  H z  H z  H z  H z   y y y y y y  Magnitude response  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 3.63  b  Magnitude Response  linear   x x x x x x x  H z  H z  H z  H z  H z  H z  H z   y y y y y y y  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 3.63  c  Magnitude Response  dB   Magnitude response  258    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x x x x x x x x  H z  H z  H z  H z  H z  H z  H z  H z   y y y y y y y y  Phase response  0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0  2  1  0  −1  −2  −3  0  φ  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 3.63  d  Phase Response  259    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.64 Consider the following discrete-time system.  H z  =  1.5z4 − .4z3 − .8z2 + 1.1z − .9 z4 − .95z3 − .035z2 + .462z − .351  Write a MATLAB program that uses ﬁlter and plot to compute and plot the zero-state response of this system to the following input. Plot both the input and the output on the same graph.  x k  =  k + 1  .9 kµ k   ,  0 ≤ k ≤ 100  Solution  % Problem 3.64  % Initialize  f_header ’Problem 3.64’  a = [1 -.95 -.035 .462 -.351] b = [1.5 -.4 -.8 1.1 .9] N =101; k = 0 : N-1; x =  k+1  .*  .9 .^k;  % Find zero-state response  y = filter  b,a,x ;  % Plot input and output  figure h = plot  k,x,k,y ; set  h 2 ,’LineWidth’,1.5  f_labels  ’’,’k’,’x k  and y k ’  legend  ’x’,’y’  f_wait  260    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   y   d n a     k   x  60  50  40  30  20  10  0    0     x y  20  40  60  80  100  k  Problem 3.64 Input and Zero-State Response  261    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.65 Consider the following discrete-time system. Write a MATLAB program that performs the  following tasks.  H z  =  2z5 + .25z4 − .8z3 − 1.4z2 + .6z − .9 z5 + .055z4 − .85z3 − .04z2 + .49z − .32   a  Compute and display the poles, zeros, and DC gain. Is this system stable?  b  Plot the poles and zeros using the FDSP toolbox function f pzplot.  c  Plot the transfer function surface using f pzsurf.  Solution  % Problem 3.65  % Initialize  f_header ’Problem 3.65’  a = [1 .055 -.85 -.04 .49 -.32]; b = [2 .25 -.8 -1.4 .6 -.9];  % Compute poles, zeros, and DC gain  poles = roots a  zeros = roots b  DC_gain = polyval b,1  polyval a,1  if max abs poles  < 1   fprintf  ’\nThis system is stable.\n’   fprintf  ’\nThis system is unstable.\n’   else  end  % Pole-zero plot  figure f_pzplot  b,a,’Poles and Zeros’  f_wait  % Transfer function surface  N =61; hmax = 10; figure f_pzsurf  b,a,hmax,N  pause  .01  f_pzsurf  b,a,hmax,N  f_wait  % Fix for Windows XP?  262    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Program output:  poles =  zeros =  -0.8681 + 0.4607i -0.8681 - 0.4607i  0.8358 0.4227 + 0.4667i 0.4227 - 0.4667i  -0.8004 + 0.6908i -0.8004 - 0.6908i  1.0354 0.2202 + 0.5833i 0.2202 - 0.5833i  DC_gain =  -0.7463  This system is stable.  263    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Poles and Zeros  −1  0  Re z   1  2  Problem 3.65  b  Pole-Zero Plot  Magnitude of transfer function    z   m I  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2     z   a     z   b   10  8  6  4  2  0 2  1  0  −1  Im z   −2  −2  −1  0  Re z   2  1  Problem 3.65  c  Transfer Function Surface  264    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.66 Consider the following discrete-time system.  H z  =  10z3 z4 − .81  Write a MATLAB program that performs the following tasks.   a  Use f freqz to compute the magnitude response and the phase response at M = 500  points assuming fs = 200 Hz. Plot them as a 2 by 1 array of plots   b  Use ﬁlter to compute the zero-state response to the following periodic input with F0 = 10 Hz. Compute the steady state response yss k  to x k  using the magnitude and phase responses evaluated at f = F0. Plot the zero-state response and the steady-state response on the same graph using a legend.  x k  = 3 cos 2πF0kT  µ k   ,  0 ≤ k ≤ 100  Solution  % Problem 3.66  % Initialize  f_header ’Problem 3.66’  a = [1 0 0 0 -.81] b = [10 0 0 0]  % Frequency response  M =500; fs = 200; [H,f] = f_freqz b,a,M,fs ; A = abs H ; phi = angle H ; subplot 2,1,1  plot f,A  f_labels ’Magnitude Response’,’f  Hz ’,’A f ’  subplot 2,1,2  plot f,phi  f_labels ’Phase Response’,’f  Hz ’,’\phi f ’  f_wait  % Zero-state response  265    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   N = 101; k = 0 : N; T = 1 fs; F0 = 10 x = 3*cos 2*pi*F0*k*T ; y = filter  b,a,x ;  % Steady-state response  i = max find f <= F0   Fi = f i  yss = 3*A i *cos 2*pi*F0*k*T + phi i  ; hp = plot k,y,k,yss ; set hp 2 ,’LineWidth’,1.5  legend ’Zero-state response’,’Steady-state response’  f_labels ’Responses to Cosine Input’,’k’,’y’  f_wait  266    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   60  40  20    f   A  0  0  0.5  1  0  −0.5  −1  0    f   φ  Magnitude Response  20  40  60  80  100  f  Hz   Phase Response  20  40  60  80  100  f  Hz   Problem 3.66 Frequency Response  267    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   40  30  20  10  y  0  −10  −20  −30  −40    0  Responses to Cosine Input     Zero−state response Steady−state response  20  40  80  100  120  60 k  Problem 3.66 Steady-State Response  268    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 3.67 The MAT ﬁle prob3 67 contains an input signal x, an output signal y, and a sampling fre- quency f s. Write a MATLAB program that performs system identiﬁcation with this data by performing the following tasks.   a  Load x, y, and f s from prob3 67 and use f idar to compute an AR model of order n = 8.   b  Plot the ﬁrst 100 samples of the data, y k , and the AR model output, Y  k , on the  Print the coeﬃcient vector a  same graph using a legend.  Solution  % Problem 3.67  % Initialize  f_header ’Problem 3.67’  load prob3_67  % Identify an AR model  n = 8; a = f_idar x,y,n   % Plot first 100 samples  b = 1; Y = filter b,a,x ; N = length x ; k = 1:min 100,N ; hp = plot k,y k ,k,Y k  ; set hp 2 ,’LineWidth’,1.5  legend ’Data’,’AR Model’  f_labels ’Output of AR Model’,’k’,’y k ’  f_wait   a  The optimal coeﬃcient vector a is  a =  0.9685 -1.5327 0.6511 1.0016 -1.4963 0.7015 0.0962 -0.3520 0.1694  269    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   y  6  4  2  0  −2  −4  −6    0  Output of AR Model     Data AR Model  20  40  60  80  100  k  Problem 3.67  b  Output of AR Model  270    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   3.68 System identiﬁcation can be performed using a MA model instead of the AR model discussed  in Section 3.9. Recall that this was the focus of problem 3.56.   a  Write function called f idma, similar to the FDSP function f idar, that performs system  identiﬁcation using a MA model. The calling sequence should be as follows.  [b,E] = f_idma  x,y,m ;  % F_IDMA: MA system identification % % Usage: % % Pre: % % % % Post: % % %  E = least squares error  coefficients  x = vector of length N containing the input samples y = vector of length N containing the output samples m = the order of the MA model  m < N   b = vector of length m+1 containing the least-squares   b  Test your f idma, function by solving Problem 3.67, but using f idma in place of f idar.  Use a MA model of order m = 20.   c  Print your user documentation for f idma using the command help f idma.  Solution   a  function [b,E] = f_idma x,y,m   [b,E] = f_idma  x,y,m ;  % F_IDMA: MA system identification % % Usage: % % Pre: % % % % Post: % % % % Notes: % % %  E = least squares error  coefficients  % Check inputs  N = length x ; if m >= N  271  x = vector of length N containing the input samples y = vector of length N containing the output samples m = the order of the MA model  m < N   b = vector of length m+1 containing the least-squares  1. For a good fit, use N >> m. 2. The input x must be persistently exciting such  as white noise or a broadband input  fprintf  ’In f_idma, the number of data samples must larger than \n’  fprintf  ’the MA model order. Here N = %d, m = %d\n\n’,N,m ;    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   b = zeros 1,m+1 ; E = -1; return  end x = x : ; y = y : ;  % Form coefficient matrix  U = zeros N,m+1 ; for k = 0 : N-1  for i = 0 : m  if  k-i  < 0  U k+1,i+1  = 0;  U k+1,i+1  = x k-i+1 ;  else  end  end  end  b = U \ y; r = U*b - y; E = r.’*r;   b  b =  % Find least-squares fit  1.0155 1.5845 1.8261 0.7559 -0.0994 -0.8757 -0.5351 -0.0203 0.7329 0.7573 0.5521 -0.0907 -0.4068 -0.4939 -0.1353 0.2097 0.4762 0.3383 0.0492 -0.2421 -0.2894  272    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Output of MA Model     Data MA Model    k   y  6  4  2  0  −2  −4  −6    0  20  40  60  80  100  k  Figure 3.68 MA Model   c  >> help f_idma  F_IDMA: MA system identification  Usage:  Pre:  Post:  Notes:  [b,E] = f_idma  x,y,m ;  x = vector of length N containing the input samples y = vector of length N containing the output samples m = the order of the MA model  m < N   b = vector of length m+1 containing the least-squares  coefficients  E = least squares error  1. For a good fit, use N >> m. 2. The input x must be persistently exciting such  as white noise or a broadband input  273    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Chapter 4  4.1 Find the DTFT of the following signals where c < 1.   a  x k  = ck cos 2πF0kT  µ k   b  x k  = ck sin 2πF0kT  µ k   Solution   a  From Table 3.2 the Z-transform of x k  is  X z  =  [z − c cos 2πF0T  ]z  z2 − 2c cos 2πF0T  z + c2  Since c < 1, the region of convergence includes the unit circle. Thus from  4.2.1   X f   = X z z=exp j2πf T    =  [exp j2πf T   − c cos 2πF0T  ] exp j2πf T   exp jπf T   − 2c cos 2πF0T   exp j2πf T   + c2   b  From Table 3.2 the Z-transform of x k  is  X z  =  c sin 2πF0T  z  z2 − 2c cos 2πF0T  z + c2  Thus from  4.2.1   X f   = X z z=exp j2πf T    =  c sin 2πF0T   exp j2πf T    exp jπf T   − 2c cos 2πF0T   exp j2πf T   + c2  274    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.2 Consider the following signal where c < 1.  x k  = k2ckµ k    a  Using Appendix 1, ﬁnd the spectrum X f  .   b  Find the magnitude spectrum, Ax f  .  c  Find the phase spectrum, φx f  .  Solution   a  From Table A6 in Appendix 1, the Z-transform of x k  is  X z  =  cz z + c   z − c 3  Since c < 1, the region of convergence includes the unit circle. Thus from  4.2.1   X f   = X z z=exp j2πf T    =  =  c exp j2πf T  [exp j2πf T   + c]  [exp j2πf T   − c]3  c[exp jπf T   + c exp j2πf T  ]  [exp j2πf T   − c]3   b  The magnitude spectrum is  Ax f   = X f    = c[exp jπf T   + c exp j2πf T  ]  [exp j2πf T   − c]3  = c[cos πf T   + c cos 2πf T  ] + jc[sin πf T   + c sin 2πf T  ] = cp[cos πf T   + c cos 2πf T  ]2 + [sin πf T   + c sin 2πf T  ]2  [cos 2πf T   − c + j sin 2πf T  ]3  {[cos 2πf T   − c]2 + sin2 2πf T  }3 2  275    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  The phase spectrum is  φx f   = 6 X f    = 6 {c[exp jπf T   + c exp j2πf T  ]}− 6 {[exp j2πf T   − c]3} = 6 {c[cos πf T   + c cos 2πf T  ] + jc[sin πf T   + c sin 2πf T  ]} − 36 {[cos 2πf T   − c + j sin 2πf T  ]} = arctan cid:26  sin πf T   + c sin 2πf T   cos 2πf T   − c cid:27  cos πf T   + c cos 2πf T   cid:27  − 3 arctan cid:26  sin 2πf T    276    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.3 Consider the following causal ﬁnite signal with x 0  = 1.  x k  = [1, 2, 1]T   a  Find the spectrum X f  .   b  Find the magnitude spectrum, Ax f  .  c  Find the phase spectrum, φx f  .  Solution   a  Using Deﬁnition 4.1  X f   = 1 + 2 exp −j2πf T   + exp −j4πf T    = 1 + 2 exp −j2πf T   + exp −j4πf T   = 1 + 2[cos 2πf T   − j sin 2πf T  ] + cos 4πf T   − j sin 4πf T   = p[1 + 2 cos 2πf T   + cos 4πf T  ]2 + [sin 2πf T  ] + sin 4πf T  ]2   b  The magnitude spectrum is  Ax f   = X f     c  The phase spectrum is  φx f   = 6 {X f  }  = 6 {1 + 2[cos 2πf T   − j sin 2πf T  ] + cos 4πf T   − j sin 4πf T  } = arctan cid:26  −[sin 2πf T  ] + sin 4πf T  ]  1 + 2 cos 2πf T   + cos 4πf T  ] cid:27   277    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.4 Let xa t  be periodic with period T0, and let x k  be a sampled version of xa t  using sampling   a  For what values of T is x k  periodic? Provide an example.   b  For what values of T is x k  not periodic. Provide an example.  interval T .  Solution   a  If T  τ is a positive rational number, then x k  will be periodic. For example, let xa t  = sin 2πt τ  . Suppose T =  L M  τ for integers L ≥ 1 and M ≥ 1. Then x k  will contain exactly M samples per L periods of xa t . Thus x k  is periodic with period M .   b  If T  τ is not a positive rational number, then x k  will not be periodic. For example,  let xa t  = sin 2πt . Suppose T = 1 √2. Then x k  will not be periodic.  x k  = sin cid:18  2πkT τ  cid:19  = sin cid:18  2πLk M  cid:19   x k  = sin cid:18  2πkT τ  cid:19  = sin cid:18  2πk √2  cid:19   278    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.5 If one allows for the possibility that X f   can contain impulses of the form, δa f  , then the table of DTFT pairs can be expanded. Using the inverse DTFT of an impulse, ﬁnd the DTFT of x k  where c is an arbitrary constant.  x k  = c  Solution  Using  4.2.4  and the sifting property of the unit impulse in  1.2.13 , the IDTFT of δa f   is  y k  = IDTFT{δa f  }  =  1  fs Z fs 2  −fs 2  exp j0   =  1 fs = T  δa f   exp jk2πf T  df  Using linearity, the IDTFT of  c T  δa f   is c. Thus  DTFT{c} =  cδa f    T  279    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.6 Using Euler’s identity, ﬁnd the inverse DTFT of the following signals.   a  X1 f   =  δa f − F0  + δa f + F0    b  X2 f   =  δa f − F0  − δ f + F0   2  j2  Solution  of X1 f   is   a  Using  4.2.4  and the sifting property of the unit impulse in  1.2.13 , the inverse DTFT  x1 k  =  X1 f   exp jk2πf T  df  [δa f − F0  + δa f + F0 ] exp jk2πf T  df  [exp jk2πF0T   + exp −jk2πF0T  ]   b  Similarly, using Euler’s identity the inverse DTFT of Xx f   is  x2 k  =  X2 f   exp jk2πf T  df  [δa f − F0  − δa f + F0 ] exp jk2πf T  df  [exp jk2πF0T   − exp −jk2πF0T  ]  1  −fs 2  fs Z fs 2 2fs Z fs 2  1  −fs 2  =  =  1 2fs  = T cos 2πkF0T    1  −fs 2  fs Z fs 2 j2fs Z fs 2  1  −fs 2  1  j2fs  =  =  = T sin 2πkF0T    280    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.7 Consider the following discrete-time signal.  x k  = c cos 2πF0kT + θ    a  Find a and b such that x k  = a cos 2πF0kT   + b sin 2πF0kT    b  Use part  a  and Problem 4.6 to ﬁnd X f  .   a  Using the cosine of the sum trigonometric identity from Appendix 2  x k  = c cos 2πF0kT + θ   = c[cos 2πF0kT   cos θ  − sin 2πF0kT   sin θ ] = a cos 2πF0kT   + b sin 2πF0kT    Solution  where   b  Using part  a  and the results from problem 4.6  X f   = a cid:20  δa f − F0  + δa f + F0   2T   cid:21  + b cid:20 δa f − F0  − δa f + F0   j2T   cid:21   =  c 2T {cos θ [δa f − F0  + δa f + F0 ] + j sin θ [δa f − F0  − δa f + F0 ]}  a = c cos θ  b = −c sin θ   281    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.8 Suppose a signal x k  has the following magnitude spectrum.  Ax f   = cos πf T    ,  0 ≤ f ≤ fs 2   a  Find the energy density spectrum, Sx f  .  b  Find the total energy, Ex.  c  Find the energy is contained in the range 0 ≤ f ≤ αfs where 0 ≤ α ≤ .5.  Solution   a  From  4.2.13  the energy density spectrum is   b  The total energy is   c  The energy in the band f ≤ αfs is  Sx f   = X f  2 x f    = A2 = cos2 πf T    Sx f  df  cos2 πf T  df  −fs 2 cid:20  1 + cos 2πf T    2   cid:21  df  −fs 2  Ex = Z fs 2 = Z fs 2 = Z fs 2 = Z fs 2  −fs 2  −fs 2 fs 2  =  df 2  0  Ex 0, αfs  = 2Z αfs = 2Z αfs = 2Z αfs = Z αfs  0  0  0  Sx f  df  cos2 πf T  df  cid:20  1 + cos 2πf T    2   cid:21  df  [1 + cos 2πf T  ]df  = αfs + sin 2πα   282    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.9 Show that the DTFT satisﬁes the following property called the frequency diﬀerentiation prop- Frequency  diﬀerentiation property  DTFT{kT x k } =  cid:18  j  2π cid:19  dX f    df  erty.  Solution  Thus  Using Deﬁnition 4.1 and the fact that the series converges absolutely  dX f    df  =  =  =  d df  ∞  Xk−∞  ∞  Xk−∞ Xk−∞  ∞  ∞  x k  exp −jk2πf T    d df {x k  exp −jk2πf T  }  −jk2πT x k  exp −jk2πf T    kT x k  exp −jk2πf T    Xk−∞  = −j2π = −j2πDTFT{kT x k }  DTFT{kT x k } =  cid:18  1 =  cid:18  j  −j2π cid:19  dX f   2π cid:19  dX f    df  df  283    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.10 Recall from Problem 3.30 that the Z-transform satisﬁes the following modulation property.  Z{h k x k } =  1  j2π IC  H u X cid:16  z  u cid:17  u−1du  Use this result and the relationship between the Z-transform and the DTFT to show an equivalent modulation property of the DTFT. Here multiplication in the time domain maps into convolution in the frequency domain.  DTFT{h k x k } =  1  fs Z fs 2  −fs 2  H λ X f − λ dλ   0.1   For the DTFT to exist, the region of convergence of the Z-transform must include the unit circle. For the contour C, pick the unit circle.  C = {exp j2πλT    − fs 2 ≤ λ ≤ fs 2}  Solution  Then  = Z{h k x k }z=exp j2πf T   =  cid:20  1  Y  f   = DTFT{h k x k } H u X cid:16  z H u X cid:20  exp j2πf T    =  u  u cid:17  u−1du cid:21  cid:12  cid:12  cid:12  cid:12 z=exp j2πf T    cid:21  u−1du exp j2πλT   cid:21  exp −j2πλT   j2πT   exp j2πλT  dλ H[exp j2πλT  ]X cid:20  exp j2πf T    1  1  =  j2π IC j2π IC j2π Z fs 2 = T Z fs 2 fs Z fs 2  −fs 2  −fs 2  =  1  −fs 2  H λ X{exp[j2π f − λ T ]}dλ  H λ X f − λ dλ  284    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.11 The following scalar, c, is real. Find its value. Hint: Use Euler’s identity.  Euler’s identity can be used in reverse to represent j in polar coordinates. That is,  Solution  Then  c = jj  j = exp cid:18  jπ 2  cid:19   α = jj  2  cid:19  cid:21 j =  cid:20 exp cid:18  jπ = exp cid:18  j2π 2  cid:19  = exp cid:18 −π 2  cid:19   285    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.12 Consider the following discrete-time signal.  x = [2, −1, 3]T   a  Find the third root of unity, W3.  b  Find the 3 × 3 DFT transformation matrix W .  c  Use W to ﬁnd the DFT of x.  d  Find the inverse DFT transformation matrix W −1.   e  Find the discrete-time signal x whose DFT is given by  X = [3, −j, j]T  Solution   a  Using  4.3.5  the third root of unity is   b  Using  4.3.10  as a guide, the DFT transformation matrix is  W3 = exp cid:18 −j2π 3  cid:19  3  cid:19  − j sin cid:18  2π 3  cid:19   = cos cid:18  2π = −.5 − j.866  W =   =   =    W 0 W 0 W 0  3 W 0 3 W 1 3 W 2  3 W 0 3 3 W 2 3 3 W 4 3 1     1  1 1 exp −j2π 3  exp −j4π 3  1 exp −j4π 3  exp −j8π 3   1 1 −.5 − j.866 −.5 + j.866  1 −.5 + j.866 −.5 − j.866  1  1     286    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  From  4.3.12 , the inverse DFT transformation matrix is   c  From  4.3.11    e  Thus  X = W x 1 1 −.5 − j.866 −.5 + j.866 1 −.5 + j.866 −.5 − j.866  1  1        2 −1 3     =   =    4  1 + j3.464 1 − j3.464     W −1 = W ∗ 3  1 1 −.5 + j.866 −.5 − j.866  1 −.5 − j.866 −.5 + j.866  1 3  =  1  1     x = W −1X 1 1 −.5 + j.866 −.5 − j.866 1 −.5 − j.866 −.5 + j.866 1     1 3  =  1  1        3 −j j     =    1.5774 .4226     287    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.13 Verify the following values of W k  N = exp −j2πk N   appearing in Table 4.6.  Solution  From  4.3.5   Thus using Euler’s identity  W k  N =  k = N 4 −j , k = N 2 −1 , , k = 3N 4 j , 1  k = N     WN = exp −j2π N    W N 4  N  = [exp −j2π N ]N 4 = exp −j2π 4  = exp −jπ 2  = −j  W N 2  N  = [exp −j2π N ]N 2 = exp −j2π 2  = exp −jπ  = −1  W 3N 4  N  = [exp −j2π N ]3N 4 = exp −j6π 4  = exp jπ 2   = j  W N N = [exp −j2π N ]N  = exp −j2π  = exp j0   = 1  288    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.14 Using the results of Problem 4.13, verify the following properties of WN = exp −j2π N    appearing in Table 4.6.  N  = W ik N = −W i   a  W  i+N  k  b  W i+N 2 N N = W i  c  W 2i N 2 N = W −1 N   d  W ∗  N  Solution   a  Using entry 4 of Table 4.6   b  Using entry 2 of Table 4.6   c  Using  4.3.5    d  Using  4.3.5   W k+N  N  N W N N  = W k = W k N  W k+N 2  N  N W N 2  N  = W k = −W k  N  N = [exp −2π N  ]2k W 2k = exp −4kπ N   = exp[−2kπ  N 2 ] = {exp[−2π  N 2 ]}k = W k  N 2  W ∗  N = [exp −j2π N ]∗  = exp j2π N   = 1  exp −j2π N   = W −1 N  289    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.15 The following orthogonal property of WN was used to derive the IDFT.  N −1  Xi=0  W ik  N = N δ k   ,  0 ≤ k < N  The ﬁnite geometric series in Problem 3.9c is valid for any complex z. Use this to verify the orthogonality property of WN .  Solution  The ﬁnite geometric series is  Thus  For k = 0  Consequently  n  Xi=m  zi =  zm − zn+1  1 − z  x k  =  N −1  N −1  N  i   W k  W ik N  Xi=0 Xi=0 1 −  W k N  N 1 − W k 1 − W kN 1 − W k 1 − exp −j2πk  1 − exp −j2πk N   0 < k < N  N  N  N  ,  =  =  =  =  = 0  x 0  =  N −1  Xi=0  W i0 N  = N  x k  = N δ k   ,  0 ≤ k < N  290    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.16 Compete the following DFT pairs for N -point signals.   a  If x k  = δ k , ﬁnd X i .   b  If X i  = δ i , ﬁnd x k .  Solution   a  Using Deﬁnition 4.2   b  Using  4.3.7   X i  =  δ k W ik N  N −1  Xk=0 = W 0 N = 1  ,  0 ≤ i < N  x k  =  δ i W −ki  N  N −1  Xi=0 W 0 N  1 N  1 N 1 N  =  =  ,  0 ≤ k < N  291    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.17 Consider the following discrete-time signal.  x = [1, 2, 1, 0]T   a  Find X i  = DFT{x k }.  b  Compute the magnitude spectrum Ax i .  c  Compute the phase spectrum φx i .  d  Compute the power density spectrum Sx i .  Solution   a  Here W4 = exp −j2π 4  = −j. Using Deﬁnition 4.2  3  Xk=0  3  Xk=0  3  Xk=0  X 0  =  x k   = 1 + 2 + 1  = 4  X 1  =  x k W k 4  X 2  =  = 1 + 2 −j  + 1 −1  = −j2 Xk=0  x k  W 2  4  k  3  = 1 + 2 −1  + 1 1  = 0  X 3  =  x k  W 3  4  k  = 1 + 2 j  + 1 −1  = j2  X = [4, −j2, 0, j2]T  292  Thus the DFT of x k  is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  The magnitude spectrum of x k  is   c  The phase spectrum of x k  is   d  The power density spectrum of x k  is  A = X  = [4, 2, 0, 2]T  A = 6 X  = [0, −π 2, 0, π 2]T  SN = X2 4  = [4, 1, 0, 1]T  293    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.18 Let x k  be an N -point signal. Starting with the deﬁnition of average power in  4.3.40 , use Parseval’s identity to show that the average power is the average of the power density spectrum.  Solution  Using the deﬁnition of average power and Parseval’s identity  Px  ∆ =  N −1  1 N  1  N  N −1  x k 2  Xi=0 X i 2 N " 1 Xi=0 N "N −1 N  X i 2 Xi=0 Xi=0  Sx i   1 N  N −1  1  =  =  =  294    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.19 Consider the following discrete-time signal.  x = [−1, 2, 2, 1]T   a  Find the average power Px.  b  Find the DFT of x.   c  Verify Parseval’s identity this case.  Solution   a  Using  4.3.40 , the average power is   b  Here W4 = exp −j2π 4  = −j. Thus, using Deﬁnition 4.2, the DFT of x k  is  Px =  3  1 4  Xk=0  x k 2 1 + 4 + 4 + 1  =  = 2.5  4  X 0  =  x k   = −1 + 2 + 2 + 1 = 4  X 1  =  x k W k 4  = −1 + 2 −j  + 2 −1  + 1 j  = −3 − j  X 2  =  x k  W 2  4  k  X 3  =  = −1 + 2 −1  + 2 1  + 1 −1  = −2 Xk=0  x k  W 3  4  k  3  = −1 + 2 j  + 2 −1  + 1 −j  = −3 + j  3  Xk=0  3  Xk=0  3  Xk=0  295    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the DFT of x k  is   c  The time side of Parseval’s identity is  X = [4, −3 − j, −2, −3 + j]T  N −1  Xk=0  x k 2 = 1 + 4 + 4 + 1  = 10  The frequency side of Parseval’s identity is  1 4  3  Xi=0  X i 2 =  = 10  16 +  9 + 1  + 4 +  9 + 1   4  296    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.20 Consider the following discrete-time signal where c < 1.  x k  = ck  ,  0 ≤ k < N   b  Use the geometric series to simplify X i  as much as possible.   a  Find X i   Solution   a  Using Deﬁnition 4.2  X i  =  ckW ki N  N −1  Xk=0   b  Using  a  and the geometric series from Chapter 2  X i  =  ckW ki N  N −1  N −1  Xk=0 Xk=0 Xk=0  ∞   cW i  N  k   cW i  N  k −   cW i  N  k  ∞  Xk=N  =  =  =  =  =  =  1  N  N − N  N  1 − cW i 1 −  cW i 1 − cW i 1 − cN W i+N 1 − cW i 1 − cN W i 1 − cW i  N  N  N  N   cW i N  N 1 − cW i  N  ,  cW i  N < 1  ,  c < 1  ,  0 ≤ i < N  297    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.21 Suppose x k  is a real N -point signal. Show that the spectrum of x k  satisﬁes the following Symmetry  property  symmetry properties.   a  Re{X i } = Re{X N − i }.  b  Im{X i } = −Im{X N − i }.  Solution   a  From Table 4.7, the symmetry property for real x k  is  Thus  X ∗ i  = X N − i   Re{X i } = Re{X ∗ i }  = Re{X N − i }  Im{X i } = −Im{X ∗ i }  = −Im{X N − i }   b  Using the symmetry property for real x k   298    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.22 Suppose x k  is a real with X i  = DFT{x k }.   a  Show that X 0  is real.   b  Show that when N is even, X N 2  is real.  Solution   a  From Deﬁnition 4.2  Since the x k  are real, the sum, X 0 , is real.   b  Since x k  is real, from the symmetry condition  X 0  =  x k W k0 N  N −1  Xk=0 Xk=0  N −1  =  x k   X ∗ i  = X N − i   Thus  Im{X i } = −Im{X ∗ i }  = −Im{X N − i }  Therefore Im{X i } exhibits odd symmetry about the midpoint i = N 2. If N is even, then N 2 is and integer and Im{X N 2 } = 0 which means X N 2  is real.  299    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.23 Consider an N -point signal x k . Find the smallest integer N such that a radix-two FFT of x k  is at least 100 times as fast as the DFT of x k  when speed is measured in complex FLOPs.  Solution  From  4.4.2 , the computational eﬀort of an N -point DFT is  nDFT = N 2 FLOPs  From  4.4.10 , the computational eﬀort of a radix-two N -point FFT is  Using the itemized cases shown in the following table, the smallest integer N  which must be a power of two  is  nFFT =  N log2 N    2  FLOPs  N = 512  Table Problem 4.23 Number of FLOPs  nDFT  nFFT nDFT nFFT  N  2 4 8 16 32 64 128 256 512 1024  4 16 64 256 1024 4096 16384 65536 262144 1048576  1 4 12 32 80 192 448 1024 2304 5120  4.0 4.0 5.3 8.0 12.8 21.3 36.6 64.0 113.8 204.8  300    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.24 Recall that the DFT of an N -point signal is periodic with period N . One of the properties  of the DFT is the conjugate property  DFT{x∗ k } = X ∗ −i   This property can be used to compute two real DFTs of length N using a single complex DFT of length N . Let a k  and b k  be real and consider the complex signal  c k  = a k  + jb k   ,  0 ≤ k < N  Using the identities in Appendix 2, and the conjugate property, show that  Solution  From Appendix 2,  Thus from conjugate property of the DFT  A i  =  B i  =  C i  + C∗ −i  C i  − C∗ −i   2  j2  a k  = Re{c k }  c k  + c∗ k   2  b k  = Im{c k }  c k  − c∗ k   j2  =  =  A i  = DFT{a k }  B i  = DFT{b k }  = DFT cid:26  c k  + c∗ k    cid:27   2 C i  + C∗ −i   =  2  = DFT cid:26  c k  − c∗ k    cid:27   j2 C i  − C∗ −i   j2  =  301    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.25  Suppose h k  and x k  are both of length L = 2048.   a  Find the number of real FLOPs for a fast linear convolution of h k  with x k .   b  Find the number of real FLOPs for a direct linear convolution of h k  with x k .   c  Express the answer to  a  as a percentage of the answer to  b .  Solution   a  Using  4.5.8  with L = 2048, the number of real FLOPs for fast convolution is  nfast = 12L log2 2L  + 8L + 4  = 12 2048  log2 4096  + 8 2048  + 4 = 311300   b  Using  4.5.9  with L = 2048, the number of real FLOPs for a direct linear convolution  is   c  The ratio of computational eﬀort when L = 2048 is  ndir = L2  =  2048 2 = 4194304  α =  100nfast  ndir  =  100 311300   4194304  = 7.422 %  302    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.26 Suppose h k  is of length L, and x k  is of length M . Let L and M be powers of two with  M ≥ L.  a  Find the number of real FLOPs for a fast linear convolution of h k  with x k . Does  your answer agree with  4.5.8  when M = L?   b  Find the number of real FLOPs for a direct linear convolution of h k  with x k . Does  your answer agree with  4.5.9  when M = L?  Solution   a  The common length of the zero-padded signals, N ≥ L + M − 1, must be a power of two. The sum of two powers of two is not necessarily a power of two. However, since M ≥ L, one can use N = 2M . Then using  4.5.8 , but with M = L,  nfast = 12M log2 2M   + 8M + 4 FLOPs   b  Using the formulation in  4.5.1 , the number of real FLOPs for a direct linear convolution  When M = L, this reduces to  4.5.8 .  of h k  with x k  is  ndir = L L + M    When M = L, this reduces to  4.5.9 .  303    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.27 Suppose L is a power of two and M = QL for some positive integer Q. Let nblock be the number of real FLOPs needed to compute a fast block convolution of an L-point signal h k  with an M -point signal x k . Find nblock.  Solution  First consider step 1 of Alg. 4.1. Since L is a power of two and N is the smallest power of two such that N ≥ 2L − 1, it follows that  Thus from  4.4.10 , the number of complex FLOPs required to compute Hz is L log2 2L . From  4.5.7  there a four real multiplications per complex multiplication. Thus the compu- tation of Hz requires the following number of real FLOPs.  N = 2L  n1 = 4L log2 2L  FLOPs  Next consider step 2 of Alg. 4.1. From  4.4.10 , the computation of Xiz requires L log2 2L  complex FLOPs, and from Algorithm 4.4, the computation of yi requires L log2 2L  + 2L complex FLOPs plus 2L real FLOPs to scale by 1 N . Thus the number of real FLOPs per iteration is 8L log2 2L  + 8L + 2L. From step 2, there are Q iterations where Q = M L. Thus the number of real FLOPs required to implement step 2 of Alg. 4.1 is  M [8L log2 2L  + 10L]  n2 =  L  = M [8 log2 2L  + 10] FLOPs  Finally, the total number of real FLOPs required to compute a fast block convolution of the L-point signal h k  with the M -point signal x k  using Alg. 4.1 is  nblock = n1 + n2  =  8M + 4L  log2 2L  + 10M FLOPs  304    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.28 Use the DFT to solve the following.   a  Recover x k  from cyx k  and y k .  b  Recover y k  from cyx k  and x k .  Solution  correlation is  Thus X i  = N Cxy k  Y ∗ i  or   a  Using the circular correlation property from Table 4.8, the DFT of the circular cross   b  Again using the circular correlation property of the DFT, Y ∗ i  = N Cxy X i . Thus  y k  can be recovered as follows.  Cxy i  =  X i Y ∗ i   N  x k  = IDFT cid:26  N Cxy i  Y ∗ i   cid:27   X i   cid:21 ∗ cid:27  y k  = IDFT cid:26  cid:20  N Cxy i  X ∗ i   cid:27   = IDFT cid:26  N C∗  xy i   305    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.29 Suppose x k  and y k  are both of length L = 4096.   a  Find the number of real FLOPs for a fast linear cross-correlation of y k  with x k .   b  Find the number of real FLOPs for a direct linear cross-correlation of y k  with x k .   c  Express the answer to  a  as a percentage of the answer to  b .  Solution   a  Using  4.5.20  with L = 4096, the number of real FLOPs for fast cross-correlation is  nfast = 12L log2 2L  + 8L + 6  = 12 4096  log2 8192  + 8 4096  + 6 = 671750   b  Using  4.5.21  with L = 4096, the number of real FLOPs for a direct linear cross-  correlation is   c  The ratio of the computational eﬀort for L = 4096 is  ndir = L2 2 + 1  =  4096 2 2 + 1 = 8388609  α =  100nfast  ndir  =  100 671750   8388609  = 8.001 %  306    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.30 Suppose y k  is of length L and x k  is of length M ≤ L.   a  Find the number of real FLOPs for a fast linear cross-correlation of y k  with x k . Does  your answer agree with  4.5.20  when M = L?   b  Find the number of real FLOPs for a direct linear cross-correlation of y k  with x k .  Does your answer agree with  4.5.21  when M = L?  Solution   a  The common length of the zero-padded signals, N ≥ L + M − 1, must be a power of two. The sum two powers of two is not necessarily a power of two. However, since M ≥ L, one can use N = 2M . Then using  4.5.20 , but with M = L,  nfast = 12M log2 2M   + 8M + 6 FLOPs   b  Using the formulation in  4.5.14 , the number of real FLOPs for a direct linear cross-  When M = L, this reduces to  4.5.20 .  correlation of h k  with x k  is  ndir =  + L  L2 2  Since this does not depend on M ≤ L, when M = L, this is still identical to  4.5.21 .  307    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.31 Let v k  be an N -point white noise signal with mean µv and variance σ2  v. Show that the  average power, the mean, and the variance are related as follows.  Pv ≈ µ2  v + σ2 v  Solution  If v k  is white noise with mean µv and variance σ2  v, then  v k  = µv + x k   where x k  is zero-mean white noise with variance E[x2] = σ2 is  v. The the average power of v k   Pv = E[v2 k ]  v + 2µvx k  + x2 k ] v] + E[2µvx k ] + E[x2 k ]  = E[{µv + x k }2] = E[µ2 = E[µ2 = µ2 = µ2  v + 2µvE[x k ] + σ2 v v + σ2 v  308    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.32 Let v k  be an N -point white noise signal with mean µv and variance σ2  v. Show that the  circular auto-correlation of v k  is  cvv k  ≈ µ2  v + σ2  v δ k   Solution  Since v k  has mean µv and variance σ2  v , one can represent v k  as follows.  v k  = µv + x k   Here x k  is stationary with zero mean and variance E[x2 k ] = σ2  v . From Deﬁnition 4.4  cvv k  =  1 N  N −1  Xi=0  v i vp k − i   ≈ E[v i v i− k ] = E[{µv + x i }{µv + x i − k }] = E[µ2 = E[µ2 = µ2 = µ2  v + µv{x i  + x i − k } + x i x i − k ] v] + µvE[x i ] + µvE[x i − k ] + E[x i x i− k ]  v + 2µvE[x i ] + E[x i − k ] + E[x i x i − k ] v + E[x i x i − k ]  Since x k  is zero-mean white noise x i  and x i − k  are statistically independent for k 6= 0. Thus  For k = 0  Thus  cvv k  ≈ µ2 = µ2 v  v + E[x i ]E[x i− k ]  ,  k 6= 0  cvv k  ≈ µ2 = µ2  v + E[x2 i ] v + σ2 , v  k = 0  cvv k  ≈ µ2  v + σ2  v δ k   309    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.33 Let v k  be an N -point white noise signal with mean µv and variance σ2  v. Using the results  of Problem 4.32, show that the power density spectrum of v k  is  Sv i  ≈ σ2  v + N µ2  vδ i   Solution  From  4.7.10  the power density spectrum is the DFT of the circular cross correlation. Thus from problem 4.32  Sv i  = Cvv i   = DFT{cvv k } v + σ2 = DFT{µ2 vδ k } v} + DFT{σ2 = DFT{µ2 = µ2  N −1  W ik  vDFT{1} + σ2 Xk=0 N + σ2 v Xk=0  N + σ2 v  W ik  N −1  = µ2 v  = µ2 v  vδ k } vDFT{δ k } Xk=0 δ k W ik N  N −1  Recall from the orthogonality property of WN in  4.3.6  that  Thus  N −1  Xi=0  W ik  N = N δ i   Sv i  = σ2  v + N µ2  vδ i   310    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.34 Let v be a random variable that is uniformly distributed over the interval [a, b].   a  Find the mth statistical moment, E[vm], for m ≥ 0.  b  Verify that E[vm] = Pv in  4.6.6  when m = 2.  Solution   a  Using Deﬁnition 4.3 and  4.6.1   −∞  xmp x dx  E[xm] = Z ∞ = Z b  m + 1  b − a  cid:12  cid:12  cid:12  cid:12   xm b − a xm+1  dx  =  a  bm+1 − am+1  m + 1  b − a   =  b  a  Pu = E[x2]  =  √  b3 − a3 3 b − a    b  Setting m = 2 in part  a  and recalling  3.85   311    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.35 Let x be a random variable whose probability density function is given in Figure 4.55.   a  What is the probability that −.5 ≤ x ≤ .5?  b  Find E[x2].  Probability density function  1.5  2  1  0    x   p  0.5  −0.5  −2  −1.5  −1  −0.5  0.5  1  1.5  2  0 x  Figure 4.55 Probability Density Function for Problem 4.35  Solution   a  Using  4.6.2 , the probability that −.5 ≤ x ≤ .5 is  −.5  p x dx  P[−.5,.5] = Z .5  1 + x dx +Z .5 = Z 0 2  cid:19  cid:12  cid:12  cid:12  cid:12  =  cid:18 x + +  cid:18 x − 8 cid:19  + cid:18  1 = − cid:18 −1 2 −  −.5 1  x2  −.5  +  2  0  0   1 − x dx  .5  0  x2  2  cid:19  cid:12  cid:12  cid:12  cid:12  8 cid:19   1  =  3 4  312    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Using Deﬁnition 4.3  x2p x dx  −∞  E[x2] = Z ∞ = Z 0 =  cid:18  x3 = − cid:18 −1  +  −1  3  0  0  x4   1 + x x2dx +Z 1 +  cid:18  x3 4  cid:19  cid:12  cid:12  cid:12  cid:12  3 − 4 cid:19  4 cid:19  + cid:18  1 1 3 −  +  −1  1  3   1 − x x2dx +  1  0  x4  4  cid:19  cid:12  cid:12  cid:12  cid:12   =  1 6  313    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.36 Consider the following discrete-time signal.  x = [10, −5, 20, 0, 15]T   a  Using  2.8.2 , ﬁnd a linear auto-correlation matrix D x  such that rxx = D x x.  b  Use D x  to ﬁnd the linear auto-correlation rxx k .  c  Using Deﬁnition 2.5, ﬁnd the normalized linear auto-correlation ρxx k .  d  Find the average power Px.  Solution   a  Since auto-correlation is a special case of cross-correlation, one can use  2.8.2 , but with  y k  replaced by x k .   b  Using  2.8.3  with y = x and the results from part  a   D x  =             0  0 0  0 0 0  x 0  x 1  x 2  x 3  x 4  x 0  x 1  x 2  x 3  x 0  x 1  x 2  x 0  x 1  x 0   0 0 0 0 20 10 −5 0 15 0 10 −5 20 0 0 0 10 −5 20 10 −5 0 0 0 10 0 0 0 0       2 −1 4 0 3 0 2 −1 4 0 0 0 2 −1 4 0 0 0 2 −1 2 0 0 0 0    rxx = D x x  4 2 −1 0 3 0 2 −1 4 0 0 0 2 −1 4 0 0 0 2 −1 2 0 0 0 0          10 −5 20 0 15      1 5  1 5             =  =  =  =  150 −30 100 −15 30      314    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   This can be veriﬁed using the FDSP toolbox function f corr.   c  Using Deﬁnition 2.5 with L = 5  Thus from  2.8.5  with y = x  rxx 0  =  1 L  L−1  Xi=0  x2 i   100 + 25 + 400 + 0 + 225  =  = 150  5  ρxx k  =  rxx k  rxx 0  rxx k   150  = = [1, −.2, .667,−.1, .2]T  This can be veriﬁed using the FDSP toolbox function f corr.   d  Using  4.7.7  with k = 0, the average power of x k  is  Px = rxx 0   = 150  315    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.37 Consider the following discrete-time signal.  x = [12, 4, −8, 16]T   a  Starting with  2.8.2 , but replacing x with xp, ﬁnd the circular auto-correlation matrix  E x  such that cxx = E x x.   b  Use E x  to ﬁnd the circular auto-correlation cxx k .  c  Find the normalized circular auto-correlation σxx k .  Solution   a  Using Deﬁnition 2.6 with y = x, cxx k  is just 1 N times the dot product of x with x rotated right by k samples. Thus the kth row of E x  is the vector x rotated right by k samples.   b  Deﬁnition 2.6 and the results from part  a   E x  =       1 4  1 4     =  =  x 0  x 1  x 2  x 3  x 3  x 0  x 1  x 2  x 2  x 3  x 0  x 1  x 1  x 2  x 3  x 0         12 16 4 −8 16 12 4 −8 −8 16 4 12 16 12 4 −8 3 1 −2 4 4 3 1 −2 1 3 −2 4 1 −2 4 3     cxx = E x x        12 4 −8 16     =  =       3 1 −2 4 4 3 1 −2 1 3 −2 4 1 −2 4 3  120 20  −16 20  This can be veriﬁed using the FDSP toolbox function f corr.  316    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using Deﬁnition 4.2 with  4.7.1   From  4.7.2  the normalized circular auto-correlation of x k  is  cxx 0  =  1 N  N −1  Xi=0  x2 i   144 + 16 + 64 + 256  =  = 120  4  σxx k  =  cxx k  cxx 0  cxx k   120  = = [1, .167, −.133, .167]T  This can be veriﬁed using the FDSP toolbox function f corr.  317    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.38 A white noise signal v k  is uniformly distributed over the interval [−a, a]. Suppose v k  has  the following circular auto-correlation.  cvv k  = 8δ k   ,  0 ≤ k < 1024   a  Find the interval bound a.   b  Sketch the power density spectrum of v k .  Solution   a  Using  4.7.6 , the circular auto-correlation of zero-mean white noise with average power  Pv is cxx k  = Pvδ k . Thus  From  4.6.6 , the average power of white noise uniformly distributed over [−a, a] is  Thus a2 3 = 8 or   b  From  4.7.10 , for zero-mean white noise with average power Pv, the power density  spectrum is ﬂat with SN  f   ≈ Pv. Thus  Pv = 8  Pv =  a3 −  −a 3 3[a −  −a ] 2a3 6a a2 3  =  =  a = √24 = 4.90  SN  f   ≈ 8  ,  0 ≤ f ≤ fs 2  318    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.39 Consider the following digital ﬁlter where a < 1.  H z  =  1  1 − az−1   a  Find the impulse response h k .   b  Find the frequency response H f  .  c  Let H i  be the N -point DFT of h k , and let fi = ifs N . Given an arbitrary  cid:15  > 0,  use  4.8.4  to ﬁnd a lower bound n such that for N ≥ n,  H i  − H fi  ≤  cid:15   for  0 ≤ i < N  Solution   a  The impulse response is   b  The frequency response is   c  Using  4.8.4  and the geometric series we have  h k  = Z−1{H z } = Z−1 cid:26  z z − a cid:27  = aku k   H f   = H z z=j2πf  =  =  z  z − a cid:12  cid:12  cid:12  cid:12 z=j2πf  exp j2πf   exp j2πf   − a  H i  − H fi  ≤  h k   ∞  ∞  =  Xk=N Xk=N = aN 1 − a  ak  319    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Setting the upper bound to  cid:15  > 0  Multiplying both sides by 1 − a and taking the logarithm of both sides then yields  Solving for N , and recalling that N must be an integer  aN 1 − a  =  cid:15   N ln a  = ln cid:20    cid:15   1 − a cid:21   n = ceil   1−ai lnh  cid:15  ln a      320    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.40 A signal xa t  is sampled at N = 300 points using a sampling rate of fs = 1600 Hz. Let xz k  be a zero-padded version of x k  using M − N zeros. Suppose a radix-two FFT is used to ﬁnd Xz i .   a  Find a lower bound on M that ensures that the frequency precision of Xz i  is no larger  than 2 Hz.   b  How much faster or slower is the FFT of xz k  in comparison with the DFT of x k ? Ex- press your answer as a ratio of the computational eﬀort of the FFT to the computational eﬀort of the DFT.  Solution   a  From  4.8.11  the frequency increment is ∆f = fs M . Thus we want fs M ≤ ∆f or   b  From  4.4.2 , the number of FLOPs for the N -point DFT of x k  is  To apply a radix-two FFT M ≥ 800 must be a power of two. Thus M = 1024. From  4.4.10 , the number of FLOPs for the M -point FFT of xz k  is  fs ∆f 1600  M ≥ =  2 = 800  nDFT = N 2 = 3002 = 9000 FLOPs  nFFT =  M log2 M    2  1024 log2 1024   =  2 = 512 10   = 5120 FLOPs  321  Thus the FFT of xz k  is faster. The ratio of computational eﬀorts, measured in FLOPs, is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   α =  nFFT nDFT 5120 9000 = .5689  =  322    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.41 Consider the spectrogram in Deﬁnition 4.5. Suppose the data x k  is real.   a  Find the number of complex FLOPs needed if the DFT is used.   b  Find the number of complex FLOPs needed if the FFT is used.  Solution   a  Since x k  is real, the multiplications by the window w k  are real FLOPs. The ith row of the spectrogram requires an L-point DFT and there are 2M − 1 rows. From  4.4.2  an L-point DFT requires L2 2 complex FLOPs. Thus the total number of complex FLOPs per spectrogram using a DFT is   b  Assuming L is a power of 2, a radix 2 FFT can be used. From  4.4.10 , an L-point FFT requires L log2 L  2 FLOPs. Thus the total number of FLOPs per spectrogram using an FFT is  mDF T =   2M − 1 L2  2  mF F T =   2M − 1 L log2 L   2  323    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.42 Consider the spectrogram in Deﬁnition 4.5.   a  Modify the spectrogram deﬁnition using zero padding so the frequency precision is im-  proved by a factor of two.   b  Compute the percent increase in computational eﬀort for the modiﬁed spectrogram in comparison with the original spectrogram assuming the FFT is used. Use complex FLOPs to measure the computational eﬀort and assume x k  is real.   c  Does the modiﬁed spectrogram have improved frequency resolution? If not, how can the  frequency resolution be improved and what is the tradeoﬀ?  Solution   a  Let xm k  be the mth subsignal deﬁned in  4.9.1 . Next let xmz  k  be the zero-padded version of xm using L zeros padded to the end of xm k . Thus xmz k  is of length 2L.  xmz  k  ∆=  cid:26  xm k   0  , 0 ≤ k < L , L ≤ k < 2L  Next let ˆw k  be a window of length 2L, The modiﬁed spectrogram ˆG m, i  is then a  2M − 1  × 2L matrix deﬁned  ˆG m, i  = DFT{ ˆw k xmz k }   b  Since x k  is real, the multiplications by the window are real FLOPs. If the FFT is used, then an N -point FFT requires N log2 N   2 complex FLOPs. Since there are 2M − 1 rows, the total number of FLOPs for the two cases are  Thus the percent increase in computational eﬀort measured by complex FLOPs is  mF F T =  ˆmF F T =   2M − 1 L log2 L   2M − 1 2L log2 2L   2  2  p =  100  ˆmF F T − mF F T    mF F T  =  =  100[ 2M − 1 L log2 2L  − .5 2M − 1 L log2 L ]  .5 2M − 1 L log2 L   100[ log2 2L  − .5 log2 L ]  .5 log2 L   324    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  No, the modiﬁed spectrum ˆG m, i  does not have improved frequency resolution because no new data has been added, only zeros. This improves the frequency precision, but not the frequency resolution. To improve frequency resolution more data samples must be added to xm k  by increasing L. The tradeoﬀ is that by increasing L one increases frequency resolution, but at the expense of decreasing time resolution because now M must be decreased since M L = N .  325    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.43 One of the problems with using data windows to reduce the Gibb’s phenomenon in the periodic extension of an N -point signal x k  is that the samples are no longer weighted equally when computing an estimate of the power density spectrum. This is particularly the case when no overlap of subsignals is used.   a  Use the trigonometric identities in Appendix 2 to show that the Hanning window in  Table 4.10 can be expressed as  w k  = .5 + .5 cos cid:20  2π k − L 2   L   cid:21   ,  0 ≤ k < L   b  If a 50% overlap of subsignals is used for the power density spectrum estimate, then each overlapped sample gets counted twice, once with weight w k  and once with weight w k + L 2 . Show that if the Hanning window is used, the overlapped samples are weighted equally. Find the total weight for each overlapped sample.   c  Are there any other windows in Table 4.10 for which the total weighting of the overlapped  samples is uniform when a 50% overlap is used? If so, which ones?  Solution   a  Using the cosine of the diﬀerence trigonometric identity from Appendix 2  w k  = .5 + .5 cos cid:20  2π k − L 2   L   cid:21   L  cid:19  cos π  + sin cid:18  2πk = .5 + .5 cid:20 cos cid:18  2πk = .5 − .5 cos cid:18  2πk L  cid:19   L  cid:19  sin π  cid:21   wT  k  = w k  + w k + L 2   = .5 − .5 cos cid:18  2πk  L  cid:19  + .5 + .5 cos cid:18  2πk L  cid:19   = 1   b  With a 50 percent overlap, each overlapped sample is counted twice. Using the results of part   a , the total sample weight using the Hanning window is   c  The only other window for which the total weighting of the overlapped samples is uniform,  when a 50 percent overlap is used, is the rectangular window.  326    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.44 Using the GUI module g correlate, select the periodic input.   b  Plot the normalized circular auto-correlation, σyy k . Notice how the noise has been   c  Estimate the period of y k  in seconds by estimating the period of σyy .   a  Plot x k  and y k .  reduced.  Solution  x k   Linear cross−  y k   correlation  ρ  yx   k   0  0    k   y    k   x  2  0  2  0  −2  −4  0  −2  −4  0  Inputs x and y: periodic input  500  1000  1500  2000  2500  3000  3500  4000  4500  500  1000  1500  2000  2500  3000  3500  4000  4500  Problem 4.44  a  Time Signals  k  327    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y k   Circular  auto−  correlation  σ  yy   k   Normalized circular auto−correlation of y k : periodic input  0 0  0 0    k    y y  σ  1.5  0.5  1  0  −0.5  0  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 4.44  b  Circular Cross Correlation   c  From the plot of σxx k  there are 30 periods of x k  in L = 4096 samples. Thus the  period is  τ =  L 3fs  4096  30 8192  1 60  sec  =  ≈  328    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.45 Using the GUI module g correlate select the white noise input. Set the scale factor to c = 0.   a  Plot x k  and y k . What is the range of values over which the uniform white noise is  distributed?   b  Verify that ryy k  ≈ Pyδ k  by plotting the auto-correlation of y k .  c  Use the Caliper option to estimate Py.  d  Verify that this estimate of Py is consistent with the theoretical value in  4.6.6 .  Solution  0 0 0 0 0  0 0 0 0 0  1  0    k   y  −1  0  1    k   x  0  −1  0  x k   Linear  convolution  x k *y k   Inputs x and y: white noise input  500  1000  1500  2000  2500  3000  3500  4000  4500  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 4.45  a  The noise is distributed over [−1, 1].  329    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y k   Linear auto−  correlation  r   k   yy  Auto−correlation of y k : white noise input     x,y  =  2.01,0.34   0 0 0  0 0 0    k    r  x x  0.4  0.3  0.2  0.1  0  −0.1  0  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 4.45  b  Auto-correlation   c  From the Caliper measurement in part  b , the estimated average power of the white  noise input x k  is   d  From  4.6.6  and the results from part  a , the predicted average power of the uniformly  distributed white noise is  Px ≈ .34  Pu =  b3 − a2 3 b − a   1 3 −  −1 3 3[1 −  −1 ] 1 3  =  =  330    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.46 Using the GUI module g correlate select the impulse train input. This sets y k  to a periodic input, and x k  to an impulse train whose period matches the period of y k . Set L = 4096 and M = 4096.   a  Plot the noise-corrupted periodic input y k  and the periodic impulse train x k .   b  Plot the normalized circular auto-correlation of y k .   c  Plot the normalized circular cross-correlation σyx k . This should be proportional to  y k , but with the noise reduced.  x k   Linear cross−  y k   correlation  ρ  yx   k   Solution  0  0  5  0    k   y  −5  0  1    k   x  0.5  0  0  Inputs x and y: impulse train input  500  1000  1500  2000  2500  3000  3500  4000  4500  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 4.46  a  Noise-Corrupted Periodic Input and Impulse Train Input  331    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k    y y  ρ  0.5  1  0  −0.5  −1  0  0 0  0 0  0 0 0  0 0 0  0.15  0.1  0.05  0  x y  −0.05  −0.1  0  y k   Linear auto−  correlation  ρ  yy   k   Normalized auto−correlation of y k : impulse train input  500  1000  1500  2000  2500  3000  3500  4000  4500  Problem 4.46  b  Normalized Circular Auto-Correlation of x k   x k   Circular  cross−  y k   correlation  σ  yx   k   Normalized circular cross−correlation: impulse train input  500  1000  1500  2000  2500  Problem 4.46  c  Reconstruction of x k  with Reduced Noise  k  k  332    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.47 Use the GUI module g spectra to plot the spectrogram of the following signals. Use fs = 3000  Hz and N = 2048 samples for each.   a  Cosine of unit amplitude and frequency F0 = 400 Hz  b  Cosine of unit amplitude and frequency F0 = 400 Hz, clipped to [−.5, .5]  c  Cosine of unit amplitude and frequency F0 = 400 Hz, plus white noise uniformly dis-  tributed over [−1.5, 1.5]  Solution  x k   DFT  y k   0  0    c e s     t  0.5  0.4  0.3  0.2  0.1  0  0  Spectrogram: cosine input  Hamming window   200  400  600  1000  1200  1400  800  f  Hz   Problem 4.47  a  Pure Cosine  333    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0    c e s     t  0.5  0.4  0.3  0.2  0.1  0  0  0 0 0  0 0 0    c e s     t  0.5  0.4  0.3  0.2  0.1  0  0  x k  x k   DFT DFT  y k  y k   Spectrogram: clipped cosine input  Hamming window   200  400  600  1000  1200  1400  800  f  Hz   Problem 4.47  b  Clipped Cosine  x k  x k  x k   DFT DFT DFT  y k  y k  y k   Spectrogram: noise−corrupted cosine input  Hamming window   200  400  600  1000  1200  1400  800  f  Hz   Problem 4.47  c  Noise-corrupted Cosine  334    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.48 Using the GUI module g spectra record the word HELLO. Play it back to make sure it is recorded properly. Save it in a MAT-ﬁle called hello. Then reload it as a User-deﬁned input. Plot the following spectral characteristics.   a  Magnitude spectrum   b  Power density spectrum  Hamming window    c  Spectrogram  Solution  x k   DFT  y k   0  0    f   A  120  100  80  60  40  20  0  0  Magnitude spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\hello.mat 140  500  1000  1500  2500  3000  3500  4000  2000  f  Hz   Problem 4.48  a  Magnitude Spectrum of “Hello”  335    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   DFT DFT  y k  y k   Power density spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\hello.mat  Hamming window   500  1000  1500  2500  3000  3500  4000  2000  f  Hz   Problem 4.48  b  Power Density Spectrum of “Hello”  x k  x k  x k   DFT DFT DFT  y k  y k  y k   Spectrogram: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\hello.mat  Hamming window     f    S  W  0 0  0 0  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  0 0 0  0 0 0  0.8  0.6  0.4  0.2    c e s     t  0  0  500  1000  1500  2500  3000  3500  2000  f  Hz   Problem 4.48  c  Spectrogram of “Hello”  336    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.49 Consider the signal shown in Figure 4.56 which contains one or more sinusoidal components corrupted with white noise. The complete signal x k  and the sampling frequency fs are stored in the ﬁle prob4 49.mat. Use the GUI module g spectra to plot the following spectral characteristics.   a  The power density spectrum  Hamming window . Use the Caliper option to estimate  the frequencies of the sinusoidal components.   b  The spectrogram  Hamming window .  Noise−corrupted signal    k   x  3  2  1  0  −1  −2  −3  0  337  20  40  80  100  120  60  k  Figure 4.56 Noise-Corrupted Signal with Unknown Sinusoidal Components  Samples  0 to N 8   Solution   a  From the plot, the estimated frequencies are F0 = 250 Hz and F1 = 399 Hz.    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   DFT DFT DFT DFT  y k  y k  y k  y k   Power density spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_49.mat  Hamming window      x,y  =  250.45,54.63      x,y  =  398.66,42.07   100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.49  a  Power Density Spectrum  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k   Spectrogram: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_49.mat  Hamming window     f    S  W  0 0 0 0  0 0 0 0  60  50  40  30  20  10  0  0  0 0 0 0 0  0 0 0 0 0  0.4  0.3  0.2  0.1    c e s     t  0  0  100  200  300  400  600  700  800  900  500  f  Hz   Problem 4.49  b  Spectrogram  338    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.50 Use the GUI module g spectra to plot the power density spectrum of a noise-free cosine input  using the default parameter values. Use the dB scale and do the following cases.   a  Rectangular window   b  Hanning window   c  Hamming window   d  Blackman window  Solution  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0  0 0 0 0 0 0  20  10  0    B d       f    S  −10  W  −20  −30  0  Power density spectrum: cosine input  Rectangular window   100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.50  a  Rectangular Window  339    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0 0 0 0  0 0 0 0 0 0 0    B d       f    S  W  20  0  −20  −40  −60  −80  −100  0  0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0    B d       f    S  W  20  10  0  −10  −20  −30  −40  −50  0  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: cosine input  Hanning window   100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.50  b  Hanning Window  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: cosine input  Hamming window   100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.50  c  Hamming Window  340    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: cosine input  Blackman window   0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0    B d       f    S  W  20  0  −20  −40  −60  −80  −100  0  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.50  d  Blackman Window  341    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.51 Use the GUI module g spectra to plot the following characteristics of a noise-corrupted damped  exponential input using the default parameter values. Use the linear scale.   a  Time signal   b  Magnitude spectrum   c  Power density spectrum  Blackman window    d  Blackman window  Solution  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0    t   x  1.2  1  0.8  0.6  0.4  0.2  0  −0.2  0  Time signal: noise−corrupted damped exponential input  0.05  0.1  0.15  0.2  0.3  0.35  0.4  0.45  0.5  0.25  t  sec   Problem 4.51  a  Time Signal  342    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0    f   A  300  250  200  150  100  50  0  0  0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0    f    S  W  14  12  10  8  6  4  2  0  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Magnitude spectrum: noise−corrupted damped exponential input  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.51  b  Magnitude Spectrum  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: noise−corrupted damped exponential input  Blackman window   0  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 4.51  c  Power Density Spectrum  Blackman Window   343    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Blackman window  0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0    k   w  1  0.8  0.6  0.4  0.2  0  0  20  40  60  80  100  120  140  k  Problem 4.51  d  Blackman Window  344    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.52 Consider the following noise-corrupted periodic signal with a sampling frequency of fs = 1600  Hz and N = 1024. Here v k  is white noise uniformly distributed over [−1, 1].  x k  = sin 600πkT   cos2 200πkT   + v k   ,  0 ≤ k < N  Create a MAT-ﬁle called prob4 52 containing x and fs. Then use g spectra to plot the follow- ing.   a  Magnitude spectrum   a  Power density spectrum using Welch’s method  rectangular window    c  Power density spectrum using Welch’s method  Blackman window   x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Solution  0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0 0    f   A  250  200  150  100  50  0  0  Magnitude spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_52.mat  100  200  300  500  600  700  800  400  f  Hz   Problem 4.52  a  Magnitude Spectrum  345    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_52.mat  Rectangular window   0  100  200  300  500  600  700  800  400  f  Hz   Problem 4.52  b  Power Density Spectrum  Rectangular Window   x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k  y k   Power density spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_52.mat  Blackman window   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0    f    S  W  14  12  10  8  6  4  2  0  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  8  6  4  2  0  0    f    S  W  100  200  300  500  600  700  800  400  f  Hz   Problem 4.52  c  Power Density Spectrum  Blackman Window   346    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.53 Use the GUI module g spectra to perform the following analysis of the vowels. Play back the  sound in each case to make sure you have a good recording.   a  Record one second of the vowel “A”, save it, and plot the time signal.   b  Record one second of the vowel “E”, save it, and plot the time signal.   c  Record one second of the vowel “I”, save it, and plot the time signal.   d  Record one second of the vowel “O”, save it, and plot the time signal.   e  Record one second of the vowel “U”, save it, and plot the time signal.  x k   DFT  y k   Solution  0  0  0.5  1  0  −0.5    t   x  Time signal: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\a.mat  0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1  t  sec   Problem 4.53  a  The Vowel “a”  347    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   DFT DFT  y k  y k   Time signal: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\e.mat  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1  t  sec   Problem 4.53  b  The Vowel “e”  x k  x k  x k   DFT DFT DFT  y k  y k  y k   Time signal: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\i.mat  0.4  0.2  0    t   x  −0.2  −0.4  0  0 0  0 0  0 0 0  0 0 0  0.5  1  0  −0.5    t   x  0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1  t  sec   Problem 4.53  c  The Vowel “i”  348    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0  0 0 0 0  0.5  1  0    t   x  −0.5  −1  0  0 0 0 0 0  0 0 0 0 0    t   x  0.5  1  0  −0.5  −1  −1.5  0  x k  x k  x k  x k   DFT DFT DFT DFT  y k  y k  y k  y k   Time signal: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\o.mat  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1  t  sec   Problem 4.53  d  The Vowel “o”  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k   Time signal: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\u.mat  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  1  t  sec   Problem 4.53  e  The Vowel “u”  349    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.54 A signal stored in prob4 54.mat contains white noise plus a single sinusoidal component whose frequency does not correspond to any of the discrete frequencies. Use GUI module g spectra to plot the following spectral characteristics.   a  The magnitude spectrum of x k  using the linear scale.   b  The power density spectrum of x k  using the Blackman window. Use the Caliper option  to estimate the frequency of the sinusoidal component.  x k  x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k  y k   Solution  0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0    f   A  100  80  60  40  20  0  0  Magnitude spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_54.mat  100  200  400  500  600  300  f  Hz   Problem 4.54  a  Magnitude Spectrum  Linear   350    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Power density spectrum: user−defined input from file C:\rjs\books\book4\_2e\chap4\prob\prob4_54.mat  Blackman window      x,y  =  272.10,7.88   x k  x k  x k  x k  x k  x k  x k   DFT DFT DFT DFT DFT DFT DFT  y k  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0 0  0 0 0 0 0 0 0  8  6  4  2  0  0    f    S  W  50  100  150  200  300  350  400  450  500  250  f  Hz   Problem 4.54  b  Power Density Spectrum  dB   351    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.55 Let xa t  be a periodic pulse train of period T0. Suppose the pulse amplitude is a = 10, and the pulse duration is τ = T0 5 as shown in Figure 4.57 for the case T0 = 1. This signal can be represented by the following cosine form Fourier series.  xa t  =  d0 2  +  ∞  Xi=1  di cos cid:18  2πit  T0  + θi cid:19   Write a MATLAB program that uses the DFT to compute coeﬃcients d0 and  di, θi  for 1 ≤ i < 16. Plot di and θi using a 2 × 1 array of plots and the MATLAB function stem.  Pulse train  15  10  5    t    x  a  0  0  0.5  1 t  1.5  2  Figure 4.57 Periodic Pulse Train with a = 10 and T0 = 1  Solution  Using  3.12 , the cosine coeﬃcients are computed from the DFT of one cycle of xa t  as follows.  % Problem 4.55  % Construct one period of the pulse train  f_header ’Problem 4.55’  a = 10; T_0 = 1; tau = T_0 5;  352    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   N = 32; x = zeros 1,N ; x 1:1+floor N*tau T_0   = 1; k = 0 : N-1; figure plot k,x  f_labels  ’One Period of Pulse Train’,’k’,’x k ’  f_wait  % Compute complex Fourier coefficients  c = fft x  N; d = 2*abs c ; theta = atan2 -imag c ,real c  ; figure k = 0 : N 2; subplot 2,1,1  stem k,d k+1 ,’filled’,’.’  f_labels  ’Magnitudes’,’k’,’d_k’  subplot 2,1,2  stem k,theta k+1 ,’filled’,’.’  f_labels  ’Phase Angles’,’k’,’\theta_k’  f_wait  353    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   k  d  k  θ  0.5  0.4  0.3  0.2  0.1  0  0  3  2  1  0  −1  −2  0  2  4  6  10  12  14  16  Phase Angles  2  4  6  10  12  14  16  Problem 4.55 Fourier Series Coeﬃcients of Pulse Train  Magnitudes  8 k  8 k  354    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.56  In addition to saturation due to clipping, another common type of nonlinearity is the dead- Dead zone nonlinearity shown in Figure 4.58. The algebraic representation of a dead zone of radius zone a is as follows.  Suppose fs = 2000 Hz, and N = 100. Consider the following input signal where 0 ≤ k < N corresponds to one cycle.  F  x, a   ∆  =  cid:26  0 ,  0 ≤ x ≤ a x , a < x < ∞  x k  = cos 40πkT    ,  0 ≤ k < N  Let the dead-zone radius be a = .25. Write a MATLAB program that does the following.   a  Compute and plot y k  = F [x k , a] versus k.   b  Compute and plot the magnitude spectrum of y k .   c  Using the DFT, compute and print the total harmonic distortion of y k  caused by the dead zone. Here, if di and θi for 0 ≤ i < M are the cosine form Fourier coeﬃcients of y k  with M = N 2, then  THD =  100 Py − d2  1 2   %  Py  function prob4_56  % include this to make F x,a  a local function  Solution  % Initialize  f_header ’Problem 4.56’  a = .25;  % Construct the input signal  fs = 2000; T = 1 fs; N = 100; k = 0 : N-1; x = cos 40*pi*k*T ;  355    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Dead−zone nonlinearity  −a  a  1  0.8  0.6  0.4  0.2  y  0  −0.2  −0.4  −0.6  −0.8  −1  −1  −0.5  0.5  1  0 x  Figure 4.58 Dead-Zone Nonlinearity of Radius a  % Plot y k  = F[x k ,a ]  y = F x,a ; figure plot  k,y  f_labels  ’Effect of Dead Zone on Cosine’,’k’,’y k ’  f_wait  % Plot magnitude spectrum  Y = fft y ; A = abs Y ; f = linspace  0, N-1 *fs N,N ; figure i = 1 : N 2 + 1; plot  f i ,A i   f_labels  ’Magnitude Spectrum’,’f  Hz ’,’A f ’  f_wait  % Find total harmonic distortion  d = 2*abs Y  N; P_y =  1 4 *d 1 ^2 +  1 2 *sum d 2:N 2 .^2 ; THD = 100* P_y -  1 2 *d 2 ^2  P_y; fprintf  ’\nTotal Harmonic Distortion = %g percent\n’,THD   356    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   function y = F x,a   % Dead-zone function  y = x; i = find abs x  <= a ; y i  = 0;  Effect of Dead Zone on Cosine    k   y  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8  −1  0  20  40  60  80  100  k  Problem 4.56  a  Distorted Cosine  357    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Spectrum    f   A  50  45  40  35  30  25  20  15  10  5  0  0  200  400  600  800  1000  f  Hz   Problem 4.56  b  Magnitude Spectrum   c   Total Harmonic Distortion = .932876 percent  358    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.57 Repeat Problem 4.56, but using fs = 1000 Hz, N = 50 samples, and the cubic nonlinearity  F  x  = x3  Solution  function prob4_57  % Construct the input signal  f_header ’Problem 4.57’  fs = 1000; T = 1 fs; N = 50; k = 0 : N-1; x = cos 40*pi*k*T ;  % Plot y k  = F[x k ]  y = F x ; figure plot  k,y  f_labels  ’Effect of Cubic Nonlinearity on Cosine’,’k’,’y k ’  f_wait  % Plot magnitude spectrum  Y = fft y ; A = abs Y ; f = linspace  0, N-1 *fs N,N ; figure i = 1 : N 2 + 1; plot  f i ,A i   f_labels  ’Magnitude Spectrum’,’f  Hz ’,’A f ’  f_wait  % Find total harmonic distortion  d = 2*abs Y  N; P_y =  1 4 *d 1 ^2 +  1 2 *sum d 2:N 2 .^2 ; THD = 100* P_y -  1 2 *d 2 ^2  P_y; fprintf  ’\nTotal Harmonic Distortion = %g percent\n’,THD   function y = F x   359    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Cubic nonlinearity  y = x .^ 3;  Effect of Cubic Nonlinearity on Cosine    k   y  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8  −1  0  10  20  30  40  50  k  Problem 4.57  a  Distorted Cosine  360    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Spectrum    f   A  20  18  16  14  12  10  8  6  4  2  0  0  100  200  300  400  500  f  Hz   Problem 4.57  b  Magnitude Spectrum   c   Total Harmonic Distortion = 10 percent  361    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 4.58 Let h k  and x k  be two N -point white noise signals uniformly distributed over [−1, 1].  Recall that the MATLAB function conv can be used to compute linear convolution. Write a MATLAB program which uses tic and toc to compute the computational time, tdir, of conv and the computational time, tfast, of the FDSP toolbox function f conv for the cases N = 4096, N = 8192, and N = 16384.   a  Print the two computational times tdir and tfast for N = 4096, 8192, and 16384.  b  Plot tdir versus N 1024 and ttast versus N 1024 on the same graph and include a legend.  hw = waitbar  0,’Computing Convolutions’ ; for i = 1 : n  Solution  % Problem 4.58  f_header ’Problem 4.58’  n = 3; N = zeros n,1 ; t_dir = zeros n,1 ; t_fast = zeros n,1 ;  % Compute convolutions  N i  = floor 2^ 11+i  ; h = f_randu  N i ,1,-1,1 ; x = f_randu  N i ,1,-1,1 ; tic y = conv h,x ; t_dir i  = toc; tic y = f_conv h,x,0 ; t_fast i  = toc; waitbar  i n,hw   end close hw   t_dir t_fast  % Plot results  figure hp = plot  N 1024,t_dir,’-o’,N 1024,t_fast,’-s’ ; set  hp 1 ,’LineWidth’,1.5  axis [4 16 -.1 1.6]  f_labels  ’Computation Times’,’N 1024’,’t  sec ’  legend  ’Direct Convolution’,’Fast Convolution’  f_wait  362    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    a  The output from the MATLAB script is  Computation Times     Direct Convolution Fast Convolution  t_dir =  t_fast =  0.0799 0.3272 1.2808  0.0016 0.0028 0.0057    c e s     t  1.6  1.4  1.2  1  0.8  0.6  0.4  0.2  0    4  6  8  12  14  16  10  N 1024  Problem 4.58 Computational Times for Two Implementations of Linear Convolution  363    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.59 Consider the following linear discrete-time system. Write a MATLAB program that performs  the following tasks.  H z  =  z  z2 − 1.4z + .98   a  Compute and plot the impulse response h k  for 0 ≤ k < L − 1 where L = 500.  b  Construct an M -point white noise input x k  that is distributed uniformly over [−5, 5] where M = 10000. Use the FDSP toolbox function f blockconv to compute the zero-state response y k  to the input x k  using block convolution. Plot y k  for 9500 ≤ k < 10000.  c  Print the number of FFTs and the lengths of the FFTs used to perform the block  convolution.  Solution  % Problem 4.59  % Construct impulse response h of filter  f_header ’Problem 4.59’  L = 500; b = [1 0]; a = [1 -1.4 .98]; delta = [1 zeros 1,L-1 ]; h = filter  b,a,delta ; figure k = 0 : L-1; plot  k,h  f_labels  ’Impulse Response’,’k’,’h k ’  f_wait  M = 10000; x = f_randu  1,M,-5,5 ; y = f_blockconv h,x ; figure k = 9500 : 10000; plot  k,y k+1   f_labels  ’Zeros-State Response’,’k’,’y k ’  f_wait  % Compute number and size of FFTs  r = L - mod M,L ;  364  % Compute input and zero-state response using fast block convolution    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   M = M + r; Q = M L; N = 2^ ceil log 2*L-1  log 2   ; fprintf  ’\nNumber of FFTs = %d\n’,Q+1  fprintf  ’Size of FFTs = %d\n’,N   Impulse Response    k   h  1.5  0.5  1  0  −0.5  −1  −1.5  0  100  200  300  400  500  k  Problem 4.59  a  Impulse Response  365    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Zeros−State Response  80  60  40  20  0  −20  −40  −60    k   y  −80  9500  9600  9700  9800  9900  10000  k  Problem 4.59  b  Zero-State Response   c  Number of FFTs = 22 Size of FFTs = 1024  366    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.60 Consider the following noise-corrupted periodic signal with a sampling frequency of fs = 1600  Hz and N = 1024.  x k  = sin2 400πkT   cos2 300πkT   + v k   ,  0 ≤ k < N  Here v k  is zero-mean Gaussian white noise with a standard deviation of σ = 1 √2. Write a program that performs the following tasks.   a  Compute and plot the power density spectrum Sx f   for 0 ≤ f ≤ fs 2.  b  Compute and print the average power of x k  and the average power of v k .  Solution  % Problem 4.60  % Initialize  f_header ’Problem 4.60’  fs = 1600; T = 1 fs; N = 1024;  % Construct signal  mu = 0; sigma = 1 sqrt 2 ; v = f_randg  1,N,mu,sigma ; k = 0 : N-1; x =  sin 400*pi*k*T  .^ 2  .*  cos 300*pi*k*T  .^ 2  + v;  % Compute power density spectra  [A,phi,S,f] = f_spec  x,N,fs ; figure i = 1 : N 2+1; plot  f i ,S i   f_labels  ’Power Density Spectrum’,’f  Hz ’,’S_N f ’  f_wait  % Compute average power of x and v  P_x =  1 N *sum x .^ 2 ; P_v =  1 N *sum v .^ 2 ; fprintf  ’P_x = %g\n’,P_x  fprintf  ’P_y = %g\n’,P_v   367    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Power Density Spectrum  100  200  300  400  500  600  700  800  f  Hz   Problem 4.60 Power Density Spectrum    f    S  N  30  60  50  40  20  10  0  0   b   P_x = 0.603097 P_y = 0.491678  368    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.61 Write a program which creates a 1 × 2048 vector x of white noise uniformly distributed over  [−.5, .5]. The program should then compute and display the following.  a  The average power Px, the predicted average power Pv, and the percent error in Px.  b  Plot the estimated power density spectrum using Bartlett’s method with L = 512. Use B of the  a y-axis range of [0, 1]. In the plot title, print L and the estimated variance σ2 power density spectrum.   c  Repeat part  b , but use L = 32.  Solution  % Problem 4.61  % Initialize  f_header ’Problem 4.61’  fs = 1;  % Construct signal  N = 2048; a = -.5; b = .5; x = f_randu  1,N,a,b ;  % Compute average power and predicted average power  P_x =  1 N *sum x .^ 2 ; P_u =  b^3 - a^3   3* b - a  ; err = 100* P_x - P_u  P_u; fprintf  ’ Average Power: P_x = %g\n’,P_x  fprintf  ’Predicted Power: P_u = %g\n’,P_u  fprintf  ’ Percent error: e = %g %%\n’,err   % Estimate power density spectrum, Bartlett with L = 512  for L = [512 32]  [S_B,f,Px] = f_pds  x,N,L,fs,0,0 ; figure i = 1 : L 2+1; plot  f i ,S_B i   v =  1 L *sum  S_B - P_x .^2 ; caption = sprintf  ’Bartlett’’s Method, L = %d, \\sigma_B^2 = %g’,L,v ; f_labels  caption,’f f_s’,’S_B f ’  axis  [0 .5 0 1]  f_wait  end  369    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    a   Average Power: P_x = 0.0818834 Predicted Power: P_u = 0.0833333 Percent error: e = -1.73994 \%  Bartlett’s Method, L = 512, σ   = 0.00197623  2  B    f    S  B  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 4.61  b  Power Density Spectrum, L = 512  370    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Bartlett’s Method, L = 32, σ   = 7.33985e−005  2  B    f    S  B  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 4.61  c  Power Density Spectrum, L = 32  371    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.62 Let x k  be an N -point white noise signal uniformly distributed over [−1, 1] where N = 4096.  Write a program that performs the following tasks.   a  Create x k  and then compute and plot the normalized circular auto-correlation, σxx k .  b  Compute cxx k , and use the result to compute and plot the power density spectrum of   c  Compute and print the average power Px.  x k .  Solution  % Problem 4.62  % Iniitialize  f_header ’Problem 4.62’  N = 1024; x = f_randu  N,1,-1,1 ;  % Compute and plot normalized circular auto-correlation  sigma_xx = f_corr  x,x,1,1 ; figure k = 0 : N-1; plot  k,sigma_xx  axis  [-N 8 9*N 8 -.2 1.2]  f_labels  ’Normalized Circular Auto-Correlation’,’k’,’\sigma_{xx} k ’  f_wait  % Compute power density spectrum using circular auto-correlation  c_xx = f_corr  x,x,1,0 ; S_N = fft c_xx ; figure i = 0 : N-1; plot  i,real S_N  ; f_labels  ’Power Density Spectrum’,’i’,’S_N i ’  f_wait;  % Compute and plot average power  P_x = c_xx 1   372    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Normalized Circular Auto−Correlation  0  200  400  600  800  1000  k  Problem 4.62  a  Normalized Circular Auto-Correlation  Power Density Spectrum    k    x x  σ  1.2  1  0.8  0.6  0.4  0.2  0  −0.2    i    S  N  2  1.8  1.6  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  200  400  800  1000  1200  600  i  Problem 4.62  b  Power Density Spectrum from Auto-Correlation   c  P_x =  0.3282  373    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.63 Consider the following N -point periodic signal of period M . Suppose M = 128 and N = 1024.  x k  = 1 + 3 cos cid:18  2πk  M  cid:19  − 2 sin cid:18  4πk M  cid:19   ,  0 ≤ k < N  Let y k  be a noise-corrupted version of x k  where v k  is white noise uniformly distributed over [−.5, .5].  y k  = x k  + v k   ,  0 ≤ k < N  The objective of this problem is to study how sensitive the periodic signal extraction technique is to the estimate of the period M .  ˆxm k  =  cid:18  N  L  cid:19  cyδm k   Write a program which performs the following tasks.   a  Compute and plot the noise-corrupted periodic signal y k .  b  Compute and plot on the same graph x k  and ˆxm k  for m = M − 5 using a legend.  c  Compute and plot on the same graph x k  and ˆxm k  for m = M using a legend.  d  Compute and plot on the same graph x k  and ˆxm k  for m = M + 5 using a legend.  Solution  % Problem 4.63  % Iniitialize  f_header ’Problem 4.63’  M = 128; N = 1024; a = 1.0;  % Construct noise-corrupted periodic input  k = 0 : N-1; x = 1 + 3*cos 2*pi*k M  - 2*sin 4*pi*k M ; v = f_randu  1,N,-a,a ; y = x + v; figure plot  k,y   374    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’Noise-Corrupted Periodic Signal’,’k’,’y k ’  f_wait  % Extract estimate of x using cross correlation  for i = -5 : 5 : 5  m = M + i; delta_m = zeros 1,N ; for j = 1 : N  if mod j-1,m  == 0  delta_m j  = 1;  end  end L = floor N m ; x_hat =  N L *f_corr y,delta_m,1,0 ; hp = plot  k,x,k,x_hat ; set  hp 1 ,’LineWidth’,1.5  f_labels  ’Estimate of Periodic Component of Noise-Corrupted Signal’,’k’,’x k ’  caption = sprintf  ’m M = %.3f’,m M ; legend  ’x k ’,caption  f_wait  end  Noise−Corruped Periodic Signal    k   y  8  6  4  2  0  −2  −4  −6  0  200  400  800  1000  1200  600  k  Problem 4.63  a  Noise-Corrupted Periodic Signal  375    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Estimate of Periodic Component of Noise−Corrupted Signal   6  x k  m M = 0.961  200  400  800  1000  1200  600  k  Problem 4.63  b  Estimated Periodic Component, m = M − 5  Estimate of Periodic Component of Noise−Corrupted Signal   6  x k  m M = 1.000  5  4  3  2  1  0  5  4  3  2  1  0    k   x  −1  −2  −3  −4    0    k   x  −1  −2  −3  −4    0  200  400  800  1000  1200  600  k  Problem 4.63  c  Estimated Periodic Component, m = M  376    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Estimate of Periodic Component of Noise−Corrupted Signal   6  x k  m M = 1.039    k   x  5  4  3  2  1  0  −1  −2  −3  −4    0  200  400  800  1000  1200  600  k  Problem 4.63  d  Estimated Periodic Component, m = M + 5  377    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.64 Consider the following digital ﬁlter of order m = 2p where p = 20.  H z  =  biz−i  2p  Xi=0  bp = .5  bi =  [.54 − .46 cos πi p ]{sin[.75π i − p ] − sin[.25π i − p ]}  , i 6= p  π i − p   Suppose fs = 200 Hz. Write a program that uses ﬁlter to do the following.   a  Compute and plot the impulse response h k  for 0 ≤ k < N where N = 64.  b  Compute and plot the magnitude response A f   for 0 ≤ f ≤ fs 2.  c  What type of ﬁlter is this, FIR or IIR? What range of frequencies gets passed by this  ﬁlter?  Solution  % Problem 4.64  % Initialize  f_header ’Problem 4.64’  fs = 200; N = 64;  % Compute impulse response  m = 40; p = m 2; b = zeros 1,m+1 ; b p+1  = .5; for i = 0 : 2*p  if i == p  b p+1  = .5;  else  end  end delta = [1,zeros 1,N-1 ]; a = 1; h = filter  b,a,delta ; k = 0 : N-1; figure  378  k = i - p; b i+1  =  .54 - .46*cos pi*i p   *  sin .75*pi*k  - sin .25*pi*k      pi*k ;    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   stem  k,h,’filled’,’.’  f_labels  ’Impulse Response’,’k’,’h k ’  f_wait  % Compute magnitude response  H = fft h,N ; A = abs H ; f = linspace  0, N-1 *fs N,N ; i = 1 : N 2+1; figure plot  f i ,A i   f_labels  ’Magnitude Response’,’f  Hz ’,’A f ’  f_wait  Impulse Response    k   h  0.5  0.4  0.3  0.2  0.1  0  −0.1  −0.2  −0.3  −0.4  0  10  20  30  40  50  60  70  k  Problem 4.64  a  Impulse Response  379    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0  0  20  40  60  80  100  f  Hz   Problem 4.64  b  Magnitude Response   c   This is an FIR ﬁlter because the denominator polynomial is a z  = 1. One can also see from the impulse response plot that h k  = 0 for k > 2p. From the magnitude response plot, the frequencies passed by the ﬁlter are 25 ≤ f ≤ 75 Hz.  380    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   4.65 Consider the following digital ﬁlter of order n where n = 11 and r = .98.  H z  =   1 + rn  1 − z−n   2 1 − rnz−n   Suppose fs = 2200 Hz. Write a program that uses ﬁlter to do the following.   a  Compute and plot the impulse response h k  for 0 ≤ k < N where N = 1001.  b  Compute and plot the magnitude response A f   for 0 ≤ f ≤ fs 2.  c  What type of ﬁlter is this, FIR or IIR? Which frequencies get rejected by this ﬁlter?  Solution  % Problem 4.65  % Initialize  f_header ’Problem 4.65’  fs = 2200; N = 1001;  % Compute impulse response  n = 11; r = .98; b_0 =  1 + r^n  2; b = b_0*[1 zeros 1,n-1  -1]; a = [1 zeros 1,n-1  -r^n]; delta = [1,zeros 1,N-1 ]; h = filter  b,a,delta ; k = 0 : N-1; figure stem  k,h,’filled’,’.’  f_labels  ’Impulse Response’,’k’,’h k ’  axis  [0 N-1 -1 1]  f_wait  % Compute magnitude response  H = fft h,N ; A = abs H ; f = linspace  0, N-1 *fs N,N ; i = 1 : N 2+1; figure  381    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   plot  f i ,A i   f_labels  ’Magnitude Response’,’f  Hz ’,’A f ’  axis  [0 fs 2 0 1.5]  f_wait  Impulse Response    k   h  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8  −1  0  200  400  600  800  1000  k  Problem 4.65  a  Impulse Response  382    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response  1.5    f   A  1  0.5  0  0  200  400  800  1000  600  f  Hz   Problem 4.65  b  Magnitude Response   c  This is an IIR ﬁlter because the denominator polynomial is a z  6= 1. From the magnitude response plot, the frequencies {200, 400, 600, 800, 1000} Hz are rejected by the ﬁlter.  383    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.1 Consider the following ﬁrst order IIR ﬁlter.  Chapter 5  H z  =  .4 1 − z−1  1 + .2z−1   a  Compute and sketch the magnitude response A f  .  b  What type of ﬁlter is this  lowpass, highpass, bandpass, bandstop ?  c  Suppose Fp = .4fs. Find the passband ripple δp.  d  Suppose Fs = .2fs. Find the stopband attenuation δs.  Solution   a  Using  5.2.1 , the frequency response is  H f   = H z z=exp j2πf T    =  =  .4[1 − exp −j2πf T  ] 1 + .2 exp −j2πf T   .4[1 − cos 2πf T   + j sin 2πf T  ] 1 + .2 cos 2πf T   − j.2 sin 2πf T    Thus the magnitude response is  A f   = H f    =  .4p[1 − cos 2πf T  ]2 + sin2 2πf T   p[1 + .2 cos 2πf T  ]2 + .04 sin2 2πf T     b  From the magnitude response sketch in part  a , this is a highpass ﬁlter.  c  Using Example 5.1 as a guide, the passband ripple is  δp = 1 − A Fp  = 1 − A .4fs  = 1 − = .1011  .4p[1 − cos .8π ]2 + sin2 .8π  p[1 + .2 cos .8π ]2 + .04 sin2 .8π   384    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  0.5  1  0.9  0.8  0.7  0.6  0.4  0.3  0.2  0.1  0  0  0.05  0.1  0.15  0.2  0.3  0.35  0.4  0.45  0.5  0.25 f f s  Problem 5.1  a  Magnitude Response   d  Using Example 5.1, the stopband ripple is  δs = A Fs   = A .2fs   =  .4p[1 − cos .4π ]2 + sin2 .4π  p[1 + .2 cos .4π ]2 + .04 sin2 .4π   = .4359  Magnitude Response  385    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.2 A bandpass ﬁlter has a sampling frequency of fs = 2000 Hz and satisﬁes the following design  speciﬁcations.  [Fs1, Fp1, Fp2, Fs2, δp, δs] = [200, 300, 600, 700, .15, .05]   a  Find the logarithmic passband ripple, Ap.  b  Find the logarithmic stopband attenuation, As.  c  Using a logarithmic scale, sketch the shaded passband and stopband regions that A f    must lie within.  Solution   a  Using  5.2.7a , the logarithmic passband ripple is   b  Using  5.2.7b , the logarithmic stopband attenuation is  Ap = −20 log10 1 − δp   = −20 log10 .85  = 1.4116 dB  As = −20 log10 δs  = −20 log10 .05  = 26.0206 dB  386    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Passband Filter Specifications     B d       f    A  0  −5  −10  −15  −20  −25  −30  −35  −40  0  100  200  300  400  600  700  800  900  1000  500 f  Hz   Problem 5.2  c  Logarithmic Speciﬁcations  387    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.3 A bandstop ﬁlter has a sampling frequency of fs = 200 Hz and satisﬁes the following design  speciﬁcations.  [Fp1, Fs1, Fs2, Fp2, Ap, As] = [30, 40, 60, 80, 2, 30]   a  Find the linear passband ripple, δp.  b  Find the linear stopband attenuation, δs.  c  Using a linear scale, sketch the shaded passband and stopband regions that A f   must  lie within.  Solution   a  Using  5.2.8a , the passband ripple is   b  Using  5.2.8b , the stopband attenuation is  δp = 1 − 10−Ap 20  = 1 − 10−.1 = .2057  δs = 10−As 20  = 10−1.5 = .0316  388    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Stopband Filter Specifications    f    A  0.5  1  0.9  0.8  0.7  0.6  0.4  0.3  0.2  0.1  0  0  10  20  30  40  60  70  80  90  100  50  f  Hz   Problem 5.3  c  Linear Speciﬁcations  389    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.4 Suppose H z  is a stable ﬁlter with A f   = 0 for .1 ≤ f  fs ≤ .2. Show that H z  is not  causal.  Solution  From the Paley-Wiener theorem in Proposition 5.1, a stable causal ﬁlter must satisfy  Z fs 2 −fs 2  log[A f  ]df < ∞  If A f   = 0 for .1fs ≤ f ≤ .2fs, then over this range  log[A f  ] = ∞. Thus H z  is not a causal ﬁlter.  390    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.5 Consider the following FIR ﬁlter of order M − 1 known as a running average ﬁlter.  H z  =  1 + z−1 + · · · + z− M −1   M   a  Find the impulse response of this ﬁlter.   b  Is this a linear-phase ﬁlter? If so, what type?   c  Find the group delay of this ﬁlter.  Solution   a  The impulse response is  h k  = Z −1{H z }  = Z −1  1 + z−1 + · · · + z− M −1   M     δ k  + δ k − 1  + · · · + δ k − M + 1   =  =   1  M 0  M  0 ≤ k < M , , M ≥ k < ∞   b  Here m = M − 1. Since h m− k  = h k , this is a linear-phase ﬁlter. Using Table 5.1, if m is even, then it is a type 1 linear-phase ﬁlter, and if m is odd it is a type 2 linear-phase ﬁlter.   c  For an FIR linear-phase ﬁlter of order m = M − 1, the group delay is  D f   =   M − 1 T  2  391    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.6 A linear-phase FIR ﬁlter H z  of order m = 8 has zeros at z = ±j.5 and z = ±.8.   a  Find the remaining zeros of H z  and sketch the poles and zeros in the complex plane.   b  The DC gain of the ﬁlter is 2. Find the ﬁlter transfer function H z .   c  Suppose the input signal gets delayed by 20 msec as it passes through this ﬁlter. What  is the sampling frequency, fs?  Solution  zeros are   a  The zeros must satisfy the reciprocal symmetry property in  5.26 . Thus, the remaining  z = ±j2, z = ±1.25  Pole−Zero Plot    z   m I  2.5  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2.5  −2  −1  1  2  0  Re z   Problem 5.6  a  Poles and Zeros   b  The general form of H z  is  H z  =  b0 z2 + .52  z2 + 22  z2 − .82  z2 − 1.252  b0 z2 + .25  z2 + 4  z2 − .64  z2 − 1.5625   z8  =  z8  392    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The DC gain is H 1  = 2. Thus  b0 =  2   1.25  5  .36  −.5265   = −1.5802   c  The group delay of a linear-phase FIR ﬁlter of order m is D = mT  2. Here m = 8 and  D = .02. Thus  Thus the sampling frequency is  T =  =  2D m 2 .02   8  = .005 sec  fs =  1 T  = 200 Hz  393    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.7 Consider a type 1 FIR linear-phase ﬁlter of order m = 2 with coeﬃcient vector b = [1, 1, 1]T.   a  Find the transfer function, H z .   b  Find the amplitude response, Ar f  .  c  Find the zeros of H z .  Solution   a  Using Example 5.3 as a guide,  H z  = 1 + z−1 + z−2   b  Let θ = 2πf T . Using Euler’s identity, the frequency response is  H f   = H z z=exp jθ   = 1 + exp −jθ  + exp −j2θ  = exp −jθ [exp jθ  + 1 + exp −jθ ] = exp −jθ [1 + 2Re{exp jθ }] = exp −jθ [1 + 2 cos θ ] = exp −j2πf  Ar f    Thus the amplitude response is   c  The numerator of H z  is b z  = z2 + z + 1. Thus the zeros of H z  are  Ar f   = 1 + 2 cos 2πf T    z1,2 = −1 ± √−3 = −1 ± j√3  2  2  394    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.8 Consider a type 2 FIR linear-phase ﬁlter of order m = 1 with coeﬃcient vector b = [1, 1]T .   a  Find the transfer function, H z .   b  Find the amplitude response, Ar f  .  c  Find the zeros of H z .  Solution   a  Using Example 5.3 as a guide,  H z  = 1 + z−1   b  Let θ = 2πf T . Using Euler’s identity, the frequency response is  H f   = H z z=exp jθ  = 1 + exp −jθ  = exp −jθ 2 [exp jθ 2  + exp −jθ 2 ] = exp −jθ 2 [2Re{exp jθ 2 }] = exp −jθ 2 2 cos θ 2  = exp −jπf  Ar f    Thus the amplitude response is   c  The numerator of H z  is b z  = z + 1. Thus the zero of H z  is  Ar f   = 2 cos πf T    z = −1  395    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.9 Consider a type 3 FIR linear-phase ﬁlter of order m = 2 with coeﬃcient vector b = [1, 0, −1]T.   a  Find the transfer function, H z .   b  Find the amplitude response, Ar f  .  c  Find the zeros of H z .  Solution   a  Using Example 5.4 as a guide,  H z  = 1 − z−2   b  Let θ = 2πf T . Using Euler’s identity, the frequency response is  H f   = H z z=exp jθ  = 1 − exp −j2θ  = exp −jθ [exp jθ  − exp −jθ ] = exp −jθ j2Im{exp jθ } = j exp −jθ 2 sin θ  = j exp −j2πf  Ar f    Thus the amplitude response is   c  The numerator of H z  is b z  = z2 − 1. Thus the zeros of H z  are  Ar f   = 2 sin 2πf T    z1,2 = 1, −1  396    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.10 Consider a type 4 FIR linear-phase ﬁlter of order m = 1 with coeﬃcient vector b = [1, −1]T .   a  Find the transfer function, H z .   b  Find the amplitude response, Ar f  .  c  Find the zeros of H z .  Solution   a  Using Example 5.4 as a guide,  H z  = 1 − z−1   b  Let θ = 2πf T . Using Euler’s identity, the frequency response is  H f   = H z z=exp jθ  = 1 − exp −jθ  = exp −jθ 2 [exp jθ 2  − exp −jθ 2 ] = exp −jθ 2 j2Im{exp jθ 2 } = j exp −jθ 2 2 sin θ 2  = j exp −jπf  Ar f    Thus the amplitude response is   c  The numerator of H z  is b z  = z − 1. Thus the zero of H z  is  Ar f   = 2 sin πf T    z = 1  397    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.11 Consider the following FIR ﬁlter.  H z  = 1 + 2z−1 + 3z−2 − 3z−3 − 2z−4 − z−5   a  Is this a linear-phase ﬁlter? If so, what is the type?   b  Sketch a signal ﬂow graph showing a direct-form II realization of H z  as in Section 3.6.  Solution   a  Here m = 5. The impulse response is  h k  = [1, 2, 3,−3,−2, 1]  Since h m − k  = −h k , this is a linear phase ﬁlter. From Table 5.1, it is of odd order with odd symmetry, so it is a type 4 linear-phase FIR ﬁlter.  x    -  -  -  y        6    6  6  6  6  1 -  u   ? z−1  2 -  3 -    ? z−1    ? z−1  ? z−1  ? z−1  −3 -  −2 -  −1 -  0  cid:27   0  cid:27   0  cid:27   0  cid:27   0  cid:27      6    6  6  6  6  398  Problem 5.11  b  Signal Flow Graph Realization    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.12 Consider the following FIR ﬁlter.  H z  = 1 + z−1 − 5z−2 + z−3 − 6z−4   a  Is this a linear-phase ﬁlter? If so, what is the type?   b  Sketch a signal ﬂow graph showing a direct-form II realization of H z  as in Section 3.6.   c  Using the MATLAB function roots ﬁnd the zeros of H z . Then sketch a signal ﬂow  graph showing a cascade form realization of H z .  Solution   a  Here m = 4. The impulse response is  h k  = [1, 1, −5, 1,−6]  Since h m − k  6= ±h k , this is not a linear phase ﬁlter. -  1 -  -  -  x    y     6    6  6  6  u   ? z−1    ? z−1    ? z−1  ? z−1  1 -  −5 -  1 -  −6 -  0  cid:27   0  cid:27   0  cid:27   0  cid:27      6    6  6  6  z =    −3 2 j −j     399  Problem 5.12  b  Direct Signal Flow Graph Realization   c  Using the MATLAB roots function on b = [1, 1, −5, 1, −6], the zeros are    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the two subsystems are  H1 z  =  z + 3  z − 2   = z2 + z − 6  H2 z  =  z − j  z + j   = z2 + 1  x    -  -  -u -      6       6    1 -  1 -    ? z−1    ? z−1  −6 -     0  cid:27   0  cid:27   -       6    0  cid:27   0  cid:27   1 -  0 -  1 -    ? z−1    ? z−1     -  y        6    Problem 5.12  c  Cascade Signal Flow Graph Realization  400    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.13 Let H z  be an arbitrary FIR transfer function of order m. Show that H z  can be written as a sum of two linear-phase transfer functions He z  and Ho z  where he k  exhibits even symmetry about k = m 2 and ho k  exhibits odd symmetry about k = m 2. Hint: Add and subtract h m − k .  H z  = He z  + Ho z   Solution  Consider the impulse response, h k . The basic idea is to add and subtract h m − k .  h k  =  h k  + h m − k   h k  − h m − k   +  2  2  = he k  + ho k   To check the symmetry of he k ,  Thus he k  exhibits even symmetry about k = m 2. Next, consider ho k .  he m − k  = =  h m − k  + h[m −  m − k ] h m − k  + h k   2  2  = he k   h m − k  − h[m −  m − k ] h m − k  − h k   2  ho m − k  = = = −ho k   2  He z  = Z cid:26  h k  + h m − k  Ho z  = Z cid:26  h k  − h m − k   2  2   cid:27   cid:27   401  Thus ho k  exhibits odd symmetry about k = m 2. Finally,    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.14 Recall from Table 5.1 that linear-phase FIR ﬁlters of types 2-4 have zeros at z = −1 or z = 1  or both. A type 1 linear-phase FIR ﬁlter is more general.   a  Show that for a type 1 linear-phase FIR ﬁlter, symmetry constraint  5.3.8  does not   b  Show that for a type 1 linear-phase FIR ﬁlter, symmetry constraint  5.3.8  does not  imply that H z  has a zero at z = −1.  imply that H z  has a zero at z = 1.  Solution   a  From symmetry constraint  5.3.8 , the zeros of a linear phase ﬁlter must satisfy  For a type 1 ﬁlter the symmetry is even  plus sign  and m is even. Thus at z = −1,  Since this does not place any constraint on the value of H −1 , z = −1 is not constrained to be a zero.   b  Again for type 1 ﬁlter the symmetry is even  plus sign  and m is even. Thus at z = 1,  Since this does not place any constraint on the value of H 1 , z = 1 is not constrained to be a zero.  H z  = ±z−mH z−1   H −1  =  −1 mH[1  −1 ]  = H −1   H 1  =  1 mH[1  1 ]  = H 1   402    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.15 This question focuses on the concept of the amplitude response of a ﬁlter.   a  Show how to compute the magnitude response from the amplitude response.  b  Suppose the magnitude response equals the amplitude response for 0 ≤ f ≤ F0, but for  f > F0 they diﬀer. What happens to the phase response at f = F0?  Solution   a  From  5.3.5 , the polar form of the amplitude response is  Ar f   = A f   exp[jβ f  ]  Here β f   is piecewise constant with values jumping between 0 and π when A f   = 0. Thus  A f   = Ar f     b  If A f   6= Ar f   for f > F0, then they diﬀer by a sign with  Ar f   = −A f    ,  f < F0  This occurs if β f   jumps from 0 to π at f = F0. Therefore the phase response φ f   jumps by π at f = F0.  403    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.16 Suppose H z  is a type 2 linear-phase FIR ﬁlter.  H z  = c0 + c1z−1 + c1z−2 + c0z−3   a  Find the amplitude response of this ﬁlter.   b  Find the phase oﬀset, α, and group delay, D f  , of this ﬁlter.  Solution   a  Recall that for an FIR ﬁlter h k  = bk for 0 ≤ k ≤ m. Thus the impulse response, h = [c0, c1, c1, c0]T , exhibits even symmetry about the midpoint k = m 2. The frequency response of this ﬁlter, in terms of θ = 2πf T , is  H f   = H z z=exp jθ   = c0 + c1 exp −jθ  + c1 exp −j2θ  + c0 exp −j3θ  = exp −j3θ 2 [c0 exp j3θ 2  + c1 exp jθ 2  + c1 exp −jθ 2  + c0 exp −j3θ 2 ]  Combining terms with identical coeﬃcients, and using Euler’s identity,  H f   = exp −j3θ  {c0[exp j3θ 2  + exp −j3θ 2 ] + c1[exp jθ 2  + exp −jθ  2]}  = exp −j3θ 2 [2c0 cos 3θ 2  + 2c1 cos θ 2 ] = exp −j3πf T  Ar f    Thus the amplitude response of this ﬁlter is  Ar f   = 2[c0 cos 3πf T   + c1 cos 3πf T  ]   b  From part  a  the phase oﬀset is α = 0 and the group delay is  D f   =  cid:18 −1 =  cid:18 −1  2π cid:19  d 2π cid:19   −3πT    df {−3πf T}  = 1.5T  404    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.17 Suppose H z  is a type 4 linear-phase FIR ﬁlter.  H z  = c0 + c1z−1 − c1z−2 − c0z−3   a  Find the amplitude response of this ﬁlter.  b  Find the phase oﬀset, α, and group delay, D f  , of this ﬁlter.  Solution   a  For an FIR ﬁlter h k  = bk for 0 ≤ k ≤ m. Thus the impulse response, h = [c0, c1, −c1, −c0]T ,  exhibits odd symmetry about the midpoint k = m 2. The frequency response of this ﬁlter, in terms of θ = 2πf T , is  H f   = H z z=exp jθ   = c0 + c1 exp −jθ  − c1 exp −j2θ  − c0 exp −j3θ  = exp −j3θ 2 [c0 exp j3θ 2  + c1 exp jθ 2  − c1 exp −jθ 2  − c0 exp −j3θ 2 ]  Combining terms with identical coeﬃcients, and using Euler’s identity,  H f   = exp −j3θ 2 {c0[exp j3θ 2  − exp −j3θ 2 ] + c1[exp jθ 2  − exp −jθ  2]}  = j exp −j3θ 2  cid:26 c0[exp j3θ 2  − exp −j3θ 2 ] = j exp −j3θ 2 [2c0 sin 3θ 2  + 2c1 sin θ 2 ] = j exp −j3πf T  Ar f    j  c1[exp jθ 2  − exp −jθ  2]  +  j   cid:27   Thus the amplitude response of this ﬁlter is  Ar f   = 2[c0 sin 3πf T   + c1 sin 3πf T  ]   b  From part  a  the presence of the factor j = exp jπ 2  yields a phase oﬀset of α = π 2.  The group delay is  D f   =  cid:18 −1 =  cid:18 −1  2π cid:19  d 2π cid:19   −3πT    df {−3πf T}  = 1.5T  405    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.18 Suppose the impulse response of an FIR ﬁlter of order m = 5 is as follows where the X terms  are to be determined.  h = [2, 4, 3, X, X, X]   a  Assuming H z  is a linear-phase ﬁlter, ﬁnd the complete impulse response. If there are  multiple solutions, ﬁnd each of them.   b  For each solution in part  a , indicate the linear-phase FIR ﬁlter type.   c  For each solution in part  a , ﬁnd the phase oﬀset, α, and the group delay, D f  .  Solution   a  For a linear-phase ﬁlter the impulse response must exhibit either even or odd symmetry  about the midpoint as in h m − k  = ±h k . Thus there are two solutions.  h1 k  = [2, 4, 3, 3, 4, 2] h2 k  = [2, 4, 3,−3, −4,−2]   b  From Table 5.1, h1 k  is a type 2 linear-phase ﬁlter, and h2 k  is a type 4 linear-phase  ﬁlter.   c  Again from Table 5.1, the phase oﬀsets for the two ﬁlters are α1 = 0 and α2 = π 2.  406    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.19 Consider the following running average ﬁlter.  H z  =  1 10  9  Xi=0  z−i   a  Write down the diﬀerence equation for this ﬁlter.   b  Convert this ﬁlter to a noncausal zero-phase ﬁlter. That is, write down the diﬀerence equations for the zero-phase version of the running average ﬁlter. You can use fi =  p1 10 in Algorithm 5.1.  Solution   a  By inspection the diﬀerence equation is   b  If x k  consists of N points, then using Algorithm 5.1,  y k  =  1 10  9  Xi=0  x k − i   9  1 √10  q1 k  =  Xi=0 q2 k  = q1 N − k  Xi=0 q3 k  = y k  = q3 N − k   1 √10  9  x k − i   q2 k − i   407    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.20 Consider the following IIR ﬁlter.  H z  =  2 z + 1.25  z2 + .25   z z2 − .81    a  Find the minimum-phase version of this system, and sketch its poles and zeros.   b  Find the maximum-phase version of this system, and sketch its poles and zeros.   c  How many transfer functions with real coeﬃcients have the same magnitude response as  H z ?  Solution   a  The factored numerator polynomial is  b z  = 2 z + 1.25  z + j.5  z − j.5   Thus the only zero outside the unit circle is z1 = −1.25. Using  5.4.9 , replace  z − z1  by  z − 1 z1  and multiply by −z1.   b  One must replace the zeros inside the unit circle with their reciprocals and multiply by  the negative of each replaced zero. The zeros inside the unit circle are z2,3 = ±j.5.  Hmin z  = −z1 z − 1 z1 H z   z − z1  2.5 z + .8 2 z2 + .25   =  z z2 − .81   Hmax z  =  z2z3 z − 1 z2  z − 1 z3 H z    z − z2  z − z3   .25 z − j2  z + j2 2 z + 1.25   z z2 − .81  .5 z2 + 4  z + 1.25   =  =  z z2 − .81    c  Since there are three zeros, there are potentially 23 = 8 separate transfer functions. However, for real coeﬃcients, the complex conjugate zeros must remain complex con- jugate pairs. This reduces the number distinct transfer functions to four: a minimum phase, a maximum phase, and two mixed phase transfer functions.  408    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.21 The following IIR ﬁlter has two parameters α and β. For what values of these parameters is  this an allpass ﬁlter?  H z  =  1 + 3z−1 +  α + β z−2 + 2z−3 2 +  α − β z−1 + 3z−2 + z−3  Solution  The coeﬃcients of an allpass transfer function must exhibit the reﬂective structure or reverse symmetry property in  5.4.7 . From inspection, this requires  α + β = α − β  Thus 2β = 0 or β = 0. There is no constraint on α.  409    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.22 Consider the following IIR ﬁlter.  H z  =  10 z2 − 4  z2 + .25   z2 + .64  z2 − .16    a  Find Hmin z , the minimum-phase version of H z .   b  Sketch the poles and zeros of Hmin z .   c  Find an allpass ﬁlter Hall z  such that H z  = Hall z Hmin z .   d  Sketch the poles and zeros of Hall z .  Solution   a  The factored numerator polynomial is  b z  = 10 z − 2  z + 2  z − j.5  z + j.5   Thus there are two zeros outside the unit circle at z1,2 = ±2. Using  5.4.9 , replace each of these zeros by its reciprocal and multiply by the negative of the zero. This yields  Hmin z  =  z1z2 z − 1 z1  z − 1 z2 H z    z − z1  z − z2  = −4 z − .5  z + .5 H z    z − 2  z + 2   = −4 z2 − .25 10 z2 + .25    z2 + .64  z2 − .16  = −40 z2 − .25  z2 + .25   z2 + .64  z2 − .16   410    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Minimum−Phase System    z   m I  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2  −1  0  Re z   1  2   b  Problem 5.22  b  Pole-zero Plot   c  Since H z  = Hall z Hmin z , one can solve for the allpass factor as follows.  Hall z  = H z H −1  min z   =  =   z2 + .64  z2 − .16   cid:21 −1 10 z2 − 4  z2 + .25   z2 + .64  z2 − .16   cid:20 −40 z2 − .25  z2 + .25  10 z2 − 4  z2 + .25   z2 + .64  z2 − .16   cid:20   z2 + .64  z2 − .16  −40 z2 − .25  z2 + .25  cid:21  z2 − .25  = −.25 z2 − 4   411    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Allpass System    z   m I  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2  −1  0  Re z   1  2   d  Problem 5.22  d  Pole-zero Plot  412    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.23 Let H z  be a nonzero linear-phase FIR ﬁlter of order m = 2.   a  Is it possible for H z  to be a minimum-phase ﬁlter? If so, construct an example. If not,   b  Is it possible for H z  to be an allpass ﬁlter? If so, construct an example. If not, why  why not?  not?  Solution   a  The general form of a FIR ﬁlter of order m = 2 is  H z  = b0 + b1z−1 + b2z−2  For H z  to be linear phase, h k  = bk must exhibit even or odd symmetry about k = 1. For H z  to be minimum phase, the zeros must not lie outside the unit circle. Yes, it is possible for a linear-phase FIR ﬁlter to be minimum phase. The following is a general type 1 example where 0 ≤ θ < 2π.  H z  =  =  z2  α[z − exp jθ ][z − exp −jθ ] α{z2 − [exp jθ  + exp −jθ ]z + 1 α[z2 − 2 cos θ z + 1]  z2  = = α[1 − 2 cos θ z−1 + z−2]  z2   b  From  5.4.7 , the coeﬃcients of the transfer function for a second-order allpass ﬁlter  must exhibit reverse symmetry as follows.  H z  =  a2 + a1z−1 + a0z−2 a0 + a1z−1 + a2z−2  For an FIR Filter, the denominator coeﬃcient vector is a = [1, 0, 0]T. Thus for a second- order FIR ﬁlter to be allpass, it is necessary that  However, h k  = δ k − 2  does not exhibit even or odd symmetry about k = 1, which means that it is not linear-phase. Therefore it is not possible for a second-order linear- phase FIR ﬁlter to be an allpass ﬁlter.  H z  = z−2  413    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.24 Suppose H z  is a ﬁlter with input x k  and output y k  whose magnitude response satisﬁes  the following constraint.   a  Show that Y  f   ≤ X f  .  b  Use Parseval’s identity to show that H z  is a passive system. That is, show that the  energy of y k  is less than or equal to the energy of x k .  A f   ≤ 1  ,  f ≤ fs 2  ∞  Xk=−∞  y k 2 ≤  ∞  Xk=−∞  x k 2  Y  f   = H f  X f    = H f   · X f   = A f  X f   ≤ X f    Solution   a  Starting with the frequency response H f     b  Using Parseval’s identity from Table 4.3  ∞  Xk=∞  y k 2 =  −fs 2 Y  f  2df  −fs 2 H f  X f  2df  −fs 2 H f  2 · X f  2df  A2 f  X f  2df  −fs 2 X f  2df  x k 2  1  1  1  fs Z fs 2 fs Z fs 2 fs Z fs 2 fs Z fs 2 fs Z fs 2 Xk=−∞  1  1  ∞  −fs 2  =  =  =  ≤  =  414    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.25 Suppose H z  is an allpass ﬁlter with input x k  and output y k  whose magnitude response  satisﬁes the following constraint.   a  Show that Y  f   = X f  .  b  Use Parseval’s identity to show that H z  is a lossless system. That is, show that the  energy of y k  is equal to the energy of x k .  A f   = 1  ,  f ≤ fs 2  ∞  Xk=−∞  y k 2 =  ∞  Xk=−∞  x k 2  Y  f   = H f  X f    = H f   · X f   = A f  X f   = X f    Solution   a  Starting with the frequency response H f     b  Using Parseval’s identity from Table 4.3  ∞  Xk=∞  y k 2 =  −fs 2 Y  f  2df  −fs 2 H f  X f  2df  −fs 2 H f  2 · X f  2df  A2 f  X f  2df  −fs 2 X f  2df  x k 2  1  1  1  fs Z fs 2 fs Z fs 2 fs Z fs 2 fs Z fs 2 fs Z fs 2 Xk=−∞  1  1  ∞  −fs 2  =  =  =  =  =  415    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.26 Consider the following IIR ﬁlter.  H z  =  2z2 + 5z + 2  z2 − 1   a  Find the minimum-phase form of H z .   b  Find a magnitude equalizer G z  such at G z H z  is an allpass ﬁlter with magnitude  response A f   = 1.  Solution   a  The factored form of H z  is  Thus there is one zero outside the unit circle at z = −2. Using  5.4.5 , replace this zero by its reciprocal and multiply by the negative of the zero. This yields   b  From  5.4.14  and  5.4.15 , the equalizer is the inverse of the minimum-phase part of  H z . Thus  H z  =  2 z2 + 2.5z + 1   z − 1  z + 1  2 z + 2  z + .5   z + 1  z + 1   =  Hmin z  =   −2  z + .5 H z   z + 2 = −4 z + .5 2  z − 1  z + 1   = −4 z2 + z + .25   z2 − 1  G z  = H −1 min   cid:21 −1  =  cid:20 −4 z2 + z + .25  −4 z2 + z + .25   z2 − 1 z2 − 1  =  = −.25 z2 − 1  z2 + z + .25  416    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.27 An ideal Hilbert transformer has the following frequency response.  Using the inverse DTFT, show that the impulse response of an ideal Hilbert transformer is  Hd f   = −jsgn f    ,  0 ≤ f < fs 2  1 − cos kπ   kπ 0  , k 6= 0 , k = 0  hd k  =    Solution  From  4.2.4 , the inverse DTFT of Hd f   is  hd k  =  = −j  = −j  0  1  −fs 2  −fs 2  sgn f   exp jk2πf T  df  Hd f   exp jk2πf T  df  exp jk2πf T  df −Z 0  fs Z fs 2 fs Z fs 2 exp jk2πf T  df fs "Z fs 2 −fs 2 fs " exp jk2πf T    cid:12  cid:12  cid:12  cid:12   cid:12  cid:12  cid:12  cid:12  k2π cid:19  [exp jkπ  − 1 − 1 + exp −jkπ ] k2π cid:19  [2 cos kπ  − 2] 1 − cos kπ  k 6= 0  exp jk2πf T  0 −  jk2πT  jk2πT  −fs 2  fs 2  kπ  ,  0  = −j =  cid:18  −1 =  cid:18  −1  =  At k = 0, using L’Hospital’s rule  Thus, the impulse response of an ideal Hilbert transformer is  hd 0  =  π sin kπ   π  = 0   cid:12  cid:12  cid:12  cid:12 k=0  1 − cos kπ   kπ 0  , k 6= 0 , k = 0  hd k  =    417    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.28 Let X k  = [x1 k , x2 k ]T . A digital oscillator that produces two sinusoidal outputs x1 k  and x2 k  that are in phase quadrature can be obtained using a ﬁrst-order two-dimensional system of the following form.  X k  = AX k − 1   ,  X 0  = c   a  Find a coeﬃcient matrix A that produces an oscillator with frequency F0 = .3fs.  b  Find an initial condition vector c that produces the solution   c  Find a coeﬃcient matrix A and an initial condition vector c that produces the solution  Solution   a  Let  From  5.5.23 , the coeﬃcient matrix is the rotation matrix  sin .6πk   cid:21  X k  =  cid:20  cos .6πk   X k  =  cid:20  d cos 2πF0kT + ψ  d sin 2πF0kT + ψ   cid:21   θ = 2πF0T  = 2π .3fs T = .6π  A = C F0   sin θ   cos θ   cid:21  =  cid:20  cos θ  − sin θ  =  cid:20  cos .6π  − sin .6π  cos .6π   cid:21   sin .6π   418    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  From  5.5.24  and  5.5.20   c =  cid:20  1 0  cid:21   c =  cid:20  d cos ψ  d sin ψ   cid:21    c  The same A as in part  a  will work. For the initial condition vector, one needs a  magnitude of d and an initial phase angle of ψ. Thus  419    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.29 Suppose the following quadrature pair of sinusoidal signals with frequency F0 and unit am-  plitude is available.  X k  =  cid:20  cos 2πF0kT   sin 2πF0kT    cid:21    a  Find the Chebyshev polynomials of the ﬁrst kind Ti x  for 0 ≤ i ≤ 3.  b  Find the Chebyshev polynomials of the second kind Ui x  for 0 ≤ i ≤ 3.  c  Let X k  = [x1 k , x2 k ]T . Find polynomials f and g such that  f [x1 k ] + x2 k g[x1 k ] = cos3 2πF0kT   + 3 sin2 2πF0kT    Solution   a  From  5.2.25    b  From  5.2.27   T0 x  = 1  T1 x  = x T2 x  = 2xT1 x  − T0 x   = 2x2 − 1  T3 x  = 2xT2 x  − T1 x  = 2x 2x2 − 1  − x = 4x3 − 3x  U0 x  = 1  U1 x  = 2x U2 x  = 2xU1 x  − U0 x   = 4x2 − 1  U3 x  = 2xU2 x  − U1 x  = 2x 4x2 − 1  − 2x = 8x3 − 4x  420    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using the harmonic generating properties of the Chebyshev polynomials in  5.5.26  and   5.5.28   f  x  = T3 x   = 4x3 − 3x g x  = 3U1 x   = 6x  421    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.30 The general form for a notch ﬁlter with a notch at F0 6= 0 is given in  5.6.10  where θ0 =  2πF0T .  Hnotch z  =  c[z − exp jθ0 ][z − exp −jθ0 ] [z − r exp jθ0  ][z − r exp −jθ0 ]   a  Rewrite Hnotch z  as a ratio of two polynomials with real coeﬃcients.   b  Find an expression for the gain factor c such that Hnotch f   = 1 at f = 0.  Solution   a  Applying Euler’s identity  Hnotch z  =  c[z − exp jθ0 ][z − exp −jθ0 ] [z − r exp jθ0 ][z − r exp −jθ0 ] c{z2 − [exp jθ0  + exp −jθ0 ]z + 1} z2 − r[exp jθ0  + exp −jθ0 ]z + r2 c[z2 − 2 cos θ0 z + 1] z2 − 2r cos θ0 z + r2  =  =   b  Since z = exp j2πf T  , DC or f = 0 corresponds to z = 1. Thus  Solving for c,  1 = Hnotch z z=1  =  c[1 − 2 cos θ0  + 1] 1 − 2r cos θ0  + r2  c =  =  1 − 2r cos θ0  + r2 1 − 2 cos θ0  + 1 1 − 2r cos θ0  + r2  2[1 − cos θ0 ]  422    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.31 Using the results from problem 5.30 and  5.6.8 , design a notch ﬁlter Hnotch z  that has a  notch at F0 = .1fs and a notch bandwidth of ∆F = .01fs.  Solution  For F0 = .1fs,  From  5.6.8 , the pole radius r is  θ0 = 2πF0T  = 2π .1fs T = .2π  r = 1 −  π∆F  fs  π.01fs  = 1 − fs = 1 − .01π  From Problem 5.30, the notch ﬁlter transfer function is  The gain factor c is  Hnotch z  =  c[z2 − 2 cos θ0 z + 1] z2 − 2r cos θ0 z + r2 c[z2 − 2 cos .2π z + 1] z2 − 2r cos .2π z + r2  =  c =  1 − 2r cos .2π  + r2  2[1 − cos .2π ]  423    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.32 Suppose the following two ﬁlters are notch ﬁlters with notches at F0 and F1, respectively.  Write the diﬀerence equation of a double-notch ﬁlter with notches at F0 and F1.  Solution  From Figure 5.31, the two notch ﬁlters must be in a cascade conﬁguration. negative powers of z  In terms of  H0 z  =  H1 z  =  b0z2 + b1z + b2 z2 + a1z + a2 B0z2 + B1z + B2  z2 + A1z + A2  H0 z  =  H1 z  =  b0 + b1z−1 + b2z−2 1 + a1z−1 + a2z−2 B0 + B1z−1 + B2z−2 1 + A1z−1 + A2z−2  Using intermediate variable u k , the diﬀerence equations are  u k  = b0x k  + b1x k − 1  + b2x k − 2  − a1u k1  − a2u k2  y k  = B0u k  + B1u k − 1  + B2u k − 2  − A1y k1  − A2y k2   424    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.33 Consider the DC notch ﬁlter in  5.6.3 .  HDC z  =  .5 1 + r  z − 1   z − r   a  Find the impulse response h k .   b  Find the diﬀerence equation.  Solution   a  Using the residue method  h 0  = b0  = .5 1 + r   The residue of the pole at z = r is  Res r, k  =  z − r HDC z zk−1z=r  = .5 1 + r  r − 1 rk−1 = .5 r2 − 1 rk−1  Thus the impulse response is  h k  = h 0 δ k  + Res r, k µ k − 1   = .5 1 + r δ k  + .5 r2 − 1 rk−1µ k − 1    b  Rewriting HDC z  in terms of negative powers of z  HDC z  =  .5 1 + r  1 − z−1   1 − rz−1  Thus  y k  = .5 1 + r [x k  − x k − 1 ] + ry k − 1   425    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.34 The general form for a resonator with a resonant frequency of F0 is given in  5.6.15  where  θ0 = 2πF0T .  Hres z  =  c z2 − 1   [z − r exp jθ0 ][z − r exp −jθ0 ]   a  Rewrite Hres z  as a ratio of two polynomials with real coeﬃcients.  a  Find an expression for the gain factor c such that Hres f   = 1 at f = F0.  Solution   a  Applying Euler’s identity  Hres z  =  c z2 − 1   c z2 − 1   [z − r exp jθ0 ][z − r exp −jθ0 ]  =  =  z2 − r[exp jθ0  + exp −jθ0 ]z + r2  c z2 − 1   z2 − 2r cos θ0 z + r2  z = exp j2πF0T    = exp jθ0    0.1    0.2    b  At f = F0,  Thus  Solving for c,  1 = Hres z z=exp jθ0   = c cid:12  cid:12  cid:12  cid:12  = c cid:18    exp j2θ0  − 1   exp j2θ0  − 2r cos θ0  exp jθ0  + r2 cid:12  cid:12  cid:12  cid:12   exp j2θ0  − 2r cos θ0  exp jθ0  + r2 cid:19    exp j2θ0  − 1   c =  exp j2θ0  − 2r cos θ0  exp jθ0  + r2   exp j2θ0  − 1   426    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.35 Using the results from problem 5.34 and  5.6.8 , design a resonator Hres z  that has a resonant  frequency at F0 = .4fs and a bandwidth of ∆F = .02fs.  Solution  For F0 = .4fs,  From  5.6.8 , the pole radius r is  θ0 = 2πF0T  = 2π .4fs T = .8π  r = 1 −  π∆F  fs  π.02fs  = 1 − fs = 1 − .02π  From Problem 5.34, the resonator ﬁlter transfer function is  Hres z  =  z2 − 2r cos θ0 z + r2  c z2 − 1   c z2 − 1   z2 − 2r cos .8π z + r2  =  The gain factor c is  c =  exp j1.6π  − 2r cos .8π  exp j.8π  + r2   exp j1.6π  − 1   427    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.36 Suppose the following two ﬁlters are resonators with resonant frequencies at F0 and F1, respectively. Write the diﬀerence equations of a double-resonator with resonant frequencies at F0 and F1.  Solution  From Figure 5.32, the two resonators must be in a parallel conﬁguration. In terms of negative powers of z  H0 z  =  H1 z  =  b0z2 + b1z + b2 z2 + a1z + a2 B0z2 + B1z + B2  z2 + A1z + A2  H0 z  =  H1 z  =  b0 + b1z−1 + b2z−2 1 + a1z−1 + a2z−2 B0 + B1z−1 + B2z−2 1 + A1z−1 + A2z−2  Using intermediate variables u1 k  and u2 k , the diﬀerence equations are  u1 k  = b0x k  + b1x k − 1  + b2x k − 2  − a1u1 k − 1  − a2u1 k − 2  u2 k  = B0x k  + B1x k − 1  + B2x k − 2  − A1u2 k − 1  − A2u2 k − 2  y k  = u1 k  + u2 k   428    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.37 Consider the DC resonator in  5.6.14 .  Hdc z  =  .5 1 − r  z + 1   z − r   a  Find the impulse response h k .   b  Find the diﬀerence equation.  Solution   a  Using the residue method  h 0  = b0  = .5 1 − r   The residue of the pole at z = r is  Res r, k  =  z − r Hdc z zk−1z=r = .5 1 − r  r + 1 rk−1 = .5 1 − r2 rk−1  Thus the impulse response is  h k  = h 0 δ k  + Res r, k µ k − 1   = .5 1 − r δ k  + .5 1 − r2 rk−1µ k − 1    b  Rewriting Hdc z  in terms of negative powers of z  Hdc z  =  .5 1 − r  1 + z−1   1 − rz−1  Thus  y k  = .5 1 − r [x k  + x k − 1 ] + ry k − 1   429    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.38 Consider the problem of designing a lowpass narrowband ﬁlter. Suppose the sampling fre-  quency is fs = 20 kHz.   a  The desired lowpass cutoﬀ frequency is Fc = 50 Hz. Find the sampling rate reduction factor M such that if Fs = fs M , then the new normalized cutoﬀ frequency will be Fc = .25Fs.   b  A cascade conﬁguration of three rate converters with rate conversion factors M1, M2, M3 can be used to implement a multistage sampling rate converter. Factor M from part  a  as follows where the maximum of {M1, M2, M3} is as small as possible.  M = M1M2M3  Solution   a  From  5.7.1 , the sampling rate reduction factor is   b  To get the smallest factors look for values near M 1 3 = 4.64. For example  Thus the maximum of {M1, M2, M3} is 5.  M =  fs 4Fc 20000 4 50   =  = 100  M = 5 · 5 · 4  430    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.39 Consider the ﬁlter bank with m = 2 ﬁlters shown in Figure 5.46.   a  Find an expression for the magnitude response A0 f   in the transition band [.2fs, .3fs].  b  Find the 3 dB cutoﬀ frequency F0 of the ﬁrst ﬁlter.   c  Find an expression for the magnitude response A1 f   in the transition band [.2fs, .3fs].  d  Find the 3 dB cutoﬀ frequency F1 of the second ﬁlter.   e  Show that the two ﬁlters form a magnitude-complementary pair with  A0 f   + A1 f   = 1   0.3   A magnitude−complementary pair  A 0  A 1  1.5  1  0    f   A  0.5  Solution   a   −0.5  0  0.1  0.2  0.3  0.4  0.5  f f  s  Figure 5.46 A magnitude-complementary pair of ﬁlters  A0 f   = 1 − 10 f  fs − .2   ,  .2 ≤ f  fs ≤ .3   b  At the 3 dB cutoﬀ frequency A0 F0  = .707.  431    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus   c   Thus  band  A1 f   = 10 f  fs − .2   ,  .2 ≤ f  fs ≤ .3   d  At the 3 dB cutoﬀ frequency A1 F1  = .707.   e  Outside the transition band, [.2fs, .3fs] it is clear that A0 f   + A1 f   = 1. Inside the  A0 f   + A1 f   = 1 − 10 f  fs − .2  + 10 f  fs − .2   = 1  .707 = .1 − 10 F0 fs − .2   = .1 − 10F0 fs − 2 = −1.9 − 10F0 fs  F0 =  1.9 + .707 fs 10  = .261fs  .707 = 10 F1 fs − .2   = 10F1 fs − 2  F1 = 2.707fs 10  = .271fs  432    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.40 Consider the ﬁlter bank with m = 2 ﬁlters shown in Figure 5.47.   a  Find an expression for the magnitude response A0 f   in the transition band [.22fs, .28fs].  b  Find the 3 dB cutoﬀ frequency F0 of the ﬁrst ﬁlter.   c  Find an expression for the magnitude response A1 f   in the transition band [.22fs, .28fs].  d  Find the 3 dB cutoﬀ frequency F1 of the second ﬁlter.   e  Show that the two ﬁlters form a power-complementary pair with  A2  0 f   + A2  1 f   = 1   0.4   A power−complementary pair  A2 0  A2 1  1.5  1  0    f    A  2  0.5  Solution   a   −0.5  0  0.1  0.2  0.3  0.4  0.5  f f  s  Figure 5.47 A power-complementary pair of ﬁlters  A0 f   = p1 − 10 f  fs − .2   ,  .2 ≤ f  fs ≤ .3   b  At the 3 dB cutoﬀ frequency A2  0 F0  = .5.  433    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus   c   Thus  band  A1 f   = p10 f  fs − .2   ,  .2 ≤ f  fs ≤ .3   d  At the 3 dB cutoﬀ frequency A2  1 F1  = .5.   e  Outside the transition band, [.2fs, .3fs] it is clear that A2  0 f   + A2  1 f   = 1. Inside the  A2  0 f   + A2  1 f   = 1 − 10 f  fs − .2  + 10 f  fs − .2   = 1  .5 = .1 − 10 F0 fs − .2   = .1 − 10F0 fs − 2 = −1.9 − 10F0 fs  F0 = 2.4fs 10  = .24fs  .5 = 10 F1 fs − .2   = 10F1 fs − 2  F1 = 2.5fs 10  = .25fs  434    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.41 Consider the mean square error performance criterion used for the adaptive ﬁlter in Figure  5.41.   cid:15  w  = E[e2 k ]   a  Suppose the mean square error is approximated as  cid:15  w  ≈ e2 k . Find the gradient vector ∇ cid:15  w  = ∂ cid:15  w  ∂w. Express your ﬁnal answer in terms of the state vector of past inputs, u.   b  Using your expression for ∇ cid:15  w  from part  a  and the step size µ, show that the following  steepest descent method for approximating w in  5.8.6  reduces to the LMS method.  Solution   a  If  cid:15  w  = e2 k , then from  5.8.3  and  5.8.4   ∂ cid:15  w  ∂wi  =  ∂e2 k   ∂wi  = 2e k   = 2e k   = 2e k   ∂e k  ∂wi ∂[d k  − y k ] ∂[d k  − wT  k u k ] ∂[wT  k u k ]  ∂wi  ∂wi  = −2e k  = −2e k ui k   ∂wi  ,  0 ≤ i ≤ m  Thus the gradient vector is  ∇ cid:15 [w k ] = −2e k u k    b  Starting with the steepest descent method for updating w  w k + 1  = w k  − µ∇ cid:15 [w k ] = w k  + 2µe k u k   ,  k ≥ 0  435    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.42 Consider the adaptive ﬁlter shown in Figure 5.48. This conﬁguration can be used to design an equalizer with delay. Here G z  is a stable IIR ﬁlter. Suppose the adaptive ﬁlter converges to an FIR ﬁlter H z  with error e k  = 0. Let  Gequal z  = G z H z    a  Show that Gequal z  is an allpass ﬁlter with Aequal f   = 1.  b  Show that Gequal z  is a linear-phase ﬁlter with φequal f   = −2πM T f.  x k  f     -  z−M     f d k   -  G z    cid:0  cid:0  cid:18   ﬁlter  - Adaptive  cid:0  cid:0   y k  - −   cid:19  cid:16  ? +  cid:18  cid:17  e k   Figure 5.48 Equalizer Design using an Adaptive Filter  Solution   a  If e k  =, then  Thus  It follows that  y k  = d k   = x k − M    Y  z  = Gequal z X z   = z−M X z   Gequal z  = z−M  436    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The magnitude response is   b  From part  a , Gequal z  = z−M . Thus the impulse response is  The ﬁlter Gequal z  can be regarded as a ﬁlter of order m = 2M . Then from Proposition 5.2, the symmetry condition for a linear-phase ﬁlter is  Aequal f   = Gequal z z=exp j2πf T    = z−Mz=exp j2πf T =  exp −j2πM f T   = 1  gequal k  = Z −1{z−M} = δ k − M    gequal m − k  = gequal 2M − k  = δ 2M − k − M   = δ M − k  = δ k − M   = gequal k   Gequal f   = Gequal z z=exp j2πf T    = z−Mz=exp j2πf T   = exp −j2πM T f   = A f   exp[jφ f  ]  φequal f   = −2πM T f  437  Therefore Gequal z  is a linear-phase FIR ﬁlter. The frequency response is  Thus the linear phase response is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.43 Use the GUI module g ﬁlters to analyze an IIR bandpass ﬁlter. Reduce the number of bits  of precision N until the quantized ﬁlter ﬁrst goes unstable. Then increase N by one.   a  Plot the magnitude response   b  Plot the pole-zero pattern  Solution  x k   H z   y k   0  0  1.5    f   A  1  0.5  0    0  Direct Butterworth IIR filter: n=18, m=18, c=32, q=0.00195313, e   = 0.69124  max     Unquantized Quantized, N = 15 Specifications  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 5.43  a  Quantized Magnitude Response  438    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0  Unquantized pole−zero plot  Quantized pole−zero plot: N = 15     2  1  0  −1    z   m I    z   m I  2  1  0  −1  −2  −2     −2  −2  −1  0  Re z   1  2  −1  0  Re z   1  2  Problem 5.43  b  Pole-Zero Plots  439    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.44 Use the GUI module g ﬁlters and select an IIR highpass ﬁlter. Adjust the number of bits of  precision N to highest value that still makes the quantized ﬁlter go unstable.   a  Plot the unstable pole-zero plot   b  Increase N by one so the quantized ﬁlter becomes stable. Then plot the impulse response.  Solution  x k   H z   y k   0  0  2  1  0  −1    z   m I     −2  −2  Unquantized pole−zero plot  Quantized pole−zero plot: N = 12     −1  0  Re z   1  2  −1  0  Re z   1  2  Problem 5.44  a  Unstable Pole-Zero Plot    z   m I  2  1  0  −1  −2  −2  440    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0  0.4  0.2  0  −0.2    k   h  Impulse response  Quantized impulse response: N = 13 0.4        −0.4  0  50 k  100  −0.4  0  50 k  100  Problem 5.44  b  Stable Impulse Response    k   h  0.2  0  −0.2  441    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.45 Use the GUI module g ﬁlters and select the User-deﬁned ﬁlter option. Load the ﬁlter in  MAT-ﬁle prob5 45. Set the number of bits for coeﬃcient quantization to N = 10.   a  Plot the magnitude response using a direct form realization.   b  Plot the phase response using a direct form realization.   c  Plot the magnitude response using a cascade form realization.   d  Plot the phase response using a cascade form realization.  Solution  x k   H z   y k   0  0  1.5  1  0.5    f   A  0    0  Direct user−defined filter from file C:\rjs\books\book4\_2e\chap5\prob\prob5_45.mat: n=8, m=8, c=4, q=0.0078125, e_{max} = 0.462068     Unquantized Quantized, N = 10  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 5.45  a  Direct Magnitude Response  442    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   Direct user−defined filter from file C:\rjs\books\book4\_2e\chap5\prob\prob5_45.mat: n=8, m=8, c=4, q=0.0078125  Unquantized Quantized, N = 10  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 5.45  b  Direct Phase Response  x k  x k  x k   H z  H z  H z   y k  y k  y k         Cascade user−defined filter from file C:\rjs\books\book4\_2e\chap5\prob\prob5_45.mat: n=8, m=8, c=4, q=0.0078125, e_{max} = 0.0394669  Unquantized Quantized, N = 10  0 0  0 0  4  2  0 0 0  0 0 0  φ  0  −2  −4    0  1.5  1  0.5    f   A  0    0  100  200  300  400  600  700  800  900  1000  Problem 5.45  c  Cascade Magnitude Response  500 f f  s  443    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   H z  H z  H z  H z   y k  y k  y k  y k   0 0 0 0  0 0 0 0  4  2  φ  0  −2  −4    0  Cascade user−defined filter from file C:\rjs\books\book4\_2e\chap5\prob\prob5_45.mat: n=8, m=8, c=4, q=0.0078125     Unquantized Quantized, N = 10  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 5.45  d  Cascade Phase Response  444    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.46 Use the GUI module g ﬁlters and select an FIR bandstop ﬁlter. Adjust the number of bits of  precision N until the quantization level q is larger than .005.   a  Plot the magnitude response.   b  Plot the pole-zero plot  Solution  x k   H z   y k   0  0  1.5    f   A  1  0.5  0    0  Direct Butterworth IIR filter: n=18, m=18, c=16, q=0.0078125, e   = 0.269151  max     100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 5.46  a  Magnitude Response  Unquantized Quantized, N = 12 Specifications  445    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0  Unquantized pole−zero plot  Quantized pole−zero plot: N = 12     2  1  0  −1    z   m I    z   m I  2  1  0  −1  −2  −2     −2  −2  −1  0  Re z   1  2  −1  0  Re z   1  2  Problem 5.46  b  Pole-zero Plot  446    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.47 Use the GUI module g ﬁlters and select an FIR lowpass ﬁlter. Adjust the parameter values  to fs = 100 Hz, F0 = 30 Hz, and B = 10 Hz.   a  Plot the magnitude response using the dB scale.   b  Plot the phase response.   c  Plot the impulse response. Is this a linear-phase ﬁlter? If so, what type?  Solution  0  0  0  −10  −20  −30    B d       f   A  −40    0  x k   H z   y k   Direct windowed FIR filter: m=60, c=1, q=1.52588e−005     Unquantized Quantized, N = 17 Specifications  5  10  15  20  30  35  40  45  50  25 f f  s  Problem 5.47  a  Logarithmic Magnitude Response  447    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0  0  4  2  φ  0  −2  −4    0  0 0 0  0 0 0    k   h  0.6  0.4  0.2  0  −0.2  −0.4  −0.6     −0.8  x k   H z   y k   Direct windowed FIR filter: m=60, c=1, q=1.52588e−005  Unquantized Quantized, N = 17     5  10  15  20  30  35  40  45  50  25 f f  s  Problem 5.47  b  Phase Response   c  Yes, this is type 1 linear-phase ﬁlter with even order and even symmetry about k = m 2.  x k  x k  x k   H z  H z  H z   y k  y k  y k   Impulse response  Quantized impulse response: N = 17     0  20  40  60  0  20  40  60  k  k  Problem 5.47  c  Impulse Response    k   h  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  448    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.48 Consider the following running average ﬁlter. Create a MAT-ﬁle called prob5 48.mat that  contains f s = 300, a, and b for this ﬁlter.  y k  =  1 10  9  Xi=0  x k − i   Use the GUI module g ﬁlters with the User-deﬁned option to load this ﬁlter.   d  Plot the impulse response. Is this a linear-phase ﬁlter? If so, what type?   a  Plot the magnitude response.   b  Plot the phase response.   c  Plot the pole-zero plot.  Solution  x k   H z   y k   0  0  1.5    f   A  1  0.5  0    0  Direct user−defined filter from file prob5_48.mat: n=0, m=9, c=1, q=1.52588e−005, e   = 6.10352e−005  max     Unquantized Quantized, N = 17  50  100  150  f f  s  Problem 5.48  a  Magnitude Response  449    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   Direct user−defined filter from file prob5_48.mat: n=0, m=9, c=1, q=1.52588e−005  Unquantized Quantized, N = 17     50  100  150  f f  s  Problem 5.48  b  Phase Response  x k  x k  x k   H z  H z  H z   y k  y k  y k   Unquantized pole−zero plot  Quantized pole−zero plot: N = 17     0 0  0 0  2  1  0  −1  −2  −3    0  φ  0 0 0  0 0 0  2  1  0  −1    z   m I     −2  −2  −1  0  Re z   1  2  −1  0  Re z   1  2  Problem 5.48  c  Pole-Zero Plot    z   m I  2  1  0  −1  −2  −2  450    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  Yes, this is a type 2 linear-phase ﬁlter with odd order and even symmetry about k = m 2.  Impulse response  Quantized impulse response: N = 17     x k  x k  x k  x k   H z  H z  H z  H z   y k  y k  y k  y k   0 0 0 0  0 0 0 0  0.1  0.05    k   h  0  −0.05     −0.1  −10  0  10  k  −10  0  10  k  Problem 5.48  d  Impulse Response    k   h  0.1  0.05  0  −0.05  −0.1  451    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.49 The derivative of an analog signal xa t  can be approximated numerically by taking diﬀerences between the samples of the signal using the following ﬁrst-order backwards Euler diﬀerentiator.  y k  =  x k  − x k − 1   T  Create a MAT-ﬁle called prob5 49.mat that contains f s = 10, a and b for this ﬁlter. Then use GUI module g ﬁlters with the User-deﬁned option to load this ﬁlter.   a  Plot the magnitude response.   b  Plot the phase response.   c  Plot the impulse response. Is this a linear-phase ﬁlter? If so, what type?  Solution  x k   H z   y k   0  0  20  15    f   A  10  5  0    0  Direct user−defined filter from file prob5_49.mat: n=0, m=1, c=16, q=0.000244141, e   = 0  max     0.5  1  1.5  2  3  3.5  4  4.5  5  2.5 f f  s  Problem 5.49  a  Magnitude Response  Unquantized  Quantized, N = 17  452    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  2  1.5  φ  1  0.5  0    0  0 0 0  0 0 0  10  5  0  −5    k   h  x k  x k   H z  H z   y k  y k   Direct user−defined filter from file prob5_49.mat: n=0, m=1, c=16, q=0.000244141  Unquantized Quantized, N = 17     0.5  1  1.5  2  3  3.5  4  4.5  5  2.5 f f  s  Problem 5.49  b  Phase Response   c  Yes, this is type 3 linear-phase ﬁlter with odd order and odd symmetry about k = m 2.  x k  x k  x k   H z  H z  H z   y k  y k  y k   Impulse response  Quantized impulse response: N = 17        −10  −10  −5  0 k  5  10  −10  −10  −5  0 k  5  10  Problem 5.49  c  Impulse Response  10  5  0  −5    k   h  453    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.50 A notch ﬁlter is a ﬁlter that is designed to remove a single frequency. Consider the following  transfer function for a notch ﬁlter.  H z  =  .9766 1 + z−1 + z−2   1 + .9764z−1 + .9534z−2  Create a MAT-ﬁle called prob5 50.mat that contains f s = 1000, and the a and b for this ﬁlter. Then use the User-deﬁned option of GUI module g ﬁlters to load this ﬁlter. Set N = 6 bits.   a  Plot the magnitude response. Use the Caliper option to estimate the notch frequency.   b  Plot the phase response.   c  Plot the pole-zero pattern.  Solution  x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Direct user−defined filter from file prob5_50.mat: n=2, m=2, c=1, q=0.03125, e   = 0.376828  max     Unquantized Quantized, N = 6  50  100  150  200  300  350  400  450  500  250 f f  s  Problem 5.50  a  Magnitude Response     x,y  =  332.81,0.09   454    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   Direct user−defined filter from file prob5_50.mat: n=2, m=2, c=1, q=0.03125     Unquantized Quantized, N = 6  50  100  150  200  300  350  400  450  500  250 f f  s  Problem 5.50  b  Phase Response  x k  x k  x k   H z  H z  H z   y k  y k  y k   Unquantized pole−zero plot  Quantized pole−zero plot: N = 6 2     0 0  0 0  φ  1.5  0.5  1  0  −0.5  −1  −1.5  −2    0  0 0 0  0 0 0  2  1  0  −1    z   m I     −2  −2  −1  0  Re z   1  2  −1  0  Re z   1  2  Problem 5.50  c  Pole-Zero Plot  1  0    z   m I  −1  −2  −2  455    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.51 Consider the following IIR ﬁlter.  H z  =  1 + 1.75z−2 − .5z−4  1 + .4096z−4   a  Write a MATLAB program that uses f minall to compute and print the coeﬃcients of  the minimum-phase and allpass parts of H z .   b  Use the MATLAB subplot command to plot the magnitude responses A f  , Amin f   and  Aall f   on a single screen using three separate plots.   c  Repeat part  b , but for the phase responses.   d  Use f pzplot to plot the poles and zeros of H z , Hmin z  and Hall z  on one screen using  three separate square plots.  Solution  % Problem 5.51  % Initialize  f_header ’Problem 5.51’  b = [1 0 1.75 0 -0.5] a = [1 0 0 0 0.4096] N = 100; fs = 1;  % Decompose H z  and display coefficients  [B_min,A_min,B_all,A_all] = f_minall  b,a ; B_min = real B_min  A_min B_all A_all  % Plot magnitude responses  [H,f] = f_freqz  b,a,N,fs ; [H_min,f] = f_freqz  B_min,A_min,N,fs ; [H_all,f] = f_freqz  B_all,A_all,N,fs ; figure subplot  3,1,1  plot  f,abs H  ; f_labels  ’Magnitude Responses’,’f f_s’,’A f ’  subplot  3,1,2  plot  f,abs H_min  ;  456    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’’,’f f_s’,’A_{min} f ’  subplot  3,1,3  plot  f,abs H_all  ; axis  [0 0.5 0 2]  f_labels  ’’,’f f_s’,’A_{all} f ’  f_wait  % Plot phase responses  figure subplot  3,1,1  plot  f,angle H  ; f_labels  ’Phase Responses’,’f f_s’,’\phi f ’  subplot  3,1,2  plot  f,angle H_min  ; f_labels  ’’,’f f_s’,’\phi_{min} f ’  subplot  3,1,3  plot  f,angle H_all  ; f_labels  ’’,’f f_s’,’\phi_{all} f ’  f_wait  % Plot pole-zero patterns  figure subplot  2,2,1  f_pzplot  b,a,’Original System’  subplot  2,2,2  f_pzplot  B_min,A_min,’Minimum-Phase Part’  subplot  2,2,3  f_pzplot  B_all,A_all,’Allpass Part’  f_wait   a  The coeﬃcients are  b =  a =  1.0000  1.0000  B_min =  A_min =  1.0000  B_all =  A_all =  2.0000  -0.0000  0.5000  0.0000  -0.2500  0  0  0  1.7500  0  0  0  0  -0.5000  0.4096  0  0.4096  0.5000  0.0000  1.0000  1.0000  0.0000  0.5000  457    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f   A    f    A  n i m    f    A  l l a  0  0  0  0  0  0  4  2  4  2  2  1  5  0  1  0  5  0  −5  0  −1  0  −5  0    f   φ    f    n i m  φ    f    l l a  φ  Magntitude Responses  0.1  0.2  0.3  0.4  0.5  0.1  0.2  0.3  0.4  0.5  0.1  0.2  0.3  0.4  0.5  Problem 5.51  b  Magnitude Responses  Phase Responses  0.1  0.2  0.3  0.4  0.5  0.1  0.2  0.3  0.4  0.5  0.1  0.2  0.3  0.4  0.5  Problem 5.51  c  Phase Responses  f f  s  f f  s  f f  s  f f  s  f f  s  f f  s  458    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     z   m I    z   m I  −1  −2  −2  2  1  0  2  1  0  −1  −2  −2  Original System  Minimim−Phase Part    z   m I  2  1  0  −1  −2  −2  0  Re z   2  Allpass Part  0  Re z   2  0  Re z   2  Problem 5.51  d  Pole-Zero Plots  459    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 5.52 A comb ﬁlter  see Chapter 7  is a ﬁlter that extracts a set of isolated equally spaced frequencies  from a signal. Consider the following comb ﬁlter that has n teeth.  H z  =  b0  1 − rnz−n  Here the ﬁlter gain is b0 = 1 − rn. Suppose n = 10, r = .98, and fs = 300 Hz. Write a MATLAB program that uses f freqz to compute the frequency response. Compute both the unquantized frequency response  set bits = 64 , and the frequency response with coeﬃcient quantization using f quant with N = 4 bits. Plot both magnitude responses on a single plot using the linear scale and a legend.  Solution  % Problem 5.52  % Initialize  f_header ’Problem 5.52’  n = f_prompt ’Enter filter order’,0,50,10 ; bits = f_prompt ’Enter number of bits’,1,64,4 ; r = 0.98; b = 1 - r^n a = [1,zeros 1,n-1 ,r^n] fs = 300; realize = 0;  % Compare original and quantized magnitude responses  p = 500; [H,f] = f_freqz  b,a,p,fs,64,realize ; [H_q,f] = f_freqz  b,a,p,fs,bits,realize ; A = abs H ; A_q = abs H_q ; figure h1 = plot  f,A,f,A_q ; set  h1 1 ,’LineWidth’,1.5  f_labels  ’Magnitude Responses’,’f  Hz ’,’A f ’  s = sprintf  ’Quantized, N=%d’,bits ; legend  ’Unquantized’,s  f_wait  460    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Responses     Unquantized Quantized, N=4    f   A  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0    0  50  100  150  f  Hz   Problem 5.52 Magnitude Responses of Comb Filter  461    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.53 An inverse comb ﬁlter  see Chapter 7  is a ﬁlter that eliminates a set of isolated equally-spaced  frequencies from a signal. Consider the following inverse comb ﬁlter that has n teeth.  H z  =  b0 1 − z−n  1 − rnz−n  Here the ﬁlter gain is b0 =  1 + rn  2. Suppose n = 8 and r = .96. Suppose n = 10, r = .98, and fs = 300 Hz. Write a MATLAB program that uses f freqz to compute the frequency response. Compute both the unquantized frequency response  set bits = 64 , and the frequency response with coeﬃcient quantization using f quant with N = 4 bits. Plot both magnitude responses on a single plot using the linear scale and a legend.  Solution  % Problem 5.53  % Initialize  f_header ’Problem 5.53’  n = f_prompt ’Enter filter order’,0,50,10 ; bits = f_prompt ’Enter number of bits’,1,64,4 ; r = 0.96; b_0 =  1 + r^n  2; b = b_0*[1, zeros 1,n-1 , -1] a = [1,zeros 1,n-1 , -r^n] fs = 200; realize = 0;  % Compare original and quantized magnitude responses  p = 500; [H,f] = f_freqz  b,a,p,fs,64,realize ; [H_q,f] = f_freqz  b,a,p,fs,bits,realize ; A = abs H ; A_q = abs H_q ; figure h1 = plot  f,A,f,A_q ; set  h1 1 ,’LineWidth’,1.5  f_labels  ’Magnitude Responses’,’f  Hz ’,’A f ’  s = sprintf  ’Quantized, N=%d’,bits ; legend  ’Unquantized’,s  f_wait  462    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Responses     Unquantized Quantized, N=4  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  20  40  60  80  100  f  Hz   Problem 5.53 Magnitude Responses of Inverse Comb Filter  463    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   5.54 Consider the following FIR system.  G z  = 3 − 4z−1 + 2z−2 + 7z−3 + 4z−4 + 9z−5  Suppose G z  is driven by N = 500 samples of white noise x k  uniformly distributed over [−10, 10]. Let D z  = G z X z  represent the desired output. Write a MATLAB program that performs the following tasks.   a  Compute the optimal weight w for an adaptive transversal ﬁlter of order m using the LMS method. Start from an initial guess of w 0  = 0 and choose a step size µ that ensures convergence. Compute and display the ﬁnal w for three cases: m = 3, m = 5, and m = 7. Also display the coeﬃcient vector b of G z .   b  Let H z  be the transfer function of the transversal ﬁlter using the ﬁnal weights when m = 7. Create a 2× 1 array of plots. Plot the magnitude responses of G z  and H z  on the ﬁrst plot with a legend. Plot the phase responses of G z  and H z  on the second plot with a legend.  Solution  % Problem 5.54  % Initialize  f_header ’Problem 5.54’  N = 500; c = 10; x = f_randu N,1,-c,c ; mu = f_prompt ’Enter the step size mu’,.00001,.01,.001 ; b = [3 -4 2 7 4 9] d = filter b,1,x ;  % Compute w using LMS method  for m = [3 5 7]  w = zeros m+1,1 ; u = zeros m+1,1 ; y = zeros N,1 ; for k = 1 : N-1  u = [x k  ; u 1:m ]; y = w’*u; e k  = d k  - y; w = w + 2*mu*e k *u;  end m w  464    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   end  % Plot the last case  M = 100; fs = 1; [G,f] = f_freqz b,1,M,fs ; [H,f] = f_freqz w,1,M,fs ; Ag = abs G ; phig = angle G ; Ah = abs H ; phih = angle H ; subplot 2,1,1  hp = plot f,Ag,f,Ah ; set hp 2 ,’LineWidth’,1.5 ; f_labels  ’Magnitude Responses’,’f f_s’,’A f ’  legend  ’A_g f ’,’A_h z ’  subplot 2,1,2  hp = plot f,phig,f,phih ; set hp 2 ,’LineWidth’,1.5 ; f_labels  ’Phase Responses’,’f f_s’,’\phi f ’  legend  ’\phi_g f ’,’\phi_h f ’  f_wait   a  Enter the step size mu  1e-005 to 0.01, default: 0.001 :  -4  2  7  4  9  b =  m =  w =  m =  w =  3  3  5  -0.8970 -1.3557 2.5336 7.6154  3.0000 -4.0000 2.0000 7.0000 4.0000 9.0000  m =  w =  7  3.0000 -4.0000 2.0000  465    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   7.0000 4.0000 9.0000 -0.0000 0.0000  30  20  10    f   A  0    0  4  2  0  −2  −4    0    f   φ  Magnitude Responses  0.1  0.2  0.3  0.4  0.5  f f s  Phase Responses        A  f  g A  z  h   f  φ g  f  φ h  0.1  0.2  0.3  0.4  0.5  f f s  Problem 5.54  b  Magnitude and Phase Responses  466    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.1 Consider the following noise-corrupted periodic signal. Here v k  is white noise uniformly  distributed over [−.5, .5].  Chapter 6  x k  = 3 + 2 cos .2πk   y k  = x k  + v k    a  Find the average power of the noise-free signal, x k .   b  Find the signal to noise ratio of y k .  c  Suppose y k  is sent through an ideal lowpass ﬁlter with cutoﬀ frequency, F0 = .15fs to produce z k . Is the signal x k  aﬀected by this ﬁlter? Find the signal-to-noise ratio of z k .  Solution   a  Using the trigonometric identities from Appendix 2,  x2 k  = 9 + 6 cos .2πk  + 4 cos2 .2πk   = 9 + 6 cos .2πk  + 4 cid:20 1 + cos .4πk   = 11 + 6 cos .2πk  + 2 cos .4πk   2   cid:21   Thus the average power of the noise-free signal is  Px = E[x2 k ]  = 11   b  From Appendix 2 the average power of white noise uniformly distributed over [−c, c] is  Pv = c2 3. Thus Pv = 1 12 and from Deﬁnition 6.1, the signal to noise ratio is  SNR y  = 10 log10 cid:18  Px Pv cid:19  1 12 cid:19  = 10 log10 cid:18  11  = 10 log10 132  = 21.2057 dB  467    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  The frequencies present in the signal are f0 = 0 and f1 where  The frequency of the cosine term is  Thus x k  is not distorted by the ﬁltering. However, since F0 < fs 2, the average power of the noise is reduced as follows.  Thus the new signal to noise ratio is  SNR z  = 10 log10 cid:18  Px .6Pv cid:19  = 10 log10 cid:18  11 .0235 cid:19   = 26.7069 dB  2πf1kT = .2πk  f1 =  .2 2T = .1fs  Pv =  cid:18  F0  fs 2 cid:19  1  12  =  .3 12  = .0235  468    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.2 Consider the problem of designing an mth order type 3 linear-phase FIR ﬁlter having the  following amplitude response.  Ar f   = sin 2πf T    ,  0 ≤ f ≤ fs 2   a  Assuming m = 2p for some integer p, ﬁnd the coeﬃcients using the windowing method  with the rectangular window.   b  Find the ﬁlter coeﬃcients using the windowing method with the Hamming window.  Solution   a  Using the trigonometric identities from Appendix 2 and  6.2.9  we have  Ar f   sin[2π k − .5m f T ] = sin 2πf T   sin[2π k − p f T ]  cos[2π k − p − 1 f T ] − cos[2π k − p + 1 f T ]  =  2  Thus from  6.2.9  the desired impulse response is   cid:26  cos[2π k − p − 1 f T ] − cos[2π k − p + 1 f T ] {cos[2π k − p − 1 f T ] − cos[2π k − p + 1 f T ]}df  2   cid:27  df  0  h k  = −2T Z fs 2 = −T Z fs 2 = −T  cid:26  sin[2π k − p − 1 f T ] 2π k − p − 1 T k 6= p ± 1  = 0  ,  0  fs 2  −  sin[2π k − p + 1 f T ]  2π k − p + 1 T  cid:27  cid:12  cid:12  cid:12  cid:12   0  ,  k 6= p ± 1  When k = p + 1  h p + 1  = −2T Z fs 2  0   cid:20  1 − cos 4πf T    2   cid:21  df  Similarly, when k = p − 1  = −T fs 2 = −1 2  469    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus the ﬁlter coeﬃcients using the rectangular window are   cid:20  cos −4πf t  − 1  2   cid:21  df  h p − 1  = −2TZ fs 2 = −T  −fs   0  2  =  1 2  h k  = .5[δ k − p − 1  − δ k − p + 1 ]  .5 , k = p + 1 −.5 , k = p − 1 , otherwise 0  =    bi = w i h i   = .5[w p + 1 δ i − p − 1  − w p − 1 δ i − p + 1 ] i = p + 1 i = p − 1 , otherwise  .5{.54 − .46 cos[π p + 1  p]} , −.5{.54 − .46 cos[π p − 1  p]} ,  0  =     b  Using  6.2.12  and Table 6.2, the numerator coeﬃcients using the Hamming window are  470    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.3 Suppose a lowpass ﬁlter of order m = 10 is designed using the windowing method with the  Hanning window and fs = 2000 Hz.   a  Estimate the width of the transition band.   b  Estimate the linear passband ripple and stopband attenuation.   c  Estimate the logarithmic passband ripple and stopband attenuation.  Solution   a  Using Table 6.3, the normalized width of the transition band is  Thus the width of the transition band is   b  From Table 6.3, the linear passband ripple and stopband attenuation are   c  From Table 6.3, the logarithmic passband ripple and stopband attenuation are  ˆB ≈  3.1 m = .31  B = ˆBfs  = .31 2000   = 620 Hz  δp = .0063 δs = .0063  Ap = .055 dB As = 44 dB  471    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.4 Consider the problem of using the windowing method to design a lowpass ﬁlter to meet the  following speciﬁcations.   fs, Fp, Fs  =  200, 30, 50  Hz   Ap, As  =  .02, 50  dB   a  Which types of windows can be used to satisfy these design speciﬁcations?  b  For each of the windows in part  a , ﬁnd the minimum order of ﬁlter m that will satisfy   c  Assuming an ideal piecewise-constant amplitude response is used, ﬁnd an appropriate  the design speciﬁcations.  value for the cutoﬀ frequency Fc.  Solution   a  From Table 6.3, the only windows that satisfy the passband ripple and stopband atten-  uation speciﬁcations are the Hamming and the Blackman windows.   b  The normalized transition bandwidth required is  ˆB = Fs − Fp  fs  = 50 − 30 = .2  100  m = ceil cid:18  3.3 .2  cid:19   = ceil 16.5   = 17  m = ceil cid:18  5.5 .2  cid:19   = ceil 27.5   = 28  472  For the Hamming window, the normalized transition bandwidth is ˆB = 3.3 m. Thus 3.3 m = .2 or  For the Blackman window, the normalized transition bandwidth is ˆB = 5.5 m. Thus 5.5 m = .2 or  Thus the Blackman window requires a higher order ﬁlter to meet the transition band- width speciﬁcation, but it has superior passband ripple and stopband attenuation.    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  The ideal cutoﬀ frequency should be placed in the middle of the transition band. Thus  Fc =  Fp + Fs  2 = 40 Hz  473    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.5 Suppose the windowing method is used to design an mth order lowpass FIR ﬁlter. The  candidate windows include rectangular, Hanning, Hamming, and Blackman.   a  Which window has the smallest transition band?   b  Which window has the smallest passband ripple, Ap?  c  Which window has the largest stopband attenuation, As?  Solution  dB.  dB.   a  From Table 6.3, the rectangular window has the smallest transition band with a normal-  ized transition bandwidth of ˆB = .9 m.   b  From Table 6.3, the Blackman window has the smallest passband ripple with Ap = .002   c  From Table 6.3, the Blackman window has the largest passband attenuation with As = 75  474    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.6 A linear-phase FIR ﬁlter is designed with the windowing method using the Hanning window. The ﬁlter meets its transition bandwidth speciﬁcation of 200 Hz exactly with a ﬁlter of order m = 30.   a  What is the sampling rate, fs?  b  Find the ﬁlter order needed to achieve the same transition bandwidth using the Hamming   c  Find the ﬁlter order needed to achieve the same transition bandwidth using the Blackman  window.  window.  Solution   a  From Table 6.3, the Hanning window has a normalized transition bandwidth of ˆB = 3.1 m. The actual transition bandwidth is B = ˆBfs. Thus 3.1fs m = 200 where m = 30. Solving for fs yields   b  The required normalized transition bandwidth is  Using Table 6.3, the Hamming window has a normalized transition bandwidth of 3.3 m. Thus the required ﬁlter order is   c  Using Table 6.3, the Blackman window has a normalized transition bandwidth of 5.5 m.  Thus the required ﬁlter order is  fs =  200 30   3.1  = 1935.5 Hz  ˆB =  200 fs  = .1033  m = ceil cid:18  3.3 .1033 cid:19   = ceil 31.9355   = 32  m = ceil cid:18  5.5 .1033 cid:19   = ceil 53.2258   = 54  475    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.7 Consider the problem of designing an ideal linear-phase bandstop FIR ﬁlter with the win- dowing method using the Blackman window. Find the coeﬃcients of a ﬁlter of order m = 40 using the following cutoﬀ frequencies.   fs, Fs1, Fs2  =  10, 2, 4  kHz  Solution  From Table 6.1 with m = 40 and p = 20, the bandstop impulse response is  h k  =  2  sin[2π k − p Fs1T ] − sin[2π k − p Fs2T ] sin[2π k − 20 .2] − sin[2π k − 20 .4] sin[.4π k − 20 ] − sin[.8π k − 20 ]  2  ,  =  =  2  k 6= 20  At k = p we have  h 20  = 1 − 2 Fs2 − Fs1 T  = 1 − 2 .4 − .2  = .6  Using  6.2.12  and Table 6.2, the numerator coeﬃcients for a Blackman window are as follows when i 6= 20  bi = w i h i   = .5[.42 − .5 cos πi 20  + .08 cos 2πi 20 ]{sin[.4π i − 20 ] − sin[.8π i− 20 ]}  When i = 20,  b20 = w 20 h 20   = [.42 + .5 + .08].6  = .6  476    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.8 Consider the problem of designing a type 1 linear-phase windowed FIR ﬁlter with the following  desired amplitude response.  Ar f   = cos πf T    ,  0 ≤ f ≤ fs 2  Suppose the ﬁlter order is even with m = 2p. Find the impulse response h k  using a rectangular window. Simplify the expression for h k  as much as possible.  Solution  Using the trigonometric identities from Appendix 2 and  6.2.6   Ar f   cos[2π k − .5m f T ] = cos πf T   cos[2π k − p f T ]  cos[2π k − p + .5 f T ] + cos[2π k − p − .5 f T ]  =  2  Thus from  6.2.6  the desired impulse response is   cid:26  cos[2π k − p + .5 f T ] + cos[2π k − p − .5 f T ] {cos[2π k − p + .5 f T ] + cos[2π k − p − .5 f T ]}df  2   cid:27  df  0  h k  = 2T Z fs 2 = T Z fs 2 = T  cid:26  sin[2π k − p + .5 f T ] 2π k − p + .5 T  0  fs 2  +  sin[2π k − p − .5 f T ]  2π k − p − .5 T  cid:27  cid:12  cid:12  cid:12  cid:12   0  sin[π k − p + .5 ] 2π k − p + .5  sin[π k − p ] cos π 2  + cos[π k − p ] sin π 2   sin[π k − p − .5 ] 2π k − p − .5   +  sin[π k − p − .5 ] 2π k − p + .5  2π k − p − .5  sin[π k − p ] cos π 2  − cos[π k − p ] sin π 2  +  +  2π k − p − .5   =  =  =  =  =  =  cos[π k − p ] 2π k − p + .5  cos[π k − p ] 2π k − p + .5  −  −1 k−p  1  2π  −1 k−p−1  2π[ k − p 2 − .25]   cid:20   k − p + .5 −  cos[π k − p ] 2π k − p − .5  k − p − .5 cid:21  0 ≤ k ≤ 2p  1  ,  477    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.9 Consider the problem of designing a type 1 linear-phase bandpass FIR ﬁlter using the fre- quency sampling method. Suppose the ﬁlter order is m = 60. Find a simpliﬁed expression for the ﬁlter coeﬃcients using the following ideal design speciﬁcations.   fs, Fp1, Fp2  =  1000, 100, 300  Hz  Solution  One can use Example 6.4 as a guide. From the bandpass speciﬁcations, the desired amplitude response is  From  6.3.1 , the ith discrete frequency is fi = ifs N where N = m + 1 = 61. Hence the samples of the desired frequency response are  Ar f   =    0 , 1 , 0 ,  0 ≤ f < .1fs .1fs ≤ f ≤ .3fs .3fs < f ≤ fs 2  Ar fi  =    0 ≤ i < 6 0 , 6 ≤ f ≤ 18 1 , 0 , 18 < f ≤ 30  From  6.3.2 , the ﬁlter coeﬃcients are  bk =  Ar 0  m + 1  +  2  m + 1  ﬂoor m 2   Xi=0  Ar fi  cos cid:20  2πi k − .5m   m + 1   cid:21   =  =  2 61  2 61  30  18  Xi=0 Xi=6   cid:21   61  Ar fi  cos cid:20  2πi k − 30  cos cid:20  2πi k − 30    cid:21   61  ,  0 ≤ k ≤ 60  478    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.10 Consider a type 3 linear-phase FIR ﬁlter of order m = 2p. Find a simpliﬁed expression for  the amplitude response Ar f   similar to  6.4.7 , but for a type 3 linear-phase FIR ﬁlter.  Solution  Starting from  6.4.5 , the frequency response of H z  can be expressed as follows where θ = 2πf T .  H f   = exp −jrθ   bi exp[−j i − r θ]  m  Xi=0  For a type 3 ﬁlter of order m, the odd symmetry constraint is bm−i = −bi. Since m is even for a type 3 ﬁlter, the middle or rth term can be separated out. Euler’s identity from Appendix 2 then can be used to combine the remaining pairs of terms as follows.  H f   = exp −jrθ {br +  r−1  bi exp[−j i − r θ] + bm−i exp[−j m − i − r θ]}  Xi=0 bi{exp[−j i − r θ] − exp[−j m − i − r θ]}  r−1  r−1  = exp −jrθ   = exp −jrθ   Xi=0 Xi=0 Xi=0 Xi=0 = −j2 exp −jrθ  = j exp −jrθ Ar f    = exp −jrθ   r−1  r−1  bi{exp[−j i − r θ] − exp[j i − r − m + 2r θ]}  bi{exp[−j i − r θ] − exp[j i − r θ]}  bi sin[ i − r θ ]  Here br = 0 due to the odd symmetry. Recall that θ = 2πf T . Thus the amplitude response for a type 3 linear-phase ﬁlter is  Ar f   = −2  bi sin[2π i − r f T ]  r−1  Xi=0  479    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.11 Use the results of Problem 6.10 to derive the normal equations for the coeﬃcients of a least- squares type 3 linear-phase ﬁlter. Speciﬁcally, ﬁnd expressions for the coeﬃcient matrix G and the right-hand side vector d, and show how to obtain the ﬁlter coeﬃcients from the solution of the normal equations.  Solution  From  6.4.3  and the results of Problem 6.10, the least-squares objective function is  Jp b  =  w2 i [Ar Fi  − Ad Fi ]2  p  p  Xi=0 Xi=0  r−1  Xk=0  =  w2 i [−2  bi sin[2π k − r FiT ] − Ad Fi ]2  Similar to the derivation in Section 6.4 for a type 1 FIR ﬁlter, let G be the following  p+1 ×r matrix and let d be the following  p + 1  × 1 column vector.  Gik = −2w i  sin[2π k − r FiT ] di = w i Ad Fi   ,  ,  0 ≤ i ≤ p, 0 ≤ k < r 0 ≤ i ≤ p  Then the objective function can be written in vector form as  From  6.4.12 , the coeﬃcient vector b which minimizes Jp b  is then  Jp b  =  Gb − d T  Gb − d   b =  GT G −1GT d  Thus yields {b0, · · · , br−1}. From the odd symmetry condition, bm−i = bi for 0 ≤ i < r and br = 0.  480    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.12 Suppose the equiripple design method is used to construct a highpass ﬁlter to meet the  following speciﬁcations. Estimate the required ﬁlter order.   fs, Fs, Fp  =  100, 20, 30  kHz   Ap, As  =  .2, 32  dB  Solution  Using  5.2.8 , the passband ripple is  Similarly, the stopband attenuation is  The normalized transition bandwidth is  δp = 1 − 10−Ap 20  = 1 − 10−.01 = .0228  δs = 10−As 20  = 10−1.6 = .0251  ˆB = Fp − Fs  fs  10 100  =  = .1  Finally, from  6.5.21  the estimated equiripple ﬁlter order is  m = ceil cid:26 −[10 log10 δpδs  + 13]  + 1 cid:27  = ceil cid:26 −[10 log10{.0228 .0251 } + 13]  14.6 .1   14.6B  + 1 cid:27   = 15  481    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.13 Consider the problem of constructing an equiripple bandstop ﬁlter of order m = 40. Suppose  the design speciﬁcations are as follows.   fs, Fp1, Fs1, Fs2, Fp2  =  200, 20, 30, 50, 60  Hz   δp, δs  =  .05, .03    a  Let r be the number of extremal frequencies in the optimal amplitude response. Find a  range for r.   b  Find the set of speciﬁcation frequencies, F .   c  Find the weighting function w f  .   d  Find the desired amplitude response Ad f  .  e  The amplitude response Ar f   is a polynomial in x. Find x in terms of f , and ﬁnd the  polynomial degree.  Solution   a  From Proposition 6.1, the number of extrema frequencies is at least r = p + 2 where p = m 2. This implies r ≥ 22. For a bandpass or bandstop ﬁlter the maximum number of extremal frequencies is r = p + 5 = 25. Thus the number of extremal frequencies must satisfy:   b  From Table 6.4 and the design speciﬁcations, the set of speciﬁcation frequencies for the  bandstop ﬁlter is   c  From the design speciﬁcations, δs δp = .6. Thus, from  6.5.7 , the weighting function is  22 ≤ r ≤ 25  F = [0, Fp1] ∪ [Fs1, Fs2] ∪ [Fp2, fs 2]  = [0, 20]∪ [30, 50]∪ [60, 100]  w f   =  cid:26  .6 , f ∈ [0, 20] ∪ [50, 100]  f ∈ [30, 50]  1  ,  482    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  The desired amplitude response for the bandstop ﬁlter is   e  From 6.5.5 , Ar f   is a polynomial in x where  Ad f   =    0 ≤ f ≤ 20 1 , 30 ≤ f ≤ 50 0 , 1 , 60 ≤ f ≤ 100  x = cos 2πf T    Since the kth Chebyshev polynomial is of degree k, it follows from  6.5.5  that Ar f   is a polynomial in x of degree p = m 2 = 20.  483    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.14 Consider the problem of constructing an equiripple lowpass ﬁlter of order m = 4 satisfying  the following design speciﬁcations.   fs, Fp, Fs  =  10, 2, 3  Hz   δp, δs  =  .05, .1   Suppose the initial guess for the extremal frequencies is as follows.   F0, F1, F2, F3  =  0, Fp, Fs, fs 2    a  Find the weights w Fi  for 0 ≤ i ≤ 3.  b  Find the desired amplitude response values Ad Fi  for 0 ≤ i ≤ 3.  c  Find the extremal angles θi = 2πFiT for 0 ≤ i ≤ 3.  d  Write down the vector equation that must be solved to ﬁnd the Chebyshev coeﬃcient vector d and the parameter δ. You do not have to solve the equation, just formulate it.  Solution   a  Using  6.5.7 , the weight vector for the lowpass ﬁlter is  w = [w 0 , w Fp , w Fs , w fs 2 ]T  = [δs δp, δs δp, 1, 1]T = [2, 2, 1, 1]T;   b  The desired amplitude response vector for the lowpass ﬁlter is  Ad = [Ad 0 , Ad Fp , Ad Fs , Ad fs 2 ]T  = [1, 1, 0, 0]T   c  The extremal angles θi = 2πFiT are  θ = 2πT [F0, F1, F2, F3]T = 2πT [0, Fp, Fs, fs 2]T = .2π[0, 2, 3, 5]T = π[0, .4, .6, 1]T  484    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  Since m = 4, the vector of unknowns is c = [d0, d1, d2, δ]T . From  6.5.20  the coeﬃcient  matrix is  D =   =   =    1 cos θ0  1 cos θ1  1 cos θ2  1 cos θ3   cos 2θ0  1 W  F0  cos 2θ1  −1 W  F1  1 W  F2  cos 2θ2  cos 2θ3  −1 W  F3      cos 0   cos 0   cos 2πFpT   cos 2πFsT    1 −.5 1 cos 4πFpT   −.5 1 1 cos 4πFsT   1 cos 2πfsT  2  cos 4πfsT  2  −1 1 1 cos .4π  1 cos .6π  cos 1.2π  1  .5 cos .8π  −.5 1 −1  −1  1  1  1        Dc = Ad  The right hand side vector is Ad from part  b , and the equations which must be solved are  485    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.15 Consider the problem of designing a ﬁlter to approximate a diﬀerentiator. Use the frequency sampling method to design a type 3 linear-phase ﬁlter of order m = 40 that approximates a diﬀerentiator, but with a delay m 2 samples. That is, ﬁnd simpliﬁed expressions for the coeﬃcients of a ﬁlter with the following desired amplitude response.  Ar f   = 2πf T  Solution  From  6.3.1 , the ith discrete frequency is fi = ifs N where N = m + 1 = 41. Thus the samples of the desired frequency response are  Ar fi  = 2πfiT  =  =  =  2πi N 2πi  m + 1 2πi 41  ,  ,  0 ≤ i ≤ m 2  0 ≤ i ≤ 20  From  6.3.6 , the ﬁlter coeﬃcients are  Ar fi  sin cid:20  2πi k − .5m   m + 1   cid:21   bk =  −2 m + 1  ﬂoor m 2    cid:21   41  Xi=0 Ar fi  sin cid:20  2πi k − 20  sin cid:20  2πi k − 20   cid:21  i sin cid:20  2πi k − 20   cid:21   2πi 41  41  41  20  20  = −2 41  = −2 41  Xi=0 Xi=0 = −4π Xi=0 1681  20  ,  0 ≤ k ≤ 40  486    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.16 Consider the problem of designing a quadrature ﬁlter with the following frequency response. To simplify the ﬁnal answer, you can assume that the Hilbert transformer component of the quadrature ﬁlter is ideal.  H f   =    5j exp −jπ20f T   −5j exp −jπ20f T    0  , 0 < f < fs 2 , f = 0, ±fs 2 , −fs 2 < f < 0   a  Find the magnitude response A f   and the residual phase response θ f  .   b  Suppose windowed ﬁlters with a Hamming window are used. Find F  z  and G z   Solution   a  Since ±j = exp ±jπ 2 , the frequency response can be rewritten as  H f   =    5 exp −jπ20f T + jπ 2  5 exp −jπ20f T − jπ 2   0  , 0 < f < fs 2 , f = 0, ±fs 2 , −fs 2 < f < 0  Thus the magnitude response is  There is a delay of τ = 10T . Thus the residual phase response is  A f   =  cid:26  5 , 0 < f < fs 2 f = 0, ±fs 2  0 ,  θ f   =    0  , ,  π 2  0 < f < fs 2 f = 0, ±fs 2 −π 2 , −fs 2 < f < 0  Af  z  = A f   cos[]θ f  ]  = 0   b  From  6.7.10   Thus F  z  = 0. Next, from  6.7.11   487    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Since the total group delay is 10T , G z  is a mth order ﬁlter with m = 10. From  6.2.6  the impulse response of G z  is  Ag z  = −A f   sin[θ f  ]  =  cid:26  5 , 0 < f < fs 2 f = 0, ±fs 2  0 ,  Ar f   cos[2π k − .5m f T ]df  0  g k  = 2TZ fs 2 = 2TZ fs 2 = 10T  cid:20  sin[2π k − .5m f T ] −2π .5 mT = −10 sin[π k − .5m ]  0  πm  fs 2   cid:21  cid:12  cid:12  cid:12  cid:12   0  5 cos[2π k − .5m f T ]df  Thus from  6.2.12  and Table 6.2, the coeﬃcients using a Hamming window are  bi = w i g i   =  cid:20 .54 − .46 cos cid:18  πi  .5m cid:19  cid:21  cid:18 −10 sin[π i − .5m ]  πm   cid:19   Finally,  G z  =  biz−i  m  Xi=0  488    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.17 Suppose F  z  and G z  are the following FIR ﬁlters.  F  z  = 1 + 2z−1 + z−2 G z  = 2 + z−1 + 2z−2   a  Show that F  z  and G z  are type 1 linear-phase FIR ﬁlters.   b  Find the amplitude responses Af  f   and Ag f  .  c  Assuming F  z  and G z  are used to construct a quadrature ﬁlter using an ideal Hilbert transformer, ﬁnd the magnitude response Aq f   and the residual phase response θq f  .  Solution  responses are   a  From inspection of F  z  and G z , the order in each case is m = 2, and the impulse  f = [1, 2, 1] g = [2, 1, 2]  Since both f and g exhibit even symmetry about m 2 and m is even, F  z  and G z  are type 1 linear-phase FIR ﬁlters.   b  Proceeding as was done in Example 5.3, let θ = 2πf T . Then  Combining terms with identical coeﬃcients, and using Euler’s identity,  F  f   = F  z z=exp jθ   = 1 + 2 exp −jθ  + exp −j2θ  = exp −jθ [exp jθ  + 2 + exp −jθ ]  F  f   = exp −jθ {[exp jθ  + exp −jθ ] + 2}  = exp −jθ [2 cos θ  + 2] = exp −j2πf T  Af f    Thus  Af  f   = 2[1 + cos 2πf T  ]  489    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Similarly,  Thus  G f   = G z z=exp jθ   = 2 + exp −jθ  + 2 exp −j2θ  = exp −jθ [2 exp jθ  + 1 + 1 exp −jθ ]  Combining terms with identical coeﬃcients, and using Euler’s identity,  G f   = exp −jθ {2[exp jθ  + exp −jθ ] + 1}  = exp −jθ [4 cos θ  + 1] = exp −j2πf T  Ag f     c  From  6.7.15  the quadrature ﬁlter magnitude response is  Ag f   = [1 + 4 cos 2πf T  ]  Aq f   = qA2  f  f   + A2  g f    = p4[1 + cos 2πf T  ]2 + [1 + 4 cos 2πf T  ]2  From  6.7.16 , the quadrature ﬁlter residual phase response is  φq f   = qA2  f  f   + A2  g f    = arctan cid:20 −Ag f   Af  f    cid:21  = arctan cid:26 −[1 + 4 cos 2πf T  ] 2[1 + cos 2πf T ]  cid:27   490    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.18 Consider the following FIR ﬁlter. Find a cascade form realization of this ﬁlter and sketch the  signal ﬂow graph.  H z  =  10 z2 − .6z − .16 [ z − .4 2 + .25]  z4  Expressing H z  as a product of second order factors with real coeﬃcients yields  Solution  where  H z  = b0H1 z H2 z   b0 = 10  H1 z  =  z2 − .6z − .16  = 1 − .6z−1 − .16z−2  z2 − .8z + .41  H2 z  =  = 1 − .8z−1 + .41z−2  z2  z2    ?    ?     491  10 -  x    -  -  -  -  y     z−1  z−1    ?    ?     −.6 -  −.16 -           6  6  z−1  z−1  −.8 -  .41 -           6  6  Problem 6.18 Cascade Form Signal Flow Graph    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.19 Consider the following FIR ﬁlter. Find a lattice form realization of this ﬁlter and sketch the  signal ﬂow graph.  H z  = 1 + 2z−1 + 3z−2 + 4z−3  Solution  Applying step 1 of Algorithm 6.3, H z  = b0A3 z  where b0 = 1 and  A3 z  = 1 + 2z−1 + 3z−2 + 4z−3 B3 z  = 4 + 3z−1 + 2z−2 + z−3  K3 = 4  Applying step 2 with i = 3 yields  A2 z  =  1 + 2z−1 + 3z−2 + 4z−3 − 4 4 + 3z−1 + 2z−2 + z−3   1 − 16  = −15 − 10z−1 − 5z−2  −15  3 + 2z−1 + z−2  =  1 + 2z−1 + 3z−2  3  3  B2 z  =  K2 = 1 3  Next, applying step 2 with i = 2 yields  A1 z  =   3 + 2z−1 + z−2  3 −  1 3  1 + 2z−1 + 3z−2   1 − 4 9   2 3 −  2 3 z−2  =  5 9  = 6 5 +  6 5 −2  B1 z  =  6 5  +  6 5 z−2  K1 = 6 5  492    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus b0 = 1 and the reﬂection coeﬃcient vector is K = [6 5, 1 3, 4]T.  -  x    -  -    @  -  -    @  -  -    @  -  y     u0   ?    v0  u1    cid:0  cid:0  6 5  6 5 @@   v1  @   cid:0   @  cid:0    cid:0  cid:0  cid:18  @@R  -  u2    cid:0  cid:0  1 3  1 3 @@   v2  @   cid:0   @  cid:0    cid:0  cid:0  cid:18  @@R  -  - z−1   cid:0     - z−1   cid:0     - z−1   cid:0     u3    cid:0  cid:0  4  4 @@   v3  @   cid:0   @  cid:0    cid:0  cid:0  cid:18  @@R  -  Problem 6.19 Lattice Form Signal Flow Graph  493    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.20 Find an eﬃcient direct form realization for a linear-phase ﬁlter of order m = 2p similar to   6.8.4 , but applicable to a type 3 ﬁlter. Sketch the signal ﬂow graph for the case m = 4.  Solution  For a type 3 linear-phase FIR ﬁlter the symmetry about k = m 2 is odd with h m − k  = −h k . Thus the equivalent of  6.8.4  for a type 3 linear-phase ﬁlter of order m = 2r is  Notice that the center term is missing because br = 0 due to the odd symmetry.  y k  =  bi[x k − i  − x k − m + i ]  r−1  Xi=0    ?  -  x    z−1 -  z−1 -    ?  6      cid:27  −z−1  ?            cid:27          cid:27      6   cid:27    −z−1  ? b0  ? b1     y   cid:27        cid:27   Problem 6.20 Signal Flow Graph of Type 3 Linear-Phase Filter, m = 4  494    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.21 Suppose a 12-bit ﬁxed point representation is used to represent values in the range −10 ≤  x < 10.   a  How many distinct values of x can be represented?   b  What is the quantization level, or spacing between adjacent values?  Solution   a  Using N = 12 bits, the number of distinct values of x is   b  The range of values for x is −c ≤ x < c where c = 10. Thus from  6.9.3 , the quantization  level, or spacing between adjacent values, is  r = 2N  = 4096  q =  c  2N −1 10  =  2048 = .0049  495    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.22 Consider the system shown in Figure 6.54. The ADC has a precision of 10 bits and an input  range of xa t  ≤ 10. The transfer function of the digital ﬁlter is  H z  =  3z2 − 2z  z2 − 1.2z + .32   a  Find the quantization level of the ADC.   b  Find the average power of the quantization noise at the input x.   c  Find the power gain of H z .   d  Find the average power of the quantization noise at the output y.  xa d - ADC  -x  H z   d y  Figure 6.54 ADC Quantization Noise  Solution   a  For the ADC, xa t  ≤ c where c = 10 and N = 10 bits. Thus from  6.9.3 , the  quantization level is   b  Using  6.9.6 , the average power of the quantization noise at the input x is  q =  =  c  2N −1 10 512  = .0195  σ2 x =  q2 12  .0195 2  12  = = 3.179 × 10−5  496    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  First one must ﬁnd the ﬁlter impulse response. The factored form of H z  is  By the initial value theorem,  H z  =  z 3z − 2    z − .4  z − .8   h 0  = lim z→∞  H z   = 3  The residues of H z zk−1 at the poles of H z  are  Res .4, k  =  z − .4 H z zk−1z=.4  Res .8, k  =  z − .8 H z zk−1z=.8  =   3z − 2 zk   z − .8   cid:12  cid:12  cid:12  cid:12 z=.4  = −.8 .4 k −.4 = 2 .4 k   3z − 2 zk   z − .4   cid:12  cid:12  cid:12  cid:12 z=.8  .4 .8 k  =  =  .4 =  .8 k  Thus the impulse response is  h k  = Z−1{H z }  = h 0 δ k  + [Res .4, k  + Res .8, k ]µ k − 1  = 3δ k  + [2 .4 k +  .8 k]µ k − 1   Using  6.9.11  and the geometric series, the power gain of the ﬁlter H z  is  497    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Γ =  h2 k   ∞  Xk=0  ∞  ∞  ∞  = 9 +  = 9 +  = 9 +  Xk=1 Xk=1 Xk=1 4 .16  1 − .16 .64 + .84 = 12.4809  = 9 +  = 9 +  [2 .4 k +  .8 k]2  4 .4 2k + 2 .4 k .8 k +  .8 2k  4 .16 k + 2 .32 k +  .64 k  +  .64  1 − .64  2 .32  1 − .32 .64 + .36  +  .64 .68  σ2 y = Γσ2 x  = 12.4809 3.179 × 10−5 = .0040   d  Using  6.9.10 , the average power of the quantization noise at the output is  498    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.23 Suppose a 16-bit ﬁxed point representation is used for values in the range x ≤ 8.   a  How many distinct values of x can be represented?   b  What is the quantization level, or spacing between adjacent values?   c  How many bits are used to represent the integer part  including the sign ?   d  How many bits are used to represent the fraction part?  Solution  represented is   a  The number of bits is N = 16. Thus the total number of distinct values that can be   b  Here c = 8. Thus from  6.9.3 , the quantization level is   c  Since c = 8, the scale factor is 2M = c. Thus the number of bits used to represent the  integer part, including the sign, is   d  There are N = 16 bits total. Thus the fractional part requires  r = 2N = 216 = 65536  q =  c  =  2N −1 8 215 = 2−12 = 2.4414 × 10−4  M + 1 = 4  P = N −  M + 1   = 12  499    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.24 Suppose the coeﬃcients of an FIR ﬁlter of order m = 30 all lie within the range bi ≤ 4. Assuming they are quantized to N = 12 bits, ﬁnd an upper bound on the error in the magnitude of in the frequency response caused by coeﬃcient quantization.  Solution  Here c = 4. Thus from  6.9.17 , the following is an upper bound on the error in the magnitude response due to coeﬃcient quantization.   m + 1 c  ∆A f   ≤ =  2N 31 4  212 = .0303  500    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.25 A high-order FIR ﬁlter is realized as a cascade of second-order blocks.   a  Suppose the ﬁlter has a sampling rate of fs = 300 Hz and a zero at z0 = exp jπ 3 .  Find a nonzero periodic signal x k  that gets completely attenuated by the ﬁlter.   b  If a zero of a second-order block starts out on the unit circle, will the radius of the zero change as a result of the coeﬃcient quantization? That is, will the zero still be on the unit circle?   c  If a zero of a second-order block starts out on the unit circle, will the angle of the zero change as a result of the coeﬃcient quantization? That is, will the frequency of the zero change?  Solution   a  Here fs = 300 Hz and z0 = exp jπ 3 . The zero z0 is on the unit circle at  Thus 2f0T = 1 3 or  z0 = exp j2πf0T    = exp jπ 3   f0 =  1 6T  = 50 Hz  The following periodic signal  a pure tone at f0 = 50 Hz  will be completely blocked by the ﬁlter. Here a 6= 0 and ψ are arbitrary.  x k  = a cos 2πf0kT + ψ   = a cos πk 3 + ψ    b  Using second-order blocks and  6.9.18 , the radius of the zero will not change due to  coeﬃcient quantization. Therefore, the zero will still be on the unit circle.   c  Yes, the frequency of the zero of a quantized second-order block will change because the  middle coeﬃcient in  6.9.18  depends on the zero angle θ0.  501    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.26 Consider the following FIR ﬁlter.  H z  =   z2 + 25  z2 + .04   z4   a  Show that this is a type 1 linear-phase ﬁlter.   b  Sketch a signal ﬂow graph realization of H z  that is still a linear-phase system even  when the coeﬃcients are quantized.  Solution   a  The transfer function can be written as  H z  =  z4 + 25.04z2 + 1  z2  = 1 + 25.04z−1 + z−2  Thus the impulse response is h k  = {1, 25.04, 1}. Since m is even and h k  is exhibits even symmetry about k = m 2, it follows from Table 5.1 that this is a type 1 linear-phase ﬁlter.   b  For this ﬁlter, b0 = 1. The zeros are at r = 5, φ = ±π 2 and at their reciprocals. Thus  using  6.9.20  we have  H z  =  .04  1 + 25z−2  25 + z−2   = c0 1 + c1z−1 + c2z−2  c2 + c1z−1 + z−2   Here c = [.04, 0, 25]T.  .04 -  x    -  25 -  -  y     -  0 -  25 -  z−1  z−1    ?    ?              6  6  z−1  z−1    ?    ?     0 -  -           6  6  Problem 6.26 Signal Flow Graph of Linear-Phase Block  502    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.27 Consider the following FIR ﬁlter.  H z  = 3 + 4z−1 + 6z−2 + 4z−3 + 3z−4  Suppose the input signal lies in the range x k  ≤ 10. Find scale factor for the input that ensures that the ﬁlter output will not overﬂow the range y k  ≤ 10.  Solution  Using  6.9.26 , we have  Thus from  6.9.25  the scale factor is  kbk1 =  m  Xi=0  bi  = 3 + 4 + 6 + 4 + 3  = 20  s1 =  1 kbk1 = .05  503    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.28 Use the GUI module g ﬁr to design a windowed lowpass ﬁlter. Set the width of the transition band to B = 150 Hz. For each of the following cases, ﬁnd the lowest value for the ﬁlter order m that meets the speciﬁcations. Plot the linear magnitude response in each case.   a  Rectangular window  b  Hanning window  c  Hamming window  d  Blackman window  Solution  x k  x k  x k  x k   H z  H z  H z  H z   y k  y k  y k  y k   0 0 0 0  0 0 0 0    f   A  1  0.8  0.6  0.4  0.2  0    0  Lowpass windowed filter, rectangular window: m = 20     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.28  a  Magnitude Response Using Rectangular Window  504    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0 0 0 0  0 0 0 0 0    f   A  1  0.8  0.6  0.4  0.2  0    0  0 0 0 0 0 0  0 0 0 0 0 0    f   A  1  0.8  0.6  0.4  0.2  0    0  x k  x k  x k  x k  x k   H z  H z  H z  H z  H z   y k  y k  y k  y k  y k   Lowpass windowed filter, Hanning window: m = 74     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.28  b  Magnitude Response Using Hanning Window  x k  x k  x k  x k  x k  x k   H z  H z  H z  H z  H z  H z   y k  y k  y k  y k  y k  y k   Lowpass windowed filter, Hamming window: m = 72     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.28  c  Magnitude Response Using Hamming Window  505    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k  x k  x k   H z  H z  H z  H z  H z  H z  H z   y k  y k  y k  y k  y k  y k  y k   0 0 0 0 0 0 0  0 0 0 0 0 0 0    f   A  1  0.8  0.6  0.4  0.2  0    0  Lowpass windowed filter, Blackman window: m = 90     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.28  d  Magnitude Response Using Blackman Window  506    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.29 Use the GUI module g ﬁr to construct a windowed highpass ﬁlter using the Hamming   a  Plot the linear magnitude response and use the Caliper option to measure the actual  width of the transition band.   b  Plot the phase response.  c  Plot the impulse response.  window.  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Highpass windowed filter, Hamming window: m = 40     FIR filter Specifications     x,y  =  637.05,0.95   100  200  300  400  600  700  800  900  1000     x,y  =  526.34,0.10   500  f  Hz   Problem 6.29  a  Magnitude Response, Actual B = 637.1 − 536.3 = 110.8 Hz  507    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  4  2  φ  0  −2  −4  0  0 0 0  0 0 0  0.5    k   h  0  x k  x k   H z  H z   y k  y k   Highpass windowed filter, Hamming window: m = 40  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.29  b  Phase Response  Linear Phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Impulse response  Highpass windowed filter, Hamming window: m = 40  −0.5  0  20 k  40  −1  0  Re z   1  2  Problem 6.29  c  Impulse Response    z   m I  2  1  0  −1  −2  −2  508    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.30 Use the GUI module g ﬁr to design a windowed bandstop ﬁlter with the Hanning window to meet the following speciﬁcations. Adjust the ﬁlter order to the lowest value that meets the design speciﬁcations.   fs, Fp1, Fs1, Fs2, Fp2  =  100, 20, 25, 35, 40  Hz   δp, δs  =  .05, .05    a  Plot the magnitude response using the linear scale.  b  Save ﬁlter parameters a, b, and f s in prob6 30.mat. Then use GUI module g ﬁlters to load these as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 6. Plot the linear magnitude responses.  Solution  x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Bandstop windowed filter, Hanning window: m = 112     5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 6.30  a  Windowed Magnitude Response Using Hanning Window  FIR filter Specifications  509    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Direct user−defined filter from file prob6_30b.mat: n=0, m=112, c=1, q=0.03125, e   = 0.125  max     Unquantized Quantized, N = 6  5  10  15  20  30  35  40  45  50  25 f f  s  Problem 6.30  b  Quantized Magnitude Response  510    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.31 Use the GUI module g ﬁr to design a frequency-sampled bandstop ﬁlter to meet the following speciﬁcations. Adjust the ﬁlter order to the lowest value that meets the design speciﬁcations.   fs, Fp1, Fs1, Fs2, Fp2  =  100, 20, 25, 35, 40  Hz   δp, δs  =  .05, .05    a  Plot the magnitude response using the linear scale.  b  Save ﬁlter parameters a, b, and f s in prob6 31.mat. Then use GUI module g ﬁlters to load these as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 6. Plot the linear magnitude responses.  Solution  x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Bandstop frequency−sampled filter: m = 54     5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 6.31  a  Frequency-Sampled Magnitude Response  FIR filter Specifications  511    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Direct user−defined filter from file prob6_31b.mat: n=0, m=54, c=1, q=0.03125, e   = 0.146345  max     Unquantized Quantized, N = 6  5  10  15  20  30  35  40  45  50  25 f f  s  Problem 6.31  b  Quantized Magnitude Response  512    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.32 Write an amplitude response function called prob6 32.m for the following user-deﬁned  ﬁlter  see u ﬁr1.m for an example .  cos πf 2 100   Ar f   =  1 + f 2  ,  0 ≤ f ≤ 10 Hz  Using GUI module g ﬁr, set f s = 20 Hz and select a frequency-sampled ﬁlter. Then use the User-deﬁned option to load this ﬁlter. Plot the following cases.   a  Magnitude response, m = 10  b  Magnitude response, m = 20  c  Magnitude response, m = 40  d  Impulse response, m = 40  Solution  x k   H z   y k   0  0    f   A  1.2  1  0.8  0.6  0.4  0.2  0  −0.2    0  User−defined filter from file prob6_32.m,  frequency−sampled filter: m = 10  FIR filter, m = 10 Ideal amplitude response     1  2  3  4  6  7  8  9  10  5  f  Hz   Problem 6.32  a  Frequency-Sampled Magnitude Response, m = 10  513    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0    f   A  1.2  1  0.8  0.6  0.4  0.2  0  −0.2    0  0 0 0  0 0 0    f   A  1.2  1  0.8  0.6  0.4  0.2  0  −0.2    0  x k  x k   H z  H z   y k  y k   User−defined filter from file prob6_32.m,  frequency−sampled filter: m = 20  FIR filter, m = 20 Ideal amplitude response        1  2  3  4  6  7  8  9  10  5  f  Hz   Problem 6.32  b  Frequency-Sampled Magnitude Response, m = 20  x k  x k  x k   H z  H z  H z   y k  y k  y k   User−defined filter from file prob6_32.m,  frequency−sampled filter: m = 40  FIR filter, m = 40 Ideal amplitude response  1  2  3  4  6  7  8  9  10  5  f  Hz   Problem 6.32  c  Frequency-Sampled Magnitude Response, m = 40  514    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   H z  H z  H z  H z   y k  y k  y k  y k   0 0 0 0  0 0 0 0  0.1  0.05  0  −0.05  −0.1    k   h     Impulse response  User−defined filter from file prob6_32.m,  frequency−sampled filter: m = 40     0  40  20 k  −1  0  Re z   1  2  Problem 6.32  d  Impulse Response, m = 40    z   m I  2  1  0  −1  −2  −2  515    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.33 Use the GUI module g ﬁr to design a least-squares bandpass ﬁlter to meet the follow- ing speciﬁcations. Adjust the ﬁlter order to the lowest value that meets the design speciﬁcations.   fs, Fs1, Fp1, Fp2, Fs2  =  2000, 300, 400, 600, 700  Hz   Ap, As  =  .4, 30  dB   a  Plot the magnitude response using the dB scale.  b  Save ﬁlter parameters a, b, and f s in prob6 33.mat. Then use GUI module g ﬁlters to load these as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 6. Plot the linear magnitude responses.  Solution  x k  x k   H z  H z   y k  y k   0 0  0 0    B d       f   A  0  −20  −40  −60  −80    0  Bandpass least−squares filter: m = 60     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.33  a  Least-Squares Magnitude Response Using dB Scale  516    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Direct user−defined filter from file prob6_33.mat: n=0, m=60, c=1, q=0.03125, e   = 0.0931356  max     Unquantized Quantized, N = 6  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 6.33  b  Quantized Magnitude Response  517    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.34 Use the GUI module g ﬁr and the User-deﬁned option to load the ﬁlter in ﬁle u ﬁr1. Adjust the ﬁlter order to m = 90. Plot the linear magnitude response for each of the following cases.   a  Windowed ﬁlter with Blackman window  b  Least-squares ﬁlter  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  User−defined filter from file u_fir1.m,  windowed filter, Blackman window: m = 90  FIR filter, m = 90 Ideal amplitude response     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.34  a  Windowed Magnitude Response Using Blackman Window  518    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  User−defined filter from file u_fir1.m,  least−squares filter: m = 90  FIR filter, m = 90 Ideal amplitude response     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.34  b  Least-Squares Magnitude Response  519    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.35 Write an amplitude response function called prob6 35.m for the following user-deﬁned  ﬁlter  see u ﬁr1 for an example .  Ar f   = 2 cid:12  cid:12  cid:12  cid:12   fs  cid:19  cid:12  cid:12  cid:12  cid:12  cos cid:18  2πf  Then use the User-deﬁned option of GUI module g ﬁr to load this ﬁlter. Select a least- squares ﬁlter. Plot the linear magnitude response for the following three cases.  x k   H z   y k    a  m = 10  b  m = 20  c  m = 40  Solution  0  0  2  1.5    f   A  1  0.5  0    0  User−defined filter from file prob6_35.m,  least−squares filter: m = 10  FIR filter, m = 10 Ideal amplitude response     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.35  a  Least-Squares Magnitude Response, m = 10  520    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.         0 0  0 0    f   A  2.5  1.5  2  1  0.5  0    0  0 0 0  0 0 0  2  1.5    f   A  1  0.5  0    0  x k  x k   H z  H z   y k  y k   User−defined filter from file prob6_35.m,  least−squares filter: m = 20  FIR filter, m = 20 Ideal amplitude response  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.35  b  Least-Squares Magnitude Response, m = 20  x k  x k  x k   H z  H z  H z   y k  y k  y k   User−defined filter from file prob6_35.m,  least−squares filter: m = 40  FIR filter, m = 40 Ideal amplitude response  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.35  c  Least-Squares Magnitude Response, m = 40  521    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.36 Use the GUI module g ﬁr to design an optimal equiripple bandpass ﬁlter to meet the following speciﬁcations. Adjust the ﬁlter order to the lowest value that meets the design speciﬁcations.   fs, Fs1, Fp1, Fp2, Fs2  =  2000, 300, 400, 600, 700  Hz   Ap, As  =  .4, 30  dB   a  Plot the magnitude response using the dB scale.  b  Save ﬁlter parameters in prob6 36. Then use GUI module g ﬁlters to load these as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 6. Plot the linear magnitude responses.  Solution  x k   H z   y k   0  0    B d       f   A  0  −20  −40  −60  −80    0  Bandpass equiripple filter: m = 40     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.36  a  Equiripple Magnitude Response Using dB Scale  522    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  Direct user−defined filter from file prob6_36b.mat: n=0, m=40, c=1, q=0.03125, e   = 0.0887215  max     Unquantized Quantized, N = 6  100  200  300  400  600  700  800  900  1000  500 f f  s  Problem 6.36  b  Quantized Magnitude Response  523    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.37 Write an amplitude response and residual phase response function called prob6 37.m  for the following user-deﬁned ﬁlter  see u ﬁr1 for an example .  Ar f   = 10f  f s  θ f   = π sin 20f  f s   Set the ﬁlter order to m = 150, and select the quadrature ﬁlter. Use the User-deﬁned option of GUI module g ﬁr to load this ﬁlter.  a  Print your amplitude response and residual phase response functions.  b  Plot the linear magnitude response  c  Plot the phase response  Solution   a  function [A,theta] = prob6_37  f,fs   A = 10*f fs; theta = pi*sin 20*f fs ;  x k   H z   y k   0  0  5  4  3  2  1  0    0    f   A  User−defined filter from file prob6_37.m,  quadrature filter: m = 300     FIR filter, m = 300 Ideal amplitude response  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.37  b  Linear Magnitude Response, m = 150  524    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0  4  2  θ  0  −2  −4    0  User−defined filter from file prob6_37.m,  quadrature filter: m = 300     Residual phase, θ Total phase, φ  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.37  c  Phase Response, m = 150  525    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.38 Write an amplitude response and residual phase response function called prob6 38.m  for the following user-deﬁned ﬁlter  see u ﬁr1 for an example .  Ar f   = .5{1 + sgn[sin 8πf T  ]} θ f   = 0  Set δs = .001 and m = 120. Then use the User-deﬁned option of GUI module g ﬁr to load this ﬁlter. Plot the following.  a  The linear magnitude response of a least-squares ﬁlter.  b  The pole-zero pattern of a least-squares ﬁlter.  c  The linear magnitude response of a quadrature ﬁlter.  d  The pole-zero pattern of a quadrature ﬁlter.  Solution  x k   H z   y k   0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  User−defined filter from file prob6_38.m,  frequency−sampled filter: m = 120  FIR filter, m = 120 Ideal amplitude response     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.38  a  Least-squares Filter Magnitude Response  526    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   H z  H z   y k  y k   0 0  0 0  User−defined filter from file prob6_38.m,  frequency−sampled filter: m = 120  Impulse response  0.5     2  1  0  −1    z   m I    k   h  0     −2  −2  −1  0  Re z   1  2  −0.5  0  50  k  100  Problem 6.38  b  Least-squares Filter Pole-zero Pattern  x k  x k  x k   H z  H z  H z   y k  y k  y k   0 0 0  0 0 0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  User−defined filter from file prob6_38.m, : m = 240  FIR filter, m = 240 Ideal amplitude response     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 6.38  c  Quadrature Filter Magnitude Response  527    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   H z  H z  H z  H z   y k  y k  y k  y k   0 0 0 0  0 0 0 0       z   m I  3  2  1  0  −1  −2  −3  User−defined filter from file prob6_38.m, : m = 240  Impulse response     −2  0  Re z   2  0  50  100  150  200  250  k  Problem 6.38  d  Quadrature Filter Pole-zero Pattern    k   h  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  528    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.39 Write a MATLAB program that constructs the following signal where fs = 200 Hz. Here v k  is white noise uniformly distributed over [−1, 1], F1 = 10 Hz, F2 = 30 Hz, and N = 4096. Use a random number generator seed of 100 to produce v k .  x k  = 4 sin 2πF1kT   cos 2πF2kT  ,  y k  = x k  + v k   0 ≤ k < N 0 ≤ k < N  ,   a  Compute Px and Pv directly from the samples. Use Deﬁnition 6.1.1 to compute  and print the signal-to-noise ratio of y k .   b  Compute Py directly from the samples. Use Pv,  6.1.1 , and Deﬁnition 6.1.1 to  compute and print the signal-to-noise ratio of y k .   c  Compute and print the percent error of the estimate of the SNR found in part   b  relative to the SNR found in part  a .   d  Plot the magnitude spectrum of y k  showing the signal and the noise.  Solution  % Problem 6.39  % Initialize  f_header ’Problem 6.39’  fs = 200; T = 1 fs; rand ’seed’,100 ;  % Construct signal  c = f_prompt  ’Enter amplitude of noise’,0,1,1 ; N = 4096; v = f_randu  1,N,-c,c ; k = 0 : N-1; F_1 = 10; F_2 = 30; x = 4*sin 2*pi*F_1*k*T  .* cos 2*pi*F_2*k*T ; y = x + v;  % Compute direct SNR  P_v1 =  1 N *sum v.^2  P_x1 =  1 N *sum x.^2  SNR_1 = 10*log10 P_x1 P_v1   % Compute indirect SNR and percent error  P_y2 =  1 N *sum y.^2   529    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   P_x2 = P_y2 - P_v1 SNR_2 = 10*log10 P_x2 P_v1  E = 100* SNR_2 - SNR_1  SNR_1  % Compute and plot magnitude spectrum  figure [A_y,phi,S,f] = f_spec  y,N,fs ; i = 1 : N 2; plot  f i ,A_y i   f_labels  ’Magnitude Spectrum’,’f  Hz ’,’A_y f ’  f_wait   a  P_v1 =   b  P_y2 =  .3277  P_x1 =  3.9990  SNR_1 =  10.8648  4.2841  P_x2 =  3.9564  SNR_2 =  10.8183   c  E =  -0.4279  530    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Spectrum    f    A  y  4000  3500  3000  2500  2000  1500  1000  500  0  0  20  40  60  80  100  f  Hz   Problem 6.39 Magnitude Spectrum of Noise-Corrupted Signal  531    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.40 Write a MATLAB program that uses f ﬁrideal to design a linear-phase lowpass FIR ﬁlter of order m = 40 with passband cutoﬀ frequency Fp = fs 5 and stopband cutoﬀ frequency Fs = fs 4 where the sampling frequency is fs = 100 Hz. Use a rectangular window, and set the ideal cutoﬀ frequency to the middle of the transition band. Use f freqz to compute and plot the magnitude response using the linear scale. Then use Table 6.3, the hold on command, and the ﬁll function to add the following items to your magnitude response plot.  a  A shaded area showing the passband ripple, δp.  b  A shaded area showing the stopband attenuation, δs.  Solution  % Problem 6.40  % Initialize  f_header ’Problem 6.40’  fs = 100; F_p = fs 5 F_s = fs 4  % Design filter  f_type = 0; F_c =  F_p + F_s  2 m = 40; win = b = f_firideal  f_type,F_c,m,fs,win ;  0;  % Compute and plot magnitude response  a = 1; N = 250; [H,f] = f_freqz  b,a,N,fs ; A = abs H ; figure plot  f,A ; f_labels  ’Windowed Lowpass Filter, Rectangular Window’,’f  Hz ’,’A f ’   % Add specifications  hold on delta_p = 0.0819 delta_s = 0.0819 fill  [0 F_p F_p 0],[1-delta_p,1-delta_p, 1+delta_p, 1+delta_p],’c’  fill  [F_s fs 2 fs 2 F_s],[0 0 delta_s delta_s],’c’  plot f,A  f_wait  532    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Windowed Lowpass Filter, Rectangular Window  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0  0  10  20  30  40  50  f  Hz   Problem 6.40 Windowed Lowpass Filter Using Rectangular Window  533    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.41 Write a MATLAB program that uses f ﬁrideal to design a linear-phase highpass FIR ﬁlter of order m = 30 with stopband cutoﬀ frequency Fs = 20 Hz, passband cutoﬀ frequency Fp = 30 and sampling frequency fs = 100 Hz. Use a Hanning window, and set the ideal cutoﬀ frequency to the middle of the transition band.   a  Use f freqz to compute and plot the magnitude response using the dB scale.  b  Use Table 6.3, the hold on command, and the ﬁll function to add a shaded area  showing the predicted stopband attenuation, As.  Solution  % Problem 6.41  % Initialize  f_header ’Problem 6.41’  fs = 100; F_s = 20; F_p = 30;  % Design filter  f_type = 1; F_c =  F_p + F_s  2 m = 30; win = 1; b = f_firideal  f_type,F_c,m,fs,win ;  % Compute and plot magnitude response  a = 1; N = 250; [H,f] = f_freqz  b,a,N,fs ; A = 20*log10 abs H  ; figure plot  f,A ; f_labels  ’Windowed Highpass Filter, Hanning Window’,’f  Hz ’,’A f   dB ’   % Add specifications  hold on A_s = 44; ylim = get  gca,’Ylim’ ; fill  [0 F_s F_s 0],[ylim 1 ,ylim 1 ,-A_s,-A_s],’c’  plot  f,A ; f_wait  534    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Windowed Highpass Filter, Hanning Window    B d       f   A  20  0  −20  −40  −60  −80  −100  −120  0  10  20  30  40  50  f  Hz   Problem 6.41 Windowed Highpass Filter Using Hanning Window  535    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.42 Write a MATLAB program that uses f ﬁrideal to design a linear-phase highpass FIR ﬁlter of order m = 40 with stopband cutoﬀ frequency Fs = 20 Hz, passband cutoﬀ frequency Fp = 30 and sampling frequency fs = 100 Hz. Use a Hamming window, and set the ideal cutoﬀ frequency to the middle of the transition band.   a  Use f freqz to compute and plot the magnitude response using the dB scale.  b  Use Table 6.3, the hold on command, and the ﬁll function to add a shaded area  showing the predicted stopband attenuation, As.  Solution  function prob6_42  % Initialize  f_header ’Problem 6.42’  fs = 100; F_s = 20; F_p = 30;  % Design filter  f_type = 1; F_c =  F_p + F_s  2 m = 40; win = 2; b = f_firideal  f_type,F_c,m,fs,win ;  % Compute and plot magnitude response  a = 1; N = 250; [H,f] = f_freqz  b,a,N,fs ; A = 20*log10 abs H  ; figure plot  f,A ; f_labels  ’Windowed Highpass Filter, Hamming Window’,’f  Hz ’,’A f   dB ’   % Add specifications  hold on A_s = 53; ylim = get  gca,’Ylim’ ; fill  [0 F_s F_s 0],[ylim 1 ,ylim 1 ,-A_s,-A_s],’c’  plot  f,A ; f_wait  536    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Windowed Highpass Filter, Hamming Window    B d       f   A  10  0  −10  −20  −30  −40  −50  −60  −70  −80  −90  0  10  20  30  40  50  f  Hz   Problem 6.42 Windowed Highpass Filter Using Hamming Window  537    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.43 Write a MATLAB program that uses f ﬁrwin to design a linear-phase highpass FIR ﬁlter of order m = 60 with stopband cutoﬀ frequency Fs = 20 Hz, passband cutoﬀ frequency Fp = 30 and sampling frequency fs = 100 Hz. Use a Blackman window, and make the desired amplitude response piecewise-constant with cutoﬀ Fc =  Fs + Fp  2.  a  Use f freqz to compute and plot the magnitude response using the dB scale.  b  Use Table 6.3, the hold on command, and the ﬁll function to add a shaded area  showing the predicted stopband attenuation, As.  Solution  function prob6_43  % Initialize  f_header ’Problem 6.43’  fs = 100; F_s = 20; F_p = 30;  % Design filter  m = 60; win = 3; sym = 0; p =  F_s + F_p  2; b = f_firwin  @highpass,m,fs,win,sym,p ;  % Compute and plot magnitude response  a = 1; N = 250; [H,f] = f_freqz  b,a,N,fs ; A = 20*log10 abs H  ; figure plot  f,A ; f_labels  ’Windowed Highpass Filter, Blackman Window’,’f  Hz ’,’A f   dB ’   % Add specifications  hold on A_s = 75; ylim = get  gca,’Ylim’ ; fill  [0 F_s F_s 0],[ylim 1 ,ylim 1 ,-A_s,-A_s],’c’  plot  f,A ; f_wait  function A = highpass  f,fs,p  % Piecewise-constant highpass amplitude response  538    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   A = zeros size f  ; for i = 1 : length f  if  f i  >= p 1    A i  = 1;  end  end  Windowed Highpass Filter, Blackman Window    B d       f   A  20  0  −20  −40  −60  −80  −100  −120  −140  0  10  20  30  40  50  f  Hz   Problem 6.43 Windowed Highpass Filter Using Blackman Window  539    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.44 Write a MATLAB program that uses f ﬁrwin to design a type 1 linear-phase FIR ﬁlter of order m = 80 using fs = 1000 Hz and the Hamming window to approximate the following amplitude response. Use f freqz to compute the magnitude response.  Ar f   =    250 cid:19 2  cid:18  f  .5 cos cid:20  π f − 250   500  ,  0 ≤ f < 250  cid:21  , 250 ≤ f < 500   a  Plot the linear magnitude response.  b  On the same graph, add the desired magnitude response and a legend.  Solution  function prob6_44  % Initialize  f_header ’Problem 6.44’  fs = 1000;  % Design filter  m = 80; win = 2; sym = 0; b = f_firwin  @fmag,m,fs,win,sym ;  % Compute and plot magnitude and phase responses  a = 1; N = 250; [H,f] = f_freqz  b,a,N,fs ; A1 = abs H ; A2 = abs fmag f,fs  ; figure h = plot  f,A1,f,A2 ; set  h 2 ,’LineWidth’,1.5  f_labels  ’Windowed Filter, Hamming Window’,’f  Hz ’,’A f ’  legend  ’Hamming Window’,’Desired Response’  f_wait  function A = fmag  f,fs   % Desired amplitude response  A = zeros size f  ;  540    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   for i = 1 : length f  if  f i  <= fs 4   A i  =  4*f i  fs ^2;  A i  = 0.5*cos 2*pi* f i  - fs 4  fs ;  Windowed Filter, Hamming Window     Hamming Window Desired Response  else  end  end    f   A  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0    0  100  200  300  400  500  f  Hz   Problem 6.44 Windowed Filter Using Hamming Window, m = 80  541    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 6.45 Write a MATLAB program that uses function f ﬁrsamp to design a linear-phase bandpass FIR ﬁlter of order m = 40 using the frequency sampling method. Use a sampling frequency of fs = 200 Hz, and a passband of Fp = [20, 60] Hz. Use f freqz to compute and plot the linear magnitude response. Add the frequency samples using a separate plot symbol and a legend. Do the following cases.  a  No transition band samples  ideal amplitude response   b  One transition band sample of amplitude .5 on each side of the passband.  % Construct samples of amplitude response  Solution  % Problem 6.45  % Initialize  f_header ’Problem 6.45’  fs = 200; F_p = [20,60]; m = 40;  N = m+1; i = 0 : m 2; fi = i*fs N; m1 =  F_p 1  fs *m+1; m2 =  F_p 2  fs *m+1; Ai = zeros size i  ; for k = m1 : m2  Ai k  = 1;  end  % Design filter  sym = 0; b = f_firsamp  Ai,m,fs,sym ; a = 1; p = 256; [H,f] = f_freqz  b,a,p,fs ; A1 = abs H ; figure plot  f,A1,fi,Ai,’r.’ ; f_labels  ’Magnitude Response’,’f f_s’,’A f ’  legend  ’Filter’,’Frequency Samples’  f_wait  % Add transition band samples  Ai m1-1  = 0.5; Ai m2+1  = 0.5;  542    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   b = f_firsamp Ai,m,fs,sym ; [H,f] = f_freqz  b,a,p,fs ; A2 = abs H ; figure plot  f,A2,fi,Ai,’r.’ ; f_labels  ’Magnitude Response with Transition Band Samples’,’f f_s’,’A f ’  legend  ’Filter’,’Frequency Samples’  f_wait  Magnitude Response     Filter Frequency Samples    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  20  40  60  80  100  f f  s  Problem 6.45  a  Frequency-Sampled Bandpass Filter, No Transition Band Samples  543    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response with Transition Band Samples     Filter Frequency Samples  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  20  40  60  80  100  f f  s  Problem 6.45  b  Frequency-Sampled Bandpass Filter, Transition Band Samples  544    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.46 Write a MATLAB program that uses function f ﬁrsamp to design a linear-phase bandstop FIR ﬁlter of order m = 60 using the frequency sampling method. Use a sampling frequency of fs = 20 kHz, and a stopband of Fs = [3, 8] kHz. Use f freqz to compute and plot the linear magnitude response. Add the frequency samples using a separate plot symbol and a legend. Do the following cases.  a  No transition band samples  ideal amplitude response   b  One transition band sample of amplitude .5 on each side of the stopband.  % Construct samples of amplitude response  Solution  % Problem 6.46  % Initialize  f_header ’Problem 6.46’  fs = 20000; F_s = [3000, 8000]; m = 60;  N = m+1; i = 0 : m 2; fi = i*fs N; m1 =  F_s 1  fs *m+1; m2 =  F_s 2  fs *m+1; Ai = ones size i  ; for k = m1 : m2  Ai k  = 0;  end  % Design filter  sym = 0; b = f_firsamp  Ai,m,fs,sym ; a = 1; p = 256; [H,f] = f_freqz  b,a,p,fs ; A1 = abs H ; figure plot  f,A1,fi,Ai,’r.’ ; f_labels  ’Magnitude Response’,’f f_s’,’A f ’  legend  ’Filter’,’Frequency Samples’  f_wait  % Add transition band samples  Ai m1-1  = 0.5; Ai m2+1  = 0.5;  545    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   b = f_firsamp Ai,m,fs,sym ; [H,f] = f_freqz  b,a,p,fs ; A2 = abs H ; figure plot  f,A2,fi,Ai,’r.’ ; f_labels  ’Magnitude Response with Transition Band Samples’,’f f_s’,’A f ’  legend  ’Filter’,’Frequency Samples’  f_wait  Magnitude Response     Filter Frequency Samples    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  2000  4000  6000  8000  10000  f f  s  Problem 6.46  a  Frequency-Sampled Bandstop Filter, No Transition Band Samples  546    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Magnitude Response with Transition Band Samples     Filter Frequency Samples  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  2000  4000  6000  8000  10000  f f  s  Problem 6.46  b  Frequency-Sampled Bandstop Filter, Transition Band Samples  547    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.47 Write a MATLAB program that uses function f ﬁrls to design a least-squares linear- phase FIR ﬁlter of order m = 30 with sampling frequency fs = 400 and the following amplitude response.  Ar f   =    f 100 200 − f 100  ,  0 ≤ f < 100 , 100 ≤ f ≤ 200  Select 2m equally spaced discrete frequencies, and use uniform weighting. Use f freqz to compute and plot both magnitude response  ideal and actual  on the same graph.  Solution  function prob6_47  % Initialize  f_header ’Problem 6.47’  fs = 400; m = 20;  p = 3*m; i = 0 : p; F = i*fs  2*p ; A = fmag F,fs ; w = ones size i  ;  % Find least squares filter  b = f_firls  F,A,m,fs ;  % Compute desired amplitude response  % Compute and display magnitude responses  N = 250; [H,f] = f_freqz  b,1,N,fs ; figure h = plot F,A,f,abs H  ; set  h 1 ,’LineWidth’,1.5  f_labels  ’Least-Squares Filter’,’f f_s’,’A f ’  legend  ’Ideal’,’LS Filter’  f_wait  function A = fmag  f,fs   % Desired amplitude response  548    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   A = zeros size f  ; for i = 1 : length f  if  f i  <= fs 4   A i  = 4*f i  fs;  else  end  end  A i  = 4* fs 2 - f i   fs;  Least−Squares Filter     Ideal LS Fitler  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1    f   A  0    0  50  100 f f  s  150  200  Problem 6.47 Least-Squares Filter, m = 20  549    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.48 The Chebyshev polynomials have several interesting properties. Write a MATLAB program that uses the FDSP toolbox function f chebpoly and the subplot command to construct a 2×2 array of plots of the Chebyshev polynomials, Tk x  for 1 ≤ k ≤ 4. Use the plot range, −1 ≤ x ≤ 1. Using induction and your observations of the plots, list as many general properties of Tk x  as you can. Use the help command for instructions on how to use f chebpoly.  Solution  % Problem 6.48  % Initialize  f_header ’Problem 6.48’  N = 101; x = linspace  -1,1,N ; T = zeros size x  ; m = 2;  figure for k = 1 : m  for i = 1 : m  p = m* k-1 + i; subplot  m,m,p ; for j = 1 : N  % Construct 2 by 2 array of plots  T j  = f_chebpoly  x j ,p-1,1 ;  end plot  x,T  ylabel = sprintf  ’T_%d x ’,p-1 ; f_labels  ’’,’x’,ylabel ;  end  end f_wait  % List properties  fprintf  ’Chebyshev polynomial properties:\n\n’  fprintf  ’1. T_k x  <= 1 for x <= 1\n\n’  fprintf  ’2. T_k 1  = 1\n\n’  fprintf  ’3. T_k -1  =  -1 ^k\n\n’  fprintf  ’4. T_k x  has k+1 extrema in [-1,1]\n\n’  fprintf  ’5. T_k x  is of degree k\n\n’   Chebyshev polynomial properties:  1. T_k x  <= 1 for x <= 1  550    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   2. T_k 1  = 1  3. T_k -1  =  -1 ^k  4. T_k x  has k+1 extrema in [-1,1]  5. T_k x  is of degree k  1.5  2  1  0.5    x    T  0  0.5  1  0  −0.5    x    T  2  0 x  0 x  0 −1  −0.5  0.5  1  −1  −1  −0.5  0.5  1  −1  −1  −0.5  0.5  1  −1  −1  −0.5  0.5  1  Problem 6.48 Chebyshev Polynomials of the First Kind  0 x  0 x  0.5  1  0  −0.5  0.5  1  0  −0.5    x    T  1    x    T  3  551    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.49 Write a MATLAB function called u ﬁrorder which estimates the order of an equirip- ple ﬁlter required to meet given design speciﬁcations using  6.5.21 . The calling sequence for u ﬁrorder should be as follows.  m = u_firorder  deltap,deltas,Bhat ;  deltap = passband ripple deltas = stopband attenuation Bhat  % U_FIRORDER: Estimate required order for FIR equiripple filter % % Usage: % % Pre: % % % % Post: % Test your function by plotting a family of curves on one graph. For the kth curve use deltap = deltas = δ where δ = .03k for 1 ≤ k ≤ 3. Plot m versus Bhat for .01 ≤ Bhat ≤ .1 and include a legend. Solution  m = estimated FIR equiripple order  = normalized transition bandwidth  function prob6_49  % Initialize  f_header ’Problem 6.49’  N = 3; p = 100; m = zeros N,p ; B_hat = linspace  0.01,0.1,p ;  % Compute filter order  for k = 1 : N  delta = 0.03*k; m k,:  = u_firorder  delta,delta,B_hat ;  end  % Display results  figure plot  B_hat,m 1,: ,’-’,B_hat,m 2,: ,’:’,B_hat,m 3,: ,’--’  legend  ’\delta = 0.03’,... ’\delta = 0.06’,... ’\delta = 0.09’ ;  axis [0 0.12 0 150]  f_labels ’Equiripple Filter Order’,’B f_s’,’m’  f_wait  function m = u_firorder  deltap,deltas,Bhat  % U_FIRORDER: Estimate required order for FIR equiripple filter  552    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   m = u_firorder  deltap,deltas,Bhat ;  % % Usage: % % Pre: % % % % Post: % r =  10*log10 deltap*deltas  + 13  .   14.6*Bhat ; m = ceil -r + 1 ;  deltap = passband ripple deltas = stopband attenuation Bhat  m = estimated FIR equiripple order  = normalized transition bandwidth  Equiripple Filter Order     δ = 0.03 δ = 0.06 δ = 0.09  150  100  m  50  0    0  0.02  0.04  0.08  0.1  0.12  0.06 B f  s  Problem 6.49 Equiripple FIR Filter Order with δp = δs = δ  553    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.50 Write a MATLAB program that uses the function f ﬁrparks to design an equiripple lowpass ﬁlter to meet the following design speciﬁcations where fs = 4000 Hz. Find the lowest order ﬁlter that meets the speciﬁcations.   Fp, Fs  =  1200, 1400  Hz  δp, δs  =  .03, .04    a  Print the minimum ﬁlter order and the estimated order based on  6.5.21 .  b  Plot the linear magnitude response.  c  Use ﬁll to add shaded areas to the plot showing the design speciﬁcations.  Solution  % Problem 6.50  % Initialize  f_header ’Problem 6.50’  fs = 4000; F_p = 1200; F_s = 1400; delta_p = 0.03; delta_s = 0.04;  % Construct equiripple filter  f_type = 0; m1 = f_prompt  ’Enter filter order’,0,50,25 ; [b,m2] = f_firparks  m1,F_p,F_s,delta_p,delta_s,f_type,fs ; fprintf  ’\nMinimum Order = %d\n’,m1  fprintf  ’\nEstimated Order = %d\n’,m2   % Plot magnitude response  p = 256; a = 1; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A ; f_labels  ’Magnitude Response’,’f  Hz ’,’A f ’   % Add specifications  hold on fill  [0 F_p F_p 0],[1-delta_p,1-delta_p,1+delta_p,1+delta_p],’c’   554    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   fill  [F_s fs 2 fs 2 F_s],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  Minimum Order = 25  Estimated Order = 24  Magnitude Response  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0  0  500  1000  f  Hz   1500  2000  Problem 6.50 Equiripple Lowpass Filter  555    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.51 Write a MATLAB program that uses the function f ﬁrparks to design an equiripple highpass ﬁlter to meet the following design speciﬁcations where fs = 300 Hz. Find the lowest order ﬁlter that meets the speciﬁcations.   Fs, Fp  =  90, 110  Hz  δp, δs  =  .02, .03    a  Print the minimum ﬁlter order and the estimated order based on  6.5.21 .  b  Plot the linear magnitude response.  c  Use ﬁll to add shaded areas to the plot showing the design speciﬁcations.  Solution  % Problem 6.51  % Initialize  f_header ’Problem 6.51’  fs = 300; F_s = 90; F_p = 110; delta_p = 0.02; delta_s = 0.03;  % Construct equiripple filter  f_type = 1; m1 = f_prompt  ’Enter filter order’,0,50,21 ; [b,m2] = f_firparks  m1,F_p,F_s,delta_p,delta_s,f_type,fs ; fprintf  ’\nMinimum Order = %d\n’,m1  fprintf  ’\nEstimated Order = %d\n’,m2   % Plot magnitude response  p = 256; a = 1; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A ; f_labels  ’Magnitude Response’,’f  Hz ’,’A f ’   % Add specifications  hold on fill  [0 F_s F_s 0],[0 0 delta_s delta_s],’c’   556    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   fill  [F_p fs 2 fs 2 F_p],[1-delta_p,1-delta_p,1+delta_p,1+delta_p],’c’  plot  f,A  f_wait  Magnitude Response  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0  0  50  100  150  f  Hz   Problem 6.51 Equiripple Highpass Filter  557    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.52 Write a MATLAB program that uses the function f hilbert to compute a Hilbert trans-  former ﬁlter using a Blackman window. Do the following cases.   a  Use f freqz to compute and plot the magnitude responses for m = 40 and m = 80 on the same graph. Also show the ideal magnitude response and add a legend. Specify the ﬁlter type in the title.   b  Use f freqz to compute and plot the magnitude responses for m = 41 and m = 81 on the same graph. Also show the ideal magnitude response and add a legend. Specify the ﬁlter type in the title.  Solution  function prob6_52  % Initialize  f_header ’Problem 6.52’  fs = 1; T = 1 fs; %sym = 1; win = 3; a = 1; p = 500; m1 = 40; m2 = 80;  %  a   b1 = f_hilbert m1,win ; b2 = f_hilbert m2,win ; [H1,f] = f_freqz  b1,a,p,fs ; [H2,f] = f_freqz  b2,a,p,fs ; A1 = abs H1 ; A2 = abs H2 ; figure h = plot  [0 .5],[1 1],’k’,f,A1,f,A2 ; set  h 2 ,’LineWidth’,1.5  f_labels  ’Type 3 Magnitude responses’,’{f f_s}’,’{A f }’  legend  ’Ideal’,’m = 40’,’m = 80’  f_wait  %  b  and  c   b1 = f_hilbert m1+1,win ; b2 = f_hilbert m2+1,win ; [H1,f] = f_freqz  b1,a,p,fs ; [H2,f] = f_freqz  b2,a,p,fs ; A1 = abs H1 ; A2 = abs H2 ;  558    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   figure h = plot  [0 .5],[1 1],’k’,f,A1,f,A2 ; set  h 2 ,’LineWidth’,1.5  f_labels  ’Type 4 Magnitude responses’,’{f f_s}’,’{A f }’  legend  ’Ideal’,’m = 41’,’m = 81’  f_wait  Type 3 Magnitude responses     Ideal m = 40 m = 80  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 6.52  a  Type 3 Magnitude Responses  559    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  Type 4 Magnitude responses     Ideal m = 41 m = 81  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 6.52  b  Type 4 Magnitude Responses  560    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.53 Using function f ﬁrquad and example 6.14 as a starting point, write MATLAB program that designs an equalizer for a system H z  with the following magnitude and phase responses. Use ﬁlters of order m = 160, δs = .001 and the Hamming window.  Ad f   = exp[− f T − .25 2 .01] φd f   = −10π f T  2 + sin 5πf T     a  Print the optimal delay τ , and the total delay τq of the equalizer.  b  Print a 3× 1 array of plots showing the magnitude responses of the original system,  the equalizer, and the equalized system similar to Figure 6.29.   c  Print a 3 × 1 array of plots showing the residual phase responses of the original  system, the equalizer, and the equalized system similar to Figure 6.30.   d  Plot the impulse response of the equalizer ﬁlter.  Solution   a   function prob6_53  % Initialize  f_header ’Problem 6.53’  fs = 1; T = 1 fs;  % Find optimal delay  N = 300; f = linspace 0,fs 2,N+1 ’; [A0,phi0] = fsys0 f,fs ; tau =  -1  2*pi  * phi0’*f   f’*f  M = round tau T ; tau_q = M*T q = M;  % Design filter  m = f_prompt ’Enter filter order’,2,250,160 ; win = f_prompt ’Enter window type  0=rectangular,1=Hanning,2=Hamming,3=Blackman’,0,3,2 ; deltas = .01; b = f_firquad @fsys,m,fs,win,deltas,q ;  % Compare magnitude responses  figure  % Original  561    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   subplot 3,1,1  hd = plot f,A0,’LineWidth’,1.5 ; f_labels ’ a  Original System’,’’,’{A_0 f }’   [Hq,fq] = f_freqz b,1,N,fs ; Aq = abs Hq ’; subplot 3,1,2  hd = plot fq,Aq,’LineWidth’,1.5 ; f_labels ’ b  Equalizer’,’’,’{A_q f }’   % Equalizer  Aequal = Aq .* A0; subplot 3,1,3  he = plot fq,Aequal,[0 fs 2],[1 1],’k’ ; set he 1 ,’LineWidth’,1.5 ; f_labels ’ c  Equalized System’,’{f fs}’,’{A_{equal} f }’  f_wait  % Combined  % Compare phase responses  figure [A,theta] = fsys f,fs,q ; theta0 = -theta; subplot 3,1,1  hd = plot f,theta0,’LineWidth’,1.5 ; axis [0 fs 2 -2 1]  caption = sprintf ’ a  Original System, M = %d’,M ; f_labels caption,’’,’{\theta_0 f }’   % Original  phiq = angle Hq ’; phiq = unwrap phiq ; thetaq = phiq + 2*pi*m*f*T; subplot 3,1,2  hd = plot fq,thetaq,’LineWidth’,1.5 ; f_labels ’ b  Equalizer’,’’,’{\theta_q f }’   % Equalizer  theta_equal = thetaq + theta0; subplot 3,1,3  he = plot fq,theta_equal,[0 fs 2],[0 0],’k’ ; set he 1 ,’LineWidth’,1.5 ; axis [0 fs 2 -pi pi]  f_labels ’ c  Equalized System’,’{f fs}’,’{\theta_{equal} f }’  f_wait  % Combined  % Plot the impulse response  figure h = f_impulse b,1,2*m ; k = 0:2*m-1; plot k,h   562    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels ’Impulse Response’,’{k}’,’{h k }’  f_wait  function [A,phi] = fsys0 f,fs  T = 1 fs; A = exp - f*T-.25 .^2 .01 ; phi = -10*pi* f*T .^2 + sin 5*pi*f*T ;  function [A,theta] = fsys f,fs,q  [A0,phi0] = fsys0 f,fs ; A = 1 .  A0; T = 1 fs; M = q; tau_q = M*T; theta = phi0 + 2*pi*f*tau_q;  Problem 6.53  tau =  1.8611  tau_q =  2  563    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    a  Original System  0.1  0.3 0.2  b  Equalizer  0.4  0.5  0.1  0.2  0.3  0.4  0.5   c  Equalized System  0.1  0.2  0.3  0.4  0.5  f fs  Problem 6.53  b  Magnitude Responses   a  Original System, M = 2  0.1  0.3 0.2  b  Equalizer  0.4  0.5  0.1  0.2  0.3  0.4  0.5   c  Equalized System  1  0.5    f    A  0  600    f    A  q  400  200  0  0  0  0  1.5  1    f    l a u q e  A  0.5  0    f    0  θ    f    q  θ  −1  −2  0  −2  0  1  0  4  2  0  2  0    f    l a u q e  θ  −2  0  0.1  0.2  0.3  0.4  0.5  f fs  Problem 6.53  c  Phase Responses  564    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Impulse Response    k   h  50  40  30  20  10  0  −10  0  50  100  150  200  250  300  350  k  Problem 6.53  d  Impulse Response  565    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.54 Consider the following FIR transfer function.  H z  =  z−i 1 + i  20  Xi=0   a  Write a MATLAB program that uses f lattice compute a lattice form realization of  this ﬁlter. Print the gain and the reﬂection coeﬃcients of the blocks.   b  Suppose the sampling frequency is fs = 600 Hz. Use f freqz to compute the frequency response using a lattice form realization. Compute both the unquantized frequency response  e.g. 64 bits , and the frequency response with coeﬃcient quantization using N = 8 bits. Plot both magnitude responses on a single plot using the dB scale and a legend.  Solution  % Problem 6.54  % Initialize  f_header ’Problem 6.54’  m = f_prompt ’Enter filter order’,0,50,20 ; for i = 1 : m+1  b i  = i;  end a = 1; fs = 600; bits = f_prompt ’Enter number of bits’,1,64,8 ; realize = 2;  % Compute lattice form coefficients  [K,b_0] = f_lattice  b ; K = K’ b_0  % Compare original and quantized magnitude responses  p = 100; [H,f] = f_freqz  b,a,p,fs,64,realize ; [H_q,f] = f_freqz  b,a,p,fs,bits,realize ; A = 20*log10 abs H  ; A_q = 20*log10 abs H_q  ; figure h1 = plot  f,A,f,A_q ; set  h1 1 ,’LineWidth’,1.5  f_labels  ’Lattice Form Realization Magnitude Responses’,’f  Hz ’,’A f   dB ’   566    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   s = sprintf  ’Quantized, N=%d’,bits ; legend  ’Unquantized’,s  f_wait   a  The lattice form parameters are  K =  0.4992 0.3331 0.2499 0.1999 0.1666 0.1428 0.1250 0.1111 0.1000 0.0909 0.0833 0.0769 0.0714 0.0667 0.0625 0.0588 0.0555 0.0473 0.0848 21.0799 -0.0349 0.0054  b_0 =  1  567    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Lattice Form Realization Magnitude Responses     Unquantized Quantized, N=8    B d       f   A  50  45  40  35  30  25  20  15    0  50  100  200  250  300  150  f  Hz   Problem 6.54  b  Lattice Form Magnitude Responses  568    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   6.55 Consider the following FIR impulse response. Suppose the ﬁlter order is m = 30.  h k  =  k + 1  m  ,  0 ≤ k ≤ m   a  Write a MATLAB program that uses f cascade to compute a cascade form realization  of this ﬁlter. Print the gain b0 and the block coeﬃcients, B and A.   b  Suppose the sampling frequency is fs = 400 Hz. Use f freqz to compute the frequency response using a cascade form realization. Compute both the unquantized frequency response  set bits = 64 , and the frequency response with coeﬃcient quantization using 8 bits. Plot both magnitude responses on a single plot using the dB scale and a legend.  Solution  % Problem 6.55  % Initialize  f_header ’Problem 6.55’  m = f_prompt ’Enter filter order’,0,80,30 ; for i = 1 : m+1 b i  = i m;  end a = 1; fs = 400; bits = f_prompt ’Enter number of bits’,1,64,8 ; realize = 1;  % Compute cascade form coefficients  [B,A,b_0] = f_cascade  b   % Compare original and quantized magnitude responses  p = 100; [H,f] = f_freqz  b,a,p,fs,64,realize ; [H_q,f] = f_freqz  b,a,p,fs,bits,realize ; A = 20*log10 max abs H ,eps  ; A_q = 20*log10 max abs H_q ,eps  ; figure h1 = plot  f,A,f,A_q ; set  h1 1 ,’LineWidth’,1.5  f_labels  ’Cascade Form Realization Magnitude Responses’,’f  Hz ’,’A f   dB ’  s = sprintf  ’Quantized, N=%d’,bits ; legend  ’Unquantized’,s  f_wait  569    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    a  The cascade form parameters are  B =  1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000  -2.0773 -1.9680 -1.7620 -1.4757 -1.1235 -0.7212 -0.2860 0.1637 0.6094 1.0325 1.4156 1.7428 2.0008 2.1790 2.2699  1.1417 1.1837 1.2106 1.2302 1.2454 1.2576 1.2676 1.2758 1.2826 1.2882 1.2926 1.2961 1.2986 1.3002 1.3011  A =  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0  b_0 =  0.0333  570    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Cascade Form Realization Magnitude Responses     Unquantized Quantized, N=8    B d       f   A  30  25  20  15  10  5  0  −5  −10    0  50  100  f  Hz   150  200  Problem 6.55  b  Cascade Form Magnitude Responses  571    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Chapter 7  7.1 Consider the problem of designing a ﬁlter whose impulse response emulates the sound from a stringed musical instrument. Suppose the sampling frequency is fs = 44.1 kHz and the desired resonant frequency or pitch is F0 = 480 Hz.   a  Find the feedback parameter L and the pitch parameter c in Figure 7.1.   b  Suppose the attenuation factor is r = .998. Find the tunable plucked-string ﬁlter transfer  function H z .  Solution   a  From  7.1.9a  the parameter L is  To compute c, one must ﬁrst compute the intermediate variable δ. Using  7.1.9b   Finally, from  7.1.9c   L = ﬂoor cid:18  fs − .5F0  cid:19  = ﬂoor cid:18  44100 − 240  480  F0  = ﬂoor 91.375    cid:19   = 91  δ =  fs −  L + .5 F0  44100 − 91.5 480   =  F0  480  = .375  c =  1 − δ 1 + δ .625 1.375 = .4545  =  572    b  Using r = .998 and  8.8 , the tunable plucked string ﬁlter transfer function is  H z  =  .5[c +  1 + c z−1 + z−2]  1 + cz−1 − .5rL[cz−L +  1 + c z− L+1  + z− L+2 ]  .5[.4545 + 1.4545z−1 + z−2]  1 + .4545z−1 − .5 .998 91[.4545z−91 + 1.4545z−92 + z−93]  .2273 + .7273z−1 + .5z−2  1 + .4545z−1 − .1894z−91 − .6061z−92 − .4167z−93  =  =  573   7.2 Consider the problem of designing a resonator that extracts the frequency F0 = 100 Hz.   a  Find a sampling frequency fs that places the resonator pole at an angle of θ0 = π 2.  b  Design a resonator Hres z  that has a 3-dB passband radius of ∆F = 2 Hz.  c  Sketch a signal ﬂow graph using a direct form II realization.  Solution   a  Using  7.2.3  and solving for fs yields   b  From  7.2.6 , the pole radius required for a 3 dB passband radius of ∆F = 2 Hz is  fs =  =  2πF0  θ0  2π100  π 2  = 400 Hz  ∆F π  fs 2π 400  r ≈ 1 −  = 1 − = .9843  Next, from  7.2.7  the resonator gain is  b0 =  exp j2θ0  − 2r cos θ0  exp jθ0  + r2   exp j2θ0  − 1  =  exp jπ  − 2 .9843  cos π 2  exp jπ 2  +  .9843 2   exp jπ  − 1  =  − 1 + .9688   − 1 − 1  = .0156  Finally, from  7.2.8 , the resonator transfer function is  Hres z  =  b0 1 − z−2   1 − 2r cos θ0 z−1 + r2z−2 .0156 1 − z−2  1 + .9688z−2  =  574   -  x    -  .0156 -  -  y     u   ? z−1    ? z−1  0  cid:27   0 -  −.9688  cid:27   −.0156 -              6  6           6  6  Problem 7.2  c  Signal Flow Graph of Resonator  575   7.3 Consider the problem of designing a resonator that has two resonant frequencies. Suppose  the sampling frequency is fs = 360 Hz.   a  Design a resonator H0 z  that has a resonant frequency at F0 = 90 Hz and a 3-dB   b  Design a resonator H1 z  that has a resonant frequency of F1 = 120 Hz and a 3-dB  passband radius of 3 Hz.  passband radius of 4 Hz.   c  Combine H0 z  and H1 z  to produce a resonator H z  that has resonant frequencies at  F0 = 90 Hz and F1 = 120 Hz. Hint: Use one of the indirect forms.   d  Sketch the signal ﬂow graph of H z  using direct form II realizations for the blocks H0 z   and H1 z .  Solution   a  From  7.2.3  the required pole angle is  Next, from  7.2.6 , the pole radius needed to achieve a 3 dB passband radius of ∆F = 3 Hz is  θ0 =  =  =  2πF0  fs  2π90 360 π 2  ∆F π  r ≈ 1 − = 1 − = .9738  fs 3π 360  From  7.2.7  the resonator gain is  b0 =  exp j2θ0  − 2r cos θ0  exp jθ0  + r2   exp j2θ0  − 1  =  exp jπ  − 2 .9738  cos π 2  exp jπ 2  +  .9738 2 = .0258   exp jπ  − 1  Finally, from  7.2.8 , the resonator transfer function is  576   Hres z  =  b0 1 − z−2   1 − 2r cos θ0 z−1 + r2z−2 .0258 1 − z−2  1 + .9483z−2  =   b  From  7.2.3  the required pole angle is  θ0 =  =  =  2πF0  fs  2π120  360  2π 3  ∆F π  r ≈ 1 − = 1 − = .9651  fs 4π 360  Next, from  7.2.6 , the pole radius needed to achieve a 3 dB passband radius of ∆F = 3 Hz is  From  7.2.7  the resonator gain is  b0 =  exp j2θ0  − 2r cos θ0  exp jθ0  + r2   exp j2θ0  − 1  =  exp j4π 3 − 2 .9651  cos 2π 3  exp j2π 3  +  .9751 2  = .0343   exp j4π 3 − 1  Finally, from  7.2.8 , the resonator transfer function is  Hres z  =  b0 1 − z−2   1 − 2r cos θ0 z−1 + r2z−2 .0343 1 − z−2   =  =  1 − 2 .9651  cos 2π 3 z−1 +  .9651 2z−2  .0343 1 − z−2   1 + .9651z−1 + .9314z−2  577    c  Using the cascade form, the transfer function of a double resonator is  H z  = H0 z H1 z   =  cid:20  .0258 1 − z−2  1 + .9483z−2  cid:21   .0343 1 − z−2   1 + .9651z−1 + .9314z−2  -  x     -  -  .0343 -  -  y     u0    6     -  0  cid:27   u1    6     .0258 -    ? z−1  0 -    ? z−1 −.0258 -  −.9483    cid:27   u2    6       ? z−1  0 -    ? z−1 −.0343 -        6  −.9651  cid:27   −.9314    cid:27   Problem 7.3  d  Cascade Form Realization of Double Resonator  578   7.4 Consider the problem of designing a notch ﬁlter that eliminates the frequency F0 = 60 Hz.   a  Suppose the notch ﬁlter pole is at the angle θ0 = π 3. Find the sampling frequency fs.  b  Design a notch ﬁlter Hnotch z  that has a 3-dB stopband radius of ∆F = 1 Hz.  c  Sketch the signal ﬂow graph using a transposed direct form II realization.  Solution   a  Using  7.2.3  and solving for fs yields   b  From  7.2.6 , the pole radius required for a 3 dB stopband radius of ∆F = 1 Hz is  fs =  =  2πF0  θ0  2π60 π 3  = 360 Hz  ∆F π  r ≈ 1 − = 1 − = .9913  fs π 360  Next, from  7.2.12  the notch ﬁlter gain is  Finally, from  7.2.13 , the notch ﬁlter transfer function is  b0 = 1 − 2r cos θ0  + r2  21 − cos θ0   = 1 − 2 .9913  cos π 3  +  .9913 2  21 − cos π 3   = 1 − .9913 + .9826 = .9913  Hnotch z  =  b0[1 − 2 cos θ0 z−1 + z−2] 1 − 2r cos θ0 z−1 + r2z−2 .9913[1 − z−1 + z−2]  1 − .9913z−1 +  .9913 2z−2 .9913[1 − z−1 + z−2] 1 − .9913z−1 + .9826z−2  =  =  579   -  x    -  .9913 -  -  y     u   ? z−1    ? z−1  .9913  cid:27   −.9913 -  −.9826  cid:27      .9913 -           6  6           6  6  Problem 7.4  c  Signal Flow Graph of Notch Filter  580   7.5 Consider the problem of designing a notch ﬁlter that has two notch frequencies. Suppose the  sampling frequency is fs = 360 Hz.   a  Design a notch ﬁlter H0 z  that has a notch frequency at F0 = 60 Hz and a 3-dB   b  Design a notch ﬁlter H1 z  that has a notch frequency at F0 = 90 Hz and a 3-dB  stopband radius of 2 Hz.  stopband radius of 2 Hz.   c  Combine H0 z  and H1 z  to produce a notch ﬁlter H z  that has notches at F0 = 60  Hz and F1 = 90 Hz. Hint: Use one of the indirect forms.   d  Sketch the signal ﬂow graph of H z  using direct form II realizations for the blocks H0 z   and H1 z .  Solution   a  From  7.2.3  the required zero angle is  Next, from  7.2.6 , the zero radius needed to achieve a 3 dB stopband radius of ∆F = 2 Hz is  θ0 =  =  =  2πF0  fs  2π60 360 π 3  ∆F π  r ≈ 1 − = 1 − = .9825  fs 2π 360  From  7.2.12  the notch ﬁlter gain is  b0 = 1 − 2r cos θ0  + r2  21 − cos θ0   = 1 − 2 .9825  cos π 3  +  .9825 2  21 − cos π 3   = 1 − .9825 + .9654 = .9829  581   Next from  7.2.6 , the zero radius needed to achieve a 3 dB stopband radius of ∆F = 2 Hz is  Finally, from  7.2.13 , the notch ﬁlter transfer function is  Hnotch z  =  b0[1 − 2 cos θ0 z−1 + z−2] 1 − 2r cos θ0 z−1 + r2z−2 .9829 1 − z−1 + z−2  1 − .9825z−1 +  .9825 2z−2 .9929 1 − z−1 + z−2  1 − .9825z−1 + .9624z−2  =  =   b  From  7.2.3  the required zero angle is  θ0 =  =  =  2πF0  fs  2π90 360 π 2  ∆F π  r ≈ 1 − = 1 − = .9738  fs 3π 360  From  7.2.12  the notch ﬁlter gain is  Finally, from  7.2.13 , the notch ﬁlter transfer function is  b0 = 1 − 2r cos θ0  + r2  21 − cos θ0   = 1 − 2 .9738  cos π 2  +  .9738 2  21 − cos π 2   = 1 + .9483 2 = .9742  Hnotch z  =  b0[1 − 2 cos θ0 z−1 + z−2] 1 − 2r cos θ0 z−1 + r2z−2 .9742 1 + z−2  1 +  .9738 2z−2 .9742 1 + z−2  1 + .9483z−2  =  =  582    c  Using the cascade form, the transfer function of a double notch ﬁlter is  H z  = H0 z H1 z   =  cid:20  .9929 1 − z−1 + z−2   1 − .9825z−1 + .9624z−2 cid:21  .9742 1 + z−2   1 + .9483z−2  -  x     -  -  .9742 -  -  y     u0    6     -  .9825  cid:27   u1    6     .9929 -    ? z−1 −.9929 -    ? z−1  −.9624    cid:27   .9929 -  u2    6           6  0  cid:27     ? z−1    ? z−1  0 -  .9483    cid:27   .9742 -  Problem 7.5  d  Cascade Form Realization of Double Notch Filter  583   7.6 Consider an input signal y k  that consists of a periodic component x k  plus a random white  noise component v k .  y k  = x k  + v k   ,  0 ≤ k < 256  Suppose the sampling rate is fs and this results in a signal x k  that is periodic with a period of L = 16. Design a comb ﬁlter Hcomb z  that passes harmonics zero through L 2 of x k . Use a 3-dB passband radius of ∆F = fs 100.  Solution  Since x k  is periodic with period L, the fundamental harmonic of x k  has frequency F0 = fs L. Thus we need a comb ﬁlter of order n = L. From  7.2.6 , the radius of each of the n poles must be  Next, from  7.2.16 , the gain of a comb ﬁlter with n teeth is  Finally, from  7.2.15 , the comb ﬁlter transfer function is  ∆F π  r ≈ 1 − = 1 − = .9686  fs π 100  b0 = 1 − rn  = 1 −  .9686 16 = .3999  Hcomb z  =  b0  1 − rnz−n 1 −  .9876 16 1 −  .9876 16z−16 .3999 1 − .6001z−16  =  =  584   7.7 Consider an input y k  that consists of a signal of interest, x k , plus a disturbance, d k .  y k  = x k  + d k   ,  0 ≤ k < N  Suppose that when the sampling rate is fs, the disturbance d k  is periodic with a period of L = 12. Design an inverse comb ﬁlter Hinv z  that removes harmonics zero through L 2 of d k  from y k . Use a 3-dB passband radius of ∆F = fs 200.  Solution  Since d k  is periodic with period L, the fundamental harmonic of d k  has frequency F0 = fs L. Thus we need an inverse comb ﬁlter of order n = L to extract the harmonics zero through L 2. From  7.2.6 , the radius of each of the n zeros must be  Next, from  7.2.19 , the gain of an inverse comb ﬁlter with n teeth is  Finally, from  7.2.18 , the inverse comb ﬁlter transfer function is  ∆F π  r ≈ 1 − = 1 − = .9843  fs π 200  b0 =  1 + rn  2  1 +  .9843 12  =  2  = .9135  Hinv z  =  b0 1 − z−n  1 − rnz−n .9135 1 − z−12  1 −  .9843 12z−12 .9135 1 − z−12  1 − .8270z−12  =  =  585   7.8 Consider the problem of designing a lowpass analog ﬁlter Ha s  to meet the following speci-  ﬁcations.  [Fp, Fs, δp, δs] = [1000, 1200, .05, .02]   a  Find the passband ripple and stopband attenuation in units of dB.  b  Find the selectivity factor, r.  c  Find the discrimination factor, d.  Solution   a  Using  7.3.2a  the passband ripple in dB is  Similarly from  7.3.2b , the stopband attenuation in dB is   b  From  7.3.4a , the selectivity factor of this ﬁlter is   c  From  7.3.4b , the discrimination factor of this ﬁlter is  Ap = −20 log10 1 − δp   = −20 log10 .95  = .4455 dB  As = −20 log10 δs  = −20 log10 .02  = 33.9794 dB  r =  Fp Fs 1000 1200 = .8333  =  d = s  1 − δp −2 − 1 δ−2 s − 1 = s  .95 −2 − 1  .02 −2 − 1  = .0066  586   7.9 Consider the following design speciﬁcations for a lowpass analog ﬁlter.  [Fp, Fs, δp, δs] = [50, 60, .05, .02]  Find the minimum-order ﬁlter needed to meet these speciﬁcations using the following classical analog ﬁlters.   a  Butterworth ﬁlter   b  Chebyshev-I ﬁlter   c  Chebyshev-II ﬁlter  Solution   a  From  7.3.4a , the selectivity factor is  Similarly, from  7.3.4b , the discrimination factor is  Using  7.4.8 , the required order for a Butterworth ﬁlter is  r =  =  Fp Fs 50 60  = .8333  d = s  1 − δp −2 − 1 δ−2 s − 1 = s  .95 −2 − 1  .02 −2 − 1  = .0066  n = ceil cid:20  ln d  ln r  cid:21  = ceil cid:20  ln .0066  ln .8333  cid:21   = ceil 27.5583   = 28  587    b  From  7.4.23 , the required order for a Chebyshev-I lowpass ﬁlter is  n = ceil" ln d−1 + √d−2 − 1  ln r−1 + √r−2 − 1  = ceil" ln[ .0066 −1 +p .0066 −2 − 1] ln[ .8333 −1 +p .8333 −2 − 1   = ceil 9.1870   = 10   c  The required order for a Chebyshev-II ﬁlter is identical to the required order for a  Chebyshev-I ﬁlter. Thus from part  b   n = 10  588   √ 7.10 Consider the problem of designing a lowpass analog Butterworth ﬁlter to meet the following  speciﬁcations.  [Fp, Fs, δp, δs] = [300, 500, .1, .05]   a  Find the minimum ﬁlter order n.   b  For what cutoﬀ frequency Fc is the passband speciﬁcation exactly met?   c  For what cutoﬀ frequency Fc is the stopband speciﬁcation exactly met?   d  Find a cutoﬀ frequency Fc for which Ha s  exceeds both the passband and the stopband  speciﬁcation.  Solution   a  From  7.3.4a , the selectivity factor is  Similarly, from  7.3.4b , the discrimination factor is  Next, from  7.4.8 , the required ﬁlter order is  r =  Fp Fs 300 500  =  = .6  d = s  1 − δp −2 − 1 δ−2 s − 1 = s  .9 −2 − 1  .05 −2 − 1  = .0242  n = ceil cid:20  ln d  ln r  cid:21  = ceil cid:20  ln .0242  ln .6   cid:21   = ceil 7.2813   = 8  589    b  From  7.4.9 , the passband speciﬁcation will be met exactly using the following cutoﬀ  frequency.   c  From  7.4.10 , the stopband speciﬁcation will be met exactly using the following cutoﬀ  frequency.   d  Any cutoﬀ frequency in the range Fcp < Fc < Fcs will exceed both the passband and  the stopband speciﬁcation. For example,  Fcp =  Fp  [ 1 − δp −2 − 1]1  2n   300  =  [ .9 −2 − 1]1  16   = 328.477 Hz  Fcs =  Fs  [δ−2 s − 1]1  2n  [ .05 −2 − 1]1  16   500  = 343.8188 Hz  =  Fc =  Fcp + Fcs  2  = 336.1698 Hz  590   7.11 Find the transfer function H s  of a third-order analog lowpass Butterworth ﬁlter that has a  3-dB cutoﬀ frequency of Fc = 4 Hz.  Solution  From Table 7.2, the transfer function of a normalized third-order lowpass Butterworth ﬁlter is  The desired cutoﬀ frequency in radians sec is  Hn =  s3 + 2s2 + 2s + 1  1  Ωc = 2πFc  = 8π  Thus from  7.4.13 , the transfer function is  Ha s  =  Ω3 c  s3 + 2Ωcs2 + 2Ω2  8π 3  cs + Ω3 c  s3 + 2 8π s2 + 2 8π 2s +  8π 3  15875  s3 + 50.27s2 + 1263s + 15875  =  =  591   7.12 Sketch the poles and zeros of an analog lowpass Butterworth ﬁlter of order n = 8 that has a  3-dB cutoﬀ frequency of Fc = 1 π Hz.  Solution  From  7.4.4b , the radius of the kth pole for 0 ≤ k < n is  From  7.4.4a , the angle of the kth pole is  pk = 2πFc  = 2   2k + 1 + n π  θk =  2n   2k + 9 π  16  =  Butterworth Poles, n = 8    s   m I  3  2  1  0  −1  −2  −3  −3  −2  −1  1  2  3  0  Re s   Problem 7.12 Lowpass Butterworth Filter Poles and Zeros  592   7.13 Consider the problem of designing an analog lowpass Chebyshev-I ﬁlter to meet the following  design speciﬁcations. Find the minimum order of the ﬁlter.  [Fp, Fs, δp, δs] = [100, 200, .03, .05]  Solution  From  7.3.4a , the selectivity factor is  Similarly, from  7.3.4b , the discrimination factor is  r =  Fp Fs 100 200  =  = .5  d = s 1 − δp −2 − 1 δ−2 s − 1 = s .97 −2 − 1  .05 −2 − 1  = .0125  Next, from  7.4.23 , the required ﬁlter order is  n = ceil"ln d−1 + √d−2 − 1  ln r−1 + √r−2 − 1  = ceil"ln[ .0125 −1 +p .0125 −2 − 1] ln[ .5 −1 +p .5 −2 − 1   = ceil 3.8508     = 4  593   7.14 Design a second-order analog lowpass Chebyshev-I ﬁlter, Ha s , using Fp = 10 Hz and δp = .1.  Solution  First one must locate the poles. Using  7.4.17 , the ripple factor parameter is  Using  7.4.19b  and  7.4.19c  with F0 = Fp, the radii of the minor and major axes of the ellipse containing the poles are   cid:15  = q 1 − δp −2 − 1 = p .9 −2 − 1  = .4843  Next, from  7.4.19a   α =  cid:15 −1 +p cid:15 −2 + 1  =  .4843 −1 +p .4843 −2 + 1  = 4.3589  r1 = πFp α1 n − α−1 n   = 10π  4.3589 1 2 −  4.3589 −1 2  = 50.5427  r2 = πFp α1 n + α−1 n   = 10π  4.3589 1 2 +  4.3589 −1 2  = 80.6375  From  7.4.20 , the angles of the poles are  θk =   2k + 1 + n π  2n   2k + 3 π  = = {3π 4, 5π 4}  4  594  Using  7.4.21 ,the real and imaginary parts of the poles are   σk = r1 cos θk   = 50.5427 cos[ 2k + 3 π 4] = −35.7391 ωk = r2 sin θk   = 80.6375 sin[ 2k + 3 π 4]  = ±57.0193  Thus the poles are  pk = −35.7391 ± j57.0193  The denominator polynomial of the transfer function is then   s − p1  s − p2  =  s + 35.7391 − j57.0193  s + 35.7391 + j57.0193   =  s + 35.7391 2 +  57.0193 2 = s2 − 71.5s + 4528.5  Next, consider the transfer function numerator. From  7.4.18 ,  Aa 0  =  1  √1 +  cid:15 2 1 p1 +  .4843 2  =  = .9  From  7.4.22 , the numerator is then  b0 = βAa 0   =  −1 np0 · · · pn−1Aa 0  =  −1 2 −35.7391 + j57.0193  −35.7391− j57.0193  .9  = 4075.6  Finally, from  7.4.22  the transfer function of the second-order Chebyshev-I lowpass ﬁlter is  Ha s  =  4075.6  s2 − 71.5s + 4258.5  595   7.15 Find the minimum order n of an analog elliptic ﬁlter that will meet the follow design spec- iﬁcations. You can use the MATLAB function ellipke to evaluate an elliptic integral of the ﬁrst kind.  [Fp, Fs, δp, δs] = [100, 200, .03, .05]  Solution  From  7.3.4a , the selectivity factor is  Similarly, from  7.3.4b , the discrimination factor is  r =  Fp Fs 100 200  =  = .5  d = s 1 − δp −2 − 1 δ−2 s − 1 = s .97 −2 − 1  .05 −2 − 1  = .0125  Let g x  be a complete elliptic integral of the ﬁrst kind as in  7.4.32 .  From  7.4.33 , the required order for an elliptic ﬁlter is  g x  = Z π 2  0  dθ  p1 − x2 sin2 θ   n = ceil" g r2 g √1 − d2 g √1 − r2 g d2  = ceil"g[ .5 2]g p1 −  .0125 2  g p1 −  .5 2g[ .0125 2]  = ceil 2.6863   = 3  Here g x  is evaluated using the MATLAB function ellipke.  596   √ 7.16 Consider the following ﬁrst-order analog ﬁlter.  Ha s  =  s  s + 4π   a  What type of frequency-selective ﬁlter is this  lowpass, highpass, bandpass, or band-   b  What is the 3-dB cutoﬀ frequency f0 of this ﬁlter?  c  Suppose fs = 10 Hz. Find the prewarped cutoﬀ frequency F0.  d  Design a digital equivalent ﬁlter H z  using the bilinear-transformation method.  stop ?  Solution   a  The frequency response is  Here the magnitude and phase responses are  Since A 0  = 0 and A ∞  = 1, this is a highpass ﬁlter.   b  Setting A2 f   = .5 and solving for f yields  Thus f 2 2 = 2 or  H f   = H s s=j2πf  =  =  j2πf  j2πf + 4π  jf  jf + 2  = A f   exp[jφ f  ]  A f   =  f  p4 + f 2  φ f   = π 2 − tan−1 f  2   f 2 =  4 + f 2 .5 = 2 + f 2 2  f0 = 2 Hz  597    c  Using  7.5.10  with fs = 10 Hz yields   d  The prototype analog highpass ﬁlter is  Using  7.5.5 , the digital equivalent ﬁlter using the bilinear transformation is  F0 =  =  tan πf0T  πT  tan π2 10   π 10  = 2.3127 Hz  Ha s  =  s F0  s F0 + 1  s  s + F0 s  s + 2.3127  =  =  H z  = Ha s s=g z  2 z − 1  T  z + 1   =  =  =  =  =  =  2 z − 1  T  z + 1   + F0  2 z − 1   2 z − 1   2 z − 1  + F0T  z + 1    2 + F0T  z + F0T − 2  2 z − 1  2.2313z − 1.7687 .8964 z − 1  z − .7927 .8964 1 − z−1  1 − .7927z−1  598   7.17 The simplest digital equivalent ﬁlter is one that preserves the impulse response of Ha s . Let  ha t  denote the desired impulse response.  Next let T be the sampling interval. The objective is to design a digital ﬁlter H z  whose impulse response h k  satisﬁes  ha t  = L−1{Ha s }  h k  = ha kT    ,  k ≥ 0  Thus the impulse response of H z  consists of samples of the impulse response of Ha s . This design technique, which preserves the impulse response, is called the impulse-invariant method. Suppose Ha s  is a stable, strictly proper, rational polynomial with n distinct poles {p1, p2, · · · , pn}.  a  Expand Ha s  s into partial fractions.  Impulse invariant method   b  Find the impulse response ha t .  c  Sample ha t  to ﬁnd the impulse response h k .  d  Find the transfer function H z .  Solution   a  Let p0 = 0. Then Ha s  s has n + 1 distinct poles, {p0, p1, . . . , pn}. Thus the partial  fraction expansion of Ha s  s is  Here the partial fraction residue at the ith pole is   b  From part  a   Ha s   s  =  n  Xi=0  Ri s − pi  Ri =   s − pi Ha s   s   cid:12  cid:12  cid:12  cid:12 s=pi  Ha s  = R0 +  n  Xi=1  Ris s − pi  599   Thus the impulse response is   c  The samples of the impulse response are  ha t  = L−1{Ha s } Xi=1  = R0δa t  +  n  Ri exp pit ua t   h k  = ha kT    = R0δ k  +  Ri exp pikT  µ k   n  Xi=1  H z  = R0 +  RiZ{exp pikT  µ k }  = R0 +  RiZ{[exp piT  ]kµ k }  = R0 +  Riz  z − exp piT    n  n  Xi=1 Xi=1 Xi=1  n   d  The discrete-equivalent transfer function using the impulse invariant method is  600   7.18 Consider the following analog prototype ﬁlter of order n = 2.  Ha s  =  6  s2 + 5s + 6   a  Find the poles of Ha s  s.  b  Find the residues of Ha s  s at each pole.  c  Find a digital equivalent transfer function using the impulse-invariant method in Problem  7.17. You can assume the sampling interval is T = .5 sec.  Solution   a  The factored form of Ha s  s is  Thus the poles are   b  The partial fraction residues of Ha s  s are  Ha s   s  =  6  s s + 2  s + 3   p0 = 0 p1 = −2 p2 = −3  R0 =   s − 0 Ha s   s  = Ha 0  = 1   s + 2 Ha s   R1 =  =  −2 −2 + 3   s + 3 Ha s   = −3  R2 =  s 6  s 6  =  = 2  −3 −3 + 2    cid:12  cid:12  cid:12  cid:12 s=0  cid:12  cid:12  cid:12  cid:12 s=−2  cid:12  cid:12  cid:12  cid:12 s=−3  601    c  From part d  of Problem 8.17, the digital equivalent transfer function using the impulse  invariant method is  H z  = R0 +  R1z  z − exp p1T    −3z  = 1 +  z − exp −2 2   = 1 + −3z  +  R2z  +  +  z − exp p2T    2z  z − exp −3 2  2z  =  =   z − .3679  z − .2231  − 3z + 2z  z − .3679 z − .2231  z − .3679  z − .2231   z2 − 1.591z + .0821  z − .3679  z − .2231   602   7.19 Consider the following analog ﬁlter that has n poles and m zeros with m ≤ n.  Ha s  =  β s − z1  s − z2  · · ·  s − zm   s − p1  s − p2  · · ·  s − pn   An alternative way to convert an analog ﬁlter into a digital ﬁlter is to map each pole and zero of Ha s  into a corresponding pole and zero of H z  using z = exp sT  . This yields:  H z  =  b0 z + 1 n−m[z − exp z1T  ][z − exp z2T  ] · · · [z − exp zmT  ]  [z − exp p1T  ][z − exp p2T  ] · · ·[z − exp pnT  ]  Note that if n > m, then Ha s  has n − m zeros at s = ∞. These zeros are mapped into the highest digital frequency, z = −1. The gain factor b0 is selected such that the two ﬁlters have the same passband gain. For example if Ha s  is a lowpass ﬁlter, then Ha 0  = H 1 . This method, which is analogous to Algorithm 7.1 but using a diﬀerent transformation, is called the matched Z-transform method. Use the matched Z-transform method to ﬁnd a digital Matched equivalent of the following analog ﬁlter. You can assume T = .2. Match the gains at DC.  Z-transform method  Solution  The factored form of Ha s  is  Ha s  =  10s + 1  s2 + 3s + 2  Ha s  =  10 s + .1    s + 1  s + 2   H z  =  b0 z + 1 [z − exp −.1T    [z − exp −T  ][z − exp −2T  ]  b0 z + 1 [z − exp −.02   [z − exp −.2 ][z − exp −.4 ] b0 z + 1  z − .9802   z − .8187  z − .6703   =  =  Matching the gains at DC, Ha 0  = H 1  or  603  Thus there are m = 1 ﬁnite zeros and n = 2 ﬁnite poles. Hence the form of the discrete equivalent transfer function using the matched Z-transform method is   Solving for b0 yields  Thus the transfer function is  .5 =  2b0 1 − .9802    1 − .8187  1 − .6703   b0 = .7545  H z  =  .7545 z + 1  z − .9802   z − .8187  z − .6703   604   7.20 Find the transfer function H s  of a second-order highpass Butterworth ﬁlter that has a 3-dB  cutoﬀ frequency of Fc = 5 Hz.  Solution  From Table 7.2, the transfer function of a second-order normalized lowpass Butterworth ﬁlter is  The desired highpass cutoﬀ in radians sec is  Hnorm s  =  1  s2 + 1.4.14s + 1  Ω0 = 2πF0  = 10π  Using the lowpass to highpass frequency transformation in Table 7.5, the highpass transfer function is  Ha s  = Hnorm[D s ] = Hnorm[Ω0 s]  =  =  =  =   Ω0 s 2 + 1.414 Ω0 s  + 1  1  s2  s2  s2  s2 + 1.414Ω0s + Ω2 0  s2 + 14.14πs + 100π2  s2 + 44.42s + 986.96  605   7.21 Find the transfer function H s  of a fourth-order bandpass Butterworth ﬁlter that has 3-dB  cutoﬀ frequencies of F0 = 2 Hz and F1 = 4 Hz.  Solution  The lowpass to bandpass frequency transformation doubles the ﬁlter order. Therefore one starts with a second order ﬁlter. From Table 7.2, the transfer function of a second-order normalized lowpass Butterworth ﬁlter is  Hnorm s  =  1  s2 + 1.4.14s + 1  The passband cutoﬀ frequencies, in radians sec, are  Ω0 = 2πF0  Ω1 = 2πF1  = 4π  = 8π  Let ∆Ω = Ω1 − Ω0. Then from the lowpass to bandpass frequency transformation in Table 7.5, the bandpass transfer function is  Ha s  = Hnorm[D s ]  1  =  =  =  =  =  ∆Ωs  + 1 cid:21 2  cid:20  s2 + Ω0Ω1  cid:20  s2 + ∆Ωs + Ω0Ω1  ∆Ωs  ∆Ωs  + 1.4.14 cid:20 s2 + Ω0Ω1 + 1 cid:21  + 1  cid:21 2 + 1.4.14 cid:20 s2 + ∆Ωs + Ω0Ω1  ∆Ωs  1   cid:21  + 1   ∆Ω 2s2  16π2s2  [s2 + ∆Ωs + Ω0Ω1]2 + 1.4.14[s2 + ∆Ωs + Ω0Ω1]∆Ωs +  ∆Ω 2s2  [s2 + 4πs + 32π2]2 + 1.4.14[s2 + 4πs + 32π2]4πs + 16π2s2  157.91s2  s4 + 18s2 + 790s2 + 5612s + 99747  606   7.22 Sketch a direct form I signal ﬂow graph realization of the following IIR transfer function.  H z  =  .8 − 1.2z−1 + .4z−3  1 − .9z−1 + .6z−2 + .3z−3  Solution  -  x    .8 -  -  y     −1.2 -  .9  cid:27   z−1  z−1  z−1    ?    ?    ?     0 -  .4 -  u             6  6  6  -    ? z−1    ? z−1    ? z−1  −.6  cid:27   −.3  cid:27      Problem 7.22 Direct Form I Signal Flow Graph  607   7.23 Sketch a direct form II signal ﬂow graph realization of the following diﬀerence equation.  y k  = 10x k  + 2x k − 1  − 4x k − 2  + 5x k − 3  − .7y k − 2  + .4y k − 3   Solution  By inspection, the transfer function is  H z  =  10 + 2z−1 − 4z−2 + 5z−3  1 + .7z−2 − .4z−3  -  x    -  10 -  -  y     u   ? z−1    ? z−1    ? z−1  0  cid:27   2 -  −.7  cid:27   −4 -  .4  cid:27   5 -                 6  6  6              6  6  6  Problem 7.23 Direct Form II Signal Flow Graph  608   7.24 Sketch a transposed direct form II signal ﬂow graph realization of the following transfer  function.  Solution  H z  =  1 − 2z−1 + 3z−2 − 4z−3 1 + .8z−1 + .6z−2 + .4z−3  -  x    -  -     -  y       ?    ?    ?     −2 -  3 -  −4 -    ?    ?    ?     z−1 6     u3  z−1 6     u2  z−1 6     u1  −.8  cid:27   −.6  cid:27   −.4  cid:27   Problem 7.24 Transposed Direct Form II Signal Flow Graph  609   7.25 Consider the following IIR system.  H z  =  z3   z − .8  z2 − z + .24    a  Expand H z  into partial fractions.   b  Sketch a parallel form signal ﬂow graph realization by combining the two poles that are  closest to the unit circle into a second-order block.  Solution   a  The factored form of H z  z is  H z   z  =  z2   z − .8  z − .6  z − .4   The partial fraction residues at the poles are  R1 =  = 8  R2 =  .64  z z2  z z2   .2  .4    z − .8 H z    z − .6 H z    cid:12  cid:12  cid:12  cid:12 z=.8  z − .6  z − .4  cid:12  cid:12  cid:12  cid:12 z=.8  cid:12  cid:12  cid:12  cid:12 z=.6  z − .8  z − .4  cid:12  cid:12  cid:12  cid:12 z=.6  cid:12  cid:12  cid:12  cid:12 z=.4  z − .8  z − .6  cid:12  cid:12  cid:12  cid:12 z=.4   −.2  .2   z − .4 H z   z z2  .16  .36   −.4  −.2   =  =  =  =  =  =  = −9  R3 =  = 2  610   -  x     -       -  -       y     Thus the partial fraction expansion is  H z  =  8z  z − .8 −  9z z − .6  +  2z z − .4   b  Combining the terms with poles at z = .8 and z = .6 then yields  H z  =  +  2z z − .4 2z z − .4 2z z − .4 2 1 − .4z−1 +  8z z − .6  − 9z z − .8  8z2 − 4.8z − 9z2 + 7.2z   z − .8  z − .6   z2 − 1.4z + .48  + + −z2 + 3.4z z2 − 1.4z + .48  −1 + 3.4z−1  1 − 1.4z−2 + .48z−2  =  =  =  u1    6  -  1.4  cid:27         6  −.48  cid:27         6  .4  cid:27   −1 -  3.4 -    ? z−1    ? z−1        2 -    ? z−1  -  -  u2    -  Problem 7.25  b  Parallel Form Realization  611   7.26 Consider the following IIR system.  H z  =  2 z2 + .64  z2 − z + .24   z2 + 1.2z + .27  z2 + .81    a  Sketch the poles and zeros of H z .   b  Sketch a cascade form signal ﬂow graph realization by grouping the complex zeros with  the complex poles. Use a direct form II realization for each block.  Solution   a  The fully factored form of H z  is  H z  =  2 z + j.8  z − j.8  z − .6  z − .4   z + .9  z + .3  z + j.9  z − j.9   Pole−Zero Plot    z   m I  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2  −1  0  Re z   1  2  Problem 7.26  a  Poles and Zeros of H z   612    b  Grouping the complex poles and zeros together  to preserve real coeﬃcients ,  b0 = 2  H1 z  =  H2 z  =  z2 + .64 z2 + .81 z2 − z + .24 z2 + 1.2z − .27  2 -  x     -  y     u0    6     -  0  cid:27   -    ? z−1  0 -    ? z−1  −.81   cid:27   .64 -  u1    6     -  -        6  −1.2  cid:27   u2    6     -    ? z−1  −1 -    ? z−1  .27    cid:27   .24 -  Problem 7.26  b  Cascade Form Realization  613   7.27 Consider the following IIR ﬁlter. Suppose 8-bit ﬁxed-point arithmetic is used to implement  this ﬁlter using a scale factor of c = 4.  H z  =  2z  z + .7   a  Find the quantization level q.   b  Find the power gain of this ﬁlter.   c  Find the average power of the product round-oﬀ error.  Solution   a  Here c = 4 and N = 8. Thus, from  7.8.1  the quantization level q is   b  The impulse response is  Using  7.8.9  and the geometric series, the power gain is  q =  =  c  2N −1 4 27  = .0313  h k  = Z−1 cid:26  2z z + .7 cid:27  = 2 −.7 kµ k   Γ =  h k 2  4 .49 k  ∞  ∞  =  Xi=0 Xi=0 1 − .49 = 7.8431  =  4  614    c  Here m = 0 and n = 1. Using  7.8.10 , the average power of the product round-oﬀ error  is  σ2 y =   Γn + m + 1 q2  12   7.8431 + 1  .0313 2  = = 7.2916 × 10−4  12  615   7.28 Consider the following IIR ﬁlter.  H z  =  .5  z + .9   a  Sketch a direct form II signal ﬂow graph of H z .   b  Suppose all ﬁlter variables are represented as ﬁxed-point numbers, and the input is constrained to x k  ≤ c where c = 2. Find a scale factor, s1, that eliminates summing junction overﬂow error.   c  Sketch a modiﬁed direct form II signal ﬂow graph of H z  that implements scaling to  eliminate summing junction overﬂow.  Solution   a  The transfer function, in terms of negative powers of z, is  H z  =  .5  1 + .9z−1  -  x    -  y     -  −.9  cid:27         6  .5 -  u   ? z−1  0 -           6  Problem 7.28  a  Direct Form II Signal Flow Graph   b  The impulse response is  The output at the ﬁrst summing junction is h k  3. Using  7.8.13 , the norm of h is  h k  = Z−1 cid:26  .5z z + .9 cid:27  = .5 −.9 kµ k   616   khk1 =  h k   ∞  ∞  Xi=0 Xi=0 1 − .9  .5  =  =  = 5  .5 .9 k  s1 =  1 khk1 1 5 = .2  =  From  7.8.14  the scale factor is  .2 -  x    10 -  y     -  −.9  cid:27         6  .5 -  u   ? z−1  0 -           6  Problem 7.28  c  Direct Form II Signal Flow Graph with Scaling  617   7.29 For the system in Problem 7.28, ﬁnd a scale factor s∞ that will eliminate summing junction  overﬂow when the input is a pure sinusoid of amplitude c ≤ 5.  Solution  The frequency response of the system in problem 7.28 is  H f   = H z z=j2πf T .5  =  =  1 − .9 exp −j2πf T   cid:12  cid:12  cid:12  cid:12 z=j2πf T  .5  1 − .9 cos 2πf T   + j.9 sin 2πf T    = A f   exp[jφ f  ]  The magnitude response is  A f   =  p[1 − .9 cos 2πf T  ]2 + .81 sin2 2πf T    Thus the required scaled factor is  .5  1  s∞ =  max0≤f ≤fs 2{A f  }  618   7.30 Let fclip x  be the following unit clipping nonlinearity.  fclip x   −1 , −∞ < x < −1 x , −1 ≤ x ≤ 1 1 < x < ∞ , 1  ∆  =    Show how fclip can be used to eliminate limit cycles due to overﬂow error by sketching a modiﬁed direct form II signal ﬂow graph of a second-order IIR block. You can assume all values are represented as fractions.  Solution  If all values are represented as fractions, then the output of each summing junction can be clipped to [−1, 1] as follows.  -  x    fclip -  y           6        6  fclip -  −a1  cid:27   −a2  cid:27   b0 -  u   ? z−1  b1 -    ? z−1  b2 -     Problem 7.30 Clipping to Avoid Limit Cycles Due to Overﬂow  619   7.31 Use the GUI module g iir to design a resonator ﬁlter with resonant frequency F0 = 100 Hz.   a  Plot the linear magnitude response. Use the Caliper option to mark the peak.   b  Plot the phase response. Is this a linear-phase ﬁlter?   c  Plot the pole-zero plot.  x k   H z   y k   Resonator filter, n = 2     x,y  =  300.45,1.00   Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0  0  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.31  a  Resonator Magnitude Response  620   x k  x k   H z  H z   y k  y k   Resonator filter, n = 2  0 0  0 0  4  3  2  1  0  −1  −2  0  φ  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.31  b  Resonator Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Resonator filter, n = 2  Impulse response  −1  0  Re z   1  2  0  100  50 k  Problem 7.31  c  Resonator Pole-Zero Plot    k   h  0.06  0.04  0.02  0  −0.02  −0.04  −0.06  621   7.32 Use the GUI module g iir to design a notch ﬁlter with a notch frequency of F0 = 200 Hz, and  a sampling frequency of fs = 1200 Hz.   a  Plot the linear magnitude response.   a  Plot the phase response. Is this a linear-phase ﬁlter?   c  Plot the impulse response.  x k   H z   y k   Notch filter, n = 2  Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0  0  100  200  400  500  600  300  f  Hz   Problem 7.32  a  Notch Filter Magnitude Response  622   x k  x k   H z  H z   y k  y k   Notch filter, n = 2  0 0  0 0  1.5  2  1  0  0.5  φ  −0.5  −1  −1.5  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  400  500  600  300  f  Hz   Problem 7.32  b  Notch Filter Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Notch filter, n = 2  Impulse response  −1  0  Re z   1  2  0  100  50 k  Problem 7.32  c  Notch Filter Impulse Response    k   h  0.5  1  0  −0.5  −1  623   7.33 Create a MAT-ﬁle called prob7 33.mat that contains b, a, and f s for an inverse comb ﬁlter of order n = 12 using fs = 1000 Hz and a 3-dB radius of ∆F = 2 Hz. Then use the GUI module g iir and the User-deﬁned option to load this ﬁlter.   a  Plot the linear magnitude response.   b  Plot the phase response   c  Plot the pole-zero pattern.  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0  0  User−defined filter from file prob7_33.mat, n = 12  50  100  150  200  300  350  400  450  500  250  f  Hz   Problem 7.33  a  Inverse Comb Filter Magnitude Response  624   x k  x k   H z  H z   y k  y k   User−defined filter from file prob7_33.mat, n = 12  0 0  0 0  1.5  1  0.5  φ  0  −0.5  −1  −1.5  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  50  100  150  200  300  350  400  450  500  250  f  Hz   Problem 7.33  b  Inverse Comb Filter Phase Response  x k  x k  x k   H z  H z  H z   y k  y k  y k   User−defined filter from file prob7_33.mat, n = 12  Impulse response  −1  0  Re z   1  2  0  100  50 k  Problem 7.33  c  Inverse Comb Filter Pole-Zero Plot    k   h  0.5  1  0  −0.5  −1  625   7.34 Use the GUI module g iir to construct a Chebyshev-I lowpass ﬁlter. Plot the linear magnitude  response for the following cases.   a  Adjust the ﬁlter order n to the highest value that does not meet the speciﬁcations.   b  Adjust the ﬁlter order n to the lowest value that meets or exceeds the speciﬁcations.  Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  x k   H z   y k   Chebyshev−I filter, n = 4     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.34  a  Chebyshev-I Filter, Speciﬁcations Not Met  626   x k  x k   H z  H z   y k  y k   0 0  0 0    f   A  1  0.8  0.6  0.4  0.2  0    0  Chebyshev−I filter, n = 5     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.34  b  Chebyshev-I Filter, Speciﬁcations Exceeded  627   7.35 Use the GUI module g iir to design a lowpass Butterworth ﬁlter. Adjust the ﬁlter order to  the lowest value that meets or exceeds the speciﬁcations. Plot the following.   a  The linear magnitude response   b  The phase response. Is this a linear-phase ﬁlter?   c  The pole-zero plot  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Butterworth filter, n = 10     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.35  a  Butterworth Lowpass Magnitude Response  628   x k  x k   H z  H z   y k  y k   Butterworth filter, n = 10  0 0  0 0  4  2  φ  0  −2  −4  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.35  b  Butterworth Lowpass Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Butterworth filter, n = 10  Impulse response  −1  0  Re z   1  2  −0.5  0  50 k  100  Problem 7.35  c  Butterworth Lowpass Pole-Zero Plot  0.5    k   h  0  629   √ 7.36 Use the GUI module g iir to design a highpass Chebyshev-I ﬁlter. Adjust the ﬁlter order to  the lowest value that meets or exceeds the speciﬁcations. Plot the following.   a  The linear magnitude response   b  The phase response. Is this a linear-phase ﬁlter?   c  The pole-zero plot  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Chebyshev−I filter, n = 5     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.36  a  Chebyshev-I Highpass Magnitude Response  630   x k  x k   H z  H z   y k  y k   Chebyshev−I filter, n = 5  0 0  0 0  4  2  φ  0  −2  −4  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.36  b  Chebyshev-I Highpass Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Chebyshev−I filter, n = 5  Impulse response  −1  0  Re z   1  2  −0.4  0  50 k  100  Problem 7.36  c  Chebyshev-I Highpass Pole-Zero Plot  0.4  0.2  0  −0.2    k   h  631   7.37 Use the GUI module g iir to design a bandpass Chebyshev-II ﬁlter. Adjust the ﬁlter order to  the lowest value that meets or exceeds the speciﬁcations. Plot the following.   a  The linear magnitude response   b  The phase response. Is this a linear-phase ﬁlter?   c  The pole-zero plot  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Chebyshev−II Filter, n = 6     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.37  a  Chebyshev-II Bandpass Magnitude Response  632   x k  x k   H z  H z   y k  y k   Chebyshev−II Filter, n = 6  0 0  0 0  4  2  φ  0  −2  −4  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.37  b  Chebyshev-II Bandpass Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Chebyshev−II Filter, n = 6  Impulse response  −1  0  Re z   1  2  −0.4  0  50 k  100  Problem 7.37  c  Chebyshev-II Bandpass Pole-Zero Plot  0.4  0.2  0  −0.2    k   h  633   7.38 Use the GUI module g iir to design a bandstop elliptic ﬁlter. Adjust the ﬁlter order to the  lowest value that meets or exceeds the speciﬁcations. Plot the following.   a  The linear magnitude response   b  The phase response. Is this a linear-phase ﬁlter?   c  The pole-zero plot  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Elliptic filter, n = 6     100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.38  a  Elliptic Bandstop Magnitude Response  FIR filter Specifications  634   x k  x k   H z  H z   y k  y k   Elliptic filter, n = 6  0 0  0 0  4  2  φ  0  −2  −4  0  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.38  b  Elliptic Bandstop Phase Response  not linear phase   x k  x k  x k   H z  H z  H z   y k  y k  y k   Elliptic filter, n = 6  Impulse response  −1  0  Re z   1  2  0  100  50 k  Problem 7.38  c  Elliptic Bandstop Pole-Zero Plot    k   h  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  635   7.39 Use the GUI module g iir to design a Butterworth bandpass ﬁlter. Find the smallest order  ﬁlter that meets or exceeds the following design speciﬁcations.  [fs, Fs1, Fp1, Fp2, Fs2] = [2000, 300, 400, 600, 700] Hz  [Ap, As] = [.6, 30] dB   a  Plot the magnitude response using the dB scale.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 39. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 12. Plot the linear magnitude responses.  Solution  0  0    B d       f   A  10  0  −10  −20  −30  −40  −50  −60    0  x k   H z   y k   Butterworth filter, n = 12     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.39  a  Butterworth Bandpass Magnitude Response  636   x k   H z   y k   0  0  Butterworth filter, n = 12  Impulse response        −2  −2  −1  0  Re z   1  2  −0.4  0  50 k  100  Problem 7.39  b  Butterworth Bandpass Pole-zero Pattern  x k   H z   y k   Direct user−defined filter from file prob7_39.mat: n=12, m=12, c=8, q=0.00390625, e   = 0.0909091  max     Unquantized Quantized, N = 12  2  1  0  −1    z   m I  0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0  0.4  0.2  0  −0.2    k   h  500 f f  s  637  100  200  300  400  600  700  800  900  1000  Problem 7.39  c  Butterworth Magnitude Response with Coeﬃcient Quantization   7.40 Use the GUI module g iir to design a Chebyshev-I bandpass ﬁlter. Find the smallest order  ﬁlter that meets or exceeds the following design speciﬁcations.  [fs, Fs1, Fp1, Fp2, Fs2] = [2000, 300, 400, 600, 700] Hz  [δp, δs] = [.05, .03]   a  Plot the linear magnitude response.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 40. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 10. Plot the linear magnitude responses.  Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  x k   H z   y k   Chebyshev−I filter, n = 8     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.40  a  Chebyshev-I Bandpass Magnitude Response  638   x k  x k   H z  H z   y k  y k   0 0  0 0  Chebyshev−I filter, n = 8  Impulse response        −2  −2  −1  0  Re z   1  2  0  100  50 k  Problem 7.40  b  Chebyshev-I Bandpass Pole-Zero Plot  x k   H z   y k   Direct user−defined filter from file prob7_40.mat: n=8, m=8, c=4, q=0.0078125, e   = 0.283333  max     Unquantized Quantized, N = 10  2  1  0  −1    z   m I  0  0  1.5  1  0.5    f   A  0    0    k   h  0.2  0.1  0  −0.1  −0.2  500 f f  s  639  100  200  300  400  600  700  800  900  1000  Problem 7.40  c  Chebyshev-I Magnitude Response with Coeﬃcient Quantization   7.41 Use the GUI module g iir to design an elliptic bandpass ﬁlter. Find the smallest order ﬁlter  that meets or exceeds the following design speciﬁcations.  [fs, Fs1, Fp1, Fp2, Fs2] = [2000, 350, 400, 600, 650] Hz  [δp, δs] = [.04, .02]   a  Plot the linear magnitude response.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 41. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 9. Plot the linear magnitude responses.  x k   H z   y k   Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Elliptic filter, n = 8     FIR filter Specifications  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.41  a  Elliptic Bandpass Magnitude Response  640   x k  x k   H z  H z   y k  y k   Elliptic filter, n = 8  Impulse response     −1  0  Re z   1  2  0  100  50 k  Problem 7.41  b  Elliptic Bandpass Pole-Zero Plot  x k   H z   y k   0 0  0 0  2  1  0  −1    z   m I     −2  −2  0  0  2  1.5    f   A  1  0.5  0    0  Direct user−defined filter from file prob7_41.mat: n=8, m=8, c=4, q=0.015625, e   = 0.908967  max     Unquantized Quantized, N = 9  100  200  300  400  600  700  800  900  1000  Problem 7.41  c  Elliptic Magnitude Response with Coeﬃcient Quantization    k   h  0.2  0.1  0  −0.1  −0.2  500 f f  s  641   7.42 Use the GUI module g iir to design a Butterworth bandpass ﬁlter. Find the smallest order  ﬁlter that meets or exceeds the following design speciﬁcations.  [fs, Fp1, Fs1, Fs2, Fp2] = [100, 20, 25, 35, 40] Hz  [δp, δs] = [.05, .02]   a  Plot the magnitude response using the dB scale.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 42. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 16. Plot the linear magnitude responses.  Solution  0  0    B d       f   A  10  0  −10  −20  −30  −40  −50  −60    0  x k   H z   y k   Butterworth filter, n = 14     FIR filter Specifications  5  10  15  20  30  35  40  45  50  25  f  Hz   Problem 7.42  a  Butterworth Bandstop Magnitude Response  642   x k  x k   H z  H z   y k  y k   0 0  0 0  Butterworth filter, n = 14  Impulse response        −2  −2  −1  0  Re z   1  2  0  100  50 k  Problem 7.42  b  Butterworth Bandstop Pole-Zero Plot  x k   H z   y k   Direct user−defined filter from file prob7_42.mat: n=14, m=14, c=32, q=0.000976563, e   = 0.155858  max     Unquantized Quantized, N = 16  2  1  0  −1    z   m I  0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0    k   h  0.2  0.1  0  −0.1  −0.2  25 f f  s  643  5  10  15  20  30  35  40  45  50  Problem 7.42  c  Butterworth Magnitude Response with Coeﬃcient Quantization   √ 7.43 Use the GUI module g iir to design a Chebyshev-II bandstop ﬁlter. Find the smallest order  ﬁlter that meets or exceeds the following design speciﬁcations.  [fs, Fp1, Fs1, Fs2, Fp2] = [20000, 2500, 3000, 4000, 4500] Hz  [δp, δs] = [.04, .03]   a  Plot the linear magnitude response.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 43. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 17. Plot the linear magnitude responses.  x k   H z   y k   Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Chebyshev−II Filter, n = 10     1000  2000  3000  4000  6000  7000  8000  9000  10000  5000  f  Hz   Problem 7.43  a  Chebyshev-II Bandstop Magnitude Response  FIR filter Specifications  644   x k  x k   H z  H z   y k  y k   0 0  0 0  Chebyshev−II Filter, n = 10  Impulse response        −2  −2  −1  0  Re z   1  2  0  100  50 k  Problem 7.43  b  Chebyshev-II Bandstop Pole-Zero Plot  x k   H z   y k   Direct user−defined filter from file prob7_43.mat: n=10, m=10, c=32, q=0.000488281, e   = 0.62411  max     Unquantized Quantized, N = 17  2  1  0  −1    z   m I  0  0    f   A  1.4  1.2  1  0.8  0.6  0.4  0.2  0    0    k   h  0.6  0.4  0.2  0  −0.2  −0.4  −0.6  5000 f f  s  645  1000  2000  3000  4000  6000  7000  8000  9000  10000  Problem 7.43  c  Chebyshev-II Magnitude Response with Coeﬃcient Quantization   7.44 Use the GUI module g iir to design an elliptic bandstop ﬁlter. Find the smallest order ﬁlter  that meets or exceeds the following design speciﬁcations.  [fs, Fp1, Fs1, Fs2, Fp2] = [20, 6.5, 7, 8, 8.5] Hz  [δp, δs] = [.02, .015]   a  Plot the linear magnitude response.   b  Plot the pole-zero pattern.   c  Save a, b, and f s in a MAT-ﬁle named prob7 44. Then use GUI module g ﬁlters to load this as a user-deﬁned ﬁlter. Adjust the number of bits used for coeﬃcient quantization to N = 14. Plot the linear magnitude responses.  x k   H z   y k   Solution  0  0    f   A  1  0.8  0.6  0.4  0.2  0    0  Elliptic filter, n = 8     1  2  3  4  6  7  8  9  10  5  f  Hz   Problem 7.44  a  Elliptic Bandstop Magnitude Response  FIR filter Specifications  646   x k  x k   H z  H z   y k  y k   0 0  0 0  Elliptic filter, n = 8  Impulse response  0.5        −2  −2  −1  0  Re z   1  2  −0.5  0  50 k  100  Problem 7.44  b  Elliptic Bandstop Pole-Zero Plot  x k   H z   y k   Direct user−defined filter from file prob7_44.mat: n=8, m=8, c=32, q=0.00390625, e   = 2.04225  max     Unquantized Quantized, N = 14  2  1  0  −1    z   m I  0  0    f   A  2.5  1.5  2  1  0.5  0    0    k   h  0  5 f f  s  647  1  2  3  4  6  7  8  9  10  Problem 7.44  c  Elliptic Magnitude Response with Coeﬃcient Quantization   7.45 Use the GUI module g iir and the User-deﬁned option to load the ﬁlter in MAT-ﬁle u iir1.   a  Plot the linear magnitude response. What type of ﬁlter is this?   b  Plot the phase response   c  Plot the impulse response.  Solution  x k   H z   y k   0  0    f   A  1  0.8  0.6  0.4  0.2  0  0  User−defined filter from file u_iir1.mat, n = 2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.45  a  User-Deﬁned Magnitude Response. This is a Resonator  648   x k  x k   H z  H z   y k  y k   User−defined filter from file u_iir1.mat, n = 2  0 0  0 0  4  3  2  1  0  −1  −2  0  φ  0 0 0  0 0 0    z   m I  2  1  0  −1  −2  −2  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 7.45  b  User-Deﬁned Phase Response  x k  x k  x k   H z  H z  H z   y k  y k  y k   User−defined filter from file u_iir1.mat, n = 2  Impulse response  −1  0  Re z   1  2  −0.015  0  50 k  100  Problem 7.45  c  User Deﬁned Impulse Response  0.015  0.01  0.005  0  −0.005  −0.01    k   h  649   7.46 Write a MATLAB program that uses f butters to design an analog Butterworth lowpass ﬁlter  to meet the following design speciﬁcations.  [Fp, Fs, δp, δs] = [10, 20, .04, .02]   a  Print the ﬁlter order  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fs.  c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  plot.  Solution  % Problem 7.46  % Initialize  f_header ’Problem 7.46’  F_p = 10; F_s = 20; delta_p = 0.04; delta_s = 0.02;  % Design filter  [b,a] = f_butters  F_p,F_s,delta_p,delta_s ; n = length a -1  % Plot magnitude response  figure f_max = 2*F_s; N = 200; [H,f] = f_freqs  b,a,N,f_max ; A = abs H ; plot  f,A  f_labels  ’Butterworth Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   % Show specifications  hold on fill  [0 F_p F_p 0],[1-delta_p, 1-delta_p, 1, 1],’c’  fill  [F_s f_max f_max F_s],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  650   The printed ﬁlter order is  n =  8  Butterworth Filter    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  5  10  15  20  25  30  35  40  f  Hz   Problem 7.46 Butterworth Lowpass Magnitude Response with Design Speciﬁcations  651   7.47 Write a MATLAB program that uses f cheby1s to design an analog Chebyshev-I lowpass ﬁlter  to meet the following design speciﬁcations.  [Fp, Fs, δp, δs] = [10, 20, .04, .02]   a  Print the ﬁlter order  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fs.  c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  plot.  Solution  % Problem 7.47  % Initialize  f_header ’Problem 7.47’  F_p = 10; F_s = 20; delta_p = 0.04; delta_s = 0.02;  % Design filter  [b,a] = f_cheby1s  F_p,F_s,delta_p,delta_s ; n = length a -1  % Plot magnitude response  figure f_max = 2*F_s; N = 200; [H,f] = f_freqs  b,a,N,f_max ; A = abs H ; plot  f,A  f_labels  ’Chebyshev-I Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   % Show specifications  hold on fill  [0 F_p F_p 0],[1-delta_p, 1-delta_p, 1, 1],’c’  fill  [F_s f_max f_max F_s],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  652   The printed ﬁlter order is  n =  5  Chebyshev−I Filter    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  5  10  15  20  25  30  35  40  f  Hz   Problem 7.47 Chebyshev-I Lowpass Magnitude Response with Design Speciﬁcations  653   7.48 Write a MATLAB program that uses f cheby2s to design an analog Chebyshev-II lowpass  ﬁlter to meet the following design speciﬁcations.  [Fp, Fs, δp, δs] = [10, 20, .04, .02]   a  Print the ﬁlter order  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fs.  c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  plot.  Solution  % Problem 7.48  % Initialize  f_header ’Problem 7.48’  F_p = 10; F_s = 20; delta_p = 0.04; delta_s = 0.02;  % Design filter  [b,a] = f_cheby2s  F_p,F_s,delta_p,delta_s ; n = length a -1  % Plot magnitude response  figure f_max = 2*F_s; N = 200; [H,f] = f_freqs  b,a,N,f_max ; A = abs H ; plot  f,A  f_labels  ’Chebyshev-II Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   % Show specifications  hold on fill  [0 F_p F_p 0],[1-delta_p, 1-delta_p, 1, 1],’c’  fill  [F_s f_max f_max F_s],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  654   The printed ﬁlter order is  n =  5  Chebyshev−II Filter    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  5  10  15  20  25  30  35  40  f  Hz   Problem 7.48 Chebyshev-II Lowpass Magnitude Response with Design Speciﬁcations  655   √ 7.49 Write a MATLAB program that uses f elliptics to design an analog elliptic lowpass ﬁlter to  meet the following design speciﬁcations.  [Fp, Fs, δp, δs] = [10, 20, .04, .02]   a  Print the ﬁlter order  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fs.  c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  plot.  Solution  % Problem 7.49  % Initialize  f_header ’Problem 7.49’  F_p = 10; F_s = 20; delta_p = 0.04; delta_s = 0.02;  % Design filter  [b,a] = f_elliptics  F_p,F_s,delta_p,delta_s ; n = length a -1  % Plot magnitude response  figure f_max = 2*F_s; N = 200; [H,f] = f_freqs  b,a,N,f_max ; A = abs H ; plot  f,A  f_labels  ’Elliptic Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   % Show specifications  hold on fill  [0 F_p F_p 0],[1-delta_p, 1-delta_p, 1, 1],’c’  fill  [F_s f_max f_max F_s],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  656   The printed ﬁlter order is  n =  4  Elliptic Filter    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  5  10  15  20  25  30  35  40  f  Hz   Problem 7.49 Elliptic Lowpass Magnitude Response with Design Speciﬁcations  657   √ 7.50 Write a MATLAB program that uses f butters and f bilin to ﬁnd the digital equivalent, H z , of a sixth-order lowpass Butterworth ﬁlter using the bilinear transformation method. Suppose the sampling frequency is fs = 10 Hz. Prewarp the analog cutoﬀ frequency so that the digital cutoﬀ frequency comes out to be Fc = 1 Hz.   a  Plot the impulse response, h k .   b  Use f pzplot to plot the poles and zeros of H z .   c  Use f freqz to compute and plot the magnitude response, A f  . Add the ideal magnitude  response and a plot legend.  Solution  % Problem 7.50  % Initialize  f_header ’Problem 7.50’  n = 6; fs = 10; T = 1 fs; f_c = 1;  % Prewarp cutoff frequency  F_c = tan pi*f_c*T     pi*T   % Compute Butterworth lowpass filter  [B,A] = f_butters  F_c,2*F_c,0.1,0.1,n ;  % Apply bilinear transformation  [b,a] = f_bilin  B,A,fs ;  % Plot impulse response  N = 50; h = f_impulse  b,a,N ; k = 0 : N-1; figure stem  k,h,’filled’,’.’  f_labels  ’Impulse Response’,’k’,’h k ’  f_wait  % Plot poles and zeros  f_pzplot  b,a,’Poles and Zeros’   658   f_wait  % Plot magnitude response  p = 200; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A  f_labels  ’Magnitude Response’,’f  Hz ’,’A f ’   % Add ideal response  hold on plot  [0 f_c f_c],[1 1 0],’k’,’LineWidth’,1.5  axis  [0 fs 2 0 1.2]  legend  ’Butterworth, n=6’,’Ideal’  f_wait  Impulse Response    k   h  0.25  0.2  0.15  0.1  0.05  0  −0.05  −0.1  0  10  20  30  40  50  k  Problem 7.50  a  Butterworth Impulse Response  659   Poles and Zeros    z   m I  1.5  0.5  2  1  0  −0.5  −1  −1.5  −2  −2    f   A  0.6  1.2  1  0.8  0.4  0.2  0    0  −1  0  Re z   1  2  Problem 7.50  b  Butterworth Poles and Zeros  Magnitude Response     Butterworth, n=6 Ideal  1  2  3  4  5  f  Hz   Problem 7.50  c  Butterworth Magnitude Response  660   7.51 Write a MATLAB program that uses f butterz to design a digital Butterworth bandstop ﬁlter  that meets the following design speciﬁcations.  [fs, Fp1, Fs1, Fs2, Fp2, δp, δs] = [2000, 200, 300, 600, 700, .05, .03]   a  Find the smallest ﬁlter order that meets the speciﬁcations. Print the order  b  Use f freqz to compute and plot the magnitude response.  c  Use ﬁll to add shaded areas showing the design speciﬁcations.  Solution  % Problem 7.51  % Initialize  f_header ’Problem 7.51’  fs = 2000; F_p = [200,700]; F_s = [300;600]; delta_p = 0.05; delta_s = 0.03; n = f_prompt ’Enter lowpass filter order’,1,20,8 ;  % Design Butterworth bandstop filter  f_type = 3; [b,a] = f_butterz  F_p,F_s,delta_p,delta_s,f_type,fs,n ; n = length a -1  % Plot magnitude response  p = 200; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A  axis  [0 fs 2 0 1.2]  f_labels  ’Butterworth Magnitude Response’,’f  Hz ’,’A f ’   % Add design specifications  hold on fill  [0 F_p 1  F_p 1  0],[1-delta_p,1-delta_p,1 1],’c’  fill  [F_s 1  F_s 2  F_s 2  F_s 1 ],[0 0 delta_s delta_s],’c’  fill  [F_p 2  fs 2 fs 2 F_p 2 ],[1-delta_p,1-delta_p,1 1],’c’  plot  f,A  f_wait  661   The printed ﬁlter order is  n =  16  Butterworth Magnitude Response    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  200  400  600  800  1000  f  Hz   Problem 7.51 Butterworth Bandstop Magnitude Response  662   7.52 Write a MATLAB program that uses f cheby1z to design a digital Chebyshev-I bandstop ﬁlter  that meets the following design speciﬁcations.  [fs, Fp1, Fs1, Fs2, Fp2, δp, δs] = [2000, 200, 300, 600, 700, .05, .03]   a  Find the smallest ﬁlter order that meets the speciﬁcations. Print the order  b  Use f freqz to compute and plot the magnitude response.  c  Use ﬁll to add shaded areas showing the design speciﬁcations.  Solution  % Problem 7.52  % Initialize  f_header ’Problem 7.52’  fs = 2000; F_p = [200,700]; F_s = [300;600]; delta_p = 0.05; delta_s = 0.03; n = f_prompt ’Enter lowpass filter order’,1,20,5 ;  % Design Butterworth bandstop filter  f_type = 3; [b,a] = f_cheby1z  F_p,F_s,delta_p,delta_s,f_type,fs,n ; n = length a -1  % Plot magnitude response  p = 200; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A  axis  [0 fs 2 0 1.2]  f_labels  ’Chebyshev-I Magnitude Response’,’f  Hz ’,’A f ’   % Add design specifications  hold on fill  [0 F_p 1  F_p 1  0],[1-delta_p,1-delta_p,1 1],’c’  fill  [F_s 1  F_s 2  F_s 2  F_s 1 ],[0 0 delta_s delta_s],’c’  fill  [F_p 2  fs 2 fs 2 F_p 2 ],[1-delta_p,1-delta_p,1 1],’c’  plot  f,A  f_wait  663   The printed ﬁlter order is  n =  10  Chebyshev−I Magnitude Response    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  200  400  600  800  1000  f  Hz   Problem 7.52 Chebyshev-I Bandstop Magnitude Response  664   7.53 Write a MATLAB program that uses f cheby2z to design a digital Chebyshev-II bandpass  ﬁlter that meets the following design speciﬁcations.  [fs, Fs1, Fp1, Fp2, Fs2, δp, δs] = [1600, 250, 350, 550, 650, .06, .04]   a  Find the smallest ﬁlter order that meets the speciﬁcations. Print the order  b  Use f freqz to compute and plot the magnitude response.  c  Use ﬁll to add shaded areas showing the design speciﬁcations.  Solution  % Problem 7.53  % Initialize  f_header ’Problem 7.53’  fs = 1600; F_p = [350;550]; F_s = [250,650]; delta_p = 0.06; delta_s = 0.04; n = f_prompt  ’Enter lowpass filter order’,1,20,4 ;  % Design Butterworth bandstop filter  f_type = 2; [b,a] = f_cheby2z  F_p,F_s,delta_p,delta_s,f_type,fs,n ; n = length a -1  % Plot magnitude response  p = 200; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A  axis  [0 fs 2 0 1.2]  f_labels  ’Chebyshev-II Magnitude Response’,’f  Hz ’,’A f ’   % Add design specifications  hold on fill  [0 F_s 1  F_s 1  0],[0 0 delta_s delta_s],’c’  fill  [F_p 1  F_p 2  F_p 2  F_p 1 ],[1-delta_p, 1-delta_p,1,1],’c’  fill  [F_s 2  fs 2 fs 2 F_s 2 ],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  665   The printed ﬁlter order is  n =  8  Chebyshev−II Magnitude Response    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  100  200  300  400  500  600  700  800  f  Hz   Problem 7.53 Chebyshev-II Bandpass Magnitude Response  666   7.54 Write a MATLAB program that uses f ellipticz to design a digital elliptic bandpass ﬁlter that  meets the following design speciﬁcations.  [fs, Fs1, Fp1, Fp2, Fs2, δp, δs] = [1600, 250, 350, 550, 650, .06, .04]   a  Find the smallest ﬁlter order that meets the speciﬁcations. Print the order  b  Use f freqz to compute and plot the magnitude response.  c  Use ﬁll to add shaded areas showing the design speciﬁcations.  Solution  % Problem 7.54  % Initialize  f_header ’Problem 7.54’  fs = 1600; F_p = [350;550]; F_s = [250,650]; delta_p = 0.06; delta_s = 0.04; n = f_prompt  ’Enter lowpass filter order’,1,20,3 ;  % Design Butterworth bandstop filter  f_type = 2; [b,a] = f_ellipticz  F_p,F_s,delta_p,delta_s,f_type,fs,n ; n = length a -1  % Plot magnitude response  p = 200; [H,f] = f_freqz  b,a,p,fs ; A = abs H ; figure plot  f,A  axis  [0 fs 2 0 1.2]  f_labels  ’Elliptic Magnitude Response’,’f  Hz ’,’A f ’   % Add design specifications  hold on fill  [0 F_s 1  F_s 1  0],[0 0 delta_s delta_s],’c’  fill  [F_p 1  F_p 2  F_p 2  F_p 1 ],[1-delta_p, 1-delta_p,1,1],’c’  fill  [F_s 2  fs 2 fs 2 F_s 2 ],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  667   The printed ﬁlter order is  n =  6  Elliptic Magnitude Response    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  100  200  300  400  500  600  700  800  f  Hz   Problem 7.54 Elliptic Bandpass Magnitude Response  668   7.55 Write a MATLAB program that uses f butters and f low2highs to design an analog Butter-  worth highpass ﬁlter to meet the following design speciﬁcations.  [Fs, Fp, Ap, As] = [4, 6, .5, 24]   a  Print the ﬁlter order, δp, and δs.  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fp using the linear   c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  scale.  plot.  Solution  % Problem 7.55  % Initialize  f_header ’Problem 7.55’  F_s = 4; F_p = 6; A_p = 0.5; A_s = 24;  % Design normalized lowpass filter  n = f_prompt  ’Enter filter order’,0,20,10  F_0 = 1  2*pi ; delta_p = 1 - 10^ -A_p 20  delta_s = 10^ -A_s 20  [b,a] = f_butters  F_0,2*F_0,delta_p,delta_s,n ;  % Convert to highpass  [B,A] = f_low2highs  b,a,F_p ;  % Plot magnitude response  figure f_max = 2*F_p; N = 200; [H,f] = f_freqs  B,A,N,f_max ; A = abs H ; plot  f,A  f_labels  ’Butterworth Highpass Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   669   % Show specifications  hold on fill  [0 F_s F_s 0],[0 0 delta_s delta_s],’c’  fill  [F_p f_max f_max F_p],[1-delta_p,1-delta_p,1,1],’c’  plot  f,A  f_wait  Butterworth Highpass Filter  The printed output is  n =  10  delta_p = .0559 delta_s = .0631    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  2  4  8  10  12  6  f  Hz   Problem 7.55 Butterworth Highpass Magnitude Response with Design Speciﬁcations  670   7.56 Write a MATLAB program that uses f cheby1s and f low2bps to design an analog Chebyshev-I  bandpass ﬁlter to meet the following design speciﬁcations.  [Fs1, Fp1, Fp2, Fs2, Ap, As] = [35, 45, 60, 70, .4, 28]   a  Print the ﬁlter order, δp, and δs.  b  Use f freqs to compute and plot the magnitude response for 0 ≤ f ≤ 2Fs2 using the   c  Use ﬁll to add shaded areas showing the design speciﬁcations on the magnitude response  linear scale.  plot.  Solution  % Problem 7.56  % Initialize  f_header ’Problem 7.56’  F_s1 = 35; F_p1 = 45; F_p2 = 60; F_s2 = 70; A_p = 0.4; A_s = 28;  % Design normalized lowpass filter  n = f_prompt  ’Enter filter order’,0,20,4 ; F_0 = 1  2*pi ; delta_p = 1 - 10^ -A_p 20  delta_s = 10^ -A_s 20  [b,a] = f_cheby1s  F_0,2*F_0,delta_p,delta_s,n ;  % Convert to highpass  [B,A] = f_low2bps  b,a,F_p1,F_p2 ; n = length A -1  % Plot magnitude response  figure f_max = 2*F_s2; N = 200; [H,f] = f_freqs  B,A,N,f_max ; A = abs H ; plot  f,A   671   f_labels  ’Chebyshev-I Bandpass Filter’,’f  Hz ’,’A f ’  axis [0 f_max 0 1.2]   % Show specifications  hold on fill  [0 F_s1 F_s1 0],[0 0 delta_s delta_s],’c’  fill  [F_p1 F_p2 F_p2 F_p1],[1-delta_p,1-delta_p,1,1],’c’  fill  [F_s2 f_max f_max F_s2],[0 0 delta_s delta_s],’c’  plot  f,A  f_wait  Chebyshev−I Bandpass Filter  The printed output is  delta_p = .0450 delta_s = .0398  n =  8    f   A  0.6  1.2  1  0.8  0.4  0.2  0  0  672  20  40  60  80  100  120  140  f  Hz   Problem 7.56 Chebyshev-I Bandpass Magnitude Response with Design Speciﬁcations   7.57 Write a MATLAB function called f ﬁltnorm that returns the Lp norm, khkp, of a digital ﬁlter.  The function f ﬁltnorm should use the following calling sequence.  b = vector of length m+1 containing coefficients of  d = f_filtnorm  b,a,p   % F_FILTNORM: Return L_p norm of filter H z  = b z  a z  % % Usage: % % Pre: % % % % % % % Post: %  d = the L_p norm, h_p  denominator polynomial.  numerator polynomial.  the infinity norm  p = integer specifying norm type. Use p = Inf for  a = vector of length n+1 containing coefficients of  Test f ﬁltnorm by writing a MATLAB program that computes and prints the L1, L2,and L∞ norms of a comb ﬁlter with n = 10 and r = .98. Verify that  7.8.17  holds in this case.  Solution  function prob7_57  % Problem 7.57  f_header ’Problem 7.57’  n = 10; r = 0.98; b = 1 - r^n a = [1,zeros 1,n-1 ,r^n]  % Compute filter norms  h_1 = f_filtnorm  b,a,1  h_2 = f_filtnorm  b,a,2  h_inf = f_filtnorm  b,a,Inf   function d = f_filtnorm  b,a,p ;  % F_FILTNORM: Return L_p norm of filter H z  = b z  a z  % % Usage: % % Pre: % %  d = f_filtnorm  b,a,p   numerator polynomial.  b = vector of length m+1 containing coefficients of  673   a = vector of length n+1 containing coefficients of  denominator polynomial.  p = integer specifying norm type. Use p = Inf for  the infinity norm  d = the L_p norm, h_p  % % % % % Post: %  % Initialize  r = 500;  % Find impulse response  h = f_impulse  b,a,r ; if p ~= Inf  d =  sum abs h .^p  ^ 1 p ;  else  end  [H,f] = f_freqz  b,a,r,1 ; A = abs H ; d = max A ;  Problem 7.57  b =  a =  0.1829  h_1 =  h_2 =  1.0000  0.3173  h_inf =  1.0000  674  The three ﬁlter norms are as follows. Observe that khk2 ≤ khk∞ ≤ khk1, so  5.8.16  holds.  1.0000  0  0  0  0  0  0  0  0   Chapter 8  8.1 Consider the variable delay system shown in Figure 8.42 where the sampling rate of x k  is fs. Suppose HL z  is a linear-phase FIR ﬁlter of order m. Find an expression for the total delay that takes into account the interpolator delay, the shift register delay, and the decimator delay.  x k  e - ↑ L  - HL z   - Shift M  - HL z   - ↓ L  ey k   Figure 8.42 A Variable Delay System  Solution  From Figure 8.42, the interpolator ﬁlter delay is m 2 samples where the sampling rate is fS = Lfs. Let T = 1 fs be the sampling interval of x k . Then  Since the decimator ﬁlter precedes the downsampler, the decimator ﬁlter delay is also  From  8.1.7 , the delay caused by the shift register is  Thus the total delay is  τ1 =  mT 2L  τ2 =  mT 2L  τ3 =  M T L  τ = τ1 + τ2 + τ3 mT M T L L  m + M  T  =  +  =  L  sec  675    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.2 Suppose a signal is sampled at a rate of fs = 10 Hz. Consider the problem of using the  variable delay system in Figure 8.42 to implement an overall delay of τ = 2.38 sec.   a  Find the smallest interpolation factor L that is needed.   b  Suppose the linear-phase FIR ﬁlters are of order m = 50. How much delay is introduced  by the two lowpass ﬁlters?   c  What length of shift register, M , is needed to achieve the overall delay?  Solution   a  The desired delay is τ = 2.38 sec. This is an integer multiple of .02 sec, and the sampling interval is T = .1 sec. Thus the sampling interval will have to be reduced by a factor of   b  The delay introduced by each of the linear-phase FIR lowpass ﬁlters is mT   2L . Thus  the delay introduced by the two ﬁlters is   c  From  8.1.7 , the delay introduced by a shift register of length M is τ = M T  L. Thus  one needs  Solving for M yields  L =  .1 .02  = 5  τlow =  mT L 50 .1   =  5 = 1 sec  M T L  = τ − τlow = 2.38 − 1 = 1.38  1.38L  M =  =  T 6.9 .1 = 69  676    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.3 Consider the problem of designing a sampling rate decimator with a down-sampling factor of  M = 8.   a  Sketch a block diagram of the sampling rate decimator.   b  Find the required frequency response of the ideal anti-aliasing digital ﬁlter assuming fs  is the sampling rate of x k .   c  Using Tables 6.1 and 6.2, design an anti-aliasing ﬁlter of order m = 40 using the win-  dowing method with a Hanning window.   d  Find the diﬀerence equation for the sampling rate decimator.  Solution  x e - HM  z   -r  ↓ M  e y  Problem 8.3 Sampling Rate Decimator Block Diagram   b  From  8.2.3 , the ideal cutoﬀ frequency is  FM =  =  fs 2M fs 16  The required frequency response for the ideal anti-aliasing digital ﬁlter is then  HM  f   =  cid:26  1 ,  0 ≤ f < fs 16 0 , fs 16 ≤ f ≤ fs 2   c  Using Table 6.1 and Table 6.2 with m = 40, p = m 2, and the Hanning window, the  FIR ﬁlter coeﬃcients are  bi = w i h i   = .5 cid:20 1 − cos cid:18  πi = .5 cid:20 1 − cos cid:18  πi  .5m cid:19  cid:21  sin[2π i − p FM T ] π i − p  20 cid:19  cid:21  sin[2π i − 20  16]  π i − 20   ,  i 6= 20  677    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is   d  From  8.2.4  the decimator diﬀerence equation is  b20 = w p h p   = .5[1 − cos π ]2FMT = 2 16  = .125  y k  =  bix M k − i   =  bix 20k − i   m  40  Xi=0 Xi=0  678    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.4 Consider the problem of designing a sampling rate interpolator with an up-sampling factor  of L = 10.   a  Sketch a block diagram of the sampling rate interpolator.   b  Find the required frequency response of the ideal anti-imaging digital ﬁlter assuming fs  is the sampling rate of x k .   c  Using Tables 6.1 and 6.2, design an anti-imaging ﬁlter of order m = 30 using the win-  dowing method with a Hamming window.   d  Find the diﬀerence equation for the sampling rate interpolator.  Solution  x e - ↑ L  -r  HL z   e y  Problem 8.4 Sampling Rate Interpolator Block Diagram   b  From  8.2.21 , the ideal cutoﬀ frequency is  FL =  =  fs 2L fs 20  The required frequency response for the ideal anti-imaging digital ﬁlter is then  HL f   =  cid:26  10 ,  0  0 ≤ f < fs 20 , fs 20 ≤ f ≤ fs 2   c  Using Table 6.1 and Table 6.2 with m = 30, p = m 2, and the Hamming window, the  FIR ﬁlter coeﬃcients are  bi = w i h i   =  cid:20 .54 − .46 cos cid:18  πi =  cid:20 .54 − .46 cos cid:18  πi  .5m cid:19  cid:21  sin[2π i − p FLT ] 15 cid:19  cid:21  sin[2π i − 15  20]  π i − p   π i − 15   ,  i 6= 15  679    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is   d  From  8.2.12  the interpolator diﬀerence equation is  b15 = w p h p   = [.54 − .46 cos π ]2FLT = 2 20  = .1  y k  =  =  m  30  Xi=0 Xi=0  biδL k − i x cid:18  k − i L  cid:19  biδ10 k − i x cid:18 k − i 10  cid:19   680    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.5 Consider the sampling rate interpolator shown previously in Figure 8.6. The input x k  is sampled at rate fs and has a triangular magnitude spectrum Ax f   as shown in Figure 8.43. Suppose the up-sampling factor is L = 3.   a  Sketch the spectrum of the zero-interpolated signal xL k  deﬁned in  8.2.5  for 0 ≤ f ≤  fs 2.   b  Sketch the magnitude response of the ideal anti-imaging ﬁlter HL z .  c  Sketch the magnitude spectrum of y k  for 0 ≤ f ≤ fs 2.  Magnitude Spectrum of x k   1.5  1  0.5    f    A  x  0 −0.5  Solution  0 f f  s  0.5  Figure 8.43 Magnitude Spectrum of x k  in Problem 8.5  681    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  x     f    H   L  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  3.5  4  3  2  1  2.5  1.5  0.5  0  0   a  Spectrum of x   k   L  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 8.5  a  Spectrum of xL k    b  Magnitude Response  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 8.5  b  Magnitude Response of HL z   682    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Spectrum of y k     f    A  y  1.5  2.5  3  2  1  0.5  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 8.5  c  Magnitude Spectrum of y k   683    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.6 Consider the problem of designing a rational sampling rate converter with a frequency con-  version factor of L M = 2 3.   a  Sketch a block diagram of the sampling rate converter.   b  Find the required frequency response of the ideal anti-aliasing and anti-imaging digital  ﬁlter assuming fs is the sampling rate of x k .   c  Use Tables 6.1 and 6.2 to design an anti-aliasing and anti-imaging ﬁlter of order m = 50  using the windowing method with the Blackman window.   d  Find the diﬀerence equation for the sampling rate converter.  Solution  x e - ↑ 2  - H0 z   - ↓ 3  e y  Problem 8.6  a  Rational Sampling Rate Converter   b  Here L = 2 and M = 3. From  8.3.2  the cutoﬀ frequency is  F0 = min cid:26  fs  4  ,  fs  6  cid:27   =  fs 6  The passband gain is L = 3. Thus  HL f   =  cid:26  3 ,  0 ≤ f < fs 6 0 , fs 6 ≤ f < ∞   c  Using Table 6.1 and Table 6.2 with m = 50, p = m 2, and the Blackman window, the  FIR ﬁlter coeﬃcients are  bi = w i h i   =  cid:20 .42 − .5 cos cid:18  πi =  cid:20 .42 − .5 cos cid:18  πi  .5m cid:19  + .08 cos cid:18  2πi 25 cid:19  + .08 cos cid:18  2πi  .5m cid:19  cid:21  sin[2π i − p F0T ] π i − p  25  cid:19  cid:21  sin[2π i − 25  6]  π i − 25   684    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is   d  From  8.3.4  the rational sampling rate converter diﬀerence equation is  b25 = w p h p   = [.42 − .5 cos π  + .08 cos 2π ]2F0T = 1 3  y k  =  =  m  50  Xi=0 Xi=0  biδL M k − i x cid:18 M k − i L  cid:19  biδ2 3k − i x cid:18  3k − i 2  cid:19   685    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.7 Consider the problem of designing a rational sampling rate converter with a frequency con-  version factor of L M = 5 4.   a  Sketch a block diagram of the sampling rate converter.   b  Find the required frequency response of the ideal anti-aliasing and anti-imaging digital  ﬁlter assuming fs is the sampling rate of x k .   c  Use Tables 6.1 and 6.2 to design an anti-aliasing and anti-imaging ﬁlter of order m = 50  using the windowing method with the Blackman window.   d  Find the diﬀerence equation for the sampling rate converter.  Solution  x e - ↑ 5  - H0 z   - ↓ 4  e y  Problem 8.7  a  Rational Sampling Rate Converter   b  Here L = 5 and M = 4. From  8.3.2  the cutoﬀ frequency is  F0 = min cid:26  fs  10  ,  fs  8 cid:27   =  fs 10  The passband gain is L = 5. Thus  HL f   =  cid:26  5 ,  0 ≤ f < fs 10 0 , fs 10 ≤ f < ∞   c  Using Table 6.1 and Table 6.2 with m = 50, p = m 2, and the Blackman window, the  FIR ﬁlter coeﬃcients are  bi = w i h i   =  cid:20 .42 − .5 cos cid:18  πi =  cid:20 .42 − .5 cos cid:18  πi  .5m cid:19  + .08 cos cid:18  2πi 25 cid:19  + .08 cos cid:18  2πi  .5m cid:19  cid:21  sin[2π i − p F0T ] π i − p  25  cid:19  cid:21  sin[2π i − 25  10]  π i − 25   686    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is   d  From  8.3.4  the rational sampling rate converter diﬀerence equation is  b25 = w p h p   = [.42 − .5 cos π  + .08 cos 2π ]2F0T = 1 5  y k  =  =  m  50  Xi=0 Xi=0  biδL M k − i x cid:18 M k − i L  cid:19  biδ5 4k − i x cid:18  4k − i 5  cid:19   687    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.8 Suppose a multirate signal processing application requires a sampling rate conversion factor  of L M = .525.   a  Find the required frequency response of the ideal anti-aliasing and anti-imaging digital  ﬁlter assuming a single-stage converter is used.   b  Factor L M into a product of two rational numbers whose numerators and denominators  are less than 10.  of L M from part  b .   c  Sketch a block diagram of a multi-stage sampling rate converter based on your factoring   d  Find the required frequency responses of the ideal combined anti-aliasing and anti-  imaging digital ﬁlters for each of the stages in part  c .  Solution   a  The reduced conversion factor is  From  8.3.2 , the ﬁlter cutoﬀ frequency is  From  8.3.3 , the required frequency response for the anti-aliasing and anti-imaging ﬁlter is  H0 f   =  cid:26  21 ,  0  0 ≤ f < fs 80 , fs 80 ≤ f ≤ fs 2   b  The numerator and denominator each can be factored to yield  L M  =  =  525 1000 21 40  ,  F0 = min cid:26  fs = min cid:26  fs  42  2L  ,  fs  2M cid:27  80 cid:27   fs  =  fs 80  L M  =  21 40  =  cid:18  7  8 cid:19  cid:18  3 5 cid:19   688    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   stage 1  stage 2  x e - ↑ 7 - H1 z  - ↓ 8  -  ↑ 3 - H2 z  - ↓ 5  e y  Problem 8.8  c  Multi-stage Sampling Rate Converter   d  From  8.3.2  the cutoﬀ frequency for H1 z  is  Using  8.3.3 , the required frequency response for the stage 1 anti-aliasing and anti- imaging ﬁlter is  H1 f   =  cid:26  7 ,  0 ≤ f < fs 16 0 , fs 16 ≤ f ≤ fs 2  Next, from  8.3.2 , the cutoﬀ frequency for H2 z  is  ,  F1 = min cid:26  fs = min cid:26  fs  14  2L  ,  fs  2M cid:27  16 cid:27   fs  =  fs 16  F2 = min cid:26  fs = min cid:26  fs  6  2L  ,  ,  fs  2M cid:27  10 cid:27   fs  =  fs 10  Using  8.3.3 , the required frequency response for the stage 2 anti-aliasing and anti- imaging ﬁlter is  H2 f   =  cid:26  3 ,  0 ≤ f < fs 10 0 , fs 10 ≤ f ≤ fs 2  689    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.9 Suppose a multirate signal processing application requires a sampling rate conversion factor  of L M = 3.15.   a  Find the required frequency response of the ideal anti-aliasing and anti-imaging digital  ﬁlter assuming a single-stage converter is used.   b  Factor L M into a product of two rational numbers whose numerators and denominators  are less than 10.  of L M from part  b .   c  Sketch a block diagram of a multi-stage sampling rate converter based on your factoring   d  Find the required frequency responses of the ideal combined anti-aliasing and anti-  imaging digital ﬁlters for each of the stages in part  c .  Solution   a  The reduced conversion factor is  From  8.3.2 , the ﬁlter cutoﬀ frequency is  From  8.3.3 , the required frequency response for the anti-aliasing and anti-imaging ﬁlter is  H0 f   =  cid:26  63 ,  0  0 ≤ f < fs 126 , fs 126 ≤ f ≤ fs 2   b  The numerator and denominator each can be factored to yield  L M  =  =  1315 100 63 20  ,  F0 = min cid:26  fs = min cid:26  fs  2L  126  fs  2M cid:27  40 cid:27   fs  ,  =  fs 126  L M  =  63 20  =  cid:18  9  5 cid:19  cid:18  7 4 cid:19   690    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   stage 1  stage 2  x e - ↑ 9 - H1 z  - ↓ 5  -  ↑ 7 - H2 z  - ↓ 4  e y  Problem 8.9  c  Multi-stage Sampling Rate Converter   d  From  8.3.2  the cutoﬀ frequency for H1 z  is  Using  8.3.3 , the required frequency response for the stage 1 anti-aliasing and anti- imaging ﬁlter is  H1 f   =  cid:26  9 ,  0 ≤ f < fs 18 0 , fs 18 ≤ f ≤ fs 2  Next, from  8.3.2 , the cutoﬀ frequency for H2 z  is  ,  F1 = min cid:26  fs = min cid:26  fs  18  2L  ,  fs  2M cid:27  10 cid:27   fs  =  fs 18  ,  F2 = min cid:26  fs = min cid:26  fs  14  2L  ,  fs  2M cid:27  8  cid:27   fs  =  fs 14  Using  8.3.3 , the required frequency response for the stage 2 anti-aliasing and anti- imaging ﬁlter is  H2 f   =  cid:26  7 ,  0 ≤ f < fs 14 0 , fs 14 ≤ f ≤ fs 2  691    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.10 Consider an integer decimator with down-sampling factor M and a linear-phase FIR anti-  aliasing ﬁlter of order m.   a  Find nM , the number of ﬂoating point multiplications  FLOPs  needed to compute each  sample of the output using a direct realization.   b  Suppose a polyphase ﬁlter realization is used to implement the decimator. Find NM ,  the number of FLOPs needed to compute each sample of the output.   c  Express NM as a percentage of nM .  Solution   a  From  8.2.4 , the diﬀerence equation for an integer decimator is  y k  =  h i x M k − i   m  Xi=0  Since M and k are both integers, computing M k is an integer multiplication, not a ﬂoating point multiplication. Thus the number of FLOPs is   b  From  8.4.4 , the number of FLOPs required to compute an output sample is   c  Expressing NM as a percentage of nM we have  nM = m + 1  NM =  =  ρM fs m + 1  M  P =  =  100NM  nM  100 M  %  692    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.11 Consider the problem of designing a decimator with fs = 60 Hz and a down-sampling factor  of M = 3.   a  What is the sampling rate of the output signal?   b  Sketch the desired magnitude response of the ideal anti-aliasing ﬁlter HM  z .  c  Suppose the anti-aliasing ﬁlter is a windowed ﬁlter of order m = 32 using the Hamming  window. Use Tables 6.1 and 6.2 to ﬁnd the impulse response, hM  k .   d  Suppose a polyphase realization is used. Find the transfer functions Ei z  of the  polyphase ﬁlters.   e  Sketch a block diagram of a polyphase ﬁlter realization of the decimator.  Solution   a  The sampling rate of the output signal is   b  From  8.2.3 , the ideal cutoﬀ frequency is  fS =  fs M  = 20 Hz  FM =  fs 2M  = 10 Hz  The required frequency response for the ideal anti-aliasing digital ﬁlter is then  HM  f   =  cid:26  1 ,  0 ≤ f < 10 0 , 10 ≤ f ≤ 30   c  Using Table 6.1 and Table 6.2 with m = 32, p = m 2, and the Hamming window, the  FIR ﬁlter coeﬃcients are  hM  k  = w k h k   =  cid:20 .54 − .46 cos cid:18  πi =  cid:20 .54 − .46 cos cid:18  πi  .5m cid:19  cid:21  sin[2π i − p FM T ] π i − p  16 cid:19  cid:21  sin[2π i − 16  6]  π i − 16   ,  k 6= 16  693    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Anti−Aliasing Magnitude Response  1.5  1  0.5    f    A  0  0  5  10  20  25  30  15  f  Hz   Problem 8.11  b  Anti-Aliasing Filter Magnitude Response  The middle term is   d  From  8.4.2   hM  16  = w p h p   = [.54 − .46 cos π ]2FMT = 1 3  E0 z  =  h 3i z−i  E1 z  =  h 3i + 1 z−i  E2 z  =  h 3i + 2 z−i  32  32  Xi=0 Xi=0 Xi=0  32  694    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  e  -  E0 z3   x0  -   cid:15  cid:12  +  cid:14  cid:13  6  - ↓ 3  ey k     ?  z−1    ?  z−1  -  E1 z3   x1  -   cid:15  cid:12  +  cid:14  cid:13  6  -  E2 z3   x2  Problem 8.11  e  Polyphase Realization of Decimator  695    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.12 Consider an integer interpolator with an up-sampling factor of L and a linear-phase FIR  anti-imaging ﬁlter of order m.   a  Find nL, the number of ﬂoating-point multiplications  FLOPs  needed to compute each  sample of the output using a direct realization.   b  Suppose a polyphase ﬁlter realization is used to implement the interpolator. Find NL,  the number of FLOPs needed to compute each sample of the output.   c  Express NL as a percentage of nL.  Solution   a  From  8.2.12 , the diﬀerence equation for an integer interpolator is  y k  =  m  Xi=0  h i δL k − i x cid:18 k − i L  cid:19   Since L, k and i are integers, computing  k − i  L is an integer operation, not a ﬂoating point multiplication or division. Thus the number of FLOPs is   b  From  8.4.8  the number of FLOPs required to compute an output sample is   c  Expressing NM as a percentage of nM we have  nL = m + 1  NL =  =  ρL  f + s m + 1  L  P =  =  100NL  nL 100 L  %  696    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.13 Consider the problem of designing an interpolator with fs = 12 Hz and an up-sampling factor   a  What is the sampling rate of the output signal?   b  Sketch the desired magnitude response of the ideal anti-imaging ﬁlter HL z .  c  Suppose the anti-imaging ﬁlter is a windowed ﬁlter of order m = 20 using the Hanning  window. Use Tables 6.1 and 6.2 to ﬁnd the impulse response, hL k .   d  Suppose a polyphase realization is used. Find the transfer functions Fi z  of the polyphase   e  Sketch a block diagram of a polyphase ﬁlter realization of the interpolator.  L = 4.  ﬁlters.  Solution   a  The sampling rate of the output signal is   b  From  8.2.11 , the ideal cutoﬀ frequency is  fS = Lfs  = 48 Hz  FL =  fs 2L  = 1.5 Hz  The required frequency response for the ideal anti-aliasing digital ﬁlter is then  HL f   =  cid:26  4 , 0 ≤ f < 1.5 0 , 1.5 ≤ f ≤ 6   c  Using Table 6.1 and Table 6.2 with m = 20, p = m 2, and the Hanning window, the  FIR ﬁlter coeﬃcients are  hL k  = w k h k   = .5 cid:20 1 − cos cid:18  πi = .5 cid:20 1 − cos cid:18  πi  .5m cid:19  cid:21  sin[2π i − p FLT ] π i − p  10 cid:19  cid:21  sin[2π i − 10  6]  π i − 10   ,  k 6= 10  The middle term is  697    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   1  2  4  5  6  3  f  Hz   Problem 8.13  b  Anti-Imaging Filter Magnitude Response    f   A  3  6  5  4  2  1  0  0   d  From  8.4.6   Anti−Imaging Magnitude Response  hL 10  = w p h p   = .5[1 − cos π ]2FLT =  1 3  F0 z  =  h 4i z−i  F1 z  =  h 4i + 1 z−i  F2 z  =  h 4i + 2 z−i  F3 z  =  h 4i + 3 z−i  20  20  20  Xi=0 Xi=0 Xi=0 Xi=0  20  698    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  e - ↑ 4  -  F0 z4   x0  -  ey k             cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  -  F1 z4   x1  -  -  F2 z4   x2  -  -  F3 z4   x3  Problem 8.13  e  Polyphase Realization of Interpolator  699    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.14 Consider a polyphase ﬁlter realization of a rational rate converter with rate conversion factor  L M = 2 3.   a  Suppose the following FIR ﬁlter is used for the anti-aliasing ﬁlter of the decimator part.  Find the ﬁlters Ei z  for a polyphase realization of HM  z .   b  Suppose the following FIR ﬁlter is used for the anti-imaging ﬁlter of the interpolator  part. Find the ﬁlters Fi z  for a polyphase realization of HL z .   c  Sketch a block diagram of a polyphase realization of the rational rate converter using a  cascade conﬁguration of an interpolator followed by a decimator.  Solution   a  Here M = 3. Thus from  8.4.2    b  Here L = 2. Thus from  8.4.6   HM  z  =  biz−i  HL z  =  ciz−i  30  Xi=0  30  Xi=0  E0 z  =  h 3i z−i  E1 z  =  h 3i + 1 z−i  E2 z  =  h 3i + 2 z−i  F0 z  =  h 2i z−i  F1 z  =  h 2i + 1 z−i  30  30  Xi=0 Xi=0 Xi=0  30  30  30  Xi=0 Xi=0  700    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  e - ↑ 2  -     F0 z2   x0  -   cid:15  cid:12 +  cid:14  cid:13  6  u e  -  E0 z3   y0  -   cid:15  cid:12  + - ↓ 3  cid:14  cid:13  6  ey k   z−1  6 6  -  F1 z2   x1    ?  z−1    ?  z−1  -  E1 z3   y1  -   cid:15  cid:12  +  cid:14  cid:13  6  -  E2 z3   y2  Problem 8.14  c  Polyphase Realization of a Rational Rate Converter  701    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.15 Consider a polyphase ﬁlter realization of a rational rate converter with rate conversion factor  L M = 4 3.   a  Suppose the following FIR ﬁlter is used for the anti-aliasing ﬁlter of the decimator part.  Find the ﬁlters Ei z  for a polyphase realization of HM  z .   b  Suppose the following FIR ﬁlter is used for the anti-imaging ﬁlter of the interpolator  part. Find the ﬁlters Fi z  for a polyphase realization of HL z .   c  Sketch a block diagram of a polyphase realization of the rational rate converter using a  cascade conﬁguration of a decimator and an interpolator.  Solution   a  Here M = 3. Thus from  8.4.2    b  Here L = 4. Thus from  8.4.6   HM  z  =  biz−i  HL z  =  ciz−i  40  Xi=0  40  Xi=0  40  40  Xi=0 Xi=0 Xi=0  40  40  40  40  Xi=0 Xi=0 Xi=0 Xi=0  40  E0 z  =  h 3i z−i  E1 z  =  h 3i + 1 z−i  E2 z  =  h 3i + 2 z−i  F0 z  =  h 4i z−i  F1 z  =  h 4i + 1 z−i  F2 z  =  h 4i + 2 z−i  F3 z  =  h 4i + 3 z−i  702    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  e - ↑ 4  -     F0 z4   x0  -  u e  -  E0 z3   y0  -   cid:15  cid:12  + - ↓ 3  cid:14  cid:13  6  ey k     ?  z−1    ?  z−1  -  E1 z3   y1  -   cid:15  cid:12  +  cid:14  cid:13  6  -  E2 z3   y2   cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  cid:15  cid:12  +  cid:14  cid:13  6  z−1  6  -     F1 z4   x1  -  -     F2 z4   x2  -  -  F3 z4   x3  Problem 8.15  c  Polyphase Realization of a Rational Rate Converter  703    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.16 Consider the following FIR ﬁlter.  H z  = 1 + 3z−1 + 5z−2 + · · · + 23z−11   a  Find polyphase ﬁlters Ei z  such that   b  Find polyphase ﬁlters Ei z  such that  H z  =  z−iEi z2   H z  =  z−iEi z6   1  Xi=0  5  Xi=0   c  Which of the two polyphase realizations of H z  is faster in terms of the number of ﬂoating point multiplications per output sample? How many times faster is it than a direct implementation of H z ?  Solution   a  Using  8.4.2  with M = 2, m = 11, and p = ﬂoor m M   = 5  = 1 + 5z−1 + 9z−2 + 13z−3 + 17z−4 + 21z−5  = 3 + 7z−1 + 11z−2 + 15z−3 + 19z−4 + 23z−5  E0 z  =  h 2i z−i  =   4i + 1 z−i  E1 z  =  h 2i + 1 z−i  =   4i + 3 z−i  5  5  Xi=0 Xi=0  5  5  Xi=0 Xi=0  704    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Using  8.4.2  with M = 6, m = 11, and p = ﬂoor m M   = 1  E0 z  =  h 6i z−i  =   12i + 1 z−i  = 1 + 13z−1  E1 z  =  h 6i + 1 z−i  =   12i + 3 z−i  = 3 + 15z−1  E2 z  =  h 6i + 2 z−i  =   12i + 5 z−i  = 5 + 17z−1  E3 z  =  h 6i + 3 z−i  =   12i + 7 z−i  = 7 + 19z−1  E4 z  =  h 6i + 4 z−i  =   12i + 9 z−i  = 9 + 21z−1  E5 z  =  h 6i + 5 z−i  1  1  Xi=0 Xi=0  1  1  Xi=0 Xi=0  1  1  Xi=0 Xi=0  1  1  Xi=0 Xi=0  1  1  Xi=0 Xi=0  1  1  Xi=0 Xi=0  =   12i + 11 z−i  = 11 + 23z−1  705   c  From  8.4.4  the computational rate for part  a  is ρ2 = 6fs FLOPs sec and the com- putational rate for part  b  is ρ6 = 2fs FLOPs sec. Thus the polyphase realization in part  b  is faster. It is faster than a direct realization of H z  by a factor of M = 6.    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.17 Consider the following FIR ﬁlter.  H z  = 2 + 4z−1 + 6z−2 + · · · + 24−11   a  Find polyphase ﬁlters Ei z  such that   b  Find polyphase ﬁlters Ei z  such that  H z  =  z−iEi z4   H z  =  z−iEi z3   3  Xi=0  2  Xi=0   c  Which of the two polyphase realizations of H z  is faster in terms of the number of ﬂoating point multiplications per output sample? How many times faster is it than a direct implementation of H z ?  Solution   a  Using  8.4.2  with M = 4, m = 11, and p = ﬂoor m M   = 2  706    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   E0 z  =  h 4i z−i  =   8i + 2 z−i  = 2 + 10z−1 + 18z−2  E1 z  =  h 4i + 1 z−i  =   8i + 4 z−i  = 4 + 12z−1 + 20z−2  E2 z  =  h 4i + 2 z−i  =   8i + 6 z−i  = 6 + 14z−1 + 22z−2  E3 z  =  h 4i + 3 z−i  2  2  Xi=0 Xi=0  2  2  Xi=0 Xi=0  2  2  Xi=0 Xi=0  2  2  Xi=0 Xi=0  =   8i + 8 z−i  = 8 + 16z−1 + 24z−2  707   b  Using  8.4.2  with M = 3, m = 11, and p = ﬂoor m M   = 3    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  From  8.4.4  the computational rate for part  a  is ρ4 = 3fs FLOPs sec and the com- putational rate for part  b  is ρ3 = 4fs FLOPs sec. Thus the polyphase realization in part  a  is faster. It is faster than a direct realization of H z  by a factor of M = 4.  E0 z  =  h 3i z−i  =   6i + 2 z−i  = 2 + 8z−1 + 14z−2 + 20z−3  E1 z  =  h 3i + 1 z−i  =   6i + 4 z−i  = 4 + 10z−1 + 16z−2 + 22z−3  E2 z  =  h 3i + 2 z−i  =   6i + 6 z−i  = 6 + 12z−1 + 18z−2 + 24z−3  3  3  Xi=0 Xi=0  3  3  Xi=0 Xi=0  3  3  Xi=0 Xi=0  708    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.18 Consider the problem of designing a multirate narrowband lowpass FIR ﬁlter as shown in Figure 8.44. Suppose the sampling frequency is fs = 8000 Hz and the cutoﬀ frequency is F0 = 200 Hz.   a  Find the largest integer frequency conversion factor M that can be used.  b  Using  6.3.6 , design an anti-aliasing ﬁlter HM  z  of order m = 32 using the frequency-  sampled method. Do not use any transition band samples.  x e - HM  z   - ↓ M  - G z   - ↑ M  - HM  z   e y  Figure 8.44 A Multirate Narrowband FIR Filter  Solution   a  From  8.5.2 , the largest frequency conversion factor is  M = ﬂoor cid:18  fs 4F0 cid:19  = ﬂoor cid:18  8000 4 200  cid:19   = 10  M F0 = 2000 Hz   b  From  8.5.3 , the multirate cutoﬀ frequency is  Here M F0 fs = .25. Thus the desired samples for a ﬁlter of order m = 32 are  Ar Fi  =  cid:26  1 ,  0 ≤ i ≤ 7 0 , 8 ≤ i ≤ 16  From  6.3.6 , the coeﬃcients of the linear-phase FIR frequency-sampled ﬁlter are  bk =  Ar 0  m + 1  +  =  1 33  +  7  Xi=0  ﬂoor m 2   Xi=0 cos cid:20  2π k − 16   33   cid:21   Ar Fi  cos cid:20  2π k − .5m   m + 1   cid:21   709    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.19 Consider the problem of designing a complex passband ﬁlter with the following ideal magni-  tude response.  A f   =    0 ≤ f < F0 0 , 1 , F0 ≤ f ≤ F1 0 , F1 < f < fs   a  Let B = F1 − F0 be the width of the passband, and consider the problem of designing a lowpass ﬁlter G z  with cutoﬀ frequency Fc = B 2. Using Tables 6.1 and 6.2, ﬁnd the impulse response g k  for a ﬁlter of order m = 60 using the windowing method with the Hamming window.   b  Using the frequency shift property in  8.5.4  and g k , ﬁnd the impulse response h k  of  the complex passband ﬁlter with cutoﬀ frequencies F0 and F1.   c  Is the magnitude response of H z  an even function of f ? Why or why not?   d  Is the magnitude response of H z  a periodic function of f ? If so, what is the period?  Solution   a  Using Table 6.1 and Table 6.2 with m = 60, p = m 2, and the Hamming window, the  FIR ﬁlter impulse response is  g k  = w k h k   =  cid:20 .54 − .46 cos cid:18  πk =  cid:20 .54 − .46 cos cid:18  πk  .5m cid:19  cid:21  sin[2π k − p FcT ] π k − p  30 cid:19  cid:21  sin[π k − 30 BT ]  π k − 30   ,  k 6= 30  The middle term is  g 30  = w p h p   = [.54 − .46 cos π ]2FcT = BT  =  F1 − F0  fs   b  One must use  8.5.4  to shift the spectrum to the right by F2 =  F0 + F1  2. Thus  h k  = exp jk2πF2T  g k   = exp[jkπ F0 + F1 T ] cid:20 .54 − .46 cos cid:18  πk  30 cid:19  cid:21  sin[π k − 30 BT ]  π k − 30   ,  k 6= 30  710    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Similarly, the middle term is  h 30  = exp jp2πF2T  g p   = exp[j30π F0 + F1 T ] cid:18 F1 − F0 fs  cid:19    c  The magnitude response is not an even function of f because the ﬁlter coeﬃcients, h k ,  are not real.   d  G f   is periodic with period fs. From  8.5.4 , H f   = G f − F2 . Therefore H f   is  periodic with period fs.  711    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.20 Consider the problem of designing a complex highpass ﬁlter with the following ideal magnitude  response.  A f   =   0 ,  0 ≤ f < F0 1 , F0 ≤ f < fs   a  Let B = fs − F0 be the width of the passband, and consider the problem of designing a lowpass ﬁlter G z  with cutoﬀ frequency Fc = B 2. Using Tables 6.1 and 6.2, ﬁnd the impulse response g k  for a ﬁlter of order m = 50 using the windowing method with the Blackman window.   b  Using the frequency shift property in  8.5.4  and g k , ﬁnd the impulse response h k  of  the complex highpass ﬁlter with a cutoﬀ frequency of F0.   c  Is the magnitude response of H z  an even function of f ? Why or why not?  d  Is the magnitude response of H z  a periodic function of f ? If so, what is the period?   a  Using Table 6.1 and Table 6.2 with m = 50, p = m 2, and the Blackman window, the FIR  Solution  ﬁlter coeﬃcients are  g k  = w k h k   The middle term is  =  cid:20 .42 − .5 cos cid:18  πk =  cid:20 .42 − .5 cos cid:18  πk  .5m cid:19  + .08 cos cid:18  2πk 25 cid:19  + .08 cos cid:18  2πk  .5m cid:19  cid:21  sin[2π k − p FcT ] π k − p  25  cid:19  cid:21  sin[π k − 25 BT ]  π k − 25   ,  k 6= 25  g 25  = w p h p   = [.52 − .5 cos π  + .08 cos 2π ]2FcT = BT  =  F1 − F0  fs   b  One must use  8.5.4  to shift the spectrum to the right by F2 =  Fs + fs  2. Thus  h k  = exp jk2πF2T  g k   = exp[jkπ F0 + fs T ] cid:20 .42 − .5 cos cid:18  πk  25 cid:19  + .08 cos cid:18 2  πk  25 cid:19  cid:21  ·  sin[π k − 25 BT ]  π k − 25   ,  k 6= 25  712    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Similarly, the middle term is  h 25  = exp jp2πF2T  g p   = exp[j25π F0 + fs T ] cid:18 F1 − F0 fs  cid:19    c  The magnitude response is not an even function of f because the ﬁlter coeﬃcients, h k , are  not real.  with period fs.   d  G f   is periodic with period fs. From  8.5.4 , H f   = G f − F2 . Therefore H f   is periodic  713    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.21 Consider the problem of designing a complex two-band ﬁlter with the magnitude response  shown in Figure 8.45.   a  Let B = .1fs be the width of each passband, and consider the problem of designing a lowpass ﬁlter G z  with cutoﬀ frequency Fc = B 2. Using Tables 6.1 and 6.2, ﬁnd the ﬁlter impulse response g k  for a ﬁlter of order m = 80 using the windowing method with the Hanning window.   b  Using the frequency shift property in  8.5.4  and g k , ﬁnd the impulse response h1 k   of the complex passband ﬁlter with cutoﬀ frequencies .1fs and .2fs.   c  Using the frequency shift property in  8.5.4  and g k , ﬁnd the impulse response h2 k   of the complex passband ﬁlter with cutoﬀ frequencies .3fs and .4fs.   d  Using h1 k  and h2 k , ﬁnd the impulse response h k  of a ﬁlter whose magnitude re-  sponse approximates A f   in Figure 8.45.   e  Sketch a block diagram of H z  using blocks H1 z  and H2 z .  Two−passband Magnitude Response  1.5    f   A  1  0.5  0  0  0.1  0.2  0.3  0.4  0.5  f f  s  Figure 8.45 Two-band Magnitude Response of Problem 8.21  Solution   a  Here B = .1fs and Fc = B 2. Using Table 6.1 and Table 6.2 with m = 80, p = m 2,  and the Hanning window, the FIR ﬁlter coeﬃcients are  714    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   g k  = w k h k   =  cid:20 .5 − .5 cos cid:18  πk =  cid:20 .5 − .5 cos cid:18  πk  .5m cid:19  cid:21  sin[2π k − p FcT ] .5m cid:19  cid:21  sin[π k − 40 BT ]  π k − p   π k − 40   ,  k 6= 40  The middle term is  g 40  = w p h p   = [.5 − .5 cos π ]2FcT = BT  = .1   b  One must use  8.5.4  to shift the spectrum to the right by F1 =  .1 + .2 fs 2 = .15fs.  Thus  h1 k  = exp jk2πF1T  g k   = exp[jk2π.15fsT    cid:20 .5 − .5 cos cid:18  πk = exp jkπ.3   cid:20 .5 − .5 cos cid:18  πk  .5m cid:19  cid:21  sin[π k − 40 BT ]  π k − 40  .5m cid:19  cid:21  sin[π k − 40 BT ]  π k − 40   ,  k 6= 40  The middle term is  h1 40  = exp jp2πF1T  g p   = exp[j80π .15 fsT ].1 = exp j12π .1 = .1   c  One must use  8.5.4  to shift the spectrum to the right by F2 =  .3 + .4 fs 2 = .35fs.  Thus  h2 k  = exp jk2πF2T  g k   = exp[jk2π.35fsT    cid:20 .5 − .5 cos cid:18  πk = exp jkπ.7   cid:20 .5 − .5 cos cid:18  πk  .5m cid:19  cid:21  sin[π k − 40 BT ]  π k − 40  .5m cid:19  cid:21  sin[π k − 40 BT ]  π k − 40   ,  k 6= 40  715    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is  h2 40  = exp jp2πF2T  g p   = exp[j80π .35 fsT ].1 = exp j28π .1  = .1   d  To account for both passbands, a parallel conﬁguration can be used where h1 k  passes  signals in the ﬁrst passband and h2 k  passes signals in the second passband. Thus  h k  = h1 k  + h2 k   x k  e     ?  cid:15  cid:12 +  cid:14  cid:13  6  ey k   - H1 z   - H2 z   Problem 8.21 Block Diagram of Two-band Filter  716    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.22 Let xM  k  = x M k  be the output of a factor of M down-sampler with input x k . Recall from  8.6.9  that the Z-transform of xM  k  can be written in terms of the Z-transform of x k  as follows where WM = exp −j2π M    Using the deﬁnitions of WM and the DTFT, show that the spectrum of xM  k  is  XM  z  =  X W −i  M z1 M    1 M  M −1  Xi=0  XM  f   =  1 M  M −1  Xi=0  X cid:18  f + ifs M  cid:19   Solution  The spectrum of xM  k  is XM  z  evaluated along the unit circle z = exp j2πf T  . Recalling that WM = exp −j2π M   the spectrum is  XM  f   =  X W −i  M z1 M   cid:12  cid:12  cid:12  cid:12  cid:12 z=exp j2πf T    M exp j2πf T  M  ]  X[W −i  X[exp j2πi M   exp j2πf T  M  ]  X{exp[j2π i + f T   M ]}  X{exp[j2π f T + ifsT   M ]}  X{exp[j2π f + ifs T  M ]} X cid:18  f + ifs M  cid:19   1 M  1 M  1 M  1 M  1 M  1 M  1 M  M −1  M −1  M −1  M −1  Xi=0 Xi=0 Xi=0 Xi=0 Xi=0 Xi=0 Xi=0  M −1  M −1  M −1  =  =  =  =  =  =  717    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.23 Consider the design of a two-channel QMF bank. Suppose the ﬁrst analysis bank ﬁlter has  transfer function F0 z  = 2 − z−3.  a  Find the remaining analysis and synthesis ﬁlter bank transfer functions that ensure an  alias-free QMF bank.   b  Find the overall QMF bank transfer function H z .   c  Find the output y k  in terms of the input x k .  Solution   a  From  8.6.19  the second analysis bank ﬁlter is  From  8.6.17  and  8.6.18 , the synthesis bank ﬁlters are  F1 z  = F0 −z  = 2 + z−3  G0 z  = F1 −z  = 2 − z−3 G1 z  = −F0 −z  = − 2 + z−3  = −2 − z−3  y k  = −2x k − 3   718   b  Since G0 z  = F0 z , it follows from  8.6.23  that  H z  = .5[F 2  0  z  − F 2  0  −z ]  = .5[ 2 − z−3 2 −  2 + z−3 2] = .5[4 − 2z−3 + z6 −  4 + 2z−3 + z−6 ] = −2z−3   c  From the delay property of the Z-transform    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.24 Consider the two-band ﬁlter whose magnitude response was shown previously in Figure 8.45.  Find the power gain Γ of this ﬁlter.  Solution  If h k  is the impulse response, then from  7.8.9  or  8.7.8  the power gain of the ﬁlter is  Γ =  h2 k   ∞  Xk=−∞  Using Parsevals identity from Table 4.3  Γ =  −fs 2 H f  2df  ∞  1  h k 2  Xk=−∞ fs Z fs 2 fs  cid:18 2Z .2fs  .1fs  1   .1fs + .1fs   =  =  =  2 fs = .4  df + 2Z .4fs  .3fs  df cid:19   719    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.25 Consider an ideal lowpass ﬁlter with a passband gain of A ≥ 1 and a cutoﬀ frequency of  Fc < fs 2. For what value of Fc is the power gain equal to one?  Solution  Using Parseval’s identity from Table 4.3 and  8.7.8  the power gain is  Setting Γ = 1 and solving for Fc yields  Γ =  ∞  ∞  1  h2 k   Xi=−∞ Xi=−∞ h k 2 fs Z fs 2 fs Z fs 2 fs Z Fc  0 2A2Fc  2  2  0  fs  −fs 2 H f  2df  H f  2df A2df  =  =  =  =  =  Fc =  fs 2A2  720    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.26 Consider the 10-bit oversampling ADC shown in Figure 8.46 with analog inputs in the range  xa t  ≤ 5.  a  Find the average power of the quantization noise of the quantized input, xq k .  b  Suppose a second-order Butterworth ﬁlter is used for the analog anti-aliasing preﬁlter. The objective is to reduce the aliasing error by a factor of  cid:15  = .005. Find the minimum required oversampling factor M .   c  Find the average power of the quantization noise at the output, y k , of the oversampling  ADC.  ﬁlter HM  f  .   d  Suppose fs = 1000 Hz. Sketch the ideal magnitude response of the digital anti-aliasing   e  Using Tables 6.1 and 6.2, design a linear-phase FIR ﬁlter of order m = 80 whose fre- quency response approximates HM  f   using the windowing method with a Hanning window.  xa e - Ha s   - ADC  -xq  HM  z   - ↓ M  e y  Figure 8.46 An Oversampling ADC with an Oversampling Factor M  Solution   a  Using  8.7.4  with c = 5 and N = 10, the input quantization level is  From  8.7.6 , the average power of the quantization noise of the quantized input xq k  is  q =  =  c  2N −1 5  512  = .0098  σ2 v =  q2 12  = 7.947 × 10−6  721    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  From  7.4.1 , the magnitude response of a second order analog Butterworth lowpass  ﬁlter with cutoﬀ frequency Fa is  The maximum magnitude of the aliasing error occurs at the folding frequency fd = fs 2. To reduce the aliasing error by a factor of at least  cid:15  = .005 set A2 fd  ≤  cid:15  or  If oversampling by a factor of M is used, then fs = 2M Fa where Fa is the bandwidth of xa t . Thus  Taking reciprocals and squaring both sides yields  Solving for M we then get  A2 f   =  1  p1 +  f  Fa 4  p1 +  fs  2Fa 4 ≤ .005  1  1  √1 + M 4 ≤ .005  1 + M 4 ≥  200 2  M = ceil[ 4 × 104  − 1  1 4]  = ceil 14.142   = 15  σ2 y =  q2 12M σ2 v M  = = 5.298 × 10−7  722   c  From  8.7.7  the average power of the quantization noise at the output of the oversam-  pling ADC is    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    d  Here fs = 1000 Hz and M = 15. From  8.2.3 , the ideal cutoﬀ frequency is  The required frequency response for the ideal anti-aliasing digital ﬁlter is then  FM =  =  fs 2M 1000  30  = 33.333 Hz  HM  f   =  cid:26  1 ,  0 ≤ f < 33.333 0 , 33.333 ≤ f ≤ 500  Anti−Aliasing Magnitude Response  1.5  1  0.5    f    A  0  0  50  100  150  200  300  350  400  450  500  250 f  Hz   Problem 8.26  d  Anti-Aliasing Filter Magnitude Response   e  Using Table 6.1 and Table 6.2 with m = 80, p = m 2, and the Hanning window, the  FIR ﬁlter coeﬃcients are  b i  = w i h i   = .5 cid:20 1 − cos cid:18  πk = .5 cid:20 1 − cos cid:18  πk  .5m cid:19  cid:21  sin[2π k − p FM T ] 40 cid:19  cid:21  sin[2π k − 40 .0333]  π k − p   π k − 40   ,  k 6= 40  723    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   The middle term is  b40 = w p h p   = .5[1 − cos π ]2FMT =  2 33.333   1000  = .0667  724    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.27 A 12-bit oversampling ADC oversamples by a factor of M = 64. To achieve the same average power of the quantization noise at the output, but without using oversampling, how many bits are required?  Solution  From  8.7.12 , the quantization noise power of a B-bit ADC with oversampling by a factor of M is the same as the quantization noise power of an N -bit ADC without oversampling. Thus one can set B = 12, M = 64 and solve for N .  N = B +  log2 M    log2 64   2  2  = 12 +  = 12 + 3  = 15 bits  Note that each additional bit corresponds to oversampling by a factor of four.  725    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.28 Suppose an analog signal in the range xa t  ≤ 5 is sampled with a 10-bit oversampling ADC with an oversampling factor of M = 16. The output of the ADC is passed through an FIR ﬁlter H z  as shown in Figure 8.47 where  H z  = 1 − 2z−1 + 3z−2 − 2z−3 + z−4   a  Find the quantization level q   b  Find the power gain of the ﬁlter H z .   c  Find the average power of the quantization noise at the system output, y k .   d  To get the same quantization noise power, but without using oversampling, how many  bits are required?  xa t  e  - Oversampling  -xq k   H z   ADC  ey k   Figure 8.47 A Discrete-time Multirate System  Solution   a  Using  8.7.4  we have c = 5 and N = 10. Thus the quantization level is   b  Using  8.7.8 , the power gain of the ﬁlter H z  is  q =  =  c  2N −1 5  512  = .0098  Γ =  h2 i   m  Xi=0  = 19  = 1 + 4 + 9 + 4 + 1  726    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  8.7.7 , the average power of the quantization noise at the system output is   d  From  8.7.12  one bit must be added for each oversampling by a factor of four. Since  M = 16, this requires two additional bits if oversampling is not used. That is,  σ2 y = Γσ2 v Γq2 12 19 .0098 2  =  12  = = 1.51 × 10−4  N = 10 + 2  = 12 bits  727    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.29 Consider the 10-bit oversampling DAC shown in Figure 8.48 with analog outputs in the range  ya t  ≤ 10.  a  Suppose a ﬁrst-order Butterworth ﬁlter is used for the analog anti-imaging postﬁlter. The objective is to reduce the imaging error by a factor of  cid:15  = .05. Find the minimum required oversampling factor L.   b  Find the average power of the quantization noise at the output of the DAC.   c  Suppose fs = 2000 Hz. Find the ideal frequency response of the digital anti-imaging ﬁlter HL f  . Include passband equalizer compensation for both the analog anti-imaging ﬁlter and the zero-order hold.  x e - ↑ L  - HL z   -w  DAC  - Ha s   eya  Figure 8.48 An Oversampling DAC with an Oversampling Factor L  Solution   a  From  7.4.1 , the magnitude response of a ﬁrst order analog Butterworth lowpass ﬁlter with  cutoﬀ frequency Fa is  Since the magnitude response decreasing monotonically, the spectral images are all reduced by a factor of at least A1 fd  where fd = fs 2 is the folding frequency. Thus, to reduce the anti-imaging error by a factor of at least  cid:15  = .05 set A1 fd  ≤  cid:15  or  If oversampling by a factor of L is used, then fs = 2LFa where Fa is the bandwidth of x k . Thus  Taking reciprocals and squaring both sides yields  A1 f   =  1  p1 +  f  Fa 2  p1 +  fs  2Fa 2 ≤ .05  √1 + L2 ≤ .05  1  1  728    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Solving for L we then get   b  Using  8.7.4  with c = 10 and N = 10, the quantization level is  Then from  8.7.7 , the average power of the quantization noise at the DAC output is   c  Here fs = 2000 Hz, and L = 20. If Fa is the signal bandwidth, then from  8.8.6  the following  is the ideal frequency response of the digital anti-imaging ﬁlter.  HL f   =    20p1 +  f  Fa 2  T sinc πf T  20   0  0 ≤ f ≤ Fa , , Fa < f < fs 2  1 + L2 ≥ 400  L = ceil[ 400 − 1  1 2]  = ceil 19.975   = 20  q =  =  c  2N −1 10 512  = .0195  σ2 y =  =  q2 12L .0195 2 12 20   = 1.589 × 10−6  729    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.30 Using the GUI module g multirate, select the amplitude-modulated  AM  input. Reduce the sampling rate of the input using an integer decimator with a down-sampling factor of M = 2. Use a windowed ﬁlter with the Hanning window, and plot the following.   a  The time signals   b  Their magnitude spectra   c  The ﬁlter magnitude response   d  The ﬁlter impulse response  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  2  0    k   x  −2  0  2    k   y  0  −2  0  Amplitude−modulated input, L M = 0.5, Hanning window filter, m = 60  1000  1500  500  500  Problem 8.30  a  Amplitude Modulated Time Signals  k  1000  1500  730    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   Amplitude−modulated input, L M = 0.5, Hanning window filter, m = 60  200  400  600  800  1000  1200  1400  1600  1800  2000  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.30  b  Amplitude Modulated Magnitude Spectra  x k  x k  x k   ↑ L ↑ L ↑ L  H H H   z   z   z   0 0 0  ↓ M ↓ M ↓ M  y k  y k  y k   L M = 0.5, Hanning window filter, m = 60  0 0  0 0  400  200    f    A  x  0  0  200    f    A  y  100  0  0  0 0 0  0 0 0    f   A  1  0.8  0.6  0.4  0.2  0  0  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.30  c  Anti-Aliasing Filter Magnitude Response  731    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Impulse response  L M = 0.5, Hanning window filter, m = 60  x k  x k  x k  x k   ↑ L ↑ L ↑ L ↑ L  H H H H   z   z   z   z   0 0 0 0  ↓ M ↓ M ↓ M ↓ M  y k  y k  y k  y k   0 0 0 0  0 0 0 0    k   h  0.5  0.4  0.3  0.2  0.1  0  −0.1  −0.2  0  20  40  60  k  −2  0  Re z   2  Problem 8.30  d  Anti-Aliasing Filter Impulse Response    z   m I  3  2  1  0  −1  −2  −3  732    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.31 Using the GUI module g multirate, select the frequency-modulated  FM  input. Increase the sampling frequency of the input using an interpolator with an up-sampling factor of L = 3. Use a windowed ﬁlter with the Hamming window, and plot the following.   a  The time signals   b  Their magnitude spectra   c  The ﬁlter magnitude response   d  The ﬁlter phase response  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  2  0    k   x  −2  0  2    k   y  0  −2  0  Frequency−modulated input, L M = 3, Hamming window filter, m = 60  500  1000  1500  2000  2500  3000  3500  4000  4500  500  1000  1500  2000  2500  3000  3500  4000  4500  k  Problem 8.31  a  Frequency Modulated Time Signals  733    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   Frequency−modulated input, L M = 3, Hamming window filter, m = 60  1000  2000  3000  4000  5000  6000  1000  2000  4000  5000  6000  3000  f  Hz   Problem 8.31  b  Frequency Modulated Magnitude Spectra  x k  x k  x k   ↑ L ↑ L ↑ L  H H H   z   z   z   0 0 0  ↓ M ↓ M ↓ M  y k  y k  y k   L M = 3, Hamming window filter, m = 60  0 0  0 0  150  100  50    f    A  x  0  0  400    f    A  y  200  0  0  0 0 0  0 0 0  3.5  2.5    f   A  1.5  3  2  1  0.5  0  0  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.31  c  Anti-Imaging Filter Magnitude Response  734    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   ↑ L ↑ L ↑ L ↑ L  H H H H   z   z   z   z   0 0 0 0  ↓ M ↓ M ↓ M ↓ M  y k  y k  y k  y k   L M = 3, Hamming window filter, m = 60  0 0 0 0  0 0 0 0  4  2  0  −2  −4  0    f   φ  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.31  d  Anti-Imaging Filter Phase Response  735    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.32 Using the GUI module g multirate, print the magnitude responses of the following anti-aliasing  and anti-imaging ﬁlters using the linear scale.   a  Windowed ﬁlter with the Blackman window   b  Frequency-sampled ﬁlter   c  Least squares ﬁlter  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  3.5  2.5    f   A  1.5  3  2  1  0.5  0  0  L M = 1.5, Blackman window filter, m = 60  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.32  a  Windowed Filter with Blackman Window  736    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  3.5  2.5    f   A  1.5  3  2  1  0.5  0  0  0 0 0  0 0 0  3.5  2.5    f   A  1.5  3  2  1  0.5  0  0  x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   L M = 1.5, frequency−sampled filter, m = 60  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.32  b  Frequency-Sampled Filter  x k  x k  x k   ↑ L ↑ L ↑ L  H H H   z   z   z   0 0 0  ↓ M ↓ M ↓ M  y k  y k  y k   L M = 1.5, least−squares filter, m = 60  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.32  c  Least Squares Filter  737    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.33 Using the GUI module g multirate, adjust the ﬁlter order to m = 80. Print the magnitude  responses of the following anti-aliasing and anti-imaging ﬁlters using the dB scale.   a  Windowed ﬁlter with the Hanning window   b  Windowed ﬁlter with the Hamming window   c  Equiripple ﬁlter  Solution  x k  x k  x k  x k  x k  x k   ↑ L ↑ L ↑ L ↑ L ↑ L ↑ L  H H H H H H   z   z   z   z   z   z   0 0 0 0 0 0  ↓ M ↓ M ↓ M ↓ M ↓ M ↓ M  y k  y k  y k  y k  y k  y k   L M = 1.5, Hanning window filter, m = 80  0 0 0 0 0 0  0 0 0 0 0 0  0  −20  −40  −60    B d       f   A  −80  0  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.33  a  Windowed Filter with Hanning Window  738    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0  −20  −40  −60    B d       f   A  −80  0  0 0 0 0 0  0 0 0 0 0  0 0 0 0  0 0 0 0  0  −20  −40  −60    B d       f   A  −80  0  x k  x k  x k  x k  x k   ↑ L ↑ L ↑ L ↑ L ↑ L  H H H H H   z   z   z   z   z   0 0 0 0 0  ↓ M ↓ M ↓ M ↓ M ↓ M  y k  y k  y k  y k  y k   L M = 1.5, Hamming window filter, m = 80  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.33  b  Windowed Filter with Hamming Window  x k  x k  x k  x k   ↑ L ↑ L ↑ L ↑ L  H H H H   z   z   z   z   0 0 0 0  ↓ M ↓ M ↓ M ↓ M  y k  y k  y k  y k   L M = 1.5, equiripple filter, m = 80  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.33  c  Equiripple Filter  739    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.34 Using the GUI module g multirate, select the damped cosine input. Set the damping factor to c = .995, the up-sampling factor to L = 2, and the down-sampling factor to M = 3. Plot the following.   a  The time signals   b  The magnitude spectra  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  2  0    k   x  −2  0  2    k   y  0  −2  0  Damped cosine input, L M = 0.666667, least−squares filter, m = 60  50  100  150  200  250  300  350  400  450  500  50  100  150  200  300  350  400  450  500  250  k  Problem 8.34  a  Damped Cosine Time Signals  740    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   0 0  0 0  100  50    f    A  x  0  0  80  60  40  20  0  0    f    A  y  Damped cosine input, L M = 0.666667, least−squares filter, m = 60  200  400  600  800  1000  1200  1400  1600  1800  2000  200  400  600  800  1200  1400  1600  1800  2000  1000  f  Hz   Problem 8.34  b  Magnitude Spectra  741    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.35 Using the GUI module g multirate, record the word hello in x. Play it back to make sure it is a good recording. Save the recording in a MAT-ﬁle named prob8 35.mat using the Save option. Then reload it using the User-deﬁned option. Play it back with and without rate conversion to hear the diﬀerence. Plot the following.   a  The time signals   b  Their magnitude spectra   c  The ﬁlter impulse response  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  0.2  0    k   x  −0.2  −0.4  0  0.2  0    k   y  −0.2  −0.4  0  User−defined input from file prob8_35.mat, L M = 1.5, least−squares filter, m = 60  2000  4000  6000  8000  10000  12000  2000  4000  8000  10000  12000  6000 k  Problem 8.35  a  Time Signals  Recorded Word HELLO   742    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  40  20    f    A  x  0  0  60    f    A  y  40  20  0  0  0 0 0  0 0 0    k   h  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  0  x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   User−defined input from file prob8_35.mat, L M = 1.5, least−squares filter, m = 60  1000  2000  3000  4000  5000  6000  1000  2000  4000  5000  6000  3000 f  Hz   Problem 8.35  b  Magnitude Spectrum  Recorded Sound   x k  x k  x k   ↑ L ↑ L ↑ L  H H H   z   z   z   0 0 0  ↓ M ↓ M ↓ M  y k  y k  y k   Impulse response  L M = 1.5, least−squares filter, m = 60  20  40  60  k  −2  0  Re z   2  Problem 8.35  c  Filter Impulse Response    z   m I  3  2  1  0  −1  −2  −3  743    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.36 Use the GUI module g multirate and the User-deﬁned input option to load the MAT-ﬁle u multirate1. Convert the sampling rate using L = 4 and M = 3 and a frequency-sampled ﬁlter. Plot the following.   a  The time signals. What word is recorded?   b  Their magnitude spectra   c  The ﬁlter impulse response  Solution  x k   ↑ L  H   z   0  ↓ M  y k   0  0  0.5  1  0    k   x  −0.5  0  1    k   y  0  −1  0  User−defined input from file u_multirate1.mat, L M = 1.33333, least−squares filter, m = 60  1000  2000  3000  4000  5000  6000  7000  8000  9000  10000  1000  2000  3000  4000  5000  6000  7000  8000  9000  10000  k  Problem 8.36  a  Time Signals. The Word is “multirate”  744    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0    f    A  x  60  40  20  0  0  100    f    A  y  50  0  0  0 0 0  0 0 0    k   h  1  0.8  0.6  0.4  0.2  0  −0.2  −0.4  0  x k  x k   ↑ L ↑ L  H H   z   z   0 0  ↓ M ↓ M  y k  y k   User−defined input from file u_multirate1.mat, L M = 1.33333, least−squares filter, m = 60 80  500  1000  1500  2000  2500  3000  3500  4000  4500  5000  500  1000  1500  2000  2500  3000  3500  4000  4500  5000  f  Hz   Problem 8.36  b  Magnitude Spectra  x k  x k  x k   ↑ L ↑ L ↑ L  H H H   z   z   z   0 0 0  ↓ M ↓ M ↓ M  y k  y k  y k   Impulse response  L M = 1.33333, least−squares filter, m = 60  20  40  60  k  −1  0  Re z   1  2  Problem 8.36  c  Filter Impulse Response    z   m I  2  1  0  −1  −2  −2  745    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.37 Consider the following periodic analog signal with three harmonics.  xa t  = cos 2πt  − .8 sin 4πt  + .6 cos 6πt   Suppose this signal is sampled at fs = 64 Hz using N = 120 samples to produce a discrete- time signal x k  = xa kT   for 0 ≤ k < N . Write a MATLAB program that uses f decimate to decimate this signal by converting it to a sampling rate of Fs = 32 Hz. For the anti-aliasing ﬁlter use a windowed ﬁlter of order m = 40 with the Hamming window. Use the subplot command and the stem function to plot the following discrete-time signals on one screen.   a  The original signal x k    b  The resampled signal y k  below it using a diﬀerent color.  Solution  % Problem 8.37  f_header ’Problem 8.37’  N = 120; fs = 64; T = 1 fs; k = 0 : N-1; theta = 2*pi*k*T; x = cos theta  - 0.8*sin 2*theta  + 0.6*cos 3*theta ;  % Resample  fS = 32; M = fs fS m = 40; f_type = 2; [y,b] = f_decimate  x,fs,M,m,f_type ;  % Plot both signals  figure subplot  2,1,1  stem  k,x,’.’,’filled’  f_labels  ’Decimation of a Signal’,’k’,’x k ’  subplot  2,1,2  stem  [0: length y -1],y,’.r’,’filled’  f_labels  ’’,’k’,’y k ’  f_wait  746    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k   x    k   y  −1  −2  0  2  1  0  2  1  0  −1  −2  0  Decimation of a Signal  20  40  80  100  120  10  20  40  50  60  Problem 8.37 A Resampled Signal Using Decimation  60 k  30 k  747    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.38 Consider the following periodic analog signal with three harmonics.  xa t  = sin 2πt  − 3 cos 4πt  + 2 sin 6πt   Suppose this signal is sampled at fs = 24 Hz using N = 50 samples to produce a discrete- time signal x k  = xa kT   for 0 ≤ k < N . Write a MATLAB program that uses f interpol to interpolate this signal by converting it to a sampling rate of Fs = 72 Hz. For the anti- imaging ﬁlter use a least-squares ﬁlter of order m = 50. Use the subplot command and the stem function to plot the following discrete-time signals on the same screen.   a  The original signal x k    b  The resampled signal y k  below it using a diﬀerent color.  Solution  % Problem 8.38  % Construct signal  f_header ’Problem 8.38’  N = 50; fs = 24; T = 1 fs; k = 0 : N-1; theta = 2*pi*k*T; x = sin theta  - 3*cos 2*theta  + 2*sin 3*theta ;  % Resample  fS = 72; L = fS fs m = 50; f_type = 5; [y,b] = f_interpol  x,fs,L,m,f_type ;  % Plot both signals  figure subplot  2,1,1  stem  k,x,’.’,’filled’  axis  [0 length x  -6 6]  f_labels  ’Interpolation of a Signal’,’k’,’x k ’  subplot  2,1,2  stem  [0: length y -1],y,’.r’,’filled’  axis  [0 length y  -6 6]   748    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’’,’k’,’y k ’  f_wait  Interpolation of a Signal    k   x    k   y  −2  −4  −6  0  6  4  2  0  6  4  2  0  −2  −4  −6  0  10  20  30  40  50  50  100  150  Problem 8.38 A Resampled Signal Using Interpolation  k  k  749    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.39 Consider the following periodic analog signal with three harmonics.  xa t  = 2 cos 2πt  + 3 sin 4πt  − 3 sin 6πt   Suppose this signal is sampled at fs = 30 Hz using N = 50 samples to produce a discrete- time signal x k  = xa kT   for 0 ≤ k < N . Write a MATLAB program that uses f rateconv to convert it to a sampling rate of Fs = 50 Hz. For the anti-aliasing and anti-imaging ﬁlter use a frequency-sampled ﬁlter of order m = 60. Use the subplot command and the stem function to plot the following discrete-time signals on the same screen.   a  The original signal x k    b  The resampled signal y k  below it using a diﬀerent color.  Solution  % Problem 8.39  % Construct signal  f_header ’Problem 8.39’  N = 50; fs = 30; T = 1 fs; k = 0 : N-1; theta = 2*pi*k*T; x = 2*cos theta  + sin 2*theta  - 3*sin 3*theta ;  % Resample  L = 5 M = 3 m = 60; f_type = 4; [y,b] = f_rateconv  x,fs,L,M,m,f_type ;  % Plot both signals  figure subplot  2,1,1  stem  k,x,’.’,’filled’  axis  [0 length x  -6 6]  f_labels  ’Rate Conversion of a Signal’,’k’,’x k ’  subplot  2,1,2  stem  [0: length y -1],y,’.r’,’filled’  axis  [0 length y  -6 6]   750    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_labels  ’’,’k’,’y k ’  f_wait  Rate Conversion of a Signal  10  20  30  40  50    k   x    k   y  6  4  2  0  −2  −4  −6  0  6  4  2  0  −2  −4  −6  0  10  20  30  50  60  70  80  Problem 8.39 A Resampled Signal Using a Rational Rate Converter  k  40 k  751    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.40 Write a MATLAB function called u narrowband that uses the FDSP toolbox functions f ﬁrideal and f rateconv to compute the zero-state response of the multirate narrowband lowpass ﬁlter shown in Figure 8.44. The calling sequence for u narrowband is as follows.  [y,M] = u_narrowband  x,F0,win,fs,m ;  = array of length N containing input samples  x F0 = lowpass cutoff frequency  F0 <= fs 4  win = window type  % U_NARROWBAND: Compute output of multirate narrowband lowpass filter % % Usage: % % Pre: % % % % % % % % % % % % Post: % %  y = array of length N containing output samples M = frequency conversion factor used  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  fs = sampling frequency m  = filter order  even   Use the maximum frequency conversion factor possible. Test function u narrowband by writ- ing a program that uses it to design a lowpass ﬁlter with a cutoﬀ frequency of F 0 = 10 Hz, a sampling frequency of fs = 400 Hz, and a ﬁlter order of m = 50. Plot the following.   a  The narrowband ﬁlter impulse response   b  The narrowband ﬁlter magnitude response and the ideal magnitude response on the  same graph with a legend.  Solution  function prob8_40  % Initialize  f_header ’Problem 8.40’  fs = 400; F_0 = 10; m = 60; win =  2;  % Compute and plot narrowband impulse response  M = fs  4*F_0   752    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   N = 750; delta = [1,zeros 1,N-1 ]; [h,M] = u_narrowband  delta,F_0,win,fs,m ; figure k = 0 : N-1; plot  k,h  f_labels  ’Narrowband Impulse Response’,’k’,’h k ’  f_wait  % Compute and plot narrowband magnitude response  H = fft h ; A = abs  H ; figure f = linspace  0, N-1 *fs N,N ; i = 1 : N 2+1; hp = plot  f i ,A i ,[0 F_0 F_0 fs 2],[1 1 0 0] ; set  hp 2 ,’Linewidth’,1.5  legend  ’Narrowband Filter’,’Ideal’  f_labels  ’Narrowband Magnitude Response’,’f  Hz ’,’A f ’  f_wait  [y,M] = u_narrowband  x,F0,win,fs,m ;  = array of length N containing input samples  x F0 = lowpass cutoff frequency  F0 <= fs 4  win = window type  function [y,M] = u_narrowband  x,F0,win,fs,m  % % U_NARROWBAND: Compute output of multirate narrowband lowpass filter % % Usage: % % Pre: % % % % % % % % % % % % Post: % %  y = array of length N containing output samples M = frequency conversion factor used  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  fs = sampling frequency m  = filter order  even   % Compute maximum rate conversion factor  M = max 1,floor fs  4*F0   ; if M == 1  a = 1;  753    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   y = filter  b,a,x ;  f_type = 0; b = f_firideal  f_type,M*F0,m,fs,win ; y1 = f_rateconv  x,fs,1,M,m,win ; y2 = filter  b,1,y1 ; y = f_rateconv  y2,fs,M,1,m,win ;  else  end  Narrowband Impulse Response    k   h  0.05  0.04  0.03  0.02  0.01  0  −0.01  −0.02  0  100  200  300  500  600  700  800  400  k  Problem 8.40  a  Narrowband Impulse Response  754    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Narrowband Magnitude Response     Narrowband Filter Ideal  1.4  1.2  1    f   A  0.8  0.6  0.4  0.2  0    0  50  100  f  Hz   150  200  Problem 8.40  b  Narrowband Magnitude Response  755    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 8.41 Write a function called u synbank that synthesizes a composite signal x i  from N low- bandwidth subsignals xi k  using a uniform DFT synthesis ﬁlter bank. The calling sequence for u synbank is as follows.  x = u_synbank  X,m,alpha,win,fs ;  = an integer specifying the desired window type  = p by N matrix containing subsignal i in column i = order of anti-imaging filter  X m alpha = relative cutoff frequency: F_0 = alpha*fs  2N  win  % U_SYNBANK: Synthesize a complex composite signal from subsignals using a DFT filter bank. % % Usage: % % Pre: % % % % % % % % % % % % Post: % % %  signal. x contains N frequency-multiplexed subsignals. The bandwidth of x is N*fs 2 and the ith subsignal is in band i  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  x = complex vector of length q = Np containing samples of composite  = sampling frequency  fs  Test function u synbank by writing a program that uses the FDSP toolbox function f subsignals to construct a 32 by 4 matrix X with the samples of the kth subsignal in column k. The func- tion f subsignals produces signals whose spectra are shown in Figure 8.23. Use alpha = .5, f s = 200 Hz, and a windowed ﬁlter of order m = 90 with a Hamming window. Save x and f s in a MAT-ﬁle named prob8 41 and plot the following   a  The real and imaginary parts of the complex composite signal x i . Use subplot to  construct a 2 × 1 array of plots on one screen.   b  The magnitude spectrum A f   = X f   for 0 ≤ f ≤ f s.  Solution  function prob8_41  % Initialize  f_header ’Problem 8.41’  fs = 200; N = 4; p = 32; m = 90; win = 2;  756    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   alpha = 0.5;  % Compute and plot complex composite signal  X = f_subsignals  p ; x = u_synbank  X,m,alpha,win,fs ; q = length x ; k = 0 : q-1; figure subplot 2,1,1  plot k,real x   set  gca,’Fontsize’,11 ; f_labels ’Composite Signal’,’k’,’Real\{x k \}’  subplot 2,1,2  plot  k,imag x   f_labels ’’,’k’,’Imag\{x k \}’  f_wait save prob7_30 x fs fprintf  ’Creating prob7_30.mat\n’   % Compute and plot composite magnitude spectrum  H_x = fft x,q ; A_x = abs H_x ; f_x = linspace 0, q-1 *N*fs q,q ; figure plot f_x,A_x  set  gca,’Fontsize’,11 ; f_labels  ’Composite Magnitude Spectrum’,’f  Hz ’,’A f ’  axis [0 N*fs 0 4]  a = 2.75; text  fs 6,a,’A_0’,’HorizontalAlignment’,’Center’  text  fs,a,’A_1’,’HorizontalAlignment’,’Center’  text  2*fs,a,’A_2’,’HorizontalAlignment’,’Center’  text  3*fs,a,’A_3’,’HorizontalAlignment’,’Center’  text  N*fs-fs 5,a,’A_0’,’HorizontalAlignment’,’Center’  f_wait  function x = u_synbank  X,m,alpha,win,fs  % % U_SYNBANK: Synthesize a complex composite signal from subsignals using a DFT filter bank. % % Usage: % % Pre: % % % %  X m alpha = relative cutoff frequency: F_0 = alpha*fs  2N  win  = p by N matrix containing subsignal i in column i = order of anti-imaging filter  = an integer specifying the desired window type  x = u_synbank  X,m,alpha,win,fs ;  757    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x = complex vector of length q = Np containing samples of composite  signal. x contains N frequency-multiplexed subsignals. The bandwidth of x is N*fs 2 and the ith subsignal is in band i  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  fs  = sampling frequency  % % % % % % % % Post: % % %  % Change sampling rate  [p,N] = size X ; L = N; q = L*p; y = zeros q,N ; type = 2; for i = 1 : N  u = f_interpol X :,i ,fs,L,m,type,alpha ; Y :,i  = u : ;  end  end  % Construct composite signal  k = [0 : q-1]’; W_N = exp -j*2*pi N ; x = zeros q,1 ; for i = 1 : N  x = x + W_N.^ - i-1 *k  .* Y :,i ;  758    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Composite Signal  20  40  60  80  100  120  140  20  40  60  80  100  120  140  Problem 8.41  a  Components of the Complex Composite Signal  Composite Magnitude Spectrum  A 1  A 2  A 3  A 0  0.5  1  0  }   k   x { l a e R  −0.5  0  0.1  0.05  0  −0.05  −0.1  0  }   k   x { g a m I  3.5  A 0  2.5    f   A  1.5  4  3  2  1  0.5  0  0  100  200  300  400  500  600  700  800  f  Hz   Problem 8.41  b  Magnitude Spectrum of the Complex Composite Signal  k  k  759    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   8.42 Write a function called u analbank that analyzes a composite signal x i  and decomposes it into N low-bandwidth subsignals xi k  using a uniform DFT analysis ﬁlter bank. The calling sequence for u analbank is as follows.  x  X = u_analbank  x,N,m,alpha,win,fs ;  = complex vector of length q = Np containing samples of composite  = number of subsignals in x = order of anti-imaging filter  signal. x contains N frequency-multiplexed subsignals. The bandwidth of x is N*fs 2 and the ith subsignal is in band i  % U_ANALBANK: Analyze a complex composite signal into subsignals using a DFT filter bank. % % Usage: % % Pre: % % % % % % % % % % % % % % % Post: %  N m alpha = relative cutoff frequency: F_0 = alpha*fs  2N  win  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  = p by N matrix containing subsignal i in column i  = an integer specifying the desired window type  = sampling frequency  fs  X  Test function u analbank by writing a program that analyzes the composite signal x i  ob- tained from the solution to Problem 8.41. That is, load MAT-ﬁle prob8 41. Use alpha = .5, and a windowed ﬁlter of order m = 90 with a Hamming window. Plot the following   a  The magnitude spectrum A f   = X f   for 0 ≤ f ≤ f s.  b  The magnitude spectra of the subsignals extracted from X. Use subplot to construct a  2 × 2 array of plots on one screen.  Solution  function prob8_42  % Initialize  f_header ’Problem 8.42’  N = 4; m = 90; win = 2; alpha = 0.5; load ’prob7_30’ p = length x  N;  760    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Compute and plot composite magnitude spectrum  q = length x ; H_x = fft x,q ; A_x = abs H_x ; f_x = linspace 0, q-1 *N*fs q,q ; figure plot f_x,A_x  set  gca,’Fontsize’,11 ; f_labels  ’Composite Magnitude Spectrum’,’f  Hz ’,’A f ’  axis [0 N*fs 0 4]  a = 2.75; text  fs 6,a,’A_0’,’HorizontalAlignment’,’Center’  text  fs,a,’A_1’,’HorizontalAlignment’,’Center’  text  2*fs,a,’A_2’,’HorizontalAlignment’,’Center’  text  3*fs,a,’A_3’,’HorizontalAlignment’,’Center’  text  N*fs-fs 5,a,’A_0’,’HorizontalAlignment’,’Center’  f_wait  % Compute and plot magnitude spectra of subsignals  X = u_analbank  x,N,m,alpha,win,fs ; for i = 1 : N  Y = fft X :,i  ; A :,i  = abs fftshift Y  ;  end f = linspace  -fs 2, p-1 *fs  2*p ,p ’; figure for r = 1 : N  subplot  2,2,r  plot  f,A :,r   ylabel = sprintf  ’A_%d f ’,r-1 ; f_labels  ’’,’f  Hz ’,ylabel   end f_wait  function X = u_analbank  x,N,m,alpha,win,fs  % % U_ANALBANK: Analyze a complex composite signal into subsignals using a DFT filter bank. % % Usage: % % Pre: % % % % %  signal. x contains N frequency-multiplexed subsignals. The bandwidth of x is N*fs 2 and the ith subsignal is in band i  = number of subsignals in x = order of anti-imaging filter  = complex vector of length q = Np containing samples of composite  X = u_analbank  x,N,m,alpha,win,fs ;  N m  x  761    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   alpha = relative cutoff frequency: F_0 = alpha*fs  2N  win  = an integer specifying the desired window type  X  = p by N matrix containing subsignal i in column i  0 = rectangular 1 = Hanning 2 = Hamming 3 = Blackman  fs  = sampling frequency  % % % % % % % % % % Post: %  % Initialize  q = length x ; p = q N; X = zeros p,N ; M = N;  % Decompose composite signal  W_N = exp -j*2*pi N ; i = [0 : q-1]’; for k = 1 : N  y = zeros q,1 ; y = y + W_N.^  k-1 *i  .* x; u = f_decimate y,fs,M,m,win,alpha ; X :,k  = u : ;  end  762    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Composite Magnitude Spectrum  A 1  A 2  A 3  A 0  3.5  A 0  2.5    f   A  1.5  4  3  2  1  0.5  0  0  100  200  300  400  500  600  700  800  f  Hz   Problem 8.42  a  Magnitude Spectrum of the Complex Composite Signal  763    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0.8  0.6  0.4  0.2  0.8  0.6  0.4  0.2    f    A  0    f    A  2  0  −100  0  −100  −50  0  50  100  −50  0  50  100  f  Hz   f  Hz   −50  0  50  100  −50  0  50  100  f  Hz   f  Hz   Problem 8.42  b  Magnitude Spectra of Decomposed Subsignals    f    A  1  0.8  0.6  0.4  0.2  0.5  0.4  0  −100    f    A  3  0.3  0.2  0.1  0  −100  764    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Chapter 9  9.1 The transversal ﬁlter structure used in this chapter is a time-varying FIR ﬁlter. One can  generalize it by using the following time-varying IIR ﬁlter.  y k  =  bi k x k − i  −  ai k y k − i   m  Xi=0  n  Xi=1   a  Find suitable deﬁnitions for the state vector u k  and the weight vector w k  such that the output of the time-varying IIR ﬁlter can be expressed as a dot product as in  9.2.3 . That is,  y k  = wT  k u k   ,  k ≥ 0   b  Suppose the weight vector w k  converges to a constant. Is the resulting ﬁlter guaranteed  to be BIBO stable? Why or why not?  Solution  Then   a  Suppose the weight vector is b k  augmented by a k . That is,  w k   ∆ = [b0 k , . . ., bm k , a1 k , . . ., an k ]T  Next let u k  be the following  m + n + 1  × 1 state vector  ∆  u k   = [x k , . . ., x k − m , −y k − 1 , . . ., −y k − n ]T  y k  =  bi k x k − i  −  ai k y k − i   wi k ui k  +  wi k ui k   n  m+n+1  Xi=1 Xi=m+1  m  m  Xi=0 Xi=0 Xi=0  m+n+1  =  =  wi k ui k   = wT  k u k   ,  k ≥ 0  765    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  If w k  converges to a constant, the resulting IIR ﬁlter may or may not be BIBO stable. Unlike with an FIR ﬁlter, it is possible for the poles of an IIR ﬁlter to be on or outside the unit circle. Therefore the ﬁlter is not guaranteed to be BIBO stable.  766    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.2 Suppose a transversal adaptive ﬁlter is of order m = 2. Find the input auto-correlation matrix  R for the following cases.   a  The input x k  consists of white noise uniformly distributed over the interval [a, b].  b  The input x k  consists of Gaussian white noise with mean µx and variance σ2 x.  Solution   a  Since x k  is white noise uniformly distributed over [a, b] it can be represented as follows.  x k  = µx + v k   Here µx =  a + b  2 is the mean and v k  is zero-mean white noise uniformly distributed over [−c, c] where c =  b − a  2. Thus the auto-correlation matrix is  Rij = E[{µx + v k − i }{µx + v k − j }]  = E[µ2 = µ2 = µ2 = µ2  x] + E[µxv k − j ] + E[µxv k − i ] + E[v k − i v k − j]  x + µxE[v k − j ] + µxE[v k − i ] + δ i − j E[v2 i ] x + δ i − j E[v2 i ] x + δ i − j Pv  From Appendix 2, the average power of v k  is  Hence the auto-correlation matrix is  R =   a + b 2  4     1 1 1 1 1 1 1 1 1    +   b − a 2  12  1 0 0 0 1 0 0 0 1         b  The form of R will be the same, but with Pv = σ2  x. Thus  Pv = E[v2 k ]  =  =  c2 3  b − a 2  12  Rij = µ2  x + δ i − j σ2  x  767    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   With m = 2 this yields  R = µ2  x   1 1 1 1 1 1 1 1 1   x  + σ2   1 0 0 0 1 0 0 0 1     768    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.3 Find the constant term, Pd = E[d2 k ], of the mean square error when the desired output is  the following signal.  d k  = b + sin cid:18  2πk  N  cid:19  − cos cid:18  2πk N  cid:19   Solution  Pd = E[d2 k ]  From  9.2.18 , the constant term of the mean square error,  cid:15  w , is the average power of the desired output. Using the linearity properties of the expected value operator,  = E[{b + sin 2πk N   − cos 2πk N  }2] = E[{b + sin 2πk N  }2 − 2{b + sin 2πk N  } cos 2πk N   + cos2 2πk N  ] = E[b2 + 2b sin 2πk N   + sin2 2πk N   − 2b cos 2πk N   − 2 sin 2πk N   cos 2πk N   +  cos2 2πk N  ]  = E[b2] + 2bE[sin 2πk N  ] + E[sin2 2πk N  ] − 2bE[cos 2πk N  ] −  2E[sin 2πk N   cos 2πk N  ] + E[cos2 2πk N  ]  = b2 + E[sin2 2πk N  ] − 2E[sin 2πk N   cos 2πk N  ] + E[cos2 2πk N  ]  Next, using the trigonometric identities from Appendix 2,  Pd = b2 + .5E[1 + cos 2πk N  ] − E[sin 4πk N  ] + .5E[1 − cos 2πk N  ]  = b2 + .5 + .5 = b2 + 1  769    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.4 Consider a transversal ﬁlter of order m = 1. Suppose the input and desired output are as  follows.  x k  = 2 + sin πk 2  d k  = 1 − 3 cos πk 2    a  Find the cross-correlation vector p.   b  Find the input auto-correlation matrix R.  c  Find the optimal weight vector w∗.  Solution  correlation vector is  pi = rdx i    a  From  9.2.13 , Deﬁnition 9.1, and the trigonometric identities in Appendix 2, the cross-  = E[d k x k − i ] = E[{1 − 3 cos πk 2 }{2 + sin π[k − i] 2 }] = E[2 + sin π[k − i] 2  − 6 cos πk 2  − 3 cos πk 2 } sin π[k − i] 2 ] = E[2] + E[sin π[k − i] 2 ] − 6E[cos πk  2] − 3E[cos πk 2  sin π[k − i] 2 ] = 2 − 3E[cos πk 2  sin π[k − i] 2 ] = 2 − 1.5E[sin π[2k − i] 2  + sin π[−i] 2 ] = 2 − 1.5E[sin π[2k − i] 2 ] − 1.5E[sin π[−i] 2 ] = 2 + 1.5E[sin πi  2]  = 2 + 1.5 sin πi 2   ,  0 ≤ i ≤ 1  Thus the cross-correlation vector is  p = [2, 3.5]T   b  From  9.2.15 , Deﬁnition 9.1, and the trigonometric identities in Appendix 2, the auto-  correlation matrix is  770    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Rij = rxx j − i   = E[x k x k − j + i ] = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] = E[4 + 2 sin π[k − j + i] 2  + 2 sin πk 2  + sin πk 2  sin π[k − j + i] 2 ] = E[4] + 2E[sin π[k − j + i] 2 ] + 2E[sin πk 2 ] + E[sin πk 2  sin π[k − j + i] 2 ] = 4 + E[sin πk 2  sin π[k − j + i] 2 ] = 4 + .5E[cos π[j − i] 2  − cos π[2k − j + i] 2 ] = 4 + .5E[cos π[j − i] 2 ] − .5E[cos π[2k − j + i] 2 ] = 4 + .5E[cos π[j − i] 2 ] = 4 + .5 cos π[j − i] 2   0 ≤ i, j ≤ 1  ,  Thus the auto-correlation matrix is   c  From  9.2.20 , the optimal weight vector is  R =  cid:20  4.5  4  4  4.5  cid:21   w∗ = R−1p  =  cid:20  4.5  4  4  4.5  cid:21 −1 cid:20  2 3.5  cid:21  −4 4.5  cid:21  cid:20  2 3.5  cid:21   1  =  4.25 cid:20  4.5 −4 =  cid:20  −1.1765 1.8235  cid:21   771    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.5 Suppose the ﬁrst row of an auto-correlation matrix R is r = [9, 7, 5, 3, 1].   a  Find R.   b  What is the average power of the input?   c  Suppose x k  is white noise uniformly distributed over the interval [0, c]. Find c.  Solution   a  Given the banded symmetric structure of R in  9.2.17 , the auto-correlation matrix is  R =     9 7 5 3 1 7 9 7 5 3 5 7 9 7 5 3 5 7 9 7 1 3 5 7 9      b  From  9.2.16 , the average power is   c  Using  9.2.8 , the average power of white noise uniformly distributed over [0, c] is Pv =  c3 3c. Thus  Solving for c yields c2 = 27 or  Px = Rii  = 9  c3 3c  = 9  c = √27  = 5.1962  772    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.6 Suppose v k  is white noise uniformly distributed over [−c, c]. Consider the following input.  x k  = 2 + sin πk 2  + v k   Find the input auto-correlation matrix R. Does your answer reduce to that of Problem 9.4 when c = 0?  Solution  When two signals are statistically independent, the expected value of their product is equal to the product of the expected value. From  9.2.15 , Deﬁnition 9.1, and the trigonometric identities in Appendix 2, the auto-correlation matrix is  Rij = rxx j − i   = E[x k x k − j + i ] = E[{2 + sin πk 2  + v k }{2 + sin π[k − j + i] 2  + v k − j + i }] = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 } + {2 + sin πk 2 }v k − j + i  +  v k {2 + sin π[k − j + i] 2 } + v k v k − j + i ]  = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + E[2 + sin πk 2 ]E[v k − j + i ] +  E[v k ]E[2 + sin π[k − j + i] 2  + E[v k v k − j + i ]  Since v k  is uniformly distributed about [−c, c], its mean is zero. Thus  Rij = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + E[v k v k − j + i ]  The samples of the white noise are statistically independent of one another. Thus when i 6= i, E[v k v k− j + i ] = E[v k ]E[v k− j + i ]. Hence from  9.2.8 , the expression for the input auto-correlation matrix reduces to  Rij = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + δ i − j E[v k v k − j + i ]  = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + δ i − j E[v2 k ] = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + δ i − j Pv = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] + δ i − j  cid:26  c3 −  −c 3 3[c −  −c ] cid:27  = E[{2 + sin πk 2 }{2 + sin π[k − j + i] 2 }] +  c2 3 δ i − j   773    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Using the trigonometric identities in Appendix 2,  Rij = E[4 + 2 sin πk 2  + 2 sin π[k − j + i] 2  + sin πk 2  sin π[k − j + i] 2 ] +  c2 3 δ i − j   = E[4] + 2E[sin πk 2 ] + 2E[sin π[k − j + i] 2 ] + E[sin πk 2  sin π[k − j + i] 2 ] +  c2 3 δ i − j  = 4 + E[sin πk 2  sin π[k − j + i] 2 ] +  c2 3 δ i − j  = 4 + .5E[cos π[i − j] 2  − cos π[2k − j + i] 2 ] +  c2 3 δ i − j  = 4 + .5E[cos π[i − j] 2 ] − .5E[cos π[2k − j + i] 2 ] +  c2 3 δ i − j  = 4 + .5 cos π[i − j] 2  +  c2 3 δ i − j   0 ≤ i, j ≤ 1  ,  Thus the input auto-correlation matrix is  R =  cid:20  4.5 + c2 3  4  4  4.5 + c2 3  cid:21   When c = 0, this reduces to the R in problem 9.4.  774    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.7 Suppose an input x k  and a desired output d k  have the following auto-correlation matrix  and cross-correlation vector. Find the optimal weight vector w∗.  R =  cid:20  5 1 1 5  cid:21   ,  p = cid:20  3 −2  cid:21   Solution  Using  9.2.20 , the optimal weight vector is  w∗ = R−1p  1  =  1 5  cid:21 −1 cid:20  3 −2  cid:21  =  cid:20  5 1 5  cid:21  cid:20  3 −2  cid:21  24 cid:20  5 −1 −1 =  cid:20  .7083 −.5417  cid:21   775    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.8  Suppose the mean square error is approximated using a running average ﬁlter of order M − 1 as follows.   cid:15  w  ≈  1 M  M −1  Xi=0  e2 k − i    a  Find an expression for the gradient vector ∇ cid:15  w  using this approximation for the mean   b  Using the steepest-descent method and the results from part  a , ﬁnd a weight-update  square error.  formula.   c  How many ﬂoating-point multiplications  FLOPs  are required per iteration to update  the weight vector? You can assume that 2µ is computed ahead of time.   d  Verify that when M = 1 the weight-update formula reduces to the LMS method.  Solution   a  Using  9.2.3  and  9.2.4 , the partial derivative of this approximation to the mean square  error with respect to wi is  ∂ cid:15  w  ∂wi  ∂e k − q   M −1  =  =  M  M −1  M −1  ∂wi  2 M  1 M  e2 k − q   =  cid:18  ∂ ∂wi cid:19  1 Xq=0 Xq=0 Xq=0 Xq=0 Xq=0  Xq=0 2e k − q  e k − q  cid:18  ∂ e k − q  cid:18  ∂ e k − q  cid:18  ∂ e k − q ui k − q   = −2 M  = −2 M  = −2 M  M −1  M −1  M −1  ∂wi cid:19  [d k − q  − y k − q ] ∂wi cid:19  y k − q  ∂wi cid:19  wT u k − q   ,  0 ≤ i ≤ m  Thus the gradient vector is  ∇ cid:15  w  = −2  M  e k − i u k − i   M −1  Xi=0  776    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  Using  9.3.3  and the results from part  a , the weight update formula using the steepest  descent method is  w k + 1  = w k  − µ∇ cid:15 [w k ] Xi=0  = w k  +  2µ M  M −1  e k − i u k − i    c  Since u k − i  is a vector of length m + 1, the number of FLOPs per iteration to update  the weight vector is  nw =  m + 1  M + 1    d  Starting with the answer to part  b  and setting M = 1 yields  w k + 1  = w k  +  e k − i u k − i   = w k  + 2µe k u k  √  2µ M  M −1  Xi=0  777    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.9 There is an oﬄine or batch procedure for computing the optimal weight vector called the least-squares method  see Problem 9.36 . For large values of m, the least-squares method requires approximately 4 m + 1 3 3 FLOPs to ﬁnd w. How many iterations are required before the computational eﬀort of the LMS method equals or exceeds the computational eﬀort of the least-squares method?  Solution  Since the 2µ can be computed ahead of time, it follows from  9.3.8  that the LMS method requires the following number ﬂoating point multiplications per iteration  Let p be the number of LMS iterations. Then the FLOPs for the LMS method equal the FLOPs for the oﬄine least-squares method when  nLMS = m + 1  p m + 1  = 4 m + 1 3 3  p = ceil cid:20  4 m + 1 2  3   cid:21   Solving for p yields  778    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.10 Suppose an input x k  has the following auto-correlation matrix.  1 2  cid:21  R =  cid:20  2 1   a  Using the eigenvalues of R, ﬁnd a range of step sizes that ensures convergence of the  LMS method.   b  Using the average power of the input, ﬁnd a more conservative range of step sizes that  ensures convergence of the LMS method.   c  Suppose the step size is one tenth the maximum in part  b . Find the time constant of  the mean square error in units of iterations.   d  Using the same step size as in part  c , ﬁnd the misadjustment factor Mf .  Solution   a  The characteristic polynomial of the input auto-correlation matrix is  ∆ λ  = det λI − R   λ − 2  cid:21  cid:27   = det cid:26  cid:20  λ − 2 −1 −1 =  λ − 2 2 − 1 = λ2 − 4λ + 4 − 1 = λ2 − 4λ + 3 =  λ − 3  λ − 1   Thus the maximum eigenvalue is  From Proposition 9.1, the range of step sizes that ensures convergence of the LMS method is  λmax = 3  0 < µ < .333  779    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    b  From  9.2.16 , the average power of the input is  Using  9.4.14 , a more conservative upper bound for the step size is  Thus the more conservative range of step sizes that guarantees convergence of the LMS method is   c  Suppose µ = .025. From part  a , the minimum eigenvalue of R is λmin = 1. Setting  T = 1 in  9.4.27 , the mean square error time constant in unit of iterations is   d  Let µ = .025. From  9.4.35 , the misadjustment factor is  Px = Rii  = 2  µmax =  1   m + 1 Px  =  1  2 2   = .25  0 < µ < .25  τmse ≈ =  4µλmin  1  1  4 .025 1  = 10  Mf ≈ µ m + 1 Px  = .025 2 2  = .1  780    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.11 Suppose the LMS learning curve converges to within one percent of its ﬁnal steady-state value  in 200 iterations.   a  Find the learning-curve time constant, τmse, in units of iterations.  b  If the minimum eigenvalue of R is λmin = .1, what is the step size?  c  If the step size is µ = .02, what is the minimum eigenvalue of R?  Solution   a  In terms of iterations, the learning curve converges at a rate of exp −k τmse . For the learning curve to converge to within one percent of its steady-state value in 200 iterations, it is necessary that  Taking the natural log of both sides, multiplying by −200, and taking reciprocals, then yields the following mean square error time constant   b  Setting T = 1 in  9.4.27  and solving for the step size yields   c  Setting T = 1 in  9.4.27  and solving for the minimum eigenvalue yields  exp −200 τmse  = .01  τmse = −200 ln .01  = 43.4294  µ =  4λminτmse  1  1  1  =  =  4 .1 43.4294  4 .1 43.4294  = .0576  λmin =  1  4µτmse 1  =  =  4 .02 43.4294  1  4 .02 43.4294  = .2878  781    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.12 Suppose the misadjustment factor for the LMS method is Mf = .4 when the input is white  noise uniformly distributed over [−2, 2].  a  Find the average power of the input.   b  If the step size is µ = .01, what is the ﬁlter order?   c  If the ﬁlter order is m = 9, what is the step size?  Solution   a  From  9.2.8 , the average power of the input is   b  From  9.4.35 , the normalized excess mean square error or misadjustment factor is  If µ = .01, then the ﬁlter order is   c  If m = 9, then from  9.4.35  the step size is  Px =  23 −  −2 3 3[2 −  −2 ] 16 12 4 3  =  =  Mf ≈ µ m + 1 Px  m =  M µPx − 1  .01  4 3  − 1  .4  =  = 29  µ =   m + 1 Px  M  .4  =  10 4 3   = .03  782    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.13 Financial considerations dictate that a production system must remain in operation while the system is being identiﬁed. During normal operation of the linear system, the input x k  has relatively poor spectral content.   a  Which of the modiﬁed LMS methods would appear to be an appropriate choice? Why?   b  How might the input be modiﬁed slightly to improve identiﬁcation without signiﬁcantly  aﬀecting the normal operation of the system?  Solution   a  The leaky LMS method would be best because it has the aﬀect of adding low-level white noise to the input thereby improving the spectral content. This makes the algorithm more stable when the input has poor spectral content.   b  The input could be modiﬁed by explicitly adding low-level white noise to improve its spectral content. By keeping the noise low level, this should not signiﬁcantly interfere with the normal operation of the system.  If Px is the average power of the original input, then the average power of the white noise should be small in comparison with Px.  For example, if v k  is white noise uniformly distributed over [−c, c], then v k  has zero mean and from  9.2.8  the average power of v k  is  Thus the bound on the amplitude of the uniform white noise should satisfy c2 3  cid:28  Px or  ˆx k  = x k  + v k   Pv  cid:28  Px  Pv =  =  c3 −  −c 3 3[c −  −c ] c2 3  c  cid:28  p3Px  783    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.14 Consider the normalized LMS method.   a  What is the maximum value of the step size?   b  Describe an initial condition for the past inputs that will cause the step size to saturate  to its maximum value.  Solution  u = 0. Thus   a  From  9.5.8 , the maximum value of the normalized LMS method step size occurs when  From  9.5.3 , an upper bound for the constant step size is α = 1. Thus µmax ≤ 1 δ.   b  From  9.5.8 , the normalized step size will saturate whenever the previous  m + 1  samples of the input are zero. Thus the following initial condition vector causes step size saturation.  µmax =  α δ  u 0  = 0  784    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.15 Consider the following periodic input that is used as part of the input-output speciﬁcation for a pseudo-ﬁlter. Suppose fi = ifs  2N   for 0 ≤ i < N . Find the auto-correlation matrix R for this input.  x k  =  Ci cos 2πfikT    N −1  Xi=0  Using  9.2.15  and the trigonometric identities from Appendix 2,  Solution  Rij = rxx j − i   Cr cos 2πfr[k − j + i]T     CqCrE[cos 2πfqkT   cos 2πfr[k − j + i]T  ]  =  N −1  N −1  N −1  N −1  N −1  N −1  = .5  Xr=0  Cq cos 2πfqkT    = E[x k x k − j + i ] = E Xq=0  Xq=0 Xr=0 Xq=0 Xr=0 Xr=0 Xq=0 Xq=0 C2 q E[cos 2πfq[i − j]T  ] Xq=0  C2 q cos 2πfq[i − j]T    = .5  = .5  = .5  N −1  N −1  N −1  N −1  ,  0 ≤ i, j ≤ m  CqCrE[cos 2π{fqk + fr[k − j + i]}T   + cos 2π{fqk − fr[k − j + i]}T  ]  CqCrE[cos 2π{fqk − fr[k − j + i]}T  ]  785    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.16 Consider the following periodic input and desired output that form the input-output speciﬁ- cation for a pseudo-ﬁlter. Suppose fi = ifs  2N   for 0 ≤ i < N . Find the cross-correlation vector p for this input and desired output.  x k  =  Ci cos 2πfikT    d k  =  AiCi cos 2πfikT + φi   N −1  N −1  Xi=0 Xi=0  Using  9.2.13  and the trigonometric identities from Appendix 2,  Solution  pi = rdx i   =  N −1  N −1  N −1  N −1  N −1  = .5  = E[d k x k − i ] = E Xq=0  Xq=0 Xr=0 Xr=0 Xq=0 Xq=0 Xr=0 Xq=0 Xq=0  AqC2  AqC2  = .5  = .5  = .5  N −1  N −1  N −1  N −1  AqCq cos 2πfqkT + φq   N −1  Xr=0  Cr cos 2πfr[k − i]T     AqCqCrE[cos 2πfqkT + φq  cos 2πfr[k − i]T  ]  AqCqCrE[cos 2π{fqk − fr[k − i]}T + φq ]  q E[cos 2πfqiT + φq ]  q cos 2πfqiT + φq   ,  0 ≤ i ≤ m  786  AqCqCrE[cos 2π{fqk + fr[k − i]}T + φq  + cos 2π{fqk − fr[k − i]}T + φq ]    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.17 Consider the following expression for the generalized cross-correlation vector used by the RLS  method.  p k  =  γ k−id i u i   k  Xi=1  Show that p k  can be expressed recursively in terms of p k − 1  by deriving the expression for p k  in  9.7.8 .  Solution  Separating out the kth term we have  p k  =  γ k−id i u i  + d k u k   k−1  k−1  Xi=1 Xi=1  = γ  γ k−1−id i u i  + d k u k   = γp k − 1  + d k u k   787    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.18 Consider the active noise control system shown in Figure 9.46. Suppose the secondary path is modeled as a delay with attenuation. That is, for some delay τ > 0 and some attenuation 0 < α < 1,   a  Let the sampling interval be T = τ  M . Find the transfer function, F  z .   b  Suppose the primary path G z  is modeled as follows. Find W  z  using  9.8.3 .  ˆy t  = αy t − τ    G z  =  z−i 1 + i  m  Xi=0   c  Is the controller W  z  physically realizable? Why or why not?  x k  e     -  z−M  ed k      - H z   -r k   W  z    cid:0  cid:0  cid:18   -y k    cid:15  cid:12  ? +  cid:14  cid:13  − e k    cid:0  cid:0   Figure 9.46 Active Control of Acoustic Noise  Solution   a  If T = τ  M , then a delay of τ corresponds to M samples. Using the delay property of  the Z-transform, the transfer function of the secondary path is   b  Using  9.8.3 , the controller transfer function is  F  z  = αz−M  788    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   W  z  = F −1 z G z  m  = [αz−M ]−1  z−i 1 + i  Xi=0  z−i 1 + i  =  =  1 α  1 α  m  m  zM  Xi=0 Xi=0  zM −i 1 + i   c  The controller W  z  is not physically realizable because it is not causal. The transfer function includes a weighted sum of positive powers of z and each positive power of z corresponds to a time advance which is not causal.  789    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.19 Consider the problem of identifying the nonlinear discrete-time system in  9.9.4  using a raised-cosine RBF network. Let the number of past inputs be m = 1 and the number of past outputs be n = 1. Suppose the range of values for the inputs is a = [−2, 2], and the range of values for the outputs is b = [−3, 3]. Let the number of grid points per dimension be d = 4.  a  Find the domain U of the function f .   b  What is the total number of grid points?   c  What is the grid point spacing in the x direction and in the y direction?   d  For each u, what is the maximum number of nonzero terms in the RBF network output?   e  Consider the following state vector. Find the vector subscripts of the vertices of the grid  element containing u.  u = [.3, −1.7, 1.1]T.   f  Find the scalar subscripts of the vertices of the grid element containing the u in part   e .  Solution   a  Using  9.9.7 , the domain of the function f is  U = [a1, a2]m+1 × [b1, b2]n  = [−2, 2]2 × [−3, 3]  Thus U ⊂ R3.   b  The number of dimensions is  The number of grid points per dimension is d = 4. Thus from  9.9.10 , the total number of grid points is  p = m + n + 1  = 3  r = dp = 43 = 64  790    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.    c  Using  9.9.9a , the grid point spacing in the x direction is  Similarly, from  9.9.9b  the grid point spacing in the y direction is   d  The network dimension is p = 3. From  9.9.25 , the maximum number of nonzero terms  in the raised-cosine RBF network is   e  Using  9.9.12 , the vector subscript of the base vertex of the grid element containing the  point u is as follows.  ∆x =  a2 − a1 d − 1 2 −  −2  4 − 1 4 3  =  =  ∆y =  b2 − b1 d − 1 3 −  −3  4 − 1  =  = 2  M = 2p = 8  v1 u  = ﬂoor cid:18  u1 − a1 ∆x  cid:19  = ﬂoor cid:18  .3 −  −2  4 3  cid:19   = ﬂoor 1.725   = 1  v2 u  = ﬂoor cid:18  u2 − a1 ∆x  cid:19  = ﬂoor cid:18 −1.7 −  −2   4 3   cid:19   = ﬂoor .225   = 0  v3 u  = ﬂoor cid:18  u3 − b1 ∆y  cid:19  = ﬂoor cid:18  1.1 −  −3   2   cid:19   = ﬂoor 2.05   = 2  791    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Thus v u  = [1, 0, 2]T. Next, from  9.9.13 , the vector subscripts of the vertices of the grid element containing u are   f  Using  9.9.14  and the results from part  e , the scalar subscripts of the vertices of the  grid element containing the point u are  q0 = [1, 0, 2]T + [0, 0, 0]T = [1, 0, 2]T q1 = [1, 0, 2]T + [0, 0, 1]T = [1, 0, 3]T q2 = [1, 0, 2]T + [0, 1, 0]T = [1, 1, 2]T q3 = [1, 0, 2]T + [0, 1, 1]T = [1, 1, 3]T q4 = [1, 0, 2]T + [1, 0, 0]T = [2, 0, 2]T q5 = [1, 0, 2]T + [1, 0, 1]T = [2, 0, 3]T q6 = [1, 0, 2]T + [1, 1, 0]T = [2, 1, 2]T q7 = [1, 0, 2]T + [1, 1, 1]T = [2, 1, 3]T  i0 = 1 + 0 4  + 2 16  = 33 i1 = 1 + 0 4  + 3 16  = 49 i2 = 1 + 1 4  + 2 16  = 37 i3 = 1 + 1 4  + 3 16  = 53 i4 = 2 + 0 4  + 2 16  = 34 i5 = 2 + 0 4  + 3 16  = 50 i6 = 2 + 1 4  + 2 16  = 38 i7 = 2 + 1 4  + 3 16  = 54  792    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.20 Consider the following candidate for a scalar radial basis function.  Gi z  =   cos2i cid:16  πz  2  cid:17  ,  0  ,  z ≤ 1 z > 1   a  Show that Gi z  qualiﬁes as an RBF for i ≥ 1.  b  Does Gi z  have compact support?  c  Show that Gi z  reduces to the raised-cosine RBF when i = 1.  Solution   a  The function Gi z  is continuous for i ≥ 1 because cos2i ±π 2  = 0. Next  Similarly, it is clear that  Gi 0  = cos2i 0   = 1  Gi z  → 0 as z → ∞  Thus the two properties in  9.9.17  hold. Hence Gi z  is a valid radial basis function for i ≥ 1.   b  The function Gi z  does have compact support because Gi z  = 0 for z  ∈ S where S is  the compact  closed and bounded  set S = [−1, 1].   c  Let i = 1. Using the trigonometric identities in Appendix 2  G1 z  = cos2 πz 2  1 + cos πz   =  √  2  793    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.21 Consider a raised-cosine RBF network with m = 0, n = 0, d = 2, and a = [0, 1]. Using the trigonometric identities from Appendix 2, show that the constant interpolation property holds in this case. That is, show that  g0 u  + g1 u  = 1  ,  a1 ≤ u ≤ a2  Solution  When m = 1 and n = 0, the network dimension is p = 1. It follows from  9.9.20  that  gi u  = G cid:18 u − ui ∆x  cid:19   ,  0 ≤ i ≤ 1  Since d = 2, from  9.9.9a  the grid point spacing is  From  9.9.8  and  9.9.11  the two grid points are  ∆x = a2 − a1  = 1  u0 = a1 = 0 u1 = a2 = 1  Thus from  9.9.20  for a1 ≤ u ≤ a2  g0 u  = .5[1 + cos πu ] g1 u  = .5{1 + cos π[u − 1] }  Using the cosine of the diﬀerence trigonometric identity from Appendix 2 yields  g0 u  + g1 u  = 1 + .5 cos πu  + .5 cos π[u − 1]   = 1 + .5 cos πu  + .5[cos πu  cos π  + sin πu  sin π ] = 1 + .5 cos πu  − .5 cos πu  = 1  ,  a1 ≤ u ≤ a2  794    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.22 Consider a raised-cosine RBF network with m = 2 past inputs and n = 2 past outputs. Suppose the range of values for the inputs is a = [0, 5], and the range of values for the outputs is [−2, 8]. Let the number of grid points per dimension be d = 6.  a  Find the compact support Ω of the overall network. That is, ﬁnd the smallest closed,  bounded region Ω ⊂ Rp such that  u  ∈ Ω ⇒ f0 u  = 0   b  Show that, in general, Ω → U as d → ∞ where U ∈ Rp is the domain of f .  Solution   a  The support for a raised-cosine RBF network is given in  9.9.30 . From  9.9.9 , the size  of the grid elements is as follows.  Thus from  9.9.30  the support for this network is  Ω = [a1 − ∆x, a2 + ∆x]m+1 × [b1 − ∆y, b2 + ∆y]n  = [0 − 1, 5 + 1]3 × [−2 − 2, 8 + 2]2 = [−1, 5]3 × [−4, 10]2   b  Using  9.9.7  and the expressions for Ω, ∆x and ∆y from part  a ,  lim d→∞  Ω = lim d→∞  [a1 − ∆x, a2 + ∆x]m+1 × [b1 − ∆y, b2 + ∆y]n × cid:20 b1 −  d − 1  cid:21 m+1 a2 − a1  a2 − a1 d − 1  d→∞ cid:20 a1 −  , a2 +  b2 − b1 d − 1  = lim  , b2 +  d − 1  cid:21 n b2 − b1  = [a1, a2]m+1 × [b1, b2]n = U  ∆x =  ∆y =  a2 − a1 d − 1 b2 − b1 d − 1  = 1  = 2  795    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.23 Suppose the nonlinear function in  9.9.4  is f  u  = c for some constant c. Let di = 2 for 1 ≤ i ≤ p and wi = c for 0 ≤ i < r. Show that the zeroth-order RBF network, S0, is exact. That is, show that if f0 u  = wT g u , then  Solution  Using the constant interpolation property in  9.9.23  and wi = c,  f0 u  = c  for  u ∈ U  f0 u  = wT g u   =  =  wigi u   cgi u   r−1  r−1  Xi=0 Xi=0 Xi=0  r−1  = c  gi u   = c  ,  u ∈ U  796    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.24 Suppose the nonlinear function in  9.9.4  is f  u  = hT u + c for some p× 1 vector h and some constant c. Let di = 2 for 1 ≤ i ≤ p, wi = c for 0 ≤ i < r, and Vij = hj for 1 ≤ i ≤ r and 1 ≤ j ≤ p. Show that the ﬁrst-order RBF network S1 is exact. That is, show that if f1 u  =  V u + w T g u , then  f1 u  = hT u + c  for  u ∈ U  Solution  Using the constant interpolation property in  9.9.23 , wi = c, and Vij = hj,  f1 u  =  V u+w g u   =  =  =  =  =  =  r−1  r−1  r−1  r−1  Xi=0 Xi=0 Xi=0 Xi=0 Xi=0 Xi=0  r−1  r−1   V u + w igi u   [ V u i + wi]gi u   [ V u i + c]gi u   p   Xj=1   Xj=1   p  gi u   Vijuj + c  hj uj + c  gi u   [hT u + c]gi u   =  hT u + c   gi u   = hT u + c  r−1  Xi=0  797    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.25 Suppose the nonlinear function f in  9.9.4  is continuously diﬀerentiable. Let F0 u  = wT g u  and consider the following metric for the error between the output of the system Sf and the output of the zeroth-order RBF network, S0.  Show that the RBF model S0 converges uniformly to the nonlinear system Sf as d approaches inﬁnity. That is, show that  Solution  The function f : U → R is continuously diﬀerentiable. Let ∇f = ∂f  u  ∂u be the gradient vector of partial derivatives of f  u  with respect to the elements of u. Consider the following norms.  Since f  u  is continuously diﬀerentiable, ∇f  u  is continuous. But ∇f : U → R and U ⊂ Rp is compact. Therefore k∇f  u k∞ achieves a maximum value on the set U . Let  Suppose wi = f  ui  for 0 ≤ i < r. Then from the orthogonality property in  9.9.21   E d   ∆ = max  u∈U {f  u  − f0 u }  E d  → 0  as  d → ∞  kxk∞ =  kxk1 =  p  p  i=1 {xi} max Xi=1  xi  α = max  u∈U {k∇f  u k∞}  f0 ui  = wT g ui   =  wjgj ui   r−1  Xj=0  = wi = f  ui   ,  0 ≤ i < r  798  Thus the RBF model is exact at each of the r grid points. Let u ∈ U be arbitrary, and let ui be the nearest grid point. Then from  9.9.9     2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f  u  − f0 u  = f  u  − f  ui  + f  ui  − f0 u  ≤ f  u  − f  ui  + f  ui  − f0 u  ≤ f  u  − f  ui  + f  ui  − f0 u  ≤ f  u  − f  ui  + f  ui  − f0 ui  + f0 ui  − f0 u  ≤ f  u  − f  ui  + f  ui  − f0 ui  + f0 ui  − f0 u  ≤ f  u  − f  ui  + f0 ui  − f0 u  ≤ αku − uik∞ + f0 ui  − f0 u  ≤ αku − uik∞ + wT ui − wT u ≤ αku − uik∞ + wT  ui − u  ≤ αku − uik∞ + kwk1kui − uk∞ ≤  α + kwk1 ku − uik∞ ≤  α + kwk1  max{∆x, ∆y} ≤  α + kwk1  max cid:26 a2 − a1 ≤  d − 1  cid:27  d − 1 }, b2 − b1  α + kwk1  max{a2 − a1, b2 − b1}  d − 1  This inequality holds for an arbitrary u ∈ U . Thus  Since the numerator is a constant, it follows that S0 converges uniformly to Sf on U . That is,  E d  = max  u∈U {f  u  = f0 u }  α + kwk1  max{a2 − a1, b2 − b1}  ≤  d − 1  E d  → 0  as  d → ∞  799    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.26 Using the GUI module g adapt, identify the black box system using the LMS method. Set  the step size to µ = .03, and then plot the following.   a  The outputs   b  The magnitude responses   c  The learning curve   d  The ﬁnal weights  Solution  x k   Black box  Adaptive  filter  d k   y k   e k   +  0  0  s t u p t u O  6  4  2  0  −2  −4  −6    0  LMS method, outputs : m = 40, mu = 0.0300, E = 0.002465     d k  y k   50  100  150  200  250  k  Problem 9.26  a  LMS Method: Outputs  800    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  LMS method, magnitude responses : m = 40, E = 0.002465     Black box Adaptive filter  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 9.26  b  LMS Method: Magnitude Responses  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  LMS method, learning curve : m = 40, mu = 0.0300, E = 0.002465  0 0  0 0  14  12  10  8  6  4  2  0    0    f   A  0 0 0  0 0 0    k    e  2  14  12  10  8  6  4  2  0  0  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.26  c  LMS Method: Learning Curve  801    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive  filter filter filter filter  d k  d k  d k  d k   y k  y k  y k  y k   e k  e k  e k  e k   + + + +  LMS method, final weights : m = 40, E = 0.002465  0 0 0 0  0 0 0 0  2  1  i  w  0  −1  −2  0  5  10  15  25  30  35  40  20 i  Problem 9.26  d  LMS Method: Final Weights  802    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.27 Consider the following FIR black-box system. Use the GUI module g adapt to identify this  system using the LMS method.  H z  = 1 − 2z−1 + 7z−2 + 4z−4 − 3z−5  Save the data in a MAT-ﬁle named prob7 27.mat and then reload it using the Data source option.   a  Plot the learning curve when m = 3.   b  Plot the learning curve when m = 5.   c  Plot the learning curve when m = 7.   d  Plot the ﬁnal weights m = 7.  Solution  x k   Black box  Adaptive  filter  d k   y k   e k   +  0  0  80  60    k    e  2  40  20  0  0  LMS method, learning curve : m = 3, mu = 0.0200, E = 0.332515  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.27  a  LMS Method Learning Curve: m = 3  803    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  60  50  40  30  20  10  0  0  0 0 0  0 0 0  60  50  40  30  20  10  0  0    k    e  2    k    e  2  x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  LMS method, learning curve : m = 5, mu = 0.0200, E = 0.000000  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.27  b  LMS Method Learning Curve: m = 5  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  LMS method, learning curve : m = 7, mu = 0.0200, E = 0.000000  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.27  c  LMS Method Learning Curve: m = 7  804    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k   Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive  filter filter filter filter  d k  d k  d k  d k   y k  y k  y k  y k   e k  e k  e k  e k   + + + +  LMS method, final weights : m = 7, E = 0.000000  0 0 0 0  0 0 0 0  8  6  4  2  0  −2  −4  0  i  w  1  2  3  4  5  6  7  i  Problem 9.27  d  LMS Method Final Weights: m = 7  805    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.28 Use the GUI module g adapt to identify the following black box system using the normalized  LMS method with a ﬁlter of order m = 40.  H z  =  3  1 − .7z−4   a  Plot the magnitude responses   b  Plot the learning curve   c  Plot the step sizes  Solution  x k  x k  x k  x k   Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive  filter filter filter filter  d k  d k  d k  d k   y k  y k  y k  y k   e k  e k  e k  e k   + + + +  0 0 0 0  0 0 0 0  10  8  6  4  2  0    0    f   A  Normalized LMS method, magnitude responses : m = 40, E = 0.000473     Black box Adaptive filter  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 9.28  a  Normalized LMS Method: Magnitude Responses  806    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k    e  2  0 0  0 0  12  10  8  6  4  2  0  0  0 0 0  0 0 0    k   µ  0.5  0.4  0.3  0.2  0.1  0  0  x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  Normalized LMS method, learning curve : m = 40, alpha = 0.200, E = 0.000473  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.28  b  Normalized LMS Method: Learning Curve  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  Normalized LMS method, step sizes : m = 40, E = 0.000473  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.28  c  Normalized LMS Method: Step Sizes  807    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.29 Use the GUI module g adapt to identify the following black box system using the correlation  LMS method with a ﬁlter of order m = 50.  H z  =  2  1 + .8z−4   a  Plot the magnitude responses   b  Plot the learning curve   c  Plot the step sizes  Solution  x k   Black box  Adaptive  filter  d k   y k   e k   +  0  0  10  8  6  4  2  0    0    f   A  Correlation LMS method, magnitude responses : m = 50, E = 0.006136     Black box Adaptive filter  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 9.29  a  Correlation LMS Method: Magnitude Responses  808    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  Correlation LMS method, learning curve : m = 50, alpha = 0.200, beta = 0.980, E = 0.006136 10  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.29  b  Correlation LMS Method: Learning Curve  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  Correlation LMS method, step sizes : m = 50, E = 0.006136    k    e  2  0 0  0 0  8  6  4  2  0  0  0 0 0  0 0 0    k   µ  0.06  0.05  0.04  0.03  0.02  0.01  0  0  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.29  c  Correlation LMS Method: Step Sizes  809    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.30 Using the GUI module g adapt, identify the black-box system using the leaky LMS method. Adjust the number of samples to N = 500, and the leakage factor to mu = .999. Plot the following.   a  The outputs   b  The magnitude responses   c  The learning curve  Solution  x k   Black box  Adaptive  filter  d k   y k   e k   +  0  0  5  0  s t u p t u O  −5    0  Leaky LMS method, outputs : m = 40, mu = 0.0200, nu = 0.999, E = 0.006997     d k  y k   50  100  150  200  250  k  Problem 9.30  a  Leaky LMS Method: Outputs  810    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  Leaky LMS method, magnitude responses : m = 40, E = 0.006997     Black box Adaptive filter  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 9.30  b  Leaky LMS Method: Magnitude Responses  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  Leaky LMS method, learning curve : m = 40, mu = 0.0200, nu = 0.999, E = 0.006997  0 0  0 0  14  12  10  8  6  4  2  0    0    f   A  0 0 0  0 0 0  12  10  8  6  4  2  0  0    k    e  2  50  100  150  200  300  350  400  450  500  250  k  Problem 9.30  c  Leaky LMS Method: Learning Curve  811    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.31 Using the GUI module g adapt with the default parameter values, identify the black box system using the leaky LMS method. Plot the learning curve for the following cases corre- sponding to diﬀerent values of the leakage factor.   a  nu = .999   b  nu = .995   c  nu = .990  Solution  0  0  12  10  8  6  4  2  0  0    k    e  2  x k   Black box  Adaptive  filter  d k   y k   e k   +  Leaky LMS method, learning curve : m = 40, mu = 0.0200, nu = 0.999, E = 0.010443  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.31  a  Leaky LMS Method: nu = .999  812    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0 0  0 0  10  8  6  4  2  0  0  0 0 0  0 0 0  12  10  8  6  4  2  0  0    k    e  2    k    e  2  x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  Leaky LMS method, learning curve : m = 40, mu = 0.0200, nu = 0.995, E = 0.071198  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.31  b  Leaky LMS Method: nu = .995  x k  x k  x k   Black box Black box Black box  Adaptive Adaptive Adaptive  filter filter filter  d k  d k  d k   y k  y k  y k   e k  e k  e k   + + +  Leaky LMS method, learning curve : m = 40, mu = 0.0200, nu = 0.990, E = 0.196996  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.31  c  Leaky LMS Method: nu = .990  813    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.32 Using the GUI module g adapt and the Data source option, load the input and desired output from the MAT-ﬁle u adapt1. Then identify the system that produced this input-output data using the normalized LMS method. Plot the following   a  The learning curve   b  The magnitude responses using the dB scale   c  The step sizes. Use the Caliper option to mark the largest step size.  Solution  x k  x k  x k  x k   Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive  filter filter filter filter  d k  d k  d k  d k   y k  y k  y k  y k   e k  e k  e k  e k   + + + +  0 0 0 0  0 0 0 0  60  50  40  30  20  10  0  0    k    e  2  Data from file u_adapt1.mat, Normalized LMS method, learning curve : m = 40, alpha = 0.200, E = 0.005011  50  100  150  200  300  350  400  450  500  250  k  Problem 9.32  a  Normalized LMS Method: Learning Curve  814    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k  x k  x k  x k   Black box Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive Adaptive  filter filter filter filter filter  d k  d k  d k  d k  d k   y k  y k  y k  y k  y k   e k  e k  e k  e k  e k   + + + + +  0 0 0 0 0  0 0 0 0 0    B d       f   A  30  20  10  0  −10  −20  −30    0  0 0 0 0 0 0  0 0 0 0 0 0  0.35  0.25    k   µ  0.2  0.15  0.1  0.05  0  0  Data from file u_adapt1.mat, Normalized LMS method, magnitude responses : m = 40, E = 0.005011     Black box Adaptive filter  100  200  300  400  600  700  800  900  1000  500  f  Hz   Problem 9.32  b  Normalized LMS Method: Magnitude Responses  x k  x k  x k  x k  x k  x k   Black box Black box Black box Black box Black box Black box  Adaptive Adaptive Adaptive Adaptive Adaptive Adaptive  filter filter filter filter filter filter  d k  d k  d k  d k  d k  d k   y k  y k  y k  y k  y k  y k   e k  e k  e k  e k  e k  e k   + + + + + +  Data from file u_adapt1.mat, Normalized LMS method, step sizes : m = 40, E = 0.005011  0.3     x,y  =  0.22,0.30   50  100  150  200  300  350  400  450  500  250  k  Problem 9.32  c  Normalized LMS Method: Step Sizes  815    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.33 Using the GUI module g adapt, identify the black box system using the following two methods.  Plot the learning curve for each case. Observe the scale of the dependent variable.   a  The LMS method   b  The RLS method  x k   Black box  Adaptive  filter  d k   y k   e k   +  0  0  12  10  8  6  4  2  0  0    k    e  2  LMS method, learning curve : m = 40, mu = 0.0200, E = 0.001822  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.33  a  LMS Method  816    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k  x k   Black box Black box  Adaptive Adaptive  filter filter  d k  d k   y k  y k   e k  e k   + +  0 0  0 0    k    e  2  0.25  0.2  0.15  0.1  0.05  0  0  RLS method, learning curve : m = 40, gamma = 0.950, E = 0.000057  100  200  300  400  600  700  800  900  1000  500  k  Problem 9.33  b  RLS Method  817    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.34 Consider the problem of designing an equalizer as shown in Figure 9.47. Suppose the delay is M = 15 and H z  represents a communication channel with the following transfer function.  H z  =  1 + .5z−1  1 + .4z−1 − .32z−2  Write a MATLAB program that uses the FDSP toolbox function f lms to construct an equal- izer of order m = 30 for H z . Suppose x k  consists of N = 1000 samples of white noise uniformly distributed over [−3, 3]. Use a step size of µ = .002.  a  Plot the learning curve   b  Using the ﬁnal weights, compute y k  using input r k . Then plot d k  and y k  for  0 ≤ k ≤ N 10 on the same graph with a legend.   c  Using the ﬁnal weights, plot the magnitude responses of H z , W  z , and F  z  = H z W  z  on the same graph using a legend. For the abscissa, use normalized fre- quency, f  fs.   cid:15  cid:12  x k  e - cid:14  cid:13  + 6  d k    cid:15  cid:12  - +  cid:14  cid:13  − 6  e e k      v k  e  -   H z   -r k   W  z    cid:0  cid:0  cid:18   y k    cid:0  cid:0   Figure 9.47 Equalization of a Communication Channel, H z   Solution  % Problem 9.34  % Initialize  f_header ’Problem 9.34’  m = f_prompt  ’Enter adaptive filter order’,0,80,30 ; M = f_prompt  ’Enter delay’,0,m 2,m 2 ; N = f_prompt  ’Enter number of points’,1,5000,1000 ; b = [1 0.5] a = [1 0.4 -0.32]  % Construct signals  818    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   c = 3; x = f_randu  1,N,-c,c ; r = filter  b,a,x ; d = [zeros 1,M ,x 1:N-M ];  % Compute equalizer filter  % input % filtered input % desired output  mu = f_prompt  ’Enter step size’,0,.1,0.002 ; [w,e] = f_lms  r,d,m,mu ;  % Plot learning curve  figure k = 0 : N-1; plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  f_wait  % Plot d k  and y k   y = filter  w,1,r ; figure q = 1 : 100; plot  q-1,d q ,q-1,y q   f_labels  ’Outputs’,’k’,’d and y’  legend  ’Desired Output, d k ’,’Equalizer Output, y k ’  f_wait  % Plot the magnitude responses  fs = 1; [H1,f] = f_freqz  b,a,N,fs ; [H2,f] = f_freqz  w,1,N,fs ; H3 = H1 .* H2; figure hp = plot  f,abs H1 ,’--’,f,abs H2 ,’:’,f,abs H3  ; set hp 2 ,’LineWidth’,1.5 ; f_labels  ’Magnitude Responses’,’f f_s’,’A f ’  legend  ’H f ’,’W f ’,’H f W f ’  f_wait  819    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     k    e  2  9  8  7  6  5  4  3  2  1  3  2  1  0  0  0  y   d n a   d  −1  −2  −3    0  Learning Curve  k  k  820  200  400  600  800  1000  Problem 9.34  a  Equalizer Learning Curve  Outputs     Desired Output, d k  Equalizer Output, y k   20  40  60  80  100  Problem 9.34  b  Desired Output and Equalizer Output    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f   A  1.2  2  1.8  1.6  1.4  1  0.8  0.6  0.4    0  Magnitude Responses     H f  W f  H f W f   0.1  0.2  0.3  0.4  0.5  f f  s  Problem 9.34  c  Equalized Magnitude Response  821    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.35 Consider the problem of designing an adaptive noise-cancellation system as shown in Figure 9.48. Suppose the additive noise v k  is white noise uniformly distributed over [−2, 2]. Let the primary microphone signal be as follows.  x k  = cos cid:18  πk  10 cid:19  − .5 sin cid:18  πk  20 cid:19  + .25 cos cid:18  πk 30 cid:19   Suppose the path for detecting the noise signal has the following transfer function.  H z  =  .5  1 + .25z−2  Write a MATLAB program that uses the FDSP toolbox function f lms to cancel the noise v k  corrupting the signal d k . Use an adaptive ﬁlter of order m = 30, N = 3000 samples, and a step size of µ = .003.   a  Plot the learning curve   b  Using the ﬁnal weights, compute y k  using input r k . Then plot x k , d k  and e k   for 0 ≤ k ≤ N 10 on the same graph with a legend.  x k  e  -   H z   ed k       cid:0  cid:0  cid:18   -y k    cid:15  cid:12  ? +  cid:14  cid:13  − e k   - W  z   cid:0  cid:0   Figure 9.48 Noise cancellation  Solution  % Problem 9.35  % Initialize  f_header ’Problem 9.35’  m = f_prompt  ’Enter adaptive filter order’,0,80,30 ; N = f_prompt  ’Enter number of points’,1,4000,3000 ; b = [0.5] a = [1 0 0.25]  822    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Construct signals  c = f_prompt  ’Enter magnitude of noise’,0,4,2 ; v = f_randu  1,N,-c,c ; k = 0 : N-1; x = cos pi*k 10  - 0.5*sin pi*k 20  + 0.25*cos pi*k 30 ; d = x + v; r = filter  b,a,v ;  % Compute noise cancelling filter  mu = f_prompt  ’Enter step size’,0,1,0.003 ; [w,e] = f_lms  r,d,m,mu ;  % Plot learning curve  figure plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  f_wait  % Plot x k , d k , and e k   y = filter  w,1,r ; e = d - y; figure q = 1 : 100; hp = plot  q-1,x q ,q-1,d q ,q-1,e q  ; set hp 1 ,’LineWidth’,1.5  f_labels  ’Signals’,’k’,’x and e’  legend  ’Noise-Free Signal x k ’,’Noise-Corrupted Signal, d k ’,’Estimated Signal, e k  \approx f_wait  823    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve  12  10    k    e  2  0  0  8  6  4  2  3  2  1  0  e   d n a   x  −1  −2  −3  −4    0  500  1000  2000  2500  3000  1500  k  Problem 9.35  a  Noise Cancellation Learning Curve  Signals     Noise−Free Signal x k  Noise−Corrupted Signal, d k  Estimated Signal, e k  ≈ x k   20  40  60  80  100  k  Problem 9.35  b  Noise Cancellation Signals  824    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.36 There is an oﬄine alternative to the LMS method called the least-squares method that is available when the entire input signal and desired output signal are available ahead of time. Suppose the weight vector w is constant. Taking the transpose of  9.2.3 , and replacing the actual output by the desired output, yields  uT  k w = d k   ,  0 ≤ k < N  Let d = [d 0 , d 1 , . . . , d N − 1 ]T and let X be an N ×  m + 1  past input matrix whose ith row is uT  i  for 0 ≤ i < N . Then the N equations can be recast as the following vector equation.  When N >  m + 1 , this constitutes an over-determined linear algebraic system of equations. A weight vector that minimizes the squared error E =  Xw − d T  Xw − d  is obtained by Normal premultiplying both sides by X T . This yields the normal equations  equations  Xw = d  X T Xw = X T d  w =  X T X −1X T d  The coeﬃcient matrix X T X is  m + 1  ×  m + 1 . If x k  has adequate spectral content, X T X will be nonsingular. In this case the optimal weight vector in a least-squares sense can be obtained by premultiplying by the inverse of X T X which yields  Write a MATLAB function called f lsﬁt that computes the optimal least-squares FIR ﬁlter weight vector, b = w, by solving the normal equations using the MATLAB left division operator, \. The calling sequence should be as follows.  w = f_lsfir  x,d,m   % F_LSFIT: FIR system identification using offline least-squares fit method % % Usage: % % Pre: % % % % Post: %  = N by 1 vector containing input samples = N by 1 vector containing desired output samples = order of transversal filter  m < N   b =  m+1  by 1 least-squares FIR filter coefficient vector  x d m  825    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   In constructing X, you can assume that x k  is causal. Test f lsﬁt by using N = 250 and m = 30. Let x be white noise uniformly distributed over [−1, 1], and let d be a ﬁltered version of x using the following IIR ﬁlter.  H z  =  1 + z−2  1 − .1z−1 − .72z−2   a  Use stem to plot the least-squares weight vector b.  b  Compute y k  using the weight vector b. Then plot d k  and y k  for 0 ≤ k ≤ 50 on the  same graph using a legend.  Solution  function prob9_36  % Initialize  f_header ’Problem 9.36’  m = f_prompt  ’Enter filter order m’,0,80,30 ; N = f_prompt  ’Enter number of points N’,1,4000,250 ; b = [1 0 1] a = [1 -0.1 -0.72]  % Construct signals  c = f_prompt  ’Enter magnitude of noise c’,0,4,1 ; x = f_randu  1,N,-c,c ; d = filter  b,a,x ;  % Identify least-squares filter  b = f_lsfit  x,d,m ;  % Plot w as a stem plot  figure stem  0:m,b,’filled’,’.’  f_labels  ’Weights’,’i’,’b_i’  f_wait  % Plot d k  and y k   y = filter  b,1,x ; figure q = 1 : 50;  826    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   plot  q-1,d q ,q-1,y q   f_labels  ’Outputs’,’k’,’d and y’  legend  ’Desired Output, d k ’,’Filter Output, y k ’  f_wait  w = f_lsfir  x,d,m   function b = f_lsfit  x,d,m  % F_LSFIT: FIR system identification using offline least-squares fit method % % Usage: % % Pre: % % % % Post: %  = N by 1 vector containing input samples = N by 1 vector containing desired output samples = order of transversal filter  m < N   b =  m+1  by 1 least-squares FIR filter coefficient vector  x d m  % Initialize  N = length x ; m = f_clip  m,0,N-1,3,’f_lsfir’ ; X = zeros  N,m+1 ; b = zeros m+1,1 ; q = x : .’;  % Construct matrix of past inputs  for i = 1 : N  if  i <= m   else  end  end  X i,1:i  = q i:-1:1 ;  X i,:  = q i:-1:i-m ;  % Solve normal equations  b = X \ d : ;  827    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   i  b  y   d n a   d  1.8  1.6  1.4  1.2  1  0.8  0.6  0.4  0.2  0  0  3  2  1  0  −1  −2  −3    0  5  10  20  25  30  15 i  Problem 9.36  a  Least Squares Weights, FIR Filter  Outputs     Desired Output, d k  Filter Output, y k   10  20  30  40  50  k  Problem 9.36  b  Desired and Actual Outputs, FIR Filter  Weights  828    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.37 A plot of the squared error is only a rough approximation to the learning curve in the sense that E[e2 k ] ≈ e2 k . Write a MATLAB program that uses the FDSP toolbox function f lms to identify the following system. For the input use N = 500 samples of white noise uniformly distributed over [−1, 1], and for the ﬁlter order use m = 30.  H z  =  z  z3 + .7z2 − .8z − .56   a  Use a step size µ that corresponds to .1 of the upper bound in  9.4.16 . Print the step   b  Compute and print the mean square error time constant in  9.4.29 , but in units of   c  Construct and plot a learning curve by performing the system identiﬁcation M = 50 times with a diﬀerent white noise input used each time. Plot the average of the M e2 k  versus k curves and draw vertical lines at integer multiples of the time constant.  size used.  iterations.  Solution  % Problem 9.37  % Initialize  f_header ’Problem 9.37’  m = f_prompt  ’Enter filter order m’,0,60,30 ; N = f_prompt  ’Enter number of points N’,1,2000,500 ; c = f_prompt  ’Enter magnitude of noise c’,0,4,1 ; M = f_prompt  ’Enter number of iterations M’,1,100,50 ; b = [0 0 1] a = [1 0.7 -0.8 -0.56]  % Construct signals  x = f_randu  N,1,-c,c ; d = filter  b,a,x ;  % Compute step size  P_x =  1 N *sum x.^2 ; mu = 0.1   m+1 *P_x   % Compute MSE time constant  lambda_min = P_x; T = 1; tau_mse = T  4*mu*lambda_min   829    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Find learning curve  E = zeros N,1 ; for i = 1 : M  x = f_randu  N,1,-c,c ; d = filter  b,a,x ; [w,e] = f_lms  x,d,m,mu ; E = E + e.^2;  end E = E M;  % Plot learning curve showing time constants  figure k = 0 : N-1; plot  k,E  f_labels  ’Learning Curve’,’k’,’E[e^2 k ]’  hold on r = floor  N tau_mse ; ylim = get  gca,’Ylim’ ; for i = 1 : r  plot  [i*tau_mse,i*tau_mse],[ylim 1 ,ylim 2 ],’k’   end f_wait   a  mu =  0.0096   b  tau_mse =  77.5000  830    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve  ]   k    e [ E  2  4.5  3.5  4  3  2  1  2.5  1.5  0.5  0  0  100  200  300  400  500  k  Problem 9.37  c  Learning Curve Based on M = 50 Identiﬁcations  831    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.38 Consider the problem of performing system identiﬁcation as shown in Figure 9.49. Suppose  the system to be identiﬁed is the following auto-regressive or all-pole ﬁlter.  H z  =  1  z4 − .1z2 − .72  Write a MATLAB program which uses the FDSP toolbox function f lmsnorm to identify a model of order m = 60 for this system. Use an input consisting of N = 1200 samples of white noise uniformly distributed over [−1, 1], a constant step size of α = .1, and a maximum step size of µmax = 5α.   a  Plot the learning curve.   b  Plot the step sizes.   c  Plot the magnitude response of H z  and W  z  on the same graph using a legend where  W  z  is the adaptive ﬁlter using the ﬁnal values for the weights.  x k  e    - z−M  ed k       cid:0  cid:0  cid:18   -y k    cid:15  cid:12  ? +  cid:14  cid:13  − e k   - W  z   cid:0  cid:0   Figure 9.49 Identiﬁcation of Linear Discrete-time System, H z   Solution  % Problem 9.38  % Initialize  f_header ’Problem 9.38’  m = f_prompt  ’Enter filter order m’,0,80,60 ; N = f_prompt  ’Enter number of points N’,1,2000,1200 ; c = f_prompt  ’Enter magnitude of noise c’,0,2,1 ; b = [0 0 0 0 1] a = [1 0 -0.1 0 -0.72]  % Compute signals  x = f_randu  N,1,-c,c ; d = filter  b,a,x ;  832    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Identify model  alpha = 0.1; delta = 0.2; [w,e,mu] = f_lmsnorm  x,d,m,alpha,delta ;  % Plot learning curve  figure k = 0 : N-1; plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  f_wait  % Plot step sizes  figure plot  k,mu  f_labels  ’Step Sizes’,’k’,’\mu k ’  f_wait  % Plot magnitude responses  figure p = 200; fs = 1; [H1,f] = f_freqz  b,a,p,fs ; [H2,f] = f_freqz  w,1,p,fs ; A1 = abs H1 ; A2 = abs H2 ; plot  f,A1,f,A2  f_labels  ’Magnitude Responses’,’f f_s’,’A f ’  legend  ’System’,’Adaptive Filter’  f_wait  833    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve  200  400  800  1000  1200  600  k  Problem 9.38  a  Normalized LMS Learning Curve  Step Sizes    k    e  2  2.5  1.5  2  1  0.5  0  0  0.35  0.3  0.25    k   µ  0.2  0.15  0.1  0.05  0  0  200  400  800  1000  1200  600  k  Problem 9.38  b  Normalized LMS Step Sizes  834    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f   A  3  6  5  4  2  1  0    0  Magnitude Responses     System Adaptive Filter  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 9.38  c  Magnitude Responses  835    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.39 Consider the problem of performing system identiﬁcation as shown previously in Figure 9.49.  Suppose the system to be identiﬁed is the following IIR ﬁlter.  H z  =  z3 + .8z2 + .25z + .2  z2  Write a MATLAB program that uses the FDSP toolbox function f lmscorr to identify a model of order m = 50 for this system. Use an input consisting of N = 2000 samples of white noise uniformly distributed over [−1, 1], a relative step size of α = 1, and the default smoothing parameter β.   a  Plot the learning curve.   b  Plot the step sizes.   c  Plot the magnitude response of H z  and W  z  on the same graph using a legend where  W  z  is the adaptive ﬁlter using the ﬁnal values for the weights.  Solution  % Problem 9.39  % Initialize  % Compute signals  x = f_randu  N,1,-c,c ; d = filter  b,a,x ;  % Identify model  f_header ’Problem 9.39’  m = f_prompt  ’Enter filter order m’,0,80,50 ; N = f_prompt  ’Enter number of points N’,1,3000,2000 ; c = f_prompt  ’Enter magnitude of noise c’,0,2,1 ; b = [0 1] a = [1 0.8 0.25 0.2]  alpha = f_prompt  ’Enter relative step size alpha’,0,1,1 ; [w,e,mu] = f_lmscorr  x,d,m,alpha ;  % Plot learning curve  figure k = 0 : N-1; plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’   836    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   f_wait  % Plot step sizes  figure plot  k,mu  f_labels  ’Step Sizes’,’k’,’\mu k ’  f_wait  % Plot magnitude responses  figure p = 200; fs = 1; [H1,f] = f_freqz  b,a,p,fs ; [H2,f] = f_freqz  w,1,p,fs ; A1 = abs H1 ; A2 = abs H2 ; plot  f,A1,f,A2  f_labels  ’Magnitude Responses’,’f f_s’,’A f ’  legend  ’System’,’Adaptive Filter’  f_wait  Learning Curve    k    e  2  1.5  3.5  2.5  3  2  1  0.5  0  0  500  1500  2000  1000  k  Problem 9.39  a  Correlation LMS Learning Curve  837    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   0.03  0.025  0.02    k   µ  0.015  0.01  0.005  0  0  4.5  3.5  4  3  2  1  2.5    f   A  1.5  0.5  0    0  Step Sizes  500  1500  2000  1000  k  Problem 9.39  b  Correlation LMS Step Sizes  Magnitude Responses     System Adaptive Filter  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 9.39  c  Magnitude Responses  838    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.40 Consider the following IIR ﬁlter.  Write a MATLAB program which used the FDSP toolbox function f lmsleak to identify a model of order m = 30 for this system. Use an input consisting of N = 120 samples, a step size of µ = .005 and the following periodic input.  H z  =  10 z2 + z + 1  z4 + .2z2 − .48  x k  = cos cid:18  πk  5  cid:19  + sin cid:18  πk 10 cid:19    a  Plot the learning curve for ν = .99.   b  Plot the learning curve for ν = .98.   c  Plot the learning curve for ν = .96.   d  Using ν = .995 and the ﬁnal value for the weights, plot d k  and y k  on the same graph  with a legend.  Solution  % Problem 9.40  % Initialize  f_header ’Problem 9.40’  m = f_prompt  ’Enter filter order m’,0,60,30 ; N = f_prompt  ’Enter number of points N’,1,2000,120 ; mu = f_prompt  ’Enter step size mu’,0,1,.005 ; b = 10*[0 0 1 1 1] a = [1 0 0.2 0 -0.48]  % Compute signals  k = 0 : N-1; x = cos pi*k 5  + sin pi*k 10 ; d = filter  b,a,x ;  % Identify models and plot learning curves  for nu = [0.99, 0.98, 0.96]  [w,e] = f_lmsleak  x,d,m,mu,nu ; figure  839    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   plot  k,e.^2  caption = sprintf  ’Learning Curve, \\nu = %g’,nu ; f_labels  caption,’k’,’e^2 k ’  f_wait  end  % Compare outputs  [w,e] = f_lmsleak  x,d,m,mu,0.995 ; y = filter  w,1,x ; figure plot  k,d,k,y  f_labels  ’Leaking LMS Response’,’k’,’outputs’  legend  ’Desired Output, d k ’,’Filter Output, y k ’  f_wait  Learning Curve, ν = 0.99    k    e  2  1000  900  800  700  600  500  400  300  200  100  0  0  20  40  80  100  120  60 k  Problem 9.40  a  Leaking LMS Learning Curve, µ = .99  840    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve, ν = 0.98    k    e  2    k    e  2  1000  900  800  700  600  500  400  300  200  100  0  0  1200  1000  800  600  400  200  0  0  20  40  80  100  120  60 k  Problem 9.40  b  Leaking LMS Learning Curve, µ = .98  Learning Curve, ν = 0.96  20  40  80  100  120  60 k  Problem 9.40  c  Leaking LMS Learning Curve, µ = .96  841    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   s t u p t u o  40  30  20  10  0  −10  −20  −30  −40  −50    0  Leaking LMS Response     Desired Output, d k  Filter Output, y k   20  40  80  100  120  60 k  Problem 9.40  d  Leaking LMS Output, µ = .995  842    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.41 Use the FDSP toolbox to write a MATLAB program that designs an FIR ﬁlter to meet the  following pseudo-ﬁlter design speciﬁcations.     A f   =  3 − 24 cid:18 f −  fs  3 cid:19  ,  φ f   = −30πf  fs  2 3  1  , ,  ,  6  3  fs  0 ≤ f < fs 6 ≤ f < fs 3 ≤ f < 5fs 12 ≤ f ≤ fs  12  2  5fs  fs  Suppose there are N = 80 discrete frequencies equally spaced over 0 ≤ f < fs 2 as in  9.6.2 . Use f lms with a step size of µ = .0001 and M = 2000 iterations.   a  Choose an order for the adaptive ﬁlter that best ﬁts the phase speciﬁcation. Print the  order m.   b  Plot the magnitude response of the ﬁlter obtained using the ﬁnal weights. On the same graph plot the desired magnitude response with isolated plot symbols at each of the N discrete frequencies, and a plot legend.   c  Plot the phase response of the ﬁlter obtained using the ﬁnal weights. On the same graph plot the desired phase response with isolated plot symbols at each of the N discrete frequencies, and a plot legend.  Solution  function prob9_41  % Initialize  f_header ’Problem 9.41’  N = f_prompt  ’Enter number of discrete frequencies’,2,200,80 ; mu = f_prompt  ’Enter LMS step size mu’,0,1,.0001 ; M = f_prompt  ’Enter number of iterations M’,1,4000,2000 ; m = f_prompt  ’Enter filter order m’,0,80,30   % Construct specifications  fs = 1; T = 1 fs; f = linspace 0, N-1 *fs  2*N ,N ; C = ones 1,N ; A = mag_fun f,fs ; phi = phase_fun f,fs ;  % Construct input and desired output  843    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x k+1  = sum C .* sin 2*pi*f*k*T  ; d k+1  = sum A .* C .* sin 2*pi*f*k*T + phi  ;  x = zeros M,1 ; d = zeros M,1 ; for k = 0 : M-1  end  % Find optimal weights  [w,e] = f_lms  x,d,m,mu ;  % Compute frequency response  b = w; a = 1; r = N; [H,freq] = f_freqz b,a,r,fs ;  % Plot magnitude responses  A_FIR = abs H ; figure plot  f,A,’.’,freq,A_FIR ; legend  ’Pseudofilter’,’FIR filter’  f_labels  ’’,’f f_s’,’A f ’  f_wait  % Plot phase responses  phi_FIR = angle H ; phi_FIR end  = []; figure plot  f,phi,’.’,f,unwrap phi_FIR  ; legend  ’Pseudofilter’,’FIR filter’  f_labels  ’’,’f f_s’,’\phi f ’  f_wait  function A = mag_fun  f,fs  N = length f ; for i = 1 : N  elseif  f i  >= fs 6  &  f i  < fs 3   elseif  f i  >= fs 3  &  f i  < 5*fs 12   A i  = 3 - 24* f i  - fs 3 ;  if f i  < fs 6  A i  = 2;  A i  = 3;  else  A i  = 1;  844    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   end  end  function phi = phase_fun  f,fs  phi = -30*pi*f fs;   a  The phase corresponding to a constant group delay of τ is φ f   = −2πτ f . For a linear-  phase ﬁlter, the group delay is τ = mT  2. Thus  φ f   = −2π mT  2 f  = −πmf  fs  Thus the best value for m in this case is  m =  30     Pseudofilter FIR filter  3.5  3  2.5    f   A  2  1.5  1  0.5    0  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 9.41  b  Magnitude Responses  845    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f   φ  0  −5  −10  −15  −20  −25  −30  −35  −40  −45  −50    0     Pseudofilter FIR filter  0.1  0.2  0.3  0.4  0.5  f f  s  Problem 9.41  c  Phase Responses  846    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   √ 9.42 Consider the problem of designing a signal predictor as shown in Figure 9.50. Suppose the  signal whose value is to be predicted is as follows.  x k  = sin cid:18  πk  5  cid:19  cos cid:18  πk  10 cid:19  + v k   ,  0 ≤ k < N  Here N = 200 and v k  is white noise uniformly distributed over [−.05, .05]. Write a MATLAB program that uses the FDSP toolbox function f rls to predict the value of this signal M = 20 samples into the future. Use a ﬁlter of order m = 40 and a forgetting factor of γ = .9.   a  Plot the learning curve.   b  Using the ﬁnal weights, compute the output y k  corresponding to the input x k . Then plot x k  and y k  on separate graphs above one another using the subplot command. Use the ﬁll function to shade a section of x k  of length M starting at k = 160. Then shade the corresponding predicted section of y k  starting at k = 140.  x k  e    ed k      - z−M   cid:0  cid:0  cid:18   -y k    cid:15  cid:12  ? +  cid:14  cid:13  − e k   - W  z   cid:0  cid:0   Figure 9.50 Signal Prediction  Solution  % Problem 9.42  % Initialize  f_header ’Problem 9.42’  m = f_prompt  ’Enter filter order m’,0,100,40 ; gamma = f_prompt  ’Enter forgetting factor gamma’,0,1,0.9 ; N = f_prompt  ’Enter number of points N’,1,2000,200 ; M = f_prompt  ’Enter number of samples to predict ahead M’,0,40,20 ; c = f_prompt  ’Enter magnitude of white noise c’,0,1,0.05 ;  % Construct input and desired output  k = [0 : N-1]’; v = f_randu N,1,-c,c ; x = sin pi*k 20 .*cos pi*k 10  + v; d = x;  847    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   x_M = zeros size x  ; x_M M+1:N  = x 1:N-M ;  % Compute the optimal weights  [w,e] = f_rls  x_M,d,m,gamma ;  % Plot learning curve  figure plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  f_wait  % Plot input and output  y = filter  w,1,x ; figure subplot  2,1,1  fill  [160 180 180 160],[-2 -2 2 2],’c’  hold on plot  k,x  f_labels  ’Input and Output’,’k’,’x k ’  subplot  2,1,2  fill  [140 160 160 140],[-2 -2 2 2],’c’  hold on plot  k,y  f_labels  ’’,’k’,’y k ’  f_wait  848    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1    k    e  2    k   x    k   y  −1  −2  0  2  1  0  2  1  0  −1  −2  0  0  0  50  100  k  150  200  Problem 9.42  a  RLS Learning Curve  Input and Output  50  150  200  50  150  200  Problem 9.42  b  RLS Signal Prediction  100  k  100  k  849    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.43 Consider the active noise control system shown previously in Figure 9.45. Suppose the sec- ondary path is modeled by the following transfer function which takes into account the delay and attenuation of sound as it travels through air, and the characteristics of the microphones, speaker, ampliﬁers and DAC.  F  z  =  .2z−3  1 − 1.4z−1 + .48z−2  Suppose the sampling frequency is fs = 2000 Hz. Write a MATLAB program that uses the FDSP toolbox f lms to identify an FIR model of the secondary path F  z  using an adaptive ﬁlter of order m = 25. Choose an input and a step size that causes the algorithm to converge.   a  Plot the learning curve to verify convergence.  b  Plot the magnitude responses of F  z  and the model, ˆF  z , on the same graph using a   c  Plot the phase responses of F  z  and the model, ˆF  z , on the same graph using a legend.  legend.  Solution  % Problem 9.43  % Initialize  f_header ’Problem 9.43’  fs = 2000; m = f_prompt  ’Enter filter order m’,0,60,25 ; N = f_prompt  ’Enter number of points N’,1,3000,1500 ; mu = f_prompt  ’Enter step size mu’,0,1,.01 ; b = [0 0 0 0.2] a = [1 -1.4 0.48]  % Construct input and desired output  k = [0 : N-1]’; c = 1; x = f_randu N,1,-c,c ; d = filter  b,a,x ;  % Identify the secondary path  [w,e] = f_lms  x,d,m,mu ;  % Plot learning curve  figure  850    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   plot  k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  f_wait  % Plot magnitude responses  M = 200; [H,f] = f_freqz  b,a,M,fs ; [H_hat,f] = f_freqz  w,1,M,fs ; A = abs H ; A_hat = abs H_hat ; figure plot  f,A,f,A_hat  f_labels  ’Magnitude Responses’,’f  Hz ’,’A f ’  legend  ’Secondary Path’,’FIR Model’  f_wait  % Plot phase responses  phi = angle H ; phi_hat = angle H_hat ; figure plot  f,phi,f,phi_hat  f_labels  ’Phase Responses’,’f  Hz ’,’\phi f ’  legend  ’Secondary Path’,’FIR Model’  f_wait  851    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve  500  1000  1500  k  Problem 9.43  a  Learning Curve  Magnitude Responses     Secondary Path FIR Model    k    e  2  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  2.5  2  1  1.5    f   A  0.5  0    0  200  400  600  800  1000  f  Hz   Problem 9.43  b  Secondary Path Magnitude Responses  852    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Phase Responses     Secondary Path FIR Model    f   φ  4  3  2  1  0  −1  −2  −3  −4    0  200  400  600  800  1000  f  Hz   Problem 9.43  c  Secondary Path Phase Responses  853    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.44 Consider the active noise control system shown previously in Figure 9.45. Suppose the primary  noise x k  consists of the following noise-corrupted periodic signal.  x k  = 2  sin 2πF0ikT    1 + i  + v k   5  Xi=1  Here the fundamental frequency is F0 = 100 Hz and fs = 2000 Hz. The additive noise term, v k , is white noise uniformly distributed over [−.2, .2]. Coeﬃcient vectors for FIR models of the secondary path F  z  and the primary path G z  are contained in MAT-ﬁle prob9 44. The coeﬃcient vectors are f and g. Write a MATLAB program that loads f and g and uses the FDSP toolbox function f fxlms to apply active noise control with the ﬁltered-x LMS method starting at sample N 4 where N = 2000. Use a noise controller of order m = 30 and a step size of µ = .002. Plot the learning curve including a title that displays the amount of noise cancellation in dB using  9.8.15 .  Solution  % Problem 9.44  % Initialize  f_header ’Problem 9.44’  m = f_prompt  ’Enter filter order m’,0,60,30 ; N = f_prompt  ’Enter number of points N’,1,3000,2000 ; r = f_prompt  ’Enter number of harmonics r’,0,10,5 ; delta = f_prompt  ’Enter amplitude of white noise’,0,1,0.2 ; mu = f_prompt  ’Enter step size’,0,1,0.002 ; load prob9_41  % loads f and g  % Construct noisy periodic input  k = [1 : N]’; fs = 2000; f_0 = 100; T = 1 fs; x = f_randu  N,1,-delta,delta ; for i = 1 : r  x = x + 2*sin 2*pi*i*k*f_0*T   1+i ;  end  % Apply active noise control starting at sample N 4+1  e = filter  g,1,x ; p = [N 4 + 1:N]; [w,e p ] = f_fxlms  x p ,g,f,m,mu ;  854    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Plot learning curve  figure plot k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  P_u = sum e 1:N 4 .^2 ; P_c = sum e 3*N 4+1:N .^2 ; E = real 10*log10 P_u P_c  ; caption = sprintf  ’Learning Curve, Noise reduction = %.1f dB’,E ; f_labels  caption,’k’,’e^2 k ’  f_wait  Learning Curve, Noise reduction = 15.8 dB  0.06  0.05  0.04    k    e  2  0.03  0.02  0.01  0  0  500  1500  2000  1000  k  Problem 9.44 Learning Curve Using FXLMS Method  855    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.45 Consider the active noise control system shown previously in Figure 9.45. Suppose the primary  noise x k  consists of the following noise-corrupted periodic signal.  x k  = 2  sin 2πF0ikT    1 + i  + v k   5  Xi=1  Here the fundamental frequency is F0 = 100 Hz and fs = 2000 Hz. The additive noise term, v k , is white noise uniformly distributed over [−.2, .2]. Coeﬃcient vectors for FIR models of the secondary path F  z  and the primary path G z  are contained in MAT ﬁle prob9 44.mat. The coeﬃcient vectors are f and g. Write a MATLAB program that loads f and g and uses the FDSP toolbox function f sigsyn to apply active noise control with the signal synthesis method starting at sample N 4 where N = 2000. Use a step size of µ = .04.   a  Plot the learning curve. Add a title which displays the amount of noise cancellation in  dB using  9.8.15 .   b  Plot the magnitude spectra of the noise without cancellation.   c  Plot the magnitude spectra of the noise with cancellation.  Solution  % Problem 9.45  % Initialize  f_header ’Problem 9.45’  N = f_prompt  ’Enter number of points N’,1,3000,2000 ; r = f_prompt  ’Enter number of harmonics r’,0,10,5 ; delta = f_prompt  ’Enter amplitude of white noise’,0,1,0.2 ; mu = f_prompt  ’Enter step size’,0,1,0.04 ; load prob9_41  % loads f and g  % Construct noisy periodic input  k = [1 : N]’; fs = 2000; f_0 = 100; T = 1 fs; x = f_randu  N,1,-delta,delta ; for i = 1 : r  x = x + 2*sin 2*pi*i*k*f_0*T   1+i ;  end  e = filter  g,1,x ; s = [N 4 + 1:N]; [p,q,e s ] = f_sigsyn  x s ,g,f,f_0,fs,r,mu ;  856    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   % Plot learning curve  figure plot k,e.^2  f_labels  ’Learning Curve’,’k’,’e^2 k ’  P_u = sum e 1:N 4 .^2 ; P_c = sum e 3*N 4+1:N .^2 ; E = real 10*log10 P_u P_c  ; caption = sprintf  ’Learning Curve, Noise reduction = %.1f dB’,E ; f_labels  caption,’k’,’e^2 k ’  f_wait  % Display power spectrum of noise  [A_u,phi_u,S_u,f] = f_spec  e 1:N 4 ,N 4,fs ; [A_c,phi_c,S_c,f] = f_spec  e 3*N 4+1:N ,N 4,fs ; figure i = 1 : N 8; plot  f i ,A_u i   f_labels  ’’,’f  Hz ’,’A_u f ’  ylim = get gca,’Ylim’ ; f_wait figure plot  f i ,A_c i   f_labels  ’’,’f  Hz ’,’A_c f ’  axis [0 fs 2 ylim 1  ylim 2 ]  f_wait  857    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Learning Curve, Noise reduction = 19.2 dB  500  1500  2000  1000  k  Problem 9.45  a  Signal Synthesis Learning Curve  0.06  0.05  0.04    k    e  2  0.03  0.02  0.01  0  0    f    A  u  35  30  25  20  15  10  5  0  0  200  400  600  800  1000  f  Hz   Problem 9.45  b  Magnitude Spectrum of Noise without Noise Control  858    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.     f    A  c  35  30  25  20  15  10  5  0  0  200  400  600  800  1000  f  Hz   Problem 9.45  c  Magnitude Spectrum of Noise with Active Noise Control  859    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.46 Consider the following nonlinear discrete-time system which has m = 0 past inputs and n = 1  past outputs.  y k  = .8y k1  + .3[x k  − y k − 1 ]3  Suppose the input x k  consists of N = 1000 samples of white noise uniformly distributed over [−1, 1]. Let the number of grid point per dimension be d = 8. Write a MATLAB program that performs the following tasks.   a  Use the FDSP toolbox function f state to compute a set of output bounds b such that b1 ≤ y k  ≤ b2. Use a safety factor of β = 1.2 as in  9.9.29 . Print a, b, ∆x, ∆y, and the total number of grid points r.   b  Plot the output y k  corresponding to the white noise input x k . Include dashed lines  showing the grid values along the y dimension.   c  Let f  u  denote the right-hand side of the nonlinear diﬀerence equation where u k  =  [x k , y k − 1 ]T . Plot the surface f  u  over the domain [a1, a2] × [b1, b2].  Solution  function prob9_46  % Initialize  f_header ’Problem 9.46’  N = 1000; a = [-1,1] m = 0; n = 1; d = 8; p = m+n+1; beta = 1.2 ; theta = zeros p,1 ;  % Estimate output bounds  x = f_randu N,1,a 1 ,a 2  ; y = zeros size x  ; for k = 1 : N  theta = f_state  x,y,k,m,n ; y k  = fun  theta ;  end y_min = min y ; y_max = max y ; b 1  =  y_min + y_max  2 - beta* y_max - y_min  2; b 2  =  y_min + y_max  2 + beta* y_max - y_min  2; b  860    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Delta_x =  a 2 -a 1    d-1  Delta_y =  b 2 -b 1    d-1  r = d^p  % Plot output and range  figure; k = 0 : N-1; hold on plot  k,y  for i = 1 : d  else  end  end f_wait  y_g = b 1  +  i-1 *Delta_y; if  i > 1  &  i < d   plot  [0 N-1],[y_g y_g],’k:’   plot  [0 N-1],[y_g y_g],’k’   % Plot equation surface  P = 60; A = linspace  a 1 ,a 2 ,P ; B = linspace  b 1 ,b 2 ,P ; f = zeros P,P ; for i = 1 : P  for j = 1 : P  theta 1  = A i ; theta 2  = B j ; f i,j  = fun  theta,m,n ;  end  end figure surf  B,A,f  pause  0.1  surf  B,A,f  f_labels  ’Nonlinear System Surface’,’\theta_2’,’\theta_1’,’f \theta ’  f_wait  function y = fun  theta,m,n   % Description: Nonlinear system  m = 0, n = 1   y = 0.8*theta 2  + 0.3* theta 1  - theta 2  ^3;   a  a =  b =  -1  1  -0.4633  0.4673  861    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Delta_x =  0.2857  Delta_y =  0.1329  r =  64  0.5  0.4  0.3  0.2  0.1  0  −0.1  −0.2  −0.3  −0.4  −0.5  0  200  400  600  800  1000  Problem 9.46  b  Nonlinear System Output  862    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   Nonlinear System Surface    θ   f  0.4  0.2  0  −0.2  −0.4  −0.6  −0.8 1  0.5  0.5  −0.5  0  θ  1  −1  −0.5  0  θ  2  Problem 9.46  c  Nonlinear System Equation Surface  863    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   9.47 Consider the following nonlinear discrete-time system which has m = 0 past inputs and n = 1  past outputs.  y k  = .8y k1  + .3[x k  − y k − 1 ]3  Let the range of inputs be −1 ≤ x k  ≤ 1 and the number of grid points per dimension be d = 8. Write a MATLAB program that does the following.   a  Use the FDSP toolbox function f state to compute a set of output bounds b such that b1 ≤ y k  ≤ b2. Use P = 1000 points of white noise uniformly distributed over [−1, 1] for the test input and a safety factor of β = 1.2 as in  9.9.29 . Print a, b, and the total number of grid points r.   b  Use FDSP toolbox function f rbfw with N = 0 and ic = 1 to compute a weight vector w that satisﬁes  9.9.22 . Then use f rbf0 to compute the output y0 k  to a white noise input with M = 100 points uniformly distributed over [−1, 1]. Use f state to compute the nonlinear system response y k  to the same input. Plot the two outputs on one graph using a legend. Compute the error E using  9.9.31  and add this to the graph title.  Solution  function prob9_47  % Initialize  f_header ’Problem 9.47’  m = 0; n = 1; p = m+n+1; P = 1000; N = 100; theta = zeros p,1 ; w = zeros p,1 ;  % Get parameters  % Estimate output bounds  a = [-1,1] x = f_randu P,1,a 1 ,a 2  ; y = zeros size x  ; for k = 1 : P  theta = f_state  x,y,k,m,n ; y k  = fun  theta,m,n ;  864  d = f_prompt  ’Enter number of grid points per dimension’,2,12,8 ;    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   end y_min = min y ; y_max = max y ; beta = 1.2; b 1  =  y_min + y_max  2 - beta* y_max - y_min  2; b 2  =  y_min + y_max  2 + beta* y_max - y_min  2; b r = d^p  % safety factor  % Compute w so network is exact on grid  mu = 0; w = f_rbfw  @fun,0,a,b,m,n,d,mu,1 ;  % Compute outputs and error  x = f_randu  N,1,a 1 ,a 2  ; y_0 = f_rbf0  x,w,a,b,m,n,d ; y = zeros N,1 ; for k = 1 : N  theta = f_state  x,y,k,m,n ; y k  = fun  theta ;  end  % Compare outputs  figure k = 1 : N; plot  k,y,k,y_0  hold on plot  [0 N],[b 1  b 1 ],’k’,[0 N],[b 2  b 2 ],’k’  e = y-y_0; E = sum e.^2  sum y.^2 ; caption = sprintf  ’System and Network Outputs, E = %.3g’,E ; f_labels  caption,’k’,’y k  and y_0 k ’  legend  ’nonlinear system’,’RBF model’  f_wait  function y = fun  theta,m,n   % Description: Nonlinear system  m = 0, n = 1   y = 0.8*theta 2  + 0.3* theta 1  - theta 2  ^3;  865    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.   System and Network Outputs, E = 0.0216     nonlinear system RBF model   a  a =  -1  1  b =  r =  64  -0.4581  0.4533  0.5  0.4  0.3  0.2  0.1  0    k    y   d n a     k   y  0  −0.1  −0.2  −0.3  −0.4  −0.5    0  20  40  60  80  100  k  Problem 9.47  b  Nonlinear System and RBF Network Outputs  866    2012 Cengage Learning. All Rights Reserved. May not be scanned, copied or duplicated, or posted to a publicly accessible website, in whole or in part.
