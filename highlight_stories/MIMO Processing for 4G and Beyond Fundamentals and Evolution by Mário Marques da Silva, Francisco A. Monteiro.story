MIMO  Processing for 4G and Beyond   Fundamentals and Evolution   Edited by  Mário Marques da Silva Francisco A. Monteiro    MATLAB® and Simulink® are trademarks of The MathWorks, Inc. and are used with permission. The MathWorks does not  warrant the accuracy of the text or exercises in this book. This book’s use or discussion of MATLAB® and Simulink® software  or related products does not constitute endorsement or sponsorship by The MathWorks of a particular pedagogical approach  or particular use of the MATLAB® and Simulink® software.  CRC Press Taylor & Francis Group 6000 Broken Sound Parkway NW, Suite 300 Boca Raton, FL 33487-2742    2014 by Taylor & Francis Group, LLC CRC Press is an imprint of Taylor & Francis Group, an Informa business  No claim to original U.S. Government works Version Date: 20140411  International Standard Book Number-13: 978-1-4665-9808-9  eBook - PDF   This book contains information obtained from authentic and highly regarded sources. Reasonable efforts have been made  to publish reliable data and information, but the author and publisher cannot assume responsibility for the validity of all  materials or the consequences of their use. The authors and publishers have attempted to trace the copyright holders of all  material reproduced in this publication and apologize to copyright holders if permission to publish in this form has not  been obtained. If any copyright material has not been acknowledged please write and let us know so we may rectify in any  future reprint.  Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmitted, or utilized in  any form by any electronic, mechanical, or other means, now known or hereafter invented, including photocopying, micro- filming, and recording, or in any information storage or retrieval system, without written permission from the publishers.  For permission to photocopy or use material electronically from this work, please access www.copyright.com  http:  www. copyright.com   or contact the Copyright Clearance Center, Inc.  CCC , 222 Rosewood Drive, Danvers, MA 01923, 978-750- 8400. CCC is a not-for-profit organization that provides licenses and registration for a variety of users. For organizations that  have been granted a photocopy license by the CCC, a separate system of payment has been arranged.  Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used only for identi- fication and explanation without intent to infringe. Visit the Taylor & Francis Web site at http:  www.taylorandfrancis.com and the CRC Press Web site at http:  www.crcpress.com   Contents  Foreword .........................................................................................................v Preface ............................................................................................................xi Editors ...........................................................................................................xv Contributors ................................................................................................xvii 1  MIMO Techniques and Applications .....................................................1  MárIO MArquEs dA sIlvA And AMérICO COrrEIA  2  MIMO detection Methods ..................................................................47  FrAnCIsCO A. MOnTEIrO, IAn J. WAssEll, And nunO sOuTO  3   Precoding for MIMO .........................................................................119 dzEvdAn KAPETAnOvIć And FrEdrIK rusEK  4  MIMO Optimized for OFdM ............................................................159  nunO sOuTO And FrAnCIsCO A. MOnTEIrO  5  MIMO Optimized for single-Carrier Frequency-domain   Equalization .......................................................................................211 ruI dInIs, JOãO CArlOs sIlvA, And nunO sOuTO  6  MIMO Optimized for W-CdMA .......................................................249  JOãO CArlOs sIlvA, nunO sOuTO, And ruI dInIs  7  ultrawideband systems and MIMO ...................................................341  vIT sIPAl, BEn AllEn, dAvId J. EdWArds, And WAsIM q. MAlIK  8   9   Frequency-domain Packet Combining Techniques for uWB ...........377 PAulO MOnTEzuMA, MárIO MArquEs dA sIlvA, And ruI dInIs  link and system level simulation for MIMO ...................................405 AMérICO COrrEIA And MárIO MArquEs dA sIlvA  iii   iv  ◾  Contents  10  Massive MIMO and Its detection ......................................................449  XIAOlI MA And qI zhOu  11  MIMO Two-Way relay Channel with superposition Coding ...........473  IOAnnIs KrIKIdIs And JOhn s. ThOMPsOn  12  Physical-layer network Coding with Multiple-Antenna relays .......491  dIrK WüBBEn, MEng Wu, And ArMIn dEKOrsy  Index ...........................................................................................................515   Foreword  In the transmission of information over a wireless channel, the channel is modeled  classically as a linear system black box with an input and output, that is, a single  input and a single output  SISO . The input is the connection point from the power  amplifier of the transmitter to the transmitting antenna terminal and the output is  the connection point from the receiving antenna terminal to the radio frequency   RF  front-end filter of the receiver. The antennas are modeled as a structure that  radiates EM waves that propagate through space. The simplest such antenna struc- ture is a radiating electric dipole element. With the presence of multipath propaga- tion in the channel, it becomes evident that the electric field at the receiver location  undergoes variations in amplitude over distances in space of the order of a wave- length. As a result, variations of the classical wireless channel were employed, where  multiple receiving antenna elements were introduced, or in other words, antenna  structures with multiple interconnection points to the receiver. These antennas were  designed to achieve so-called receiver diversity. The channel could then be modeled  as having a single input and multiple outputs, or in the current terminology SIMO   single input multiple output . Classical receiver techniques to process the multiple  outputs were referred to as combining techniques. The three classical combining  techniques are selection, equal gain, and maximal ratio combining.  Alternative processing approaches of the signals at the multiple outputs taking  the phase of the received signal into account  or taking the timing of the received  signal into account  result in the receiver antenna structure behaving as a direc- tional antenna, where the antenna gain is dependent on the direction of arrival— the technique is referred to as beamforming, or antenna array, or phased array, and  works well when the timing of the received signals at the antenna elements is on the  order of a carrier period; that is, elements are spaced on the order of a wavelength.  Such a technique can also be employed with multiple antenna elements at the trans- mitter and a single element at the receiver. This results in the system being modeled  as a SISO system with directivity. In either the case of transmitter or receiver beam- forming, the system may be modeled as a SISO system with directivity.  Over the past 30 years of wireless research, another variation was introduced,  where  multiple  transmitting  antenna  elements  are  introduced,  and  where  an   v   vi  ◾  Foreword  information signal is fed into the different elements with various delays. The rela- tive delays between the signals are much larger than the carrier period and on the  order of the transmission symbol period. This technique became known as delay  transmission  diversity  and  in  effect  simulated  a  channel  with  multipath  propa- gation. Such a channel exhibits what is referred to as frequency diversity in that  the frequency response has a variation over the frequency band of the transmit- ted signal. The variation with frequency is measured by the coherence bandwidth  parameter and is inversely related to the relative delay of the signals being fed into  the transmitting antenna elements. A SISO channel with the channel multipath  having a small delay spread exhibits what we call frequency flat fading, with its  effect being uncorrectable with any signal processing techniques at the receiver.  The introduction of relative delays at the different transmitting antenna elements  basically transforms the channel into a frequency-selective fading channel, where  appropriate signal processing techniques can then be introduced at the receiver to  correct the effect of fading. Such a receiver utilizes an equalizer and the resulting  signal is insensitive to the precise location of the receiving antenna over several  wavelengths. One form of this scheme, for wideband signals, is a spread spectrum  system  e.g., CDMA*  with a Rake receiver.  The  next  development  in  antenna  schemes  came  with  the  introduction  of  a  multiplicity of antenna elements at the transmitter but with different information  signals being fed into the different antenna elements. This work was first reported  by DaSilva and Sousa in the mid-1980s as a way to solve the flat fading problem  with narrowband systems, such as those with 30 kHz RF channels  1G in North  America .  The  flat  fading  problem  of  narrowband  cellular  systems  is  a  result  of   narrow RF bandwidth together with a small portable receiver terminal which is not  conducive to receiver antenna diversity. The idea was to find a transmitter diversity  technique that requires a relatively simple receiver. To motivate the idea we imag- ine such a SISO system with a multipath where, at the receiver, there are a series  of nulls and peaks in the signal strength over distances of the order of half of a  wavelength. If the single antenna at the receiver is located at a null, then we have a  very weak signal. To attempt to mitigate the flat fading, conceptually we imagine  the transmitting antenna being placed in a motor and move it so that the nulls at  the receiver also move and we get diversity. However, we wish to implement such  a  system  without  moving  parts,  hence  we  can  propose  what  is  called  switching  diversity, where the signal at the transmitter is periodically switched between two  antenna elements. Such switching may have undesirable effects in broadening the  spectrum. We therefore considered that switching between two antennas is a form  of transmitting two orthogonal signals in the two antenna elements and, in this  way, we were led to a scheme where a signaling constellation of two dimensions is  created where each dimension is associated with a transmitting antenna element.  In the basic scheme we have the constellation points:  −1, −1 ,  −1, 1 ,  1, −1 , and   *  Code division multiple access.   Foreword  ◾  vii   1,1 . We then realized that if we introduce a rotation of this constellation in the  plane we obtain in effect a modulation scheme that, in a sense, has fading resistant  properties.  A variation of the above technique of transmitter diversity was introduced after- ward by Alamouti where, instead of associating the signals transmitted on the dif- ferent antennas with a 4-point constellation, a scheme is devised where two symbols  s1 and s2 are transmitted over two successive time slots as follows: At time slot 1  we send s1 on antenna 1 and s2 on antenna 2, and in time slot 2 we send −s2 * on  antenna 1 and  s1 *  on antenna 2. This scheme was later coined as space–time coding,  although some coding theorists would argue that this is a misnomer as there is no  coding theory involved in the classical sense of coding theory.  The next major development, by Foschini and others, occurred with consider- ation of enhanced receiver antenna structures where it is possible to install a mul- tiplicity of antenna elements and achieve some degree of decorrelation between the  signals in the different receiver antenna elements. We consider a system with m  receiving antenna elements and n transmitting antenna elements; that is, a system  with multiple inputs and multiple outputs  MIMO . The channel can then be mod- eled by a channel gain matrix h =  hi,j , where hi,j is the path gain between the ith  transmitting antenna element and the jth receiving antenna element. We model  the inputs to the different antenna elements by the vector x, where the component  xi is fed into the ith antenna element and where the vector y models the outputs  at the receiver antenna. Thus, we have y = hx. We observe that if the channel has  no multipath components, then we have hi,j = 1 for all i,j, and use of the multiple  antennas has no benefit in the sense that we cannot separate the signals from the  different transmitter elements to, in effect, recover all the data. In fact, the signals at  each receiver antenna element are all equal to the sum of the inputs to the different  transmitter elements. However, in the case that m = n, and if the matrix h is invert- ible, we can easily compute x = h−1y. Hence, we can recover x from y; that is, we  can decouple the channel and make it behave as if there are n parallel noninteract- ing paths. The next observation is that the behavior of this scheme is very much  dependent on the eigenvalues of the matrix h, because in a sense they determine  the signal strength in each of the decoupled paths and eventually the performance  in the presence of noise in each path. The scheme works well if the environment  contains many multipath components.   The analysis of this scheme is usually presented by diagonalizing the matrix h  as follows: h = MΛM*, where Λ is the diagonal matrix of eigenvalues of h and M  is the matrix whose column vectors are the associated eigenvectors. In this form we  can view the effect of h on the channel input signal as three transformations. First,  the multiplication by M* is a form of pre-coding of the channel input vector x, or  changing of coordinate system to make it simple to apply the channel transforma- tion. Then, the multiplication by Λ, in effect, models the different independent  paths of the channel and, finally, the effect of multiplication by M converts back  into a coordinate system that corresponds to the system under which the real signal    viii  ◾  Foreword  observations are made. In the case that the matrix h is not a square, then a similar  decomposition can be achieved using the well-known singular-value decomposi- tion  SVD : h = uΛv*, where u is an m × m real or complex unitary matrix; Λ is  an  m × n  rectangular  diagonal  matrix;  and  v*  is  the  conjugate  transpose  of  v,  which is an n × n real or complex unitary matrix. We may view the matrix h as  providing the transformation between the input signal x and the output signal y,  hence we have y = hx = uΛv*x.   Considering the input to the channel as a vector of information symbols, the  “signals” in this linear system are finite dimensional vectors. These transformations  become very familiar if we draw a comparison with the area of linear time invariant   LTI  systems with which we are familiar in an introduction to linear systems. In  those systems, the familiar concepts are time domain, frequency domain, convo- lution, and transfer function. The direct method of computation of the output is  based on a convolution and is done in one step. The indirect method based on the  frequency domain uses three steps. In a sense performing the multiplication y = hx  is analogous to convolution. Now, using the SVD decomposition of h, we first  compute v*x  analogous to converting the input into the “frequency domain” .  Then, multiplication by the diagonal matrix Λ  simple  is like multiplying by the  transfer function. Finally, multiplication by the matrix u corresponds to convert- ing back into the analogue of the time domain. In the design of linear systems, we  prefer the frequency domain because it simplifies our understanding of the system  and, in a sense, the above SVD form is preferable to understanding the behavior of  the multipath channel.  Now, MIMO is a technology that has been widely adopted in state-of-the-art  cellular systems such as LTE and systems such as WiFi and WiMax, where con- figurations up to 4 × 4  4 transmitting elements and 4 receiving elements  have  been adopted. For instance, bit-rate capacities per link are often quoted in bps  Hz where the ITU* specifies the target of 15 bps Hz in the downlink for the LTE†  advanced system. Nevertheless, to achieve these targets, a radio environment with  rich multipath propagation is required. However, when a network assessment is  made, the benefits of MIMO are reduced. To achieve a high degree of multipath,  we need to consider multipath over a wide range of angles of arrival, but in a net- working context we also have the option of beamforming at the transmitter in order  to reduce interference. Using a narrow beam at the transmitter greatly reduces the  interference on neighboring terminals. However, this beamforming then reduces  the multipath that is required by a MIMO link and the effectiveness of MIMO  then decreases. Ultimately, a MIMO system utilizes propagation modes  or paths ,  which have a wide range of angles of departure from the transmitter and angles  of arrival at the receiver. However, these propagation modes, in a sense, cause the   *  International telecommunications union. †  Long-term evolution.   Foreword  ◾   ix  occupation of more space by extra signal components, which degrade the network  where a number of links are designed to operate simultaneously.  The standard MIMO technique assumes a number of antenna elements that are  relatively close together. The goal is to achieve uncorrelated signals at the different  antenna elements, where the correlation decreases with increased distance between  elements, but at the same time have all the elements as close to one another so that  the overall antenna occupies less space. This is an important issue, especially for  portable terminals and the result is that the form factor of the terminal puts a limit  on the number of elements that we may have at the terminal. Nevertheless, there is  another approach where we may place the antenna elements at significant distances  from each other, especially on the infrastructure side of the link where each element  is connected to a controller using various approaches such as optical links—often  referred to as front-haul. This approach is referred to as virtual MIMO and it is one  of the approaches currently being considered in cellular systems employing the so- called remote RF in highly dense cell environments. In other words, a base station  feeds a number of remote RF units where the signals from to these units are jointly  processed at the base station.  As  we  look  into  the  future,  there  are  a  number  of  possibilities  to  generalize  MIMO techniques. Currently, most of the systems consider that each input and  output corresponds to an antenna radiating element as in an antenna array. The set  of elements may be replaced by a generalized radiating antenna structure that has a  number of ports to input and output signals. Such a structure may be quite differ- ent from a set of discrete elements as in the current configurations. One could also  imagine applications and scenarios where the wireless channels and the propaga- tion modes or paths are under the control of the system designer.  We have discussed MIMO from the standpoint of the transfer of signals from  a transmitter to a receiver, where the essence of the scheme has been the increase  in the dimensionality of the signal space available for the transmission of informa- tion signals. There is also the important aspect of mapping or coding of general- ized information signals to the input ports of a MIMO link, and the associated  processing of the signals at the output ports in order to extract the information at  the receiver. A vast amount of research has been performed in the areas of chan- nel modeling, channel sounding, detection, modulation, coded modulation, and  adaptation to the three major wireless standards of today. A great deal of this work  is documented in the following chapters of this book. Looking into the future, we  can expect this research to continue, especially targeting new antenna structures  where the system permits a larger form factor  more antenna elements , and also the  targeting of various cooperative approaches including hybrids of standard MIMO  and cooperative MIMO. A key issue will be the design of schemes with improved  channel sounding techniques over the current standards, where the overhead for  channel sounding quickly grows with the rank of the MIMO scheme  number of  antennas . The network of the future may very well be a two-tier network, where  each  transmission  from  network  infrastructure  to  mobile  hand-held  terminal    x  ◾  Foreword  occurs  over  two  hops.  The  first  hop  would  heavily  employ  MIMO  techniques  between the base stations and a relay station  i.e., not hand held , and can utilize  MIMO with a high rank. The second hop would be between the relay station and  the terminal. Many different scenarios in building the base station to relay station  infrastructure, depending on the nature of traffic demand, are possible, and differ- ent MIMO structures will be required to be employed in each scenario.  Elvino sousa University of Toronto   Preface  This book presents a detailed and comprehensive summary of the most important  enhancements in multiple-input multiple-output  MIMO  systems for 4G, includ- ing their evolution and future trends. Moreover, this book includes descriptions of  the fundamentals of MIMO techniques, associated signal processing, and receiver  design.  The previous books in this series, titled Transmission Techniques for Emergent  Multicast and Broadcast Systems  CRC Press  and Transmission Techniques for 4G  Systems  CRC Press , focused on the transition from 3G to LTE and on the trans- mission  techniques  to  be  employed  in  future  4G  cellular  systems,  respectively.  Therefore, these books covered wide areas.  The purpose of this book is to concentrate in a single place several important  ongoing research and development  R&D  activities in the field of MIMO systems  and their associated signal processing that are expected to be employed in 4G and  5G systems. This is a hot and important topic which allows achieving the increased  throughputs demanded by emergent services. Moreover, this book also aims to pro- vide a comprehensive description of MIMO fundamentals and theory, with special  interest for those needing to improve their skills in the subject, such as corporate  industrial employees or graduate students. Therefore, this book aims to serve a wide  range of potential readers. It can be used by an engineer with a BSc to learn about  the latest R&D on MIMO systems, for the purpose of an MSc or a PhD program,  or for business activities; it can also be used by academic, institutional, or industrial  researchers in order to support the planning, design and development of prototypes  and systems. It is worth noting that the contributing authors have been working on  many international R&D projects related to the subject of the book, and are highly  cited in the MIMO field, which represents an added value.  MIMO systems were initially introduced in IEEE 802.11n  commonly referred  to as Wi-Fi  and in Release 7 of the universal mobile telecommunication system   UMTS  by the Third Generation Partnership Project  3GPP . These systems were  intended to efficiently use network and radio resources by transmitting multiple  data  streams  over  a  common  radio  channel.  This  is  achieved  by  using  multiple  antennas at the transmitter and at the receiver sides.  xi   xii  ◾  Preface  This book is divided into chapters written by different invited authors, leading  researchers in MIMO, covering the various topics associated with MIMO systems  and MIMO processing, starting from the fundamental concepts and conventional  receiver design, up to the most advanced and recently proposed processing techniques. The use of multiple antennas at both the transmitter and receiver aims to improve  performance or increase the symbol rate of the systems, without an increase of the  spectrum bandwidth, but it usually requires higher implementation complexity. In  the case of a frequency selective fading channel, the different transmitted symbols  will be affected by interference coming from other symbols, and this effect is usu- ally known as intersymbol interference  ISI . This effect tends to increase with the  used bandwidth. By exploiting diversity, multi-antenna systems can be employed  to mitigate the negative effects of both fading and ISI. Space–time coding, such as  the pioneering scheme proposed by Alamouti, is an example of a scheme that can  be applied to improve the performance by exploiting diversity.  MIMO systems may also target high bit-rate services over a common channel,  as proposed by Foschini. One of the most important properties of MIMO systems  is resource sharing among many user equipment  UE . MIMO based on spatial  multiplexing  multilayer transmission  aims to achieve higher data rates in a given  bandwidth. This rate increase corresponds to the number of transmitter antennas.  In the case of spatial multiplexing using the conventional postprocessing approach,  the number of receiver antennas must be equal to or higher than the number of  transmitter antennas  although there is active research for underdetermined sys- tems where that restriction is removed .  MIMO  processing  can  be  split  into  two  different  categories:  postprocessing  and preprocessing. Single-user MIMO  SU-MIMO  considers data being trans- mitted from a single user to another individual user, and corresponds to having  postprocessing only or a combination of both, if channel state information  CSI  is  available at the transmitter side. With a sufficient number of receiver antennas, it is  possible to resolve all data streams, as long as the antennas are sufficiently spaced to  minimize the correlation between them. Another type of preprocessing for MIMO  is commonly referred to as multiuser MIMO  MU-MIMO .* The approach behind  MU-MIMO is similar to spatial multiplexing typically employed in the uplink.†  Nevertheless, MU-MIMO is normally implemented in the downlink. This allows  sending different data streams to different UEs. Using the preprocessing approach,  the traditional constraint on spatial multiplexing  where the number of receiver  antennas must be equal to or higher than the number of transmitter antennas  can  be reversed. Therefore, the spatial multiplexing concept can be employed in the  downlink, where the transmitter  BS  accommodates a high number of transmit- ter antennas and the receiver  UEs  can only accommodate a single or a reduced   *  Also referred to as MIMO broadcast. †  Because the base station  BS  typically has the ability to accommodate a higher number of   receiver antennas to perform the nulling algorithm.   Preface  ◾  xiii  number of antennas. With this approach, multiple data streams may be sent to  multiple users at the same time, all in the same frequency bands. Alternatively,  instead  of  implementing  the  spatial  multiplexing  principle  described  above,  the  MU-MIMO can also be performed using a beamforming algorithm. One should  emphasize that most of the MU-MIMO systems require accurate downlink CSI at  the transmitter side.  Chapter 1 of this book starts by exposing the different wireless communica- tion standards that make use of MIMO systems, followed by a description of the  various MIMO techniques, whether SU-MIMO or MU-MIMO, including space– time coding, spatial multiplexing, and beamforming. Finally, Chapter 1 ends with  a description of advanced MIMO applications, such as base station cooperation,  multihop relay, and multiresolution transmission schemes.  Chapter 2 focuses on receiver processing associated with MIMO signal detec- tion, and clarifies how spatial multiplexing is achieved via an insightful geomet- ric interpretation of the MIMO detection problem based on lattice theory. The  chapter covers the most important detection algorithms and lays the bases for the  reader  to  better  understand  subsequent  chapters  on  precoding   Chapter  3 ,  on  OFDM detection  Chapter 4 , and detection in systems with large antenna arrays   Chapter 10 .  Chapter 3 tells us that, when CSI is available at the transmitter side, the tradi- tional singular value decomposition combined with water-filling power allocation  among the channel’s singular values, applied to spatial multiplexing MIMO, is not  optimal. Also capitalizing on a lattice interpretation of the precoding problem, the  optimal precoders are derived. The preprocessing associated to MU-MIMO is also  described under the same framework in Chapter 3, as the only difference is that the  receiver antennas are not co-located. This latter concept comprises multiple streams  of data simultaneously allocated to different users, using the same frequency bands. Optimized MIMO schemes and processing for block transmission techniques  are  described  in  Chapter  4  for  the  orthogonal  frequency  division  multiplexing   OFDM  transmission technique, and in Chapter 5 for single carrier–frequency  domain equalization  SC–FDE , while Chapter 6 presents MIMO processing and  optimization for wideband code division multiple access  WCDMA . Moreover,  the description of the ultra-wideband  UWB  transmission technique* and corre- sponding MIMO processing and optimizations are provided in Chapters 7 and 8.  The MIMO optimizations for different transmission techniques include enhanced  state-of-the-art  receivers,  in  order  to  improve  the  overall  system  performance,  capacity, and coverage.  Although all of these subjects are nonspecific to any particular system, Chapter  9 focuses on the performance analysis of possible schemes for 4G systems using  different  combinations  of  MIMO  schemes   SU-MIMO  and  MU-MIMO   and  transmission  techniques,  cellular  environments,  relay  techniques,  and  services.   *  UWB transmission technique is envisaged for 5G systems.   xiv  ◾  Preface  To allow the deployment of the emergent services, such as video broadcast or video- on-demand, the combination of these enhancements is accomplished by adaptive  transmission techniques. In Chapter 9, the authors combine several of these tech- niques for the purpose of implementing 4G services. A number of simulation results  obtained using link level and system level simulations are presented, allowing for  comparison among the several different techniques and schemes, and enabling the  reader to identify the key factors required by emergent wireless systems.  In the final three chapters, the book presents very recent and exciting extensions  to MIMO. After more than a decade of research on MIMO detection methods, an  efficient way to put in practice a receiver for the 8 × 8 antenna configuration, as  required by the LTE-Advanced standard, is still an issue that with which manu- facturers  have  to  deal.  Chapter  10  shows  that  recent  developments  in  detection  algorithms  combined with the new nature of the problem when the number of  dimensions  becomes  very  high   actually  open  doors  to  the  use  of  much  larger  antenna  arrays.  Then,  in  Chapters  11  and  12,  the  very  recent  concept  of  “add- ing bits in the air”  now known as physical layer network coding  is explored and  combined in different ways with multiple-antenna terminals. This brings together  coding and signal processing in a way that will redefine the design of the physical  layer. It seems that many more interesting discoveries in the history of radio com- munications are still to come.  Mário Marques da silva Francisco A. Monteiro  MATLAB  and Simulink  are registered trademarks of The MathWorks, Inc. For  product information, please contact:  The MathWorks, Inc. 3 Apple Hill Drive Natick, MA 01760-2098 USA Tel: 508 647 7000 Fax: 508-647-7001 E-mail: info@mathworks.com Web: www.mathworks.com   Editors  Mário  Marques  da  silva  is  an  associate  profes- sor at the Universidade Autónoma de Lisboa, and  a  researcher  at  Instituto  de  Telecomunicações  in  Lisbon,  Portugal.  He  earned  his  BSc  in  elec- trical  engineering  in  1992,  and  MSc  and  PhD  in  telecommunications electrical  engineering  in  1999 and 2005, respectively, both from Instituto  Superior Técnico, University of Lisbon.  Between  2005  and  2008,  he  was  with  the  NATO  Air  Command  Control  &  Management  Agency  NACMA  in Brussels  Belgium , where  he  managed  the  deployable  communications  of  the new Air Command and Control System Program. He has been involved in  several  telecommunications  projects.  His  research  interests  include  networking  and  mobile  communications,  namely,  block  transmission  techniques   OFDM,  SC-FDE ,  interference  cancellation,  space–time  coding,  MIMO  systems,  smart  and adaptive antennas, channel estimation, software defined radio, IP technolo- gies, and network security. He is also a Cisco certified CCNA instructor.  Dr. Marques da Silva has authored books such as Multimedia Communications  and Networking  CRC Press , Transmission Techniques for Emergent Multicast and  Broadcast Systems  CRC Press , and Transmission Techniques for 4G Systems  CRC  Press , as well as authored several dozens of journal and conference papers. He is a  member of the Institute of Electrical and Electronics Engineers  IEEE  and a mem- ber of the Armed Forces Communications and Electronics Association  AFCEA ,  as well as a reviewer for a number of international scientific IEEE journals and  conferences. Finally, he has chaired many conference sessions and has been serving  in the organizing committee of relevant EURASIP and IEEE conferences.  xv   xvi  ◾  Editors  Francisco  A.  Monteiro  is  an  assistant  professor  at  ISCTE—University  Institute  of  Lisbon  and  a  researcher  at  Instituto  de  Telecomunicações  in  Lisbon,  Portugal.  In  the  past,  he  has  been  a  teaching assistant at the Department of Electrical  and Computer Engineering at Instituto Superior  Técnico, University of Lisbon.  He  obtained  his  PhD  in  engineering  from  the  University  of  Cambridge,  United  Kingdom,  in  2012,  and  had  previously  received  both  the  Licenciatura degree and an MSc in electrical and  computer  engineering  from  Instituto  Superior  Técnico, University of Lisbon, in 1999 and 2003, respectively. His research has  always been focused on signal processing for wireless communications. He acts as  a frequent reviewer for a number of IEEE journals and conferences, and has been  serving in the organizing committee of relevant EURASIP and IEEE conferences. In 2008, Dr. Monteiro was a visiting researcher at the Department of Electrical  and  Computer  Engineering  of  the  University  of  Toronto  for  four  months,  with  scholarships from the Royal Academy of Engineering, the Calouste Gulbenkian  Foundation  and  the  Cambridge  Philosophical  Society.  At  Cambridge,  he  was  a  member of Fitzwilliam College  where he received a College Senior Scholarship in  2007 2008 , and carried out his research in the Digital Technology Group at the  Computer Laboratory, while being affiliated with the Department of Engineering. He  received  the  Best  Paper  Award   Conference  Prize   at  the  European  Conference  on  Wireless  Technology  2007  in  Munich,  Germany.  He  was  also  awarded the Young Engineer Best Paper Award at the European Conference on  Wireless Technology 2004, in Amsterdam, the Netherlands. His MSc thesis was  awarded 3rd place at the Innovation Young Engineer Competition presented by  the Portuguese Engineers Institution in 2002.  Dr. Monteiro is a member of several societies of the IEEE, a life member of  Fitzwilliam  College,  a  Fellow  of  the  Cambridge  Philosophical  Society,  a  junior  member of the Isaac Newton Institute for Mathematical Sciences, and a life mem- ber of student societies for the promotion of science and technology  namely, the  Trinity Mathematical Society, and the Cambridge University Scientific Society .   Contributors  Ben Allen University of Bedfordshire Luton, United Kingdom  Américo Correia ISCTE—Instituto Universitário   de Lisboa  and Instituto de Telecomunicações Lisbon, Portugal  Mário Marques da silva Universidade Autónoma de Lisboa and Instituto de Telecomunicações Lisbon, Portugal  Armin dekorsy University of Bremen Bremen, Germany  rui dinis FCT—Universidade Nova de Lisboa  and Instituto de Telecomunicações Caparica, Portugal  david J. Edwards University of Oxford Oxford, United Kingdom  dzevdan Kapetanović Interdisciplinary Centre for  Security Reliability and  Trust  SnT   University of Luxembourg Luxembourg  Ioannis Krikidis University of Cyprus Nicosia, Cyprus  Xiaoli Ma Georgia Institute of   Technology  Atlanta, Georgia  Wasim q. Malik Massachusetts Institute   of Technology  and Harvard Medical School Cambridge, Massachusetts  Francisco A. Monteiro ISCTE—Instituto Universitário de   Lisboa  and Instituto de Telecomunicações Lisbon, Portugal  xvii   xviii  ◾  Contributors  Paulo Montezuma FCT—Universidade Nova de   Lisboa  and UNINOVA Caparica, Portugal  Fredrik rusek Lund University Lund, Sweden  João Carlos silva ISCTE—Instituto Universitário de   Lisboa  and Instituto de Telecomunicações Lisbon, Portugal  vit sipal Dublin Institute of Technology Dublin, Ireland  Elvino sousa University of Toronto Toronto, Ontario, Canada  nuno souto ISCTE—Instituto Universitário de   Lisboa  and Instituto de Telecomunicações Lisbon, Portugal  John s. Thompson The University of Edinburgh Edinburgh, United Kingdom  Ian J. Wassell University of Cambridge Cambridge, United Kingdom  Meng Wu University of Bremen Bremen, Germany  dirk Wübben University of Bremen Bremen, Germany  qi zhou Ratrix Technologies Atlanta, Georgia   Chapter 1 MIMO Techniques  and Applications  Mário Marques da Silva and Américo Correia  Contents 1.1    Evolution of Cellular Systems and the New Paradigm of 4G .......................2 1.1.1  Evolution from 3G Systems into Long-Term Evolution .....................5 1.1.2  WiMAX—IEEE802.16 ....................................................................7 1.1.3  LTE-Advanced and IMT-Advanced ..................................................9 1.2  MIMO Techniques ....................................................................................10 1.2.1  Space–Time Coding .......................................................................12 1.2.1.1  Space–Time Block Coding for Two Antennas ..................13 1.2.1.2  Space–Time Block Coding for Four Antennas ..................14 1.2.2  Selective Transmit Diversity ...........................................................16 1.2.3  Multilayer Transmission .................................................................17 1.2.4  Space Division Multiple Access .......................................................20 1.2.5  Beamforming ..................................................................................21 1.2.6  Multiuser MIMO ...........................................................................23 1.3  Advanced MIMO Applications ..................................................................24 1.3.1  Base Station Cooperation ................................................................25 1.3.1.1  Coordinated Multipoint Transmission .............................26 1.3.1.2  Macro-Diversity ................................................................28 1.3.2  Multihop Relay ...............................................................................31 1.3.2.1  Adaptive Relaying .............................................................31 1.3.2.2  Configurable Virtual Cell Sizes ........................................32 1.3.2.3  Multihop Relay in 3GPP ..................................................33  1   2  ◾  MIMO Processing for 4G and Beyond  1.3.3  Multiresolution Transmission Schemes ...........................................37 1.3.4  Energy Efficiency in Wireless Communications..............................39 Acknowledgment ............................................................................................... 42 References .......................................................................................................... 42  1.1   Evolution of Cellular Systems and the   New Paradigm of 4G  The first generation of cellular networks  1G  were analog, deployed between 1980  and 1992. 1G included a myriad of cellular systems, namely, the total access com- munication system  TACS , the advanced mobile phone system  AMPS , and the  Nordic mobile telephony  NMT , among others. These systems were of low reli- ability, low capacity, low performance, and without roaming capability between  different networks and countries. The multiple access technique adopted was fre- quency division multiple access  FDMA , where signals of different users are trans- mitted in different  orthogonal  frequency bands.  The  second  generation  of  cellular  networks   2G ,  like  the  global  system  for  mobile communications  GSM , were widely used between 1992 and 2003. This  introduced the digital technology in the cellular environment, with a much better  performance, better reliability, higher capacity, and even with the roaming capabil- ity between operators, due to its high level of standardization and technological  advancements. The multiple access technique used by GSM was time division mul- tiple access  TDMA , where signals generated by different users were transmitted  in different  orthogonal  time slots.  Narrowband code division multiple access  CDMA  system was adopted in  the 1990s by IS-95 standard, in the United States. IS-95 was also a 2G system.  Afterward,  the  Universal  Mobile  Telecommunications  System   UMTS ,  stan- dardized  in  1999  by  the  Third  Generation  Partnership  Project   3GPP *  release  99  see Table 1.1 , proceeded with its utilization, in this particular case using the  wideband CDMA  WCDMA . The UMTS consists of a third-generation cellular  system  3G .  The CDMA concept relies on different spread spectrum transmissions, each  one associated with a different user’s transmission, using a different  ideally orthog- onal  spreading sequence [Marques da Silva et al. 2010].  The long-term evolution  LTE  can be viewed as the natural evolution of 3G,†  using a completely new air interface, as specified by 3GPP release 8, and enhanced  in its release 9. Its initial deployment took place in 2010. The LTE comprises an   *  3GPP is responsible for specifying and defining the architecture of the European 3G and 4G   evolution.  †  In fact, LTE is sometimes referred to as 3.9G.   MIMO Techniques and Applications  ◾  3     A M D F O    :  k n  i l  n w o D     A M D F O    :  k n  i l  n w o D  A M D F - C S    :  k n  i l  p U  A M D F - C S    :  k n  i l  p U  A M D C S - D T     A M D C W  A M D C S - D T     A M D C W  A M D C S - D T     A M D C W    t e k c a p     d e s a b P I       t e k c a p     d e s a b P I          t e k c a p +   t i u c r i C       t e k c a p +   t i u c r i C       t e k c a p +   t i u c r i C  i    g n h c t i  w s  i    g n h c t i  w s  i  g n h c t i  w s  i  g n h c t i  w s  i  g n h c t i  w s  d e c n a v d A T M     I   E T L    ;  c i d a m o n   s p b M 0 0 5     e  l i  b o m    s p b M 0 5       ;  c i d a m o n   s p b G 1     e  l i  b o m    s p b M 0 0 1     2 1   1 1   0 1  4 1 0 2  E T L  E T L - D T  + A P S H  A P S H  A M D C W  A P U S H D T  -  A P D S H D T  -  A M D C S - D T  D D F  D D T  b s p b M 0 6 1 >        a s p b M 8 2     a s p b M 4     .  4 1  s p b k 4 8 3     e t a r    a t a d k n     i l  n w o D  0 1 0 2  9   8  9   8 0 0 2  7  8   6 0 0 2  6   5  3 0 0 2  9 9  t n e m y o p e D  l  l  e s a e e r   P P G 3     s e s a e l e R P P G 3   t n e r e f f i  D    l a r e v e S   f o     n o s i r a p m o C     .  1 1    e l b a T  b s p b M 0 6 >        a s p b M 1 1     a s p b M 6 7     .  5  s p b k 8 2 1     e t a r    a t a d k n     i l  p U  c s e Y  s e Y  s e Y  s e Y  s e Y  s e Y  o N  s e Y  o N  o N  s e Y  o N  s e Y  o N  o N  o N  o N  s e Y  o N  o N  .                 i  I  O M M 2 × 2 d n a h t d w d n a b z H M 0 2 g n m u s s A  i           o N  o N  o N  o N  o N     n o i s s i  m s n a r T  i  e u q n h c e t  O M M  I  y a l e r   p o h i t l u M  i  g n h c t i  w S     n o i t a l u d o m e v i t p a d A     i  g n d o c d n a     s  m e t s y s   e v i t a r e p o o C  n o i t a g e r g g a    r e  i r r a C  . s e t a r       a t a d k a e P  .  I  O M M 8 × 8              a     b     c      4  ◾  MIMO Processing for 4G and Beyond  air interface based on orthogonal frequency division multiple access  OFDMA * in  the downlink and single carrier–frequency division multiple access  SC-FDMA   in the uplink. This allows a spectral efficiency improvement by a factor of 2–4,  as compared to the high-speed packet access†  HSPA , making use of new spec- trum, different transmission bandwidths from 1.4 MHz up to 20 MHz, along with  multiple-input–multiple-output  MIMO  systems and the all-over IP‡ architecture  [Marques da Silva et al. 2010; Marques da Silva 2012].  With the aim of fully implementing the concept of “anywhere” and “anytime,”  as well as to support new and emergent services, users are demanding more and more  from  the  cellular  communication  systems.  New  requirements  include  increasing  throughputs and bandwidths, enhanced spectrum efficiency, lower delays, and net- work capacity, made available by the air interface.§ These are the key requirements  necessary to deliver the new and emergent broadband data services. In order to meet  these requirements, the LTE-Advanced¶ was initially specified in release 10 of 3GPP,  and improved in its release 11 and 12. The LTE-Advanced consists of a fourth-gener- ation cellular system  4G , being expected to be fully implemented in 2014. It aims to  support peak data rates in the range of 100 Mbps for vehicular mobility to 1 Gbps for  nomadic access  in both indoor and outdoor environments . 4G aims to support cur- rent and emergent multimedia services, such as social networks and gaming, mobile  TV, high-definition television  HDTV , digital video broadcast  DVB , multime- dia messaging service  MMS , or video chat, using the all-over IP concept and with  improved quality of service**  QoS  [Marques da Silva 2012].  The  specifications  for  International  Mobile  Telecommunications–Advanced   IMT-Advanced††   were  agreed  upon  at  the  International  Telecommunications  Union–Radio communications  ITU-R  in [ITU-R 2008]. ITU has determined  that  “LTE-Advanced”  should  be  accorded  the  official  designation  of  IMT- Advanced. IMT-Advanced is meant to be the international standard of the next- generation cellular systems.‡‡  New topological approaches such as cooperative systems, carrier aggregation,  multihop relay, advanced MIMO systems, as well as block transmission techniques  allow an improved coverage of high-rate transmission, and improved system per- formance and capabilities, necessary to fit the advanced requirements of IMT-A  [ITU-R 2008].  *  In opposition to WCDMA utilized in UMTS. †  Standardized in 3GPP Releases 5, 6, and 7  see Table 1.1 . ‡  Internet protocol. §  Where the bottleneck is typically located. ¶  LTE-Advanced is commonly referred to as LTE-A. ** Important QoS parameters include the definition of the required throughput, bit error rate,   end-to-end packet loss, delay, and jitter.  †† IMT-Advanced is commonly referred to as IMT-A. ‡‡ Similarly, IMT2000 corresponds to a set of third-generation cellular system standards, namely,   IEEE 802.16e, CDMA2000, WCDMA, and so on.      MIMO Techniques and Applications  ◾  5  1.1.1  Evolution from 3G Systems into Long-Term Evolution The third generation of cellular system comprises different evolutions. The initial  version,  specified  by  3GPP  release  99,  marked  a  sudden  change  in  the  multiple  access technique  see Table 1.1 . While the GSM was based on TDMA, the 3G  makes use of WCDMA to achieve an improved spectrum efficiency and cell capac- ity. This evolution allowed a rate improvement from a few dozens of kbps up to  384 kbps for the downlink and 128 kbps for the uplink. These rates were improved  in the following updates, achieving 28 Mbps in the downlink of HSPA+  3GPP  release 7 . In order to respond to the increased speed demands of the emergent  services, higher speeds became possible with the already deployed LTE, supporting  160 Mbps in the downlink  as defined by 3GPP release 8 , and even higher speeds  with  some  additional  improvements  to  the  LTE  baseline  introduced  in  3GPP  release 9  e.g., advanced MIMO systems . The LTE air interface was the result of  a study item launched by 3GPP named Evolved UTRAN  E-UTRAN . The goal  was to face the latest demands for voice, data, and multimedia services, improving  spectral efficiency by a factor 2–4, as compared to HSPA release 7. The LTE can be  viewed as a cellular standard for 3.9G  3.9 Generation .  The LTE air interface relies on a completely new concept that introduced sev- eral technological evolutions as a means to support the performance requirements  of this new standard. This includes block transmission technique using multicarri- ers, multiantenna systems  MIMO , base station  BS  cooperation, multihop relay- ing, as well as the all-over IP concept.  The  air  interface  of  LTE  considers  the  OFDMA  transmission  technique  in  the downlink and SC-FDMA in the uplink. Depending on the purpose, differ- ent types of MIMO systems are considered in 3GPP release 8. The modulation  employed in LTE comprises quadrature phase shift keying  QPSK , 16-QAM, or  64-QAM  quadrature amplitude modulation , using adaptive modulation and cod- ing  AMC . In the presence of noisy channels, the modulation order is reduced and  the code rate is increased. The opposite occurs when the channel presents better  conditions.  The LTE comprises high spectrum flexibility, with different spectrum alloca- tions of 1.4, 3, 5, 10, 15, and 20 MHz. This allows a more efficient spectrum usage  and a dynamic spectrum allocation based on the bandwidths data rates required by  the users [Astely et al. 2009].  Intracell  interference  is  avoided  in  LTE  by  allocating  the  proper  orthogonal  time  slots  and  carrier  frequencies  between  users  in  both  uplink  and  downlink.  However, intercell interference is a problem higher than in the case of UMTS,*  especially for users at the cell edge. Intercell interference can be mitigated by imple-  *  Owing to the lower-power spectral density of WCDMA signals, the level of interferences gen-  erated in UMTS tends to be lower.      6  ◾  MIMO Processing for 4G and Beyond  menting mechanisms such as interference cancelation schemes, reuse partitioning,  and advanced BS cooperation.  Another important modification of the LTE, as compared to UMTS, is the all- IP architecture  i.e., all services are carried out on top of IP , instead of the circuit*  plus packet† switching network adopted by UMTS.  An important improvement of the LTE, compared to the UMTS, relies on its   improved capability to support multimedia services.  The multimedia broadcast and multicast service  MBMS , already introduced  in 3GPP release 6  HSPA , aims to use spectrum-efficient multimedia services, by  transmitting data over a common radio channel. MBMS is a system that allows  multiple mobile network users to efficiently receive data from a single content pro- vider source by sharing radio and transport network resources. While conventional  mobile communications are performed in unicast‡ mode, multimedia services are  normally delivered in either broadcast or multicast mode. In broadcast mode, data  are transmitted in a specific area  MBMS service area  and all users in the specific  MBMS service area are able to receive the transmitted MBMS data. Very often,  broadcast  communications  are  established  in  a  single  direction   i.e.,  there  is  no  feedback from the receiver into the transmitter . In multicast mode, data are trans- mitted in a specific area but only registered users in the specific MBMS service area  are able to receive the transmitted MBMS data.  The  LTE  introduced  a  new  generation  of  MBMS,  titled  evolved  MBMS   eMBMS .  This  is  implemented  in  LTE  in  two  types  of  transmission  scenarios  [Astely et al. 2009]:   ◾ Multicell  transmission:  multimedia  broadcast  over  a  single-frequency  net- work  MBSFN § on a dedicated frequency layer or on a shared frequency  layer. The group of cells that receive the same MBSFN multicast data service  is referred to as MBSFN area.¶   ◾ Single-cell  transmission:  single  cell–point  to  multipoint   SC-PTM   on  a   shared frequency layer.  Multicell  transmission  in  single-frequency  network   SFN   area  is  a  way  to  improve the overall network spectral efficiency. In MBSFN, when different cells  transmit the same eMBMS multimedia data service, the signals are combined, in  order to provide diversity for user equipment  UE  located at a cell boundary. This  results in an improved performance and better service quality.  *  Circuit switching is employed in UMTS for voice service. †  Packet switching is employed in UMTS for data service. ‡  Unicast stands for a communication whose data destination is a single station. §  The MBSFN allows delivering services such as mobile television. ¶  Within an MBSFN area, if one or more cells are not required to broadcast the multimedia data  service, the transmission can be switched off and the corresponding resources can be released  to regular unicast or other services.      MIMO Techniques and Applications  ◾  7  1.1.2  WiMAX—IEEE802.16 WiMAX stands for Worldwide Interoperability for Microwave Access and allows  fixed and mobile access. WiMAX, standardized by the Institute of Electrical and  Electronics Engineers  IEEE  as IEEE 802.16, was initially created in 2001 and  updated by several newer versions. It consists of a technology that implements a  wireless metropolitan area network  WMAN  [Eklund et al. 2002; Andrews et al.  2007; Peters and Heath 2009]. WiMAX provides wireless Internet access to the  last mile, with a range of up to 50 km. Therefore, it can be viewed as a complement  or competitor of the existing asynchronous digital subscriber line  ADSL  or cable  modem,  providing  service  with  the  minimum  effort  in  terms  of  required  infra- structures. However, fixed WiMAX can also be viewed as a backhaul for Wi-Fi   IEEE 802.11 , cellular BS, or mobile WiMAX. Since the standard only defines the  physical layer and medium access control  MAC  sublayer, it can be associated with  either IP version 4  IPv4  or IP version 6  IPv6 .  In order to allow the operation of WiMAX in different regulatory spectrum  constraints faced by operators in different geographies, this standard specifies chan- nel sizes ranging from 1.75 MHz up to 20 MHz, using either time division duplex- ing  TDD  or frequency division duplexing  FDD , with many options in between  [Yarali and Rahman 2008].  The initial version of WiMAX was updated by several newer versions, namely   ◾ IEEE  802.16-2004,  also  referred  to  as  IEEE  802.16d.  This  version  only  specified the fixed interface of WiMAX, without providing any support for  mobility  IEEE 802.16-2004 . This version of the standard was adopted by  European Telecommunications Standards Institute  ETSI  as a base for the  HiperMAN.*   ◾ IEEE 802.16-2005, also referred to as IEEE 802.16e. It consists of an amend- ment to the previous version. It introduced support for mobility, handover,  and roaming, among other new capabilities  IEEE 802.16e . In addition, to  achieve better performances, MIMO schemes were introduced.   ◾ Relay specifications are included in IEEE 802.16j amendment. The incorpo- ration of multihop relay capability in the foundation of mobile IEEE 802.16- 2005 is a way to increase both the available throughput by a factor of 3–5  and or coverage  and higher channel reuse factor , or even to fill the “coverage  hole” of indoor coverage [Oyman et al. 2007; IEEE 802.16; Peters and Heath  2009]. Multihop relay capability was also included in IMT-Advanced [Astely  et al. 2009].  In  addition  to  these  versions,  requirements  for  the  next-version  Mobile  WiMAX  titled  IEEE  802.16 m   IEEE  802.16 m   were  completed.  The  goal  of   *  High-performance metropolitan area network.      8  ◾  MIMO Processing for 4G and Beyond  IEEE 802.16 m version is to reach all the IMT-Advanced requirements as pro- posed by ITU-R in ITU-R 2008, making this standard a candidate for the IMT- A. Advances in IEEE 802.16 m include wider bandwidths  up to 100 MHz, shared  between uplink and downlink , adaptive and advanced TDMA OFDMA access  schemes, advanced relaying techniques  already incorporated in IEEE 802.16j ,  advanced multiple-antenna systems, adaptive modulation schemes such as hierar- chical constellations and AMC, and frequency adaptive scheduling, among other  advanced techniques.  The original version of the standard specified a physical layer operating in the  range of 10–66 GHz, based on OFDM and TDMA technology. IEEE 802.16- 2004  added  specifications  for  the  2–11 GHz  range   licensed  and  unlicensed ,  whereas  IEEE  802.16-2005  introduced  the  scalable  OFDMA   SOFDMA   with  MIMO  either space–time coding based, spatial multiplexing based, or beamform- ing  or advanced antenna systems  AAS   IEEE 802.16e , instead of the simple  OFDM with 256 subcarriers considered by the previous version.  In terms of throughputs and coverage, these two parameters are subject to a  trade-off  IEEE 802.16e : typically, mobile WiMAX provides up to 10 Mbps per  channel   symmetric ,  over  a  range  of  10 km  in  rural  areas   line-of-sight  [LOS] environment   or  over  a  range  of  2 km  in  urban  areas   non-LOS  environment   [Ohrtman 2008]. With the fixed WiMAX, this range can normally be extended.  Mobile version considers an omnidirectional antenna, whereas fixed WiMAX uses  a  high-gain  antenna   directional .  Throughput  and  ranges  may  always  change.  Nevertheless, by enlarging one parameter, the other has to reduce; otherwise, the  bit error rate  BER  would suffer degradation. In the limit, WiMAX can deliver up  to 70 Mbps per channel  in LOS, short distance and fixed access , and may cover  up to 50 km  in LOS for fixed access , with a high-gain antenna [Ohrtman 2008],  but not both parameters simultaneously. Contrary to UMTS where handover is  specified in detail, mobile WiMAX has three possibilities but only the first one is  mandatory: hard handover  HHO , fast base station switching  FBSS , and macro- diversity handover  MDHO . FBSS and MDHO are optional, as it is up to the  manufacturers to decide on their implementation specifications. Therefore, there is  the risk that handover is not possible for these advanced handover schemes between  two BS from different manufacturers. Another drawback on the use of WiMAX is  the maximum speed allowed in mobility, which is limited to 60 km h. For higher  speeds, the user may experience a high degradation in performance.  The  WiMAX  version  currently  available   IEEE  802.16-2005   incorporates  most of the techniques also adopted by LTE  from 3GPP . Such examples of tech- niques are OFDMA, MIMO, advanced turbo coding, all-over IP architecture, and  so on. In addition, the inclusion of multihop relay capabilities  IEEE 802.16j  aims  to improve the speed of service delivery and coverage by a factor of 3–5. Moreover,  IEEE  802.16 m  integrates  and  incorporates  several  advancements  in  transmis- sion techniques that meet the IMT-Advanced requirements, including 100 Mbps  mobile and 1 Gbps nomadic access, as defined by ITU-R [ITU-R 2008].      MIMO Techniques and Applications  ◾  9  1.1.3  LTE-Advanced and IMT-Advanced The  4G  aims  to  support  the  emergent  multimedia  and  collaborative  services,  with  the  concept  of  “anywhere”  and  “anytime,”  facing  the  latest  bandwidth  demands. The LTE-Advanced  standardized by 3GPP  consists of a 4G system.  Based on LTE, the LTE-Advanced presents an architecture using the all-over IP  concept [Bhat et al. 2012]. The support for 100 Mbps in vehicular and 1 Gbps  for nomadic access* is achieved with the following mechanisms:   ◾ Carrier  aggregation  composed  of  multiple  bandwidth  components   up  to   20 MHz  in order to support transmission bandwidths of up to 100 MHz.   ◾ AAS  increasing  the  number  of  downlink  transmission  layers  to  eight  and  uplink transmission layers to four. Moreover, LTE-Advanced introduced the  concept of multiuser MIMO, in addition to the single-user MIMO previ- ously considered by the LTE.   ◾ Multihop  relay   adaptive  relay,  fixed  relay  stations,  configurable  cell  sizes,  hierarchical cell structures, etc.  in order to achieve a coverage improvement  and or an increased data rate.   ◾ Advanced intercell interference cancelation  ICIC  schemes.  ◾ Advanced BS cooperation, including macro-diversity.  ◾ Multiresolution  techniques   hierarchical  constellations,  MIMO  systems,   OFDMA multiple access technique, etc. .  Standardization of LTE-Advanced is part of 3GPP release 10  completed in  June 2011 , and enhanced in its release 11  December 2012  and in its release 12   March 2013 .  The IMT-Advanced refers to the international 4G system, as defined by the  ITU-R [ITU-R 2008]. Moreover, the LTE-Advanced was ratified by the ITU as an  IMT-Advanced technology in October 2010 [ITU 2010].  Within  4G,  voice,  data,  and  streamed  multimedia  are  delivered  to  the  user  based on an all-over IP packet-switched platform, using IPv6. The goal is to reach  the necessary QoS and data rates in order to accommodate the emergent services.  Owing to the improvements in address spacing with the 128 bits made available  by IPv6, multicast and broadcast applications will be easily improved, as well as the  additional security, reliability, intersystem mobility, and interoperability capabili- ties. Moreover, since the 4G system relies on a pool of wireless standards, this can  be efficiently implemented using the software defined radio  SDR  platform, being  currently an interesting R&D† area in many industries worldwide.  *  1 Gbps as a peak data rate in the downlink, whereas 500 Mbps is required for the uplink. †  Research and development.      10  ◾  MIMO Processing for 4G and Beyond  1.2  MIMO Techniques The basic concept behind MIMO techniques relies on exploiting the multiple prop- agation paths of signals between multiple transmit and multiple receive antennas.  The use of multiple antennas at both the transmitter and receiver aims to improve  performance or symbol rate of systems, without an increase of the spectrum band- width,  but  it  usually  requires  higher  implementation  complexity  [Rooyen  et  al.  2000; Marques da Silva and Correia 2001, 2002a,b, 2003; Hottinen et al. 2003;  Marques da Silva et al. 2012].  In the case of frequency selective fading channel, different symbols suffer inter- ference from each other, whose effect is usually known as intersymbol interference   ISI . This effect tends to increase with the increase of the symbol rate.  By exploiting diversity, multiantenna systems can be employed to mitigate the  effects of ISI. The antenna spacing must be larger than the coherence distance to  ensure independent fading across different antennas [Foschini 1996, 1998; Rooyen  et al. 2000]. Alternatively, different antennas should use orthogonal polarizations  to ensure independent fading across different antennas.  The various configurations, shown in Figure 1.1, are referred to as single input  single output  SISO , multiple input single output  MISO , single input multiple  output  SIMO , or multiple input multiple output  MIMO . SIMO and MISO  architectures  are  a  form  of  receive  and  transmit  diversity  schemes,  respectively.  Moreover, MIMO architectures can be used for combined transmit and receive  diversity, as well as for the parallel transmission of data or spatial multiplexing.  When used for spatial multiplexing, MIMO technology promises high bit rates in  a narrow bandwidth; therefore, it is of high significance to spectrum users. MIMO  systems transmit different signals from each transmit element so that the receive  antenna  array  receives  a  superposition  of  all  the  transmitted  signals.  Figure  1.2  presents a generic diagram of a MIMO system.  For M transmit and N receive antennas, the spectral efficiency, expressed in bits   per seconds per hertz  bit s Hz , is defined by [Telatar 1995; Foschini 1998]     C  EP =  log  2  det  I  N  +  ′ HH        β M            1.1   SISO  SIMO  MISO  MIMO  Figure 1.1  Multiple antenna configurations.      MIMO Techniques and Applications  ◾  11  Input data  MIMO TX processing  Multipath environment  Output data  MIMO RX processing  x1  x2  .  .  .  xM  y1  y2  yN  .  .  .  Figure 1.2  Generic diagram of a MIMO scheme.  where In is the identity matrix of dimension N × N, h is the channel matrix, h′ is  the transpose-conjugate of h, and β is the signal-to-noise ratio  SNR  at any receive  antenna. Foschini and Telatar demonstrated that the capacity grows linearly with  m = min M, N , for uncorrelated channels [Foschini 1996; Telatar 1999].  MIMO schemes are implemented based on multiple-antenna techniques. These   multiple-antenna techniques can be of different forms:   ◾ Space–time block coding  STBC   ◾ Multilayer transmission  ◾ Space division multiple access  SDMA   ◾ Beamforming  STBC is essentially a MISO system. Nevertheless, the use of receive diversity  makes it a MIMO, which corresponds to the most common configuration for this  type of diversity. STBC-based schemes focus on achieving a performance improve- ment through the exploitation of additional diversity, while keeping the symbol rate  unchanged. Open-loop transmit diversity  TD  schemes achieve diversity without  previous knowledge of the channel state at the transmitter side. On the contrary,  closed-loop TD requires knowledge about the channel state information  CSI  at the  transmitter side. STBC, also known as Alamouti scheme, is the most known open- loop technique [Alamouti 1998]  see Figure 1.3 . 3GPP specifications define several  TD schemes, such as the standardized closed-loop modes 1 and 2 [3GPP 2003a],  or  the  open-loop  STBC  [3GPP  2003b]  for  two  transmit  antennas.  The  selective  transmit diversity  STD  is a closed-loop TD. This is not exactly an STBC scheme.  Nevertheless, since this is also a TD scheme, this subject is dealt along with STBC. However, multilayer transmission and SDMA belong to another group, titled  spatial  multiplexing   SM ,  whose  principles  are  similar  but  whose  purposes  are  quite different. The goal of the MIMO based on multilayer transmission* scheme   *  The same principle is applicable to SDMA, but where different transmit antennas correspond   to different users that share the spectrum.      12  ◾  MIMO Processing for 4G and Beyond  Antenna 1  Channel 1  Space–time  block encoder  .  .  .  Channel M  UE  Antenna M  Figure 1.3  Generic block diagram of an open-loop transmitter scheme.  relies on achieving higher symbol rates in a given bandwidth. This rate increase cor- responds to the number of transmit antennas. Using multiple transmit and receive  antennas, together with additional postprocessing, multilayer transmission allows  exploiting multiple and different flows of data, increasing the throughput and the  spectral efficiency. In this case, the number of receive antennas must be equal to  or higher than the number of transmit antennas  although there is active research  for underdetermined systems where that restriction is removed . The increase of  symbol rate is achieved by “steering” the receive antennas to each one  separately   of the transmit antennas, to receive the corresponding symbol stream. This can be  achieved through the use of the nulling algorithm.  Finally, beamforming is implemented by antenna array with certain array ele- ments at the transmitter or receiver being closely located to form a beam array  typi- cally separated half wavelength . This scheme is an effective solution to maximize  the SNR, as it steers the transmit  or receive  beam toward the receive  or transmit   antenna. As a result, an improved performance or coverage can be achieved with  beamforming.  1.2.1  Space–Time Coding Although  space–time  coding  is  essentially  a  MISO  system,  the  use  of  receiver  diversity makes it a MIMO, which corresponds to the most common configuration  for this type of diversity. The STBC is a TD technique, being particularly inter- esting for fading channels, where it is difficult to have multiple receive antennas.  A possible scenario for its application is the downlink transmission of a cellular  environment, where the BS uses several transmit antennas and the mobile terminal  typically has a single antenna [Alamouti 1998].  STBC-based schemes focus on achieving a performance improvement through  the exploitation of additional diversity, while keeping the symbol rate unchanged  [Alamouti 1998; Tarokh et al. 1999]. Symbols are transmitted using an orthog- onal block structure, which enables a simple decoding algorithm at the receiver  [Alamouti 1998; Marques da Silva et al. 2004, 2009].      MIMO Techniques and Applications  ◾  13  The Alamouti’s TD scheme requires some processing from the transmitter, and  can be implemented either in the time domain or in the frequency domain. In this  latter case, it is referred to as space–frequency block coding.* The current descrip- tion focuses on the time-domain coding. The extension to frequency domain cod- ing is straightforward.  Let us consider the lth transmitted symbol defined by  s  l  t      =  a h t   l T  −  nT S         1.2   where al refers to the symbol selected from a given constellation, TS denotes the symbol  duration, and hT t  denotes the adopted pulse-shaping filter. The signal sl t  is trans- mitted over a time-dispersive channel. The received signal is sampled, and the result- ing time-domain block is yl, which is then subject to frequency domain equalization. In the following, we will adopt the following notation: lower- and upper-case  signal variables correspond to time and frequency domain variables, respectively.  The  mapping  between  one  and  the  other  is  achieved  through  discrete  Fourier  transform  DFT  and inverse DFT  IDFT  operations  i.e.,  X  and  x l  = The  lth  frequency-domain  block  before  the  receiver’s  equalization  process  is   { } x  IDFT  DFT  }  {  X  =   .  l  l  l  Yl = DFT  yl , with  Y  l  =     m  S H l    l  m     +  N  l  M  ∑    m  = 1     m  In the above expression, Hl    denotes the channel frequency response for the  lth time domain block  the channel is assumed invariant in the frame  and the mth  transmit antenna. Nl is the frequency-domain block channel noise for the lth block.  1.2.1.1  Space–Time Block Coding for Two Antennas Considering the STBC with two transmit antennas  STBC2 , the lth time-domain  m   , with [Alamouti 1998] block to be transmitted by the mth antenna  m = 1 or 2  is sl   1.3    1.4   − 1  l      1 = a − 2 1 l 2 l     2 = − a * − 2 1 2 l     1 = a l 2 2     2 = a * 2 2 l  − 1  l  l  s s s s              *  The Alamouti transmit diversity scheme can also be applied simultaneously to space, time, and   frequency. In this case, it is referred to as space–time–frequency block coding  STFBC .      14  ◾  MIMO Processing for 4G and Beyond  where  al  refers  to  the  symbol  selected  from  a  given  constellation   e.g.,  a  QPSK  constellation  under an appropriate mapping rule, to be transmitted in the lth time  domain block. Considering the matrix–vector representation, we define sl  ] as  1 2,[           where different rows of the matrix refer to transmit antenna order and different  columns refer to symbol period orders.  The  Alamouti  postprocessing  for  two  antennas  becomes  [Alamouti  1998;   Marques da Silva et al. 2009]  ]  [ 1 2 , sl  =  a l 2 − a  − 1 * 2  l      a a * 2  2  l  l  − 1         l  − 1   cid:31  A 2  cid:31  A 2  l  l   = Y H  − 1 2      1 Y H  2 l  *  l      1 l −  *  +  Y H * l 2   l  2  Y H * l 2  − 1      2 l         β  =  β      1.5    1.6   where β = ∑   − 1  .     l  − 1  2       mH1   M = m l  Y 2  Y   [ , ] 1 2  =  Y − Y  * l 2 * l 2      Defining  yl  H can be expressed in the matrix–vector representation as  cid:31 A where   cid:31  [ , ] 1 2 A l    and  hl   cid:31  A 2   cid:31  A 2  − 1  − 1  .  T  2  l  l  l  [ , ] 1 2  =    =     Finally, the decoded symbols become  *      1 l  [ , ] 1 2 l  T      2  l [ , ] 1 2 Y l  H  =  ,  Equation  1.6   × β,  ×  [ , ] 1 2 l  H   cid:31  A 2  l  −  j  =  Desired Symbol   cid:30   cid:29  cid:28  cid:28  ∑  A 2  M  −  j  l   cid:27  cid:28  cid:28  β    m l  H  2     m  = 1  Noise CComponent cid:26   +  N  eq l 2  −  j  j = 0 1,      1.7   eq where N k l ,  denotes the equivalent noise for detection purposes.  1.2.1.2  Space–Time Block Coding for Four Antennas Orthogonal  codes  of  rate  one,  using  more  than  two  antennas,  do  not  exist  for  modulation orders higher than two. Schemes with 4 and 8 antennas with code  rate one only exist in the case of binary transmission. If orthogonality is essential   fully loaded systems with significant interference levels , a code with R < 1 should  be employed.  The current description focuses on a nonorthogonal scheme with M = 4 trans- mit antennas  STBC4  [Marques da Silva et al. 2009], presenting a code rate one.      MIMO Techniques and Applications  ◾  15  The symbol construction for the STBC with four antennas can be generally   written as [Marques da Silva et al. 2009]  ]  [ , 1 4 l  s  =  ]  [ , 3 4 s l [ , 1 2 s l  ] *       ]  [ , 1 2 s l [ , 3 4 − s l  ] *         3 4,[  1 2,[ ] is the same as sl  where sl and 2 by 4, as well as by replacing 2l by 4l  e.g., a 2  ]  see Equation 1.5 , by replacing the subscripts 1 by 3   −→ l 4  a  3   .  l  − 1  Similar to Equations 1.4 and 1.5, and considering the STBC with four transmit  antennas as in Equation 1.8, the time-domain blocks to be transmitted by the mth  m   , which can be expressed in the matrix–vector  antenna  m = 1, 2, 3, or 4  are sl representation as  ]  [ 1 4 , sl  =  l  −  2  a 4 l − a a * 4 l − a          3  − * 4  − 1  4  l  a a a a  l  −  2  l  −  3  4 * 4 * 4  l  4  l  − 1  a − 4 1 l − ll a * 4 − a * 4 a  −  4  l  l  2  −  3  l  a 4 a * l 4 − a − a  − 1 * 4  l  −  2  4  l  −  3             Note that in Equation 1.9, different rows of the matrix refer to different trans-  mit antennas and different columns refer to different symbol periods.  y  l  The lth frequency-domain block, before the receiver’s equalization process, is  { } = Y Let us define  , with Yl as defined by Equation 1.3.  IDFT  l   cid:31  [ , ]1 4 A l  =    cid:31  A 4  l  −  3   cid:31  A 4  l  −  2   cid:31  A 4  l  − 1   cid:31  A 4  l  T       [ , ] 1 4 y l  =  [ , ] 3 4 y l [ , ] 1 2 y l      − [ , ]* 1 2 y l [ , ]* 3 4 y l         [ , ] 1 4  hl  =    *      1 l  H      2 l  H      3 l  H  *      4 l  H  T       [ , ]3 4  as defined for yl  with yl as by replacing 2l by 4l  e.g., Y  −→ l 4  Y   .  3  2  l  − 1  [ , ]1 2  by replacing the subscripts 1 by 3 and 2 by 4, as well   The postprocessing STBC for four antennas  M = 4  becomes   cid:31 A  [ , ] 1 4 l  =  [ , ] 1 4 Y l  ×  H  [ , ] 1 4 l     × β      1.8    1.9    1.10    1.11    1.12    1.13                         16  ◾  MIMO Processing for 4G and Beyond  Finally, the decoded symbols become [Marques da Silva and Dinis 2011]   cid:31  A 4  l  −  j  =  Desired Symbol   cid:30   cid:29  cid:28  cid:28  M ∑  A 4  −  j  l   cid:27  cid:28  cid:28  2      m l  H  m  = 1  Residuall Interference   cid:30   cid:29  cid:28   cid:27  cid:28   cid:26  eq −N l C A 4 j 4  +  ⋅  −  p  Noise Component  l  −   1.14      with j = 0,1,2,3, and p = 3 − j. We also define  2  Re  {  C  =  *      1 l      4 H H l =∑ M  m  1  −   m l  H      2 l 2  H H    *      3 l  }      1.15         which stands for the residual interference coefficient generated in the STBC decod- ing process of order four.  The signal processing for nonorthogonal scheme with eight transmit antennas is   defined in [Marques da Silva et al. 2009] and in the references therein.  It is worth noting that although the described STBC scheme is a MISO, by   adopting receive diversity, this can be viewed as a MIMO system.  1.2.2  Selective Transmit Diversity The STD is a closed-loop TD, where the transmitter selects one out of multiple  transmit antennas to send data, based on the one that presents a more beneficial  propagation environment.  Assuming the downlink direction, the STD scheme comprises a low-rate feed- back link from the receiver  MS  telling the transmitter  BS , which antenna should  be used in transmission. It is worth noting that by adopting receive diversity this  can also be viewed as a type of MIMO technique.  As depicted in Figure 1.4, the STD comprises a common or dedicated pilot  sequence, which is also transmitted. Different antennas with specific pilot patterns  codes enable antenna selection. Then, the transmitter has a link quality informa- tion about the M  number of transmit antennas  links. Based on link information,  it transmits a single symbol stream over the best antenna. Then, another decision  process is made. The receiver is supposed to reacquire the carrier phase θk t    after  every  switch  between  antennas.  The  antenna  switch   AS   has  the  capability  to  switch every slot duration.  The decision for the antenna selection of the STD using WCDMA signals com- bined with the Rake receiver should select the signal from the transmit antenna  whose multipath diversity order is higher. In other words, it should select the mth  transmit antenna, experiencing a channel with L multipaths, which maximizes the       MIMO Techniques and Applications  ◾  17  AS  Ant. 1  Pilot sequence  Data sequence  M U X  Spreading  Switch  Ant. M  RF  . . .  RF  Figure 1.4  Scheme of a selective transmit diversity with feedback indication.  quantity max[ be employed in receive diversity.  m lh1  ,  ∑ =l L   2  ].  This process is similar to the selective combiner that can   1.2.3  Multilayer Transmission The goal of the MIMO based on multilayer transmission scheme relies on achiev- ing higher data rates in a given bandwidth, whose increase rate corresponds to the  number of transmit antennas [Foschini 1996, 1998; Nam and Lee 2002].  Currently, MIMO systems are typically employed to improve the spectral effi- ciency. This is achieved by increasing the throughput sent in a certain bandwidth.  A widely employed technique for this purpose relies on the use of multilayer trans- mission, as opposed to space–time coding  which aims to provide a performance  improvement by exploiting diversity .  In multilayer transmission, the number of receive antennas must be equal to  or higher than the number of transmit antennas. The increase of symbol rate is  achieved by “steering” the receive antennas to each one  separately  of the transmit  antennas, in order to receive the corresponding data stream. This can be achieved  through the use of the nulling algorithm. With a sufficient number of receive anten- nas, it is possible to resolve all data streams, as long as the antennas are sufficiently  spaced so as to minimize the correlation [Marques da Silva et al. 2005].  Let us consider the generic scheme of the multilayer MIMO depicted in Figure  1.5. The M × N MIMO scheme is spectral efficient and resistant to fading, where  the BS uses M transmit antennas and the MS uses N receive antenna [Marques  da Silva et al. 2004, 2012]. As long as the antennas are located sufficiently far  apart, the transmitted and received signals from each antenna undergo indepen- dent fading.      18  ◾  MIMO Processing for 4G and Beyond  Input data  Serial-to- parallel  conversion  Multipath environment  Multilayer detector  .  .  .  y1  y2  yN  ˆ x1  ˆ x2  ˆ xM  x1  x2  xM  .  .  .  Figure 1.5  Generic diagram of the M × N multilayer MIMO scheme.  As depicted in Figure 1.6, two different multilayer MIMO schemes can be  considered: scheme 1 and scheme 2 [Marques da Silva et al. 2004]. Scheme 1*  directly  allows  an  increase  of  symbol  rate  whose  increase  rate  corresponds  to  the number of transmit antennas. Scheme 2 allows the exploitation of diversity,  without increasing the data rate. The diversity combining is performed using any  combining algorithm, preferably the MSE-based  mean square error  combining  algorithm. In case of the scheme 2  depicted in Figure 1.6b , antenna switch- ing is performed at a symbol rate, where gray dashed lines represent the signal  path at even symbol periods, in case of two transmit antennas. Output signals  are then properly delayed and combined to provide diversity using a combining  algorithm.  Let us focus on the MIMO based on multilayer transmission, as depicted in  Figure 1.5, where the system is equipped with M transmit and N receive anten- nas   with  N ≥ M .  At  the  transmitter  side,  the  data  stream  is  demultiplexed  into  M  independent  substreams,  and  then  each  substream  is  encoded   modu- lated  and transmitted by M antennas. Each spread data symbol xm is sent to the    a   Data frame  S P  Multi- layer detector  P S  Mod &   Spr  Mod &   Spr  Mod &   Spr  Mod &   Spr   b   Data frame  S P  Antenna  Switching  Multi- layer detector  Antenna  Switching  Ts Delay Ts Delay  Diversity combiner Diversity combiner  P   S  Figure 1.6  Diagram of the 2 × 2 multilayer MIMO alternatives:  a  scheme 1 and   b  scheme 2.  *  Note that, in Figure 1.6, “Mod & Spr” stands for modulator and spreader.      MIMO Techniques and Applications  ◾  19  mth transmit antenna. It is considered that the radiated signals are propagated  through multipath frequency selective fading channels. At the receiver, the detec- tor estimates the transmitted symbols from the received signals at the N receive  antennas.  The low pass equivalent transmitted signals at the M antennas are given by   x t     1  .   .   .   x   M  =  E  S  ⋅  s      1 l  ⋅  h t   T  −  nT S     t      =  E  S  M     ⋅  s    l  ⋅  h t   T  −  nT S         1.16    1.17         where sl refers to the symbol selected from a given constellation  e.g., a QPSK con- stellation  under an appropriate mapping rule, to be transmitted in the lth time  domain block from the mth transmit antenna  with 2 ≤ m ≤ M . Moreover, as in     1   Equation 1.2, TS refers to the symbol interval and hT t  is the pulse waveform. sl   are the data symbols fed to the first and to the Mth transmit antenna. The  and sl baseband equivalent of the N-dimensional received vector  y = [  at  sampling instants is expressed by  2  cid:30   y y 1  yN  ] T  M   y =  L  ∑H x + z  l  l  = 1     ,  ,  θ j  e  , m n    l  δ  −  =  , m n  t    τ    m n l  α       .  where  x  =  [x1  x2  …  xM]T  denotes  the  transmitted  symbol  vector,  with  each  ele- ment having the unit average power, and hl : h1 h2 … hL denotes the N × M  channel  matrix,  whose  elements  hm,n  at  the  nth  row  and  mth  column  are  the  channel gain from the mth transmit antenna to the nth receive antenna, that is, h   L  refers  to  the  number  of  multipaths  of  the      m n l channel and the index l stands for the multipath order. It is considered a discrete  tap-delay-line channel model where the channel from the mth transmit antenna  to the nth receive antenna comprises discrete resolvable paths, expressed through  the channel coefficients. The N × M sets of temporal multipaths corresponding to  paths between the multiple transmit antennas and the receive antennas experience  independent but identical distributed  i.i.d.  Rayleigh fading. The elements of the  N-dimensional noise vector z = [z1, z2, . . ., zN]T are also assumed to be i.i.d. complex  Gaussian random variables with zero mean and variance σ n 2.  Different  types  of  detectors  can  be  employed  in  multilayer  MIMO  systems.  Linear  detectors  include  the  decorrelator  and  the  minimum  mean  square  error   MMSE .  Nevertheless,  the  former  presents  the  disadvantage  of  introducing  noise enhancement. Among the suboptimal detectors, the successive interference       20  ◾  MIMO Processing for 4G and Beyond  cancelation  SIC  or the vertical Bell laboratories layered space–time  V-BLAST   detector are two examples. A detector widely employed in multilayer transmission  scheme is the V-BLAST detector, which typically comprises an SIC, alongside a  decorrelator or an MMSE detector. The maximum likelihood sequence estimator   MLSE  detector is also an option. Nevertheless, since the complexity and process- ing increases exponentially with the increase of the number of antennas, its real  implementation tends to be limited to very specific scenarios.*  Lately, two types of decoders have been investigated: the lattice and the sphere  detector.  These  types  of  detectors  tend  to  achieve  good  performances  with  a  reduced complexity. Different detectors for MIMO systems are dealt with in detail  in Chapter 2.  1.2.4  Space Division Multiple Access The goal of an SDMA scheme relies on improving the capacity  more users per cell ,  while keeping the spectrum allocation unchanged. In other words, the SDMA is a  technique that allows multiple users exploiting spatial diversity as a multiple access  technique, while sharing a common spectrum.  As referred to previously, both SDMA and multilayer transmission belong to  the same group, titled spatial multiplexing. Therefore, the basic concept is com- mon.  Nevertheless,  while  in  multilayer  transmission  an  increase  of  the  symbol  rate is achieved by considering multiple antennas at the transmitter side, using  the  SDMA,  it  is  assumed  that  each  transmitter  has  a  single  antenna,  and  the  multiple  number  of  receive  antennas  allow  steering  the  different  flows  of  data  corresponding to different users. Consequently, it is commonly employed in the  uplink, where the transmitter  UE  has a single antenna, whereas the receiver  BS   has several antennas. Figure 1.7 depicts an SDMA configuration applied to the  uplink. SDMA assumes that the number of antennas at the receiver is equal to  or higher than the number of users who share the same spectrum. With such an  approach, the receiver can decode the signals from each transmitter, while avoid- ing  the  signals  from  the  other  transmitters   interfering  signals .  Similar  to  the  decoding performed in multilayer transmission, this can be achieved through the  use of the nulling algorithm.  In  the  V-BLAST  detector,  the  symbols  from  the  transmit  antenna  with  the  highest SNR are first detected using a linear nulling algorithm such as zero forcing   ZF  or MMSE detector. The detected symbol is regenerated, and the correspond- ing signal portion is subtracted from the received signal vector using an SIC detec- tor. This cancelation process results in a modified received signal vector with fewer  interfering signal components left. This process is repeated until all symbols from  all  transmit  antennas  are  detected.  According  to  the  detection-ordering  scheme   *  Owing to this reason, the MLSE detector is commonly referred to as brute force detector.      MIMO Techniques and Applications  ◾  21  Space division multiple access   SDMA , with M ≥ N  Mobile station 1  Tx1  Tx2  . . .  TxM  Base station  Mobile station 2  Mobile station N  Figure 1.7  Example of SDMA scheme applied to the uplink.  in [Foschini 1996], the detection process is organized so that the symbols from  the transmit antenna with the highest SNR are detected at each detection stage.  Clearly, the processing of SDMA is almost the same as that of the MIMO based  on multilayer transmission. Therefore, the reader should refer to Chapter 2 for a  detailed description of spatial multiplexing detectors.  1.2.5  Beamforming In STBC and spatial multiplexing MIMO schemes, the antenna elements that form  an array are usually widely separated in order to form a TD array with low correla- tion among them. On the other hand, the beamforming is implemented by antenna  array with array elements at the transmitter or receiver being closely located to form  a beam. The beam is generated with the uniform linear antenna array  ULA . The  ULA antenna elements spacing is typically half wavelength. Beamforming is an  effective solution to maximize the SNR, as it steers the transmit  or receive  beam  toward the receive  or transmit  antenna [Marques da Silva et al. 2009]. As a result,  an improved performance or coverage is achieved with beamforming. In the cel- lular environment, this translates in a reduced number of required sites to cover a  given area.  Figure 1.8 depicts a transmitting station sending signals using the beamform- ing, generated with the ULA. As can be seen, the beamforming allows transmit- ting a higher-power signal directed toward the desired station, while minimizing       22  ◾  MIMO Processing for 4G and Beyond  1st mobile station  nth mobile  station  M antenna elements  Wm  Figure 1.8  Simplified diagram of a beamforming transmitter.  the transmitted power toward the other stations. This allows a reduction of the  interference.  The  beamforming  consists  of  M  identical  antenna  elements  with  120   half- power beam width  HPBW  [Schacht et al. 2003]. Each antenna element is con- nected  to  a  complex  weight  w .  An  analogy  can  be  made  with  a  receiving array antenna.  m M  m,1 ≤  The weighted elementary signals are summed together making an output signal   ≤  as follows [Schacht et al. 2003]:  θ   , y t     =  M  ∑  m  = 1   w x t   m  −  m    −    1  sin  θ  d c              where x t  is the signal sent by the first antenna element, d is the distance between  elements, c is the propagation speed, and θ is the direction of arrival  or departure   for the main sector  −60  < θ < 60  . In the frequency domain, the output signal  can be written as  Y f    θ ,     =  w X f e       m  −  j  2  −    π f m 1  sin  θ  d c  M  ∑  m  = 1      1.18    1.19       MIMO Techniques and Applications  ◾  23  which makes the relationship between the output signal and the input signal to be  H f    θ ,     =    θ Y f , X f        =  M  ∑ 2  w em  −  j  m  = 1  −    π f m 1  sin  θ  d c     For narrowband beamforming, f is constant and θ is variable. For the beam to   be directed toward the desired direction θ1, we have  in which, for the case of d = λ 2, Equation 1.21 results in [Schacht et al. 2003]  w m  =  e  j  2  −    π f m 1  θsin 1  d c     w m  =  e  −    π j m 1  sin  θ 1     H f     θ1 = ,  M     In other words, for θ = θ1, H f,θ1  reduces to   1.20    1.21    1.22    1.23               which is the maximum attainable amplitude by beamforming.  1.2.6  Multiuser MIMO The MIMO techniques previously exposed are employed in the concept of single- user  MIMO   SU-MIMO .  This  considers  data  being  transmitted  from  a  single  user to another individual user. An alternative concept is the multiuser MIMO   MU-MIMO , where multiple streams of data are simultaneously allocated to dif- ferent users, using the same frequency bands.  When the aim relies on achieving a performance improvement, an SU-MIMO  is normally employed using an algorithm such as STBC. However, when the aim  relies on achieving higher throughputs using a constrained spectrum, we have two  options: in the downlink, the MU-MIMO is typically the solution; in the uplink,  spatial multiplexing is normally employed  in this case, multilayer transmission .  The  approach  behind  MU-MIMO  is  similar  to  SDMA.  Nevertheless,  while  SDMA  is  typically  employed  in  the  uplink,*  the  MU-MIMO  is  widely  imple- mented in the downlink. This allows sending different data streams into differ- ent UEs. In this case, instead of performing the nulling algorithm at the receiver  side, the nulling algorithm needs to be performed using a preprocessing† approach  at the transmitter side  BS . This is possible because the BS can accommodate a   *  Because the nulling algorithm requires a high number of receive antennas. †  This is commonly referred to as precoding.      24  ◾  MIMO Processing for 4G and Beyond  high number of transmit antennas and the UE can only accommodate a single or  reduced number  lower  of receive antennas. In the downlink of an MU-MIMO  configuration, the number of transmit antennas must be higher than the number  of  multiple  data  streams  that  are  sent  to  multiple  users,  at  the  same  time,  and  occupying  the  same  frequency  bands   the  opposite  of  the  SDMA  approach .  In  this configuration, the nulling algorithm is implemented, at the transmitter side,  using a preprocessing algorithm such as the ZF, MMSE, dirty paper coding, and so  on. Alternatively, instead of implementing the above-described spatial multiplexing  principle, the MU-MIMO can be performed using the beamforming algorithm.  In any case, MU-MIMO requires accurate downlink CSI at the transmitter side.  Obtaining CSI is trivial using TDD mode, being more difficult to be obtained  when FDD is employed. In FDD mode, CSI is normally obtained using a feedback  link.  It is worth noting that users located at the cell edge, served by MU-MIMO, may  experience SNR degradation due to intercell interference, interuser interference,*  additional path loss or due to limited BS transmit power  which results from the use  of precoding . A mechanism that can be implemented to mitigate such limitation  relies on employing a dynamic MIMO system, where MU-MIMO is employed  everywhere  in the case of the downlink , except at the cell edge. In this area, the  BS switches into SU-MIMO  using, e.g., space–time coding , which translates in  an improvement of performance. Alternatively, coordinated multipoint  CoMP †  transmission is known as an effective mechanism that improves the performance  at the cell edge, resulting in a more homogeneous service quality, regardless of the  users’ positions.  1.3  Advanced MIMO Applications The  challenge  facing  the  mobile  telecommunications  industry  today  is  how  to  continually improve the end-user experience, to offer appealing services through a  delivery mechanism that offers improved speed, service attractiveness, and service  interaction. In order to deliver the required services to the users at minimum cost,  the technology should enable better performances, higher throughputs, improved  capacities, and higher spectral efficiencies.  The basic concept of MIMO relies on the transmission of signals through mul- tiple paths, between multiple transmit and multiple receive antennas. Instead of  representing an additional interference level, these multiple paths can be used as an  advantage. While, in MIMO systems, the multiple transmit or the multiple receive  antennas are colocated, advanced cellular network architectures may also achieve   *  Interference among users that share the spectrum and that are separated by the MU-MIMO   spatial multiplexing.  †  Sometimes also referred to as downlink base station cooperation.      MIMO Techniques and Applications  ◾  25  the same level of diversity, but using antennas belonging to different BSs or relay  nodes. Nevertheless, a certain level of synchronization or coordination is normally  required between those stations. These techniques are described in the following  sections.  1.3.1  Base Station Cooperation BS cooperation aims at improving the performance of UEs located at the cells edge,  or to increase the throughput of UEs in an area covered by multiple BSs.  An important requirement of 4G systems is the ability to deliver a homoge- neous service, regardless of the users’ positions [Lee et al. 2012]. Users located at  the cell edge may experience a degradation of the SNR due to intercell interference,  additional path loss, or limited eNode-B* transmit power. In case MU-MIMO is  employed, the power constraint becomes more important† and the SNR degrada- tion of UEs located at the cell edge can be even deeper than in SISO environments.  In these scenarios, BS cooperation plays an important role, as it allows the exploi- tation of additional diversity or the delivery of a high and constant throughput,  regardless of the users’ positions.  BS cooperation stands for the ability to send or receive data from to multiple  adjacent BSs to from UEs. Instead of employing the conventional HHO, with BS  cooperation, independent antenna elements of different BSs are grouped together,  forming a cluster, and the UEs may experience a throughput increase or perfor- mance improvement  i.e., SNR increase .‡ Figure 1.9 shows the downlink BS coop- eration using a cluster of three BSs. The dashed area corresponds to the area where  the UE is able to simultaneously receive signals from three BSs. Using BS coop- eration, adjacent BSs can simultaneously transmit the same data. In this case, a  combining algorithm may be employed at the UE side, such as the maximum ratio  combining  MRC , the MSE-based, or the selective combining. This technique is  employed in macro-diversity, as described in Section 1.3.1.2. Alternatively, some  type of preprocessing may be employed at the BSs side, such that the signals that  reach the UE do not require any type of postprocessing. In this case, this coopera- tion is commonly referred to as coordinated multipoint transmission, as described  in Section 1.3.1.1.  BS  cooperation  can  also  be  employed  in  the  uplink,  being  also  referred  to  as CoMP reception. In this case, traditional receive diversity is employed, using   *  Evolved Node-B  eNode-B  refers to the base station of LTE and 4G systems. This corresponds   to the evolution of the Node-B, considered by UMTS.  †  In  MU-MIMO,  the  power  at  the  transmitter  side   i.e.,  at  the  BS,  in  case  of  downlink   becomes very demanding because the precoding may, instantly, require a high level of power.  Consequently, using precoding, the dynamic range of signals tends to increase.  ‡  A performance improvement can be achieved through the exploitation of additional diversity   using, for example, space–time coding.      26  ◾  MIMO Processing for 4G and Beyond  Cell 2  UE  BS  Cell 1  BS  Cell 3  BS  Figure 1.9  Downlink base station cooperation using a cluster of three BSs.  combining algorithms such as the MRC, or the MSE. Alternatively, independent  parallel streams of data can be sent out by different UE transmit antennas  typi- cally, a different data stream is sent out by each transmit antenna element , while  different  BSs  decode  these  different  streams  using  the  above-described  SDMA  algorithm.  1.3.1.1  Coordinated Multipoint Transmission Using  CoMP  transmission,  independent  antenna  elements  of  different  BSs  are  grouped together, forming a cluster, and the UEs can experience a throughput increase  or performance improvement. A preprocessing is typically employed at the BS side  such that the signals that reach the UE do not require any type of postprocessing.  In case each BS uses the MIMO scheme, the resulting MIMO can be viewed  as a “giant MIMO,” consisting of the combination of the independent antenna ele- ments from different BSs  see Figure 1.10 .  Coordinated multipoint transmission comprises the coordinated transmission  of  signals  from  adjacent  BSs,  and  the  corresponding  reception  from  a  UE.  The  signal received at the UE side consists of the sum of independent signals sent by  different BSs.  CoMP  transmission  is  an  important  technique  that  can  mitigate  intercell  interference, improve the throughput, exploit diversity and, therefore, improve the  spectrum efficiency. Note that CoMP transmission allows a spectrum efficiency  improvement, even at the cell edge. CoMP transmission can be viewed as a special  type of MU-MIMO.      MIMO Techniques and Applications  ◾  27  Tx 2 .BS 1  .  .  Tx 1  Tx M  Tx 1  Tx M  Tx 2 . BS 2  .  .  User  equipment  Figure  1.10  Base  station  cooperation   CoMP  transmission   combined  with  downlink MIMO.  Similar to MU-MIMO, a preprocessing such as beamforming, ZF, MMSE, or  dirty-paper coding [Peel 2003] is typically employed in order to assure that the UE  receives a preprocessed signal coming from multiple BSs. In this case, the UE com- monly employs a low-complexity and regular detector. Alternatively, noncoherent  joint transmission and coordinated scheduling is employed. In this case, CoMP  transmission can be associated with carrier aggregation, activating or deactivating  some carriers in order to optimize the performance. This technique is employed in  LTE-Advanced  3GPP Release 10 .  Similar to MU-MIMO, accurate downlink CSI is required at BSs side, which  consists of an implementation difficulty. In case of TDD, obtaining CSI is trivial,  as the uplink and downlink channels are almost the same. Nevertheless, in case of  FDD, obtaining CSI at the transmitter side is a complex task.  Depending on the way the coordination between different BSs is performed,  and the way CSI is obtained  in FDD mode , two different architectures can be  implemented:   ◾ Centralized architecture: In this architecture, there is a central control unit   CU  that decides the transmission scheme and resources allocation to be  used by different BSs. In this case, the CU is connected to different BSs of  the cluster. Each UE estimates the downlink CSI of the signals received from  each BS. Then, the CSI is sent back to the corresponding BS. At a third stage,  CSI is sent from different BSs of the cluster to the CU through backhaul  links. Based on CSI, the CU decides the transmission scheme and resources  allocation to be used by each BS, and sends this information to different BSs  of the cluster. A major limitation of this architecture relies on the latency,  whose factor may result in performance degradation due to fast CSI varia- tions [Diehm et al. 2010].      28  ◾  MIMO Processing for 4G and Beyond   ◾ Distributed architecture: In this architecture, each BS is associated with a  different CU, and the decision about the transmission scheme and resources  allocation is performed independently at the BS level. This information is  then exchanged among the cluster’s BSs. In this case, each UE estimates the  downlink CSI to different BSs and sends this joint data back not only to  the BS of reference, but to all BSs. This way the CU associated with each  BS has information about different downlink CSI and makes the decision  accordingly. An advantage of this architecture relies on the fact that latency  is much reduced, and there is no need to use backhaul links for the purpose  of exchanging CSI. Nevertheless, this architecture is more subject to errors  caused by the uplink transmission [Papadogiannis et al. 2009].  It is finally worth noting that the use of CoMP transmission requires perform- ing a cost–benefit analysis, as CoMP allows a performance network improvement  at the cost of a larger amount of overhead on the over-the-air feedback links and in  the backhaul links used to interconnect different BSs.  1.3.1.2  Macro-Diversity Macro-diversity refers to the transmission of the same information by different BSs  to the UEs in the downlink. Therefore, this can be viewed as a particular type of  downlink BS cooperation. Macro-diversity aims at supplying additional diversity*  in  situations  where  the  terminal  is  far  from  the  BSs.  This  allows  compensating  the path loss affecting the transmission to a UE located at the edge of the cell.  Consequently, this allows a reduction of the amount of transmit power required  to  reach  a  distant  receiver,  thus  increasing  network  capacity.  Therefore,  macro- diversity can be viewed as a special type of BS cooperation.  There are two types of networks to be considered: the multifrequency networks   MFNs  and the SFNs. The BSs to which a terminal is linked to are referred to as  the active sets.  In broadcast, the global channel impulse response  CIR  tends to be longer due  to the longer distances between the transmitter  BS  and the farer of the different  receivers  UEs . If the cyclic extension is long enough, the global CIR will be the  sum of the independent CIRs. This can be seen from Figure 1.11. This enables the  SFN concept exploiting the macro-diversity effect.  Macro-diversity  is  used  during  soft  handover  to  ensure  smooth  transitions  between two cells or two sectors of the same cell, increasing the multipath diversity  and reducing the risk of call drop.  Using  the  same  transmitting  frequencies   from  different  BSs ,  diversity  is  exploited and deep fading tends to be avoided. In case the channel profile between  each of the two BSs and the UE is single path, the resulting signal is viewed as   *  Since it provides transmit diversity, macro-diversity can be viewed as a MISO system.      MIMO Techniques and Applications  ◾  29  Transmitter 1  Transmitter 2   a    b    c   Transmitter 1 + 2  t  t  t  CP length  Figure  1.11  Global  CIR   c   is  composed  of  the  sum  of  the  CIR  of  the  several  transmitters  a + b .  a  two-path  channel  profile,  and  diversity  is  exploited.  Nevertheless,  since  a  sin- gle receiver is employed, although diversity is exploited, the frequency selectivity  increases.  In  fact,  this  effect  can  be  viewed  as  one  signal  received  from  one  BS  interfered  by  the  signal  received  from  another  BS.  Nevertheless,  this  additional  frequency selectivity is mitigated because OFDM signals make use of equalizers at  subcarrier level, as long as the appropriate cyclic prefix is employed. Consequently,  the macro-diversity presents overall benefits in terms of diversity.  The  performance  gain  brought  by  macro-diversity  depends  on  the  diversity  order of the channel. A two-path channel benefits more from macro-diversity than  a six-path channel, because the latter already exhibits a high multipath diversity  order. Since MBMS in SFN mode is simultaneously broadcasted in several cells,  macro-diversity for MBMS in SFN mode does not consume network resources.  In the case of MFN, the UE is required to estimate the carrier of each BS it is  linked to. This increases its power consumption. In this case, the signals received  from different BSs  especially far ones  may be significantly delayed with regard to  those received from near BSs. This requires extramemory at the terminal in order  to store the received signals for further combining. Alternatively, an additional syn- chronization procedure between the BS transmitters is required. In the downlink,  the combining takes place at the UE, which has to demodulate and then combine       30  ◾  MIMO Processing for 4G and Beyond  the signals received from the different BSs. The extracomplexity added by macro- diversity then depends on the receiver type. In the case of an equalizer, the UE has  to equalize the channel for each BS the UE is linked to. Moreover, the UE must  estimate one transmission channel per BS.  In  the  special  case  of  OFDM,  two  main  cases  for  macro-diversity  can  be   distinguished:     1. BSs are synchronized, at least to allow UE’s receiving signals from two or   more BSs with a time difference smaller than the cyclic prefix.    2. BSs are not synchronized.  In the first case, the BSs can transmit identical signals to the UEs on the same  time–frequency  resource.  This  is  possible  because  the  signals  will  superimpose  within the cyclic prefix. In this situation, no ISI occurs as long as the sum of the  time differences plus the maximum delay of the CIR is shorter than the cyclic pre- fix. Therefore, the terminal can employ a single receiver to demodulate the super- imposed signals. This means that it will perform a unique DFT. In this scenario,  macro-diversity  behaves  just  like  TD   from  a  unique  transmitter  with  multiple  spaced antennas . When different BSs transmit the same data over the same sub- carriers, the resulting propagation channel is equivalent to the allegorical sum of all  propagation channels, which increases the diversity gain  deep fading is avoided .  When BSs send the same data over different subcarriers  MFN , the maximum  diversity can be achieved since each data symbol benefits from the summation of  the propagation channel powers  i.e., frequency diversity .  If the BSs are not synchronized, the terminal will need separated receiver chains  to demodulate the signals from the distinct BSs. Moreover, to avoid interference,  orthogonal time–frequency resources have to be allocated to different BSs. This is  still very complex to fulfill; thus, in the general case, interference will occur and  spectral efficiency will decrease.  Fast cell selection is one option for macro-diversity in unicast mode  selective  diversity . Intra-BS selection should be able to operate on a subframe basis. An alter- native to intra-BS macro-diversity scheme for unicast consists of a simultaneous  multicell transmission with softcombining. The basic idea of multicell transmission  is that, instead of avoiding interference at the cell border by means of intercell inter- ference coordination, both cells are used for the transmission of the same informa- tion to a UE, thus, reducing intercell interference as well as improving the overall  available  transmit  power.  Another  possibility  of  intra-BS  multicell  transmission  relies on the exploitation of diversity between the cells with space–time processing   i.e.,  by  employing  STBC  through  two  cells .  Assuming  BS-controlled  schedul- ing and that fast tight coordination between different BS is not feasible, multicell  transmission should be limited to cells belonging to the same BS. For multicell  broadcast, soft combining of radio links should be supported, assuming a sufficient  degree of inter-BS synchronization, at least between a subset of BSs.      MIMO Techniques and Applications  ◾  31  1.3.2  Multihop Relay One important key to improve the coverage and capacity for high-quality multi- media broadcast and multicast transmissions in mobile networks is to provide a  homogeneous service, regardless of the users’ positions, that is, to allow high data  rates for UEs even at the cell edge. Moreover, the distribution of UEs inside the  cell can be heterogeneous. Multihop relay is a technique that can be employed to  overcome these impairments.  UEs at the cell edge suffer from high propagation loss and high intercell interfer- ence from neighbor cells. Other UEs reside in areas that suffer from strong shadowing  effects or require indoor coverage from outdoor BS. These impairments originate a  degradation of the SNR, which translates in a reduced service quality. Thus, the over- all goal of multihop relay is to bring more power to the cell edge and into shadowed  areas, while inducing minimal additional interference for neighbor cells. Moreover,  increased cell capacity tends also to be achieved by using multihop relay. In addition,  multihop relay may also represent an increased life cycle of UEs’ batteries.  There are several mechanisms that can be used to implement multihop relays  [Sydir and Taori 2009]. As defined in the following, one technique employed in  multihop relay consists of using TDD [Stencel et al. 2010], where the communica- tion between the BS and the relay node  RN  is performed in a time slot different  from the one utilized for the communication between the RN and the UE. On the  contrary, [Schoene et al. 2008] proposed the use of multihop relay associated with  FDD.  The next sections describe the most important methods utilized in multihop   relay.  1.3.2.1  Adaptive Relaying As previously described, UEs at the cell edge suffer from high propagation loss  and high intercell interference from the neighbor cells. Other UEs reside in areas  that suffer from strong shadowing effects. The obvious solution for this would be  to decrease cell sizes by installing additional BSs, which represents an increase of  network infrastructure costs. Contrarily, adaptive relay nodes can provide tempo- rary network deployment, avoiding outage of service in the area, while keeping the  investment cost at an acceptable level. The positioning of relay nodes is selected in a  manner that an improvement of service quality or cell coverage is achieved.  In opposition to conventional repeaters working with the amplify-and-forward  strategy,  adaptive  relays  are  understood  to  work  in  a  decode-and-forward  style.  By performing this, relays amplify and retransmit only the wanted component of  the signal they receive and suppress the unwanted portions  i.e., regeneration is  performed .  The  disadvantage  of  an  adaptive  relay,  compared  to  a  conventional  repeater,  relies  on  the  additional  delay  introduced  into  the  transmission  path  between BS and UE. Moreover, depending on the algorithm, a signaling overhead       32  ◾  MIMO Processing for 4G and Beyond  RS  UE 1  RS  BS  RS  UE 2  Figure 1.12  Two-hop relaying architecture.  may also be required. The gain is based on the fact that the transmission path is  split up into smaller areas representing a reduction of the propagation loss.  Fixed relay stations positioned at a specified distance from the BS  see Figure  1.12  tend to increase the probability that a UE receives enough power from the  BS. This deployment concept sectorizes the cell in an inner region where the UEs   e.g., UE 1 in the figure  receive signals from the BS plus some relay stations, and an  outer region where only signals from relay stations are strong enough to be received  by the UE  e.g., UE 2 in the figure .  1.3.2.2  Configurable Virtual Cell Sizes Configurable virtual cell sizes were proposed in [Kudoh and Adachi 2003], consist- ing of a wireless multihop virtual cellular network. This configuration includes the  following components:   ◾ Central port: this corresponds to a BS acting as a gateway to the core network.  ◾ Wireless ports: these correspond to relay stations that may or may not com-  municate with the UEs, and relay the signals from and to the central port.  The wireless  ports  that are  communicating directly  with the  UEs are  called  end wireless ports. The wireless ports are stationary and can act together with the  central port as one virtual BS. The central port and the end wireless ports introduce  additional diversity into the cell, such that the transmit power can be reduced. This  also results in a reduced interference level for other virtual cells. The differences  between conventional cellular networks and virtual cellular networks can be seen  from Figures 1.13 and 1.14.  From the perspective of MBMS, configurable virtual cell sizes could be employed  to adapt the cell size to the user distribution and service demands. Service needs  may present spatial and temporal variations.      MIMO Techniques and Applications  ◾  33  Network  Network Network  Figure 1.13  Conventional cellular network.  Figure 1.14  Virtual cellular network.  1.3.2.3  Multihop Relay in 3GPP Relay nodes were introduced in 3GPP release 9 [3GPP 2010a] as a special type of  eNB* that is not directly connected to the core network. An RN receives data that  was forwarded by an eNB† that is connected to the evolved packet core‡  EPC .   *  eNB stands for evolved Node-B  eNode-B , that is, a Node-B employed in LTE. Note that a   Node-B is a BS in the UMTS environment. †  This eNB is acting as Donor eNB  DeNB . ‡  Evolved packet core corresponds to the core of the LTE  all-IP  network.      34  ◾  MIMO Processing for 4G and Beyond  1  S  S1  EPC  X2  UE  UE  DeNB  DeNB-RN  Area without  coverage  UE  RN  UE  eNB  UE  UE  Figure 1.15  Example of relay node in E-UTRAN.  Upon receiving such data, the RN sends it to the UEs that are under its area of cov- erage. This technique can be seen from Figure 1.15. This is a very interesting option  for operators because, compared to eNB, RNs present structures less expensive to  deploy and to maintain. They can provide temporary network deployment and new  services in an area  e.g., when a sporadic event that concentrates a lot of people in  the same geographical area, such as a summer festival . The use of an RN allows  a fast-deploying and inexpensive way to solve the problem, and can also provide  coverage in small areas not covered by eNBs.  In  [3GPP  2010b],  four  relay  architectures  are  proposed  and  studied.  Those  architectures  differ  from  each  other  in  terms  of  the  expected  behavior  of  the  RN DeNB and how the data are sent within the EPC until it reaches the UE.  That study concludes that an architecture where an RN acts as a proxy for S1  X2 has the most overall benefits, having been incorporated in 3GPP release 10   LTE-Advanced .  The detailed RN architecture chosen for LTE-Advanced can be seen from Figure   1.16. In this architecture, we can see that the RN plays two roles simultaneously:   ◾ From the network point of view  particularly for the DeNB , the RN acts as   an ordinary UE  denoted as Relay-UE .   ◾ From the UE point of view, the RN acts as a normal eNB.  This way the network can abstract itself from establishing a point-to-point con- nection with each and every UE. In fact, it only has to establish a connection with  the RN as it would normally perform with an ordinary UE, and then forward all  data that were destined to UEs to the RN  see Figure 1.15 . Then, the RN, on its  own, will forward all the data received from the network to the respective UEs.  The process of relaying is completely transparent, that is, a UE always assumes to       MIMO Techniques and Applications  ◾  35  Relay-UE’s  MME  S1-MME  relay   S11  relay   Relay network elements UE network elements UE S1 path  E-UTRA  Uu  UE   Relay  eNB UE  E-UTRA  Un  relay   Donor- eNB  function  S1-U  relay   Relay-UE’s S-GW  P-GW  User-UE  Relay-GW  optional   S1-U  UE   User-UE’s S-GW  P-GW  IP  1 1 S   U E    S1-MME   UE   User-UE’s  MME  Figure 1.16  Relay architecture chosen for LTE-Advanced.  Adapted from 3GPP,  Evolved  Universal  Terrestrial  Radio  Access   E-UTRA ;  Relay  architectures  for  E-UTRA  LTE-Advanced , TR 36.806 V9.0.0, May 2010b.   be connected to an eNB because RNs are viewed as eNB from the UE side, and  as a consequence, no changes to the communication protocol or interfaces used by  UEs have to be made.  In the context of multiresolution for Evolved-MBMS  E-MBMS ,* the use of  relaying  fits  perfectly.  With  the  introduction  of  RN  in  E-MBMS,  we  can  have  different zones with different grades of service. Let us consider again the example  depicted in Figure 1.15. In areas covered by eNBs, UEs are expected to have high  signal-to-interference plus noise ratio  SINR  when they are closer to the center of  the cell, reducing as the UEs approach the cell edges. If a hierarchical 64-QAM  modulation with coding rate 3 4 is being employed, UEs at the cell edge will expe- rience low levels of QoS or even service outage due to low SINR. If an RN is strate- gically positioned at the cell edge of existing eNBs, we can expect that area to have  an improved coverage and the RN can adapt its transmitting conditions to provide  a different resolution of the service in the area.† With such approach, the use of RNs  means that, in E-UTRAN, when providing E-MBMS, UEs will experience higher  coverage and different service resolutions for the same E-MBMS contents depend- ing on their location and their receiving conditions.  *  Evolved-MBMS  E-MBMS  framework constitutes the evolutionary successor of MBMS, and  is  envisaged  to  play  an  essential  role  for  the  LTE-A  proliferation  in  mobile  environments.  E-MBMS was initially introduced in 3GPP release 8  LTE , with further improvements to be  implemented in LTE-A. The basic role of these techniques mechanisms relies on the power  and  resources  optimization  during  MBMS  transmissions.  The  objective  of  E-MBMS  is  to  provide services with different QoS requirements depending on the channel conditions expe- rienced by different users.  †  Instead of transmitting video with high frame rate and low resolution, we can half the frame   rate and transmit with higher resolution.      36  ◾  MIMO Processing for 4G and Beyond  According to [3GPP 2010a], RNs can operate in two different modes:   ◾ Inband mode: the link between DeNB and the RN uses the same carrier   frequency as the link between RN-UE and eNB-UE.   ◾ Outband mode: the link between DeNB and the RN uses a different carrier   frequency than that of the RN-UE link.  It is worth noting that the transmit power of RNs is lower than that of eNBs.  The objective is to diminish intercell interference caused by the introduction of  RNs operating in the same band and carrier frequency as eNBs  inband mode , and  to limit the area of coverage of a given RN  since RNs are used to cover small areas  that cannot be properly covered by existing eNBs .  In order to reduce intercell interference, RNs can also be employed in E-MBMS  subframes to create “transmission gaps.” These transmissions gaps are illustrated in  Figure 1.17. As can be seen, in the first instance where Time = t, the DeNB transmits  a segment of data labeled “Data 1” to all the UE inside its area of coverage and also  to the RN. At this instance, the RN stores “Data 1” in memory and is not transmit- ting any data to the users inside its area of coverage, thus not creating any intercell  interference. At the next instance Time = t + 1, a second set of data labeled “Data 2”  is transmitted from DeNB to all the UEs within its area of coverage. On its turn,  the RN is not receiving “Data 2” but, instead, is transmitting to the UEs within   UE  UE  DeNB  Time = t  Data 1 DeNB-to-UE and DeNB-to-RN transmission  DeNB  RN  Ctrl  Ctrl  Data 1  Ctrl  Ctrl  “Transmission gap” One subframe  UE  UE  Time = t + 1  UE  UE  DeNB  RN area of coverage DeNB area of coverage  UE  Data 1 DeNB-to-UE and DeNB-to-RN transmission  DeNB  Ctrl  Data 1  RN  Ctrl  “Transmission gap” One subframe  UE  Ctrl  Ctrl  Data 2  Data 1  Time  Time  UE  RN  UE  RN  Figure 1.17  Example of transmission gaps in E-MBMS.      MIMO Techniques and Applications  ◾  37  its area of coverage the “Data 1” that was stored in memory at Time = t, generating  intercell interference.  As a result of this intercell interference pattern produced by RNs, the total inter- cell interference is greatly reduced  RNs are only causing interference half of the total  transmission times  with a trade-off between throughput and intercell interference.  1.3.3  Multiresolution Transmission Schemes For MBMS services, it makes sense to have two or more classes of bits with dif- ferent error protection, to which different streams of information can be mapped.  Depending on the propagation conditions, a given user can attempt to demodulate  only the more protected bits or also the other bits that carry the additional informa- tion. By using nonuniformly spaced signal points in hierarchical modulations, it is  possible to modify the different error protection levels [Vitthaladevuni and Alouini  2001, 2004].  Multiresolution techniques are interesting for applications where the data being  transmitted are scalable, that is, it can be split into classes of different importance.  For  example,  in  the  case  of  video  transmission,  the  data  from  the  video  source  encoders  may  not  be  equally  important.  The  same  happens  in  the  transmission  of coded voice. The introduction of multiresolution in a broadcast cellular system  deals with source coding and transmission of output data streams. In a broadcast  cellular system, there is a heterogeneous network with different terminal capabili- ties and connection speeds. For the particular case of video, scalable video consists  of a common strategy presented in the literature that adapts its content within a  heterogeneous communications environment [Li 2001; Liu et al. 2003; Vetro et al.  2003; Dogan et al. 2004; Holma 2007].  Scalable  video,  depicted  in  Figure  1.18,  provides  a  base  layer  for  minimum  requirements, and one or more enhancement layers to offer improved quality at  increasing bit frame rates and resolutions [Li 2001]. Therefore, this method signifi- cantly decreases the storage costs of the content provider.  Besides being a potential solution for content adaptation, scalable video schemes  may also allow an efficient usage of power resources in MBMS, as suggested in [Cover  1972]. This is depicted in Figure 1.18, where three separate physical resource blocks   PRBs  are provided for one MBMS service  e.g., @384 kbps : one for the base layer,  at 1 3 rate of the total bit rate  128 kbps , and with a power allocation that can cover  the whole cell range  UE3 ; another PRB for the first enhanced layer, also at 1 3 rate of  the total bit rate  but aggregate rate of 256 kbps , with less power allocation than that  of the base layer  UE2 ; and the third PRB for the second enhanced layer transmitted  with small power to be received near the BS  UE1 with aggregate rate of 384 kbps .  The  system  illustrated  in  Figure  1.18  consists  of  three  QoS  regions,  where  the first region receives all the information, whereas the second and third regions  receive the most important data. The QoS regions are associated with the geometry  factor that reflects the distance of the UE from the BS antenna.      38  ◾  MIMO Processing for 4G and Beyond  UE2  UE3  Node B  UE1  Figure 1.18  Scalable video transmission.  Scalable  video  transmission  can  also  be  implemented  using  different  tech- niques. One possibility relies on the use of hierarchical constellations. The system  illustrated in Figure 1.19 consists of 64-QAM hierarchical constellation. Strong  bits blocks are QPSK demodulated, medium bits blocks are 16-QAM demodu- lated, and weak bits blocks are 64-QAM demodulated. Furthermore, hierarchical   QPSK  16-QAM  64-QAM  BS  Figure 1.19  Example of the type of demodulation used inside a cell for a trans- mission of a 64-QAM hierarchical constellation.      MIMO Techniques and Applications  ◾  39  constellations may also be combined with different channel coding rates. This cor- responds to the concept of AMC [Souto et al. 2007].  It is worth noting that the nonuniform QAM constellation concept has already   been incorporated in the DVB Terrestrial  DVB-T  standard.  Another possibility to implement scalable video transmission relies on the use of  spatial multiplexing MIMO technique, where each transmit antenna sends a differ- ent data stream. The first data stream  most powerful  may include the base layer,  whereas the enhancement layer may be sent by a second antenna  less powerful data  stream . Depending on the power and channel conditions, a certain UE may suc- cessfully receive either the two streams or only the base layer.  1.3.4  Energy Efficiency in Wireless Communications The  tremendous  expansion  of  mobile  network  terminals  has  contributed  to  the  increase of the environmental footprint. Currently, more than 4 billion subscribers  are using mobile phones around the world. The operation of both mobile phones  and network infrastructure requires huge quantities of electrical energy, which cur- rently represents up to 50% of the operational costs.  Energy-efficient wireless transmission techniques along with energy-efficient  network architecture and protocols, hardware optimization, and renewable energy  sources contribute to the implementation of the green cell networks concept, as  they allow a reduction in the carbon emission footprint. Summarizing, the carbon  footprint reduction can be achieved through advancements in three main different  dimensions:   ◾ Architecture  and  protocols:  improvements  in  the  transmission  techniques   and network protocols and architectures.   ◾ Components:  more  efficient  hardware  implementation  in  terms  of  energy    ◾ Energy provisioning: including a new strategy based on the generalized use   dependency.  of renewable energy sources.  The architecture and protocols dimension can be implemented in two different   fronts: the network level and the link level.  The network level comprises the dimensioning and adjustment of the network  as a whole such that a reduction of the energy consumption is possible without  radically  compromising  the  network  performance  and  the  spectral  efficiency  [Correia et al. 2010; Ferling et al. 2010]. This is achieved through the implemen- tation of network protocols such as BS cooperation, multihop relay  see Figure  1.20 , MIMO systems, hierarchical cellular structure,* or interference mitigation   *  Using macrocells, microcells, picocells, femtocells, and so on.      40  ◾  MIMO Processing for 4G and Beyond  Fixed relay  Base station  Figure 1.20  Cooperative MIMO system with fixed relay station.  schemes  including precoding . These techniques may support a reduction in the  transmit power by both BSs and UE [Ericsson 2007].  Mobile adhoc networking  MANET  is a concept that allows the implementa- tion of networks without making use of BSs, and therefore, achieving the same  capability  with  less  energy  and  with  less  visual  impact  and  investment.  Energy  efficiency is also achieved by dynamically allowing an adaption of the cellular net- work architecture to traffic load fluctuations. In this case, the network architecture  should be sufficiently dynamic such that it adapts to variations of the number of  UEs, variations of the throughputs required by different UEs, or to various UEs’  geographic densities. Cognitive radio brings flexibility to the network as it consti- tutes a mechanism that allows a dynamic and more efficient use of the spectrum.  This translates in higher throughput per user or higher number of users per cell by  exploiting spectrum opportunities. Cognitive radio constitutes an efficient alter- native to the traditional approach where the networks were dimensioned to peak  traffic scenarios.  The link level front is associated with the individual energy utilization in the  interface between a UE and a BS. This includes synchronization and channel esti- mation  techniques.  Owing  to  multiplexing  of  pilot training  and  data  symbols,  some of the available bandwidth and energy has to be consumed for accomplish- ing the transmission of the pilot symbols. Since the CIR can be very long, espe- cially for block transmission schemes, the required channel estimation overheads  can also be high, namely, for fast-varying scenarios. This translates in a reduction  of the useful bit rate, decreasing the spectral efficiency and increasing the energy  needs. A promising method for overcoming this problem relies on the employ- ment of implicit pilots, also known as pilot embedding or superimposed pilots,       MIMO Techniques and Applications  ◾  41  which are added to the data block, instead of being multiplexed with it [Marques  da Silva and Dinis 2011]. This means that we can significantly increase the pilots’  density, while keeping the system capacity. Note that the MIMO implementation  constitutes a mechanism to improve the spectral efficiency, throughput, or num- ber of users per cell. Nevertheless, it requires additional energy spent in pilots, as  the channel estimation is independently performed for each antenna pair, using  a different pilot stream per transmit antenna. This results in an energy efficiency  degradation of the MIMO relating to the SISO. The implementation of embed- ded pilots allows the MIMO system becoming an energy-efficient technique, as  the energy spent in pilot symbols is very much reduced, and thus the MIMO can  improve the SNR, coverage, or throughput, without additional transmit power  or  even with a power reduction .  From the components’ perspective, the basic concept relies on the development  of signal processing techniques for smart components in order to obtain a reduc- tion of the energy consumption. Moreover, the relationship between the output  power and the consumed power of an equipment or component  e.g., a transmit- ter  should also be maximized. This can be viewed as power efficiency, and can  also be improved by implementing a careful design and advanced signal process- ing. It is known that the energy consumed in a power amplifier  PA  represents  between 50% and 80% of the electrical energy consumed in a BS [Correia et al.  2010].  OFDM  transmission  technique  is  characterized  by  high  peak-to-average  power  ratio   PAPR *  levels,  whose  implementation  requires  a  PA  operating  well  below the saturation point. This results in poor power efficiency. A signal process- ing technique commonly employed to improve the energy efficiency of a PA relies  on decreasing the PAPR through the use of a precoding technique, which reduces  the dynamic range of a block transmission signal. This technique allows a PA opera- tion closer to the saturation threshold, which translates in an energetic efficiency  gain. Another signal processing technique currently in research relies on the imple- mentation of smart cooling.† It is also worth noting that cooling systems tend to  be more demanding in high-power transmitters. Reducing the required transmit  power allows a simpler and less powerful cooling system.  Finally, a new energy provisioning strategy based on the use of renewable energy  sources is another dimension that can be exploited in order to achieve a reduction  of the carbon emission footprint. This includes the implementation of photovol- taic cells and or wind generators in BSs. Moreover, photovoltaic cells can also be  employed in mobile phones or in human clothes to charge it.  *  Such PAPR level increases with the increase of the number of OFDM subcarriers. †  Cooling systems represent up to 30% of the consumed BS energy.      42  ◾  MIMO Processing for 4G and Beyond  Acknowledgment This work was supported by the FCT  Fundação para a Ciência e Tecnologia  via  project PEst-OE EEI LA0008 2013.  References 3GPP, TR 25.214-v5.5.0, Physical layer procedures  FDD , 2003a. 3GPP, TR 25.211-v5.2.0, Physical channels and mapping of transport channels onto physi-  cal channels  FDD , 2003b.  v9.2.0, 2010a.  3GPP, Feasibility study for further advancements for E-UTRA  LTE-Advanced , TR 36.912   3GPP,  Evolved  Universal  Terrestrial  Radio  Access   E-UTRA ;  Relay  architectures  for   E-UTRA  LTE-Advanced , TR 36.806 V9.0.0, May 2010b.  Alamouti, S. M. A simple transmitter diversity scheme for wireless communications, IEEE   Journal on Selected Areas in Communications, 16 8 , 1451–1458, October 1998.  Andrews, J. G., A. Gosh, R. Muhamed, Fundamentals of WiMAX: Understanding Broadband   Wireless Networking, Prentice-Hall, New Jersey, 2007.  Astely, D., E. Dahlman, A. Furuskar, Y. Jading, M. Lindstrom, S. Parkvall, LTE: The evolu- tion of mobile broadband, IEEE Communications Magazine, 47 4 , 44–51, April 2009. Bhat, P., S. Nagata, L. Campoy, I. Berberana, T. Derham, G. Liu, X. Shen, P. Zong, J. Yang,  LTE-advanced: An operator perspective, IEEE Communications Magazine, 50 2 , 104– 114, February 2012.  Correia,  L.,  D.  Zeller,  O.  Blume,  D.  Ferling,  Y.  Jading,  G.  István,  G.  Auer,  L.  Perre,  Challenges and enabling techniques for energy aware mobile radio networks, IEEE  Communications Magazine, 48, 66–72, November 2010.  Cover, T. Broadcast channels, IEEE Transactions on Information Theory, IT-18, 2–14, January   Diehm, F., P. Marsch, G. Fetweeis, The FUTON prototype: Proof of concept of coordi- nated multi-point in conjunction with a novel integrated wireless optical architecture,  Proceedings of IEEE WCNCW’10, Sydney, NSW, pp. 1–4, April 2010.  Dogan, S. et al., Video content adaptation using transcoding for enabling UMA over UMTS,   Proceedings of WIAMIS 2004, Lisbon, Portugal, April 2004.  Eklund, C. et al., IEEE Standard 802.16: A technical overview of the Wireless MAN air  interface  for  broadband  wireless  access,  IEEE  Communications  Magazine,  40 6 ,  98–107, June 2002.  Ericsson,  Sustainable  energy  use  in  mobile  communications, White  paper,  August  2007,   http:  www.ericsson.com, accessed December 23, 2011.  Ferling, D., T. Bohn, D. Zeller, P. Frenger, I. Gódor, Y. Jading, W. Tomaselli, Energy effi- ciency approaches for radio nodes, Proceedings of Future Networks Mobile Summit 2010,  Florence, Italy, June 2010.  Foschini,  G.  J.  Layered  space-time  architecture  for  wireless  communication  in  a  fading  environment when using multiple antennas, Bell Laboratories Technical Journal, 1 2 ,  41–59, Autumn 1996, .  Foschini, G. J., M. J. Gans, On limits of wireless communications in fading environments when   using multiple antennas, Wireless Personal Communications, 6, 315–335, March 1998.  1972.      MIMO Techniques and Applications  ◾  43  Holma, H., A.Toskala, WCDMA for UMTS: HSPA Evolution and LTE, 4th ed., John Wiley   & Sons, New York, 2007.  Hottinen, A., O. Tirkkonen, R. Wichman, Multi-Antenna Transceiver Techniques for 3G and   Beyond, John Wiley & Sons, Chichester, UK, 2003.  IEEE802.16RelayTaskGroup, 2008;http:  www.ieee802.org 16 relay,accessedJanuary3, 2012. IEEE  Standard  802.16-2004,  Air  interface  for  fixed  broadband  wireless  access  systems,   IEEE Standard 802.16e-2005, Amendment to air interface for fixed and mobile broadband  wireless access systems—Physical and medium access control layers for combined fixed  and mobile operations in licensed bands, 2005.  IEEE  Standard  802.16 m-07 002r8,  IEEE802.16m  System  Requirements,  January  2009;   http:  ieee802.org 16 tgm index.html, accessed January 5, 2012.  ITU Paves Way for Next-Generation 4G Mobile Technologies, ITU press release, October   2004.  21, 2010.  ITU-R Recommendation M. 2133—Requirements, evaluation criteria and submission tem-  plates for the development of IMT-Advanced, 2008.  Kudoh,  E.,  F.  Adachi,  Transmit  power  efficiency  of  a  multi-hop  virtual  cellular  system,  Proceedings of IEEE Vehicular Technology Conference, 2003  VTC2003-Fall , Orlando,  USA, 5, 2910–2914, October 6–9, 2003.  Lee, D., H. Seo, B. Clerckx, E. Hardouin, D. Mazzarese, S. Nagata, K. Sayana, Coordinated  multipoint transmission and reception in LTE-Advanced deployment: Scenarios and  operational  challenges,  IEEE  Wireless  Communications  Magazine,  50 2 ,  148–155,  February 2012.  Li, W. Overview of fine granularity scalability in MPEG-4 video standard, IEEE Transactions   Liu, J., B. Li, Y.-Q. Zhang, Adaptive video multicast over the Internet, IEEE Multimedia,   CSVT, 11 3 , 301–317, March 2001.  10 1 , 22–33, January–March 2003.  Marques  da  Silva,  M.  Multimedia  Communications  and  Networking,  1st  ed.,  CRC  Press   Auerbach Publications, Boca Raton, USA, March 2012, ISBN: 9781439874844.  Marques da Silva, M., A. Correia, Space time diversity for the downlink of WCDMA,IEEE— Wireless  Personal  and  Mobile  Communications—WPMC’01,  Aalborg,  Denmark,  September 9–12, 2001.  Marques da Silva, M., A. Correia, Space time block coding for 4 antennas with coding rate  1, IEEE—International Symposium on Spread Spectrum Techniques and Application— ISSSTA, Prague, Czech Republic, September 2–5, 2002a.  Marques da Silva, M., A. Correia, Space time coding schemes for 4 or more antennas, IEEE— International  Symposium  on  Personal  Indoor  and  Mobile  Radio  Communications— PIMRC’02, Lisbon, Portugal, September 16–18, 2002b.  Marques  da  Silva,  M.,  A.  Correia,  Combined  transmitdiversity  and  beamforming  for   WCDMA, IEEE EPMCC’03, Glasgow, Scotland, April 2003.  Marques da Silva, M., A. Correia, J. C. Silva, N. Souto, Joint MIMO and parallel inter- ference cancellation for the HSDPA, Proceedings of IEEE International Symposium on  Spread  Spectrum  Techniques  and  Applications  2004   ISSSTA’04 ,  Sydney,  Australia,  September 2004.  Marques da Silva, M., A. Correia, R. Dinis, On transmission techniques for multi-antenna  W-CDMA  systems,  European Transactions  on Telecommunications,  20 1 ,  107–121,  January 2009.      44  ◾  MIMO Processing for 4G and Beyond  Marques da Silva, M., A. Correia, R. Dinis, N. Souto, J. Silva, Transmission Techniques for  Emergent Multicast and Broadcast Systems, 1st ed., CRC Press Auerbach Publications,  Boca Raton, USA, June 2010, ISBN: 9781439815939.  Marques da Silva, M., A. Correia, R. Dinis, N. Souto, J. Silva, Transmission Techniques for  4G Systems, 1st ed., CRC Press Auerbach Publications, Boca Raton, USA, November  2012, ISBN: 9781466512337.  Marques da Silva, M., R. Dinis, Iterative frequency-domain detection and channel esti- mation  for  space-time  block  codes,  European  Transactions  on  Telecommunications,  22 7 , 339–351, November 2011, doi: 10.1002 ett.1484, http:  dx.doi.org 10.1002  ett.1484.  Marques da Silva, M., R. Dinis, A. Correia, A V-BLAST detector approach for W-CDMA  signals with frequency-selective fading, Proceeding of the 16th IEEE Personal Indoor and  Mobile Radio Communications 2005  PIMRC’05 , Berlin, Germany, September 11–14,  2005.  Nam,  S.  H.,  K.  B.  Lee,  Transmit  Power  Allocation  for  an  Extended  V-BLAST  System,   PIMRC’2002, Lisbon, Portugal, September 2002.  Ohrtman, F. WiMAX Handbook, McGraw-Hill Communications, New York, 2008. Oyman, O., J. N. Laneman, S. Sandhu, Multihop relaying for broadband wireless mesh net- works: From theory to practice, IEEE Communications Magazine, 45 11 , 116–122,  November 2007.  Papadogiannis, A., E. Hardouin, D. Gesbert, Decentralising multicell cooperative process- ing:  A  novel  robust  framework,  EURASIP  Journal  of Wireless  Communications  and  Networking, 2009, 1–10, August 2009.  Peel,  C.  B.  On  “Dirty-Paper  coding”,  IEEE  Signal  Processing  Magazine,  20 3 ,  112–113,   May 2003.  Peters, S. W., R. W. Heath, The future of WiMAX: Multihop relaying with IEEE 802.16j,   IEEE Communications Magazine, 47 1 , 104–111, January 2009.  Rooyen, P. V., M. Lötter, D. Wyk, Space-Time Processing for CDMA Mobile Communications,   Kluwer Academic Publishers, Boston, 2000.  Schacht,  M.,  A.  Dekorsy,  P.  Jung,  Downlink  Beamforming  Concepts  in  UTRA  FDD,   Kleinheubacher Tagung 2002, Kleinheubacher Berichte 2003.  Schoene, R., R. Halfmann, B. H. Walke, An FDD multihop cellular network for 3GPP-  LTE, VTC 2008, pp.1990–1994, May 2008.  Souto,  N.,  R.  Dinis,  J.  C.  Silva,  Iterative  decoding  and  channel  estimation  of  MIMO- OFDM transmissions with hierarchical constellations and implicit pilots, International  Conference on Signal Processing and Communications  ICSPC’07 , Dubai, United Arab  Emirates, November 24–27, 2007.  Stencel, V., A. Muller, P. Frank, LTE advanced—A further evolutionary step for next genera- tion mobile networks, 20th International Conference on Radioelektronika, Brno, Czech  Republic, pp. 19–21, April 2010.  Sydir, J., R.Taori, An evolved cellular system architecture incorporating relay stations, IEEE   Communications Magazine, 47 6 , 150–155, June 2009.  Tarokh,  V.,  H.  Jafarkhani,  A.  R.  Calderbank,  Space-time  block  codes  from  orthogonal   designs, IEEE Transactions on Information Theory, 45 5 , 1456–1467, July 1999.  Telatar, I. E. Capacity of multiantenna Gaussian channels, AT&T Bell Laboratories, Tech.   Telatar, I. E., Capacity of multiantenna Gaussian channels, European Transactions on Communi-  Memo., June 1995.  cations, 10 6 , 585–595, 1999.      MIMO Techniques and Applications  ◾  45  Vetro, A., C. Christopoulos, H. Sun, Video transcoding architectures and techniques: An   overview, IEEE Signal Processing Magazine, 20 2 , 18–29, March 2003.  Vitthaladevuni, P. K., M.-S.Alouini, BER computation of 4 M-QAM hierarchical constella-  tions, IEEE Transactions on Broadcasting, 47 3 , 228–239, September 2001.  Vitthaladevuni, P. K., M.-S.Alouini, A closed-form expression for the exact BER of gener- alized PAM and QAM constellations, IEEE Transactions on Communications, 52 5 ,  698–700, May 2004.  Yarali, A., S. Rahman, WiMAX broadband wireless access technology: Services, architecture  and deployment models, IEEE CCECE2008, Niagara Falls, Ontario, pp. 77–82, May  4–7, 2008.       Chapter 2 MIMO Detection  Methods  Francisco A. Monteiro, Ian J. Wassell,  and Nuno Souto  Contents 2.1  Terminology: Old and New Signal Processing ...........................................48 2.1.1  Diversity Order and Multiplexing Gain ..........................................49 2.1.2  Detection for Space–Time Codes ...................................................51 2.1.3  Detection for Spatial Multiplexing .................................................52 2.2  The Geometry of Lattices ...........................................................................54 2.2.1  Definitions ......................................................................................56 2.2.1.1  Lattice ..............................................................................56 2.2.1.2  Fundamental Region ........................................................58 2.2.1.3  Voronoi Region .................................................................58 2.2.1.4  Gram Matrix ....................................................................59 2.2.1.5  Volume .............................................................................59 2.2.1.6  Unitary, Orthogonal, and Unimodular Matrices ..............60 2.2.1.7  Equivalent Lattices ...........................................................60 2.2.1.8  Geometry of Unimodular Transformations ......................61 2.2.1.9  Shortest Vector and Successive Minima ............................62 2.2.2  Dual Lattice ....................................................................................62 2.3  Communication with Vectors ....................................................................65 2.3.1  System Model .................................................................................65 2.3.2  Real Equivalent Model ...................................................................69 2.3.3  Capacity with Channel State Information at the Receiver ..............70  47   48  ◾  MIMO Processing for 4G and Beyond  2.4  Detection in MIMO Spatial Multiplexing .................................................73 2.4.1  Optimal Detection and Complexity ...............................................75 2.5  Traditional Receivers ..................................................................................76 2.5.1  Linear Receivers ............................................................................. 77 2.5.2  Zero-Forcing Detection ................................................................. 77 2.5.2.1  Geometry of Zero-Forcing Detection ...............................80 2.5.2.2  Algebraic Analysis of ZF ...................................................81 2.5.3  Minimum Mean-Squared Error Detection .....................................82 2.5.3.1  Projection Matrices ...........................................................87  2.5.4  Geometry of Optimally Ordered Successive Interference   Cancellation ...................................................................................89 2.5.4.1  Gram–Schmidt Orthogonalization and QR   Decomposition .................................................................94 2.5.5  Lattice-Reduction-Aided Detection ................................................97 2.5.5.1  Complex Lattice Reduction ............................................100 2.5.6  Randomized Lattice Decoding .....................................................103 2.5.7  Sphere Decoding ..........................................................................105 2.6  Performance Comparison .........................................................................109 Acknowledgments .............................................................................................110 References .........................................................................................................110  2.1  Terminology: Old and New Signal Processing Digital transmission has progressed during the last two decades of the twentieth  century aiming at higher data rates, less bandwidth for a fixed data rate  i.e., higher  spectral efficiency , while spending the least possible amount of energy per bit, given  a certain additive noise. There is, however, a fourth dimension to the problem: the  complexity involved in the “construction” of the transmitted signal  i.e., the com- plexity associated with the modulation and the coding scheme , and the complexity  involved in the detection and decoding of the signal at the receiver. Multiple-input  multiple-output  MIMO  spatial multiplexing  SM  allows unprecedented spectral  efficiencies  at  the  expense  of  high  detection  complexity  due  to  the  fact  that  the  underlying detection problem is equivalent to the closest vector problem  CVP  in a  lattice. Finding better detection algorithms  also referred in the literature as detection  methods or detection techniques  to deal with the problem has been a central topic  since the last decade of research in MIMO SM and yet an efficient technique for the  8 × 8 configuration in LTE-A is not a closed problem [Bai et al. 2012].  This chapter introduces the reader to the most prominent detection techniques  for MIMO, namely, linear filtering-based receivers and nonlinear approaches, such as  ordered  successive  interference  cancellation   OSIC ,  lattice-reduction-aided,  sphere  decoding  SD  concept, among other more recent developments. We believe that the  easiest way to cut through the MIMO detection methods is to understand the underly- ing lattice problem and the type of manipulations that each of these methods executes    MIMO Detection Methods  ◾  49  in the lattice. In addition to a unifying geometric interpretation, the lattice interpreta- tion often offers additional insights. For example, the geometric relation between the  primal and the dual lattice is clarified, leading to a simple interpretation of the optimal  detection order of the layers  i.e., symbols at the receiver antennas  in OSIC.  Typically,  progress  toward  Shannon  capacity  was  achieved  by  means  of  chan- nel coding concatenated with higher-order modulation, eventually at the expense of  higher complexity, mostly at the receiver. Turbo-codes, low-density parity-check codes   LDPCs , and lattice-coded modulation are examples of that path of increasing com- plexity  mostly in detection and decoding . As it will be seen in subsequent chapters,  coding still plays a crucial role in any system.  The rapid rise in the computing power available at the handset now permits rather  complex baseband processing. Over a decade, we have witnessed the core problems  in communication engineering being much less electronics-centric and much more  algorithmic-centric.  Modern  communication  theory  is  now  largely  entwined  with  problems traditionally in the domain of theoretical computer science  e.g., machine  learning, data structures, algorithms, and their complexity , or, more generally, in  applied mathematics  related with matrix algebra, discrete mathematics, integer pro- gramming, or combinatorics . Sometimes the separation is now only barely possible  by looking at the application in mind and not by the nature of the problem itself. More  generally, this can also be said of many of the aspects of information theory and cod- ing theory. The fields of image communication or source coding  compression  always  incorporated a wide variety of fundamental research. What is new is that this fusion  propagated down to the physical layer, once clearly within electrical engineering.  The problem of detection in MIMO SM constitutes a clear example of an algo- rithmic  problem  at  the  physical  layer.  The  problem  is  analogous  to  the  CVP  in  lattices  sometimes also called the nearest vector problem, e.g., [Lenstra 2008] . The  study of the problem began in the realms of theoretic computer science, cryptogra- phy, complexity theory, algorithmic number theory, and in some domains of applied  mathematics. The curious reader may want to delve into details of the field. For  example, a recent detection technique looks at lattices from a group theory perspec- tive [Monteiro and Kschischang 2011]. It is shown that it is possible to approximate  the typical lattices encountered in MIMO by a lattice having a trellis representation.  2.1.1  Diversity Order and Multiplexing Gain From Shannon we know that, in the additive white Gaussian noise  AWGN  chan- nel, a symbol error rate  SER  curve Ps  ρ  is a function of the signal-to-noise ratio   SNR , ρ, and can be as steep as one wants. In the limit, the curve Ps  ρ  can have an  infinite negative slope. For the Rayleigh fading* channel, it is well known that Ps ρ   exhibits a −1 slope in the uncoded single-input single-output  SISO  case, that is,   *  This limiting behavior is only characteristic for the Rayleigh fading assumption. Other fading   statistics lead to different diversity orders.      50  ◾  MIMO Processing for 4G and Beyond  one finds that Ps  ρ  ∝ ρ−1. One door that MIMO opens is the possibility of increas- ing  in modulo  that slope, that is, obtaining a faster reduction of the error rate as  SNR increases. Formally, one defines the diversity order, corresponding to the slope  d  =  lim →∞ SNR  −      log   Ps log   ρ   ρ    .      2.1   This diversity order measures how many statistically independent copies of the  same symbol the receiver is able to separate. In brief, this amounts to the number of  independent fading coefficients that the receiver can average in order to produce a  reliable estimate of a transmitted symbol. Not surprisingly, the maximum available  diversity that can be attained is dmax = NT NR, in the case of uncorrelated fading, as  in the model that will be introduced in Section 2.2.1.  The benefits of vector communication with spatial diversity are not limited to  this increased slope. Think of a SISO setup where one switches from a 4-PAM con- stellation  2 bps Hz  to an 8-PAM constellation, in this case the same error rate can  be obtained by increasing the SNR by 6 dB while 1 more bit s can be transmitted   now 3 bps Hz  using the same bandwidth. If one changes from a 16-QAM  4 bps  Hz  to 64-QAM constellation, the same additional 6 dB are required to achieve  the same SER, though the spectral efficiency is increased by a factor of 2. It is said  that the multiplexing gain of the latter QAM constellation is higher than the one of  PAM. In the MIMO general case, this gain is defined as  g  =  lim →∞ SER  log  log   R    . ρ     2.2   When plotting the symbol error rate  SER  versus the SNR, the existing diver- sity d in the communication link is simply the slope  in the asymptotic regime   of the SER curve. However, the interpretation of the multiplexing gain in a typi- cal SER plot is not so straightforward. The metric  g indicates how the capacity  increases with the SNR, which is a common representation in information theory  since Shannon but is less useful in practice. In terms of the SER, the multiplexing  gain g measures how fast spectral efficiency can increase with the increase of SNR  while keeping the same error rate and corresponds to the maximum number of  independent layers or parallel channels, being limited by  g  max min   =  N NT  ,  R   .      2.3   It was showed in [Zheng and Tse 2003] that there is a trade-off between d and  g, that is, the famous diversity-multiplexing trade-off  DMT : increasing one leads  to a decrease in the other. The only pairs  d, g  that are allowed lie on the following  piecewise-linear function constructed by connecting the points defined by  d k      =     N  R  −  k N     T  −  k   ,  for 0  ≤  k  ≤  g  .max      2.4                   MIMO Detection Methods  ◾  51  One interpretation of this trade-off is that some subset of the antennas provide  for the existence of several layers, while the remaining ones assure the diversity,  but they cannot all be contributing to both objectives. The operational informa- tion conveyed by the DMT curve is very often confusing and misleading in the  literature. The operational meaning of the DMT curve lies in the extremities con- nected by each of the piecewise-linear segments. Each segment defines an operation  “mode” with a pair  d, g  defined by the extremities of the segment, which then  define the maximum value that each of the parameters can assume.  The  practical  relevance  of  the  DMT  has  been  much  criticized  though;  some  argue that it is only valid for the ideal  uncorrelated  Rayleigh channel and only  at an impractically high SNR regime, while authors in the LTE literature rebuke  the usefulness of DMT for ignoring other aspects of the transmission chain, which  bring other sources of diversity, for example, from the frequency domain or from  coding. Indeed, providing a physical interpretation of g in the finite SNR regions is  impossible.  Despite the connection between the two gains, there is a division in system  design  between  either   i   aiming  at  full  diversity  or   ii   aiming  at  maximizing  the multiplexing gain, which in practice has been measured by the spectral effi- ciency gain provided by the transmission over multiple layers. The development  of space–time codes  STC  addresses the first objective, while the SM concept aims  at the latter. Physical layer designers have to opt between STC and SM. Another  attempt to match them under a unified system design was presented in [El-Hajjar  and Hanzo 2010]. A pragmatic approach for switching between them according  to  the  channel  conditions  was  considered  in  [Heath  and  Paulraj  2005].  Which  one is preferable is a question that was thoroughly investigated in [Lozano and  Jindal  2010].  The  authors  have  looked  into  the  problem  of  considering  MIMO  in systems that combine MIMO with interleaving and coding, wideband chan- nelizations with OFDM, link adaptation  adaptive modulation and rate control ,  and automatic repeat request  ARQ . Their work addresses precisely some of the  criticism aimed at the somewhat idealized conditions in which DMT was defined  [Tse and Viswanath 2005]. The conclusion was that with all the diversity available  in  time  and  frequency   including  carrier  aggregation ,  spatial  diversity  becomes  redundant and SM should be the only objective when designing the MIMO aspects  of  the  physical  layer,  especially  when  the  channel  is  wider  than  10 MHz.  Note  that  LTE  release  8  defines  channel  bandwidths  up  to  20 MHz,  LTE-Advanced   i.e., release 10  already defines a bandwidth up to 100 MHz [Parkvall et al. 2011],  and 100 MHz is possible in WiMAX by carrier aggregation [Ahmadi 2009], and  802.11n is defined up to 40 MHz [Perahia and Stacey 2008].  2.1.2  Detection for Space–Time Codes The  celebrated  Alamouti  2 × 1  space–time  code   STC   was  presented  in  1998  [Alamouti 1998]. The scheme achieves the same diversity as the traditional maximum       52  ◾  MIMO Processing for 4G and Beyond  ratio combining  MRC  with two antennas at the transmitter while having only one  antenna at the receiver, and transposing the burden of two antennas to the transmit- ter.* The structure of the Alamouti code permits a very simple decoding method. This  advantage was extended to larger dimensions by Tarokh, Jafarkhani, and Calderbank  [Tarokh  et  al.  1999],  who  discovered  other  orthogonal  space–time  block  codes   OSTBC , which are also easy to decode owing to their structure. Interestingly, the  Alamouti scheme realizes the optimal trade-off for the 2 × 1 configuration; the other  OSTBC do not achieve that optimal diversity-multiplexing trade-off  DMT  [Tse  and Viswanath 2005], nor does the Alamouti 2 × 2 system.  The  computational  complexity  for  their  decoding  was  recently  analyzed  in  depth [Ayanoglu et al. 2011]. Sadly, these constructions for STBCs were shown not  to exist for configurations larger than 4 × 4. They are however instances of linear  dispersion codes which, albeit not necessarily orthogonal, also spread the symbols  in both space and time. The design and study of space–time codes constitutes a  research field of its own [Larsson and Stoica 2003, Jafarkhani 2005, Giannakis  et al. 2007]. Another family of codes, proposed earlier than STBC, is the space– time trellis codes  STTC  [Tarokh et al. 1998], where the symbols emanating from  the antennas not only depend on the new data but also on the state of an encoder   as in convolutional codes .  Lattices have been essential in coding for MIMO just as they had been for the  AWGN channel and afterwards for the SISO flat Rayleigh channel. A fruitful line  of research, mostly lead by Oggier, Viterbo, and Belfiori, uses algebraic number  theory for finding good lattice codes for MIMO [Viterbo and Oggier 2004, Oggier  2005, Oggier et al. 2006]. The 2 × 2 so-called Golden Code, which simultaneously  achieves full diversity 4 and full multiplexing gain equal to 2, was created under  that  framework.  One  other  example  of  STC  with  lattices  was  the  discovery  by  [Gamal et al. 2004] of the so-called lattice space–time  LAST  codes, which real- ize the DMT. These codes are grounded in the Erez and Zamir constructions [Erez  and Zamir 2004]. The optimum detection algorithm for LAST codes was proposed  in [Su et al. 2009].  2.1.3  Detection for Spatial Multiplexing This technique focuses  only on the objective of increasing the data rate, leaving  behind rather than obtaining any spatial diversity in an NT × NR configuration. If  the receiver is able to correctly estimate the channel matrix  although that informa- tion is oblivious to the transmitter , signal processing at the receiver can extract the  mutual interference and decouple min NT, NR  streams of independent data.  *  There is a power penalty though, given that only half of the power is collected with one antenna  at the receiver rather than two. This results in an error probability curve translated by 3 dB  with respect to the MRC performance curve. The extrapolation to a 2 × 2 configuration of the  Alamouti space–time code is straightforward and that loss is recovered.      MIMO Detection Methods  ◾  53  The first spatial technique, proposed by Foschini, as mentioned in Chapter 1,  was D-BLAST  diagonal Bell Labs layered space–time . This technique uses error  correcting  codes  and  “rotates”  over  time  the  distribution  of  the  different  code  streams  the layers  across the antennas. Considering two-dimensional space–time  frames, different layers end up associated with distinct diagonals of a space–time  grid  or frame . This creates spatial diversity besides SM. However, owing to the  detection complexity it incurred it was dropped very early in favor of a much sim- pler approach known as vertical-BLAST  V-BLAST . One other downside with  D-BLAST is that it wastes some space–time resources at the time extremities of a  frame, although one can minimize that effect by appropriately dimensioning the  frames [Goldsmith 2005, Section 10.6]. It should be noted that, despite its imprac- ticability, when the number of antennas approaches infinity, D-BLAST is able to  approach the capacity of the MIMO channel [Tse and Viswanath 2005, Section  8.5]. Interestingly, the V-BLAST architecture is able to approach capacity by rate  adaptation across the different layers, when there is channel state information at the  transmitter  CSIT  [Bölcskei et al. 2006, Chapter 5]  for a practical example, see  [Magarini 2007] . Near capacity MIMO open-loop SM has been achieved using  soft SD  see Section 2.5.7  concatenated with linear codes by means of an inter- leaver [Hochwald and ten Brink 2003].  V-BLAST does not make use of all the spatial diversity that exists in the MIMO  channel as D-BLAST is able to. In the vertical version, there exists a fixed association  between the parallel sub-channels and the antennas at both extremities of the link.  Note that these sub-channels are also frequently called layers, even in uncoded sys- tems, where each layer simply corresponds to the symbols from a particular transmit  antenna. Consequently, the maximum spatial diversity V-BLAST offers is, at most,  NR, and even so, only if maximum likelihood detection  MLD  is used. In the case  of the OSIC detector, the diversity is only NT − NR + 1, that is, only one in the com- mon case of symmetric configurations. This latter fact was conjectured about from  very early on [e.g., Paulraj et al. 2003, p. 158] but has only very recently been proven  [Jiang et al. 2011]  this will be further commented on in Section 2.5.4 .  Unlike the Alamouti  and other OSTBCs , both V- and D-BLAST could be  trivially extended to any number of antennas, as there is no structural constraint  in their design. However, to optimally detect all layers  with an error performance  curve that exhibits all the diversity that these schemes still provide and with no gain  penalty , involves a computational complexity that grows exponentially with the  number of antennas at the receiver.  The predominance of the V-BLAST architecture made it almost synonymous  with SM. Furthermore, as Golden et al. presented a simple receiver based in inter- ference cancellation for V-BLAST [Golden et al. 1999], the name became much  associated with that particular detection technique. The name successive interfer- ence cancellation  SIC  will subsequently be used in this work for the concept that  underlies the detection method first proposed for V-BLAST in [Golden et al. 1999].  The V-BLAST architecture will be simply referred to throughout this work as SM.      54  ◾  MIMO Processing for 4G and Beyond  SM does not require CSIT  since it is an open-loop architecture  and the capacity  grows linearly with min NT, NR . In practice, the number of antennas in some equip- ment is not only limited by the signal processing complexity at the receiver, but also  by the physical dimension the antenna array may have; one should bear in mind that  as the spacing between antennas diminishes, they become increasingly correlated and  the capacity of the system diminishes [e.g., Paulraj et al. 2003, Section 4.6.1].  The  major  limitation  in  SM  is  the  large  algorithmic  complexity  involved  in  the optimum detection applying the MLD principle to achieve optimum detec- tion. MLD captures the spatial diversity of the architecture while removing all the  mutual interference between layers.  In the last decade, there was a burst of research on this problem: how to detect  the received vector with a performance as close as possible to the optimal yet having a  reduced complexity compared with MLD? The most abstract and general description  of this problem is the CVP in a lattice, the applications of which go far beyond the  MIMO detection problem in SM. The detection of some STC is also a CVP in a lat- tice after vectorizing the space–time matrix code words [Viterbo and Oggier 2004]. Other communication problems such as inter-symbol interference  ISI  chan- nels [Mow 1991] and multi-user detection  MUD  [Verdú 1998] are formally the  same, and may be encapsulated as a general equalization problem  as proposed in  [Zhang et al. 2009]  that can be mapped as a CVP. Table 2.1 lists some terminol- ogy that is used in these different frameworks.  2.2  The Geometry of Lattices The regularity of a lattice lends itself for the representation of problems where sig- nals are interpreted as a point in a multidimensional space defined in some basis.  One of the most important lattice problems is the CVP [Agrell et al. 2002], which  consists in finding the point that is the one at the shortest distance from a given  off-lattice target point.  The study of lattices began in the 1890s with Minkowski who created the then  new  field  of  geometry  of  numbers  [Nguyen  and  Micciancio  2005,  Cassels  1971].  Lattices are related with problems in the integer domain, such as continued frac- tions, simultaneous Diophantine equations  systems of questions where one is solely  interested in integer solutions  [Schrijver 1986]; simultaneous Diophantine approx- imation [Lovász 1986, Lenstra 2008],  finding the closest rational numbers to a  set of real numbers with the restriction that they all have the same denominator ,  and several other fundamental problems in number theory [Lenstra 2008, Kannan  1987],  and  in  integer  programming  [Schrijver  1986,  Bertsimas  and  Weismantel  2005]. These problems can usually be reduced to the CVP or to the shortest vector  problem  SVP  in a lattice [Micciancio and Goldwasser 2002].  In the last three decades, one could have found applications of lattices in vec- tor quantization and image coding [Dubois 1985, Zamir 1996, Agrell and Eriksson       MIMO Detection Methods  ◾  55  Table 2.1  Different Names of Analogous Techniques  MIMO   	 Zero-forcing  ZF   	 Channel inversion  	 Decorrelation  Equalization for   ISI Channels  Multi-User   Communication  Zero-forcing  ZF   equalization  Decorrelation  MMSE  MMSE filtering  Inversion   linear   Minimum  mean squared  error  MMSE   Interference  cancellation   	 Nulling and   cancelling  	 Successive   interference  cancellation  SIC   	 V-BLAST detection  Decision  feedback  equalization   DFE   Optimum  detection   	 Maximum likelihood   detection  MLD   	 Exhaustive search  Maximum  likelihood  sequence  detection  MLSD   Precoding   	 Multiuser-MIMO  	 Broadcast channel    	 ISI Precoding  	 Costas   Dirty paper  coding  DPC    BC   MMSE  detection   	 Iterative   multi-user  detection   MUD    	 Successive   interference  cancellation   SIC    	 ML detection  	 Brute force  	 SD  near  optimum   Parallel  sub-channels   	 Closed-loop   SU-MIMO  Not defined  precoding  	 Tomlinson– Harashima  precoding   THP    	 OFDM  	 Multi-tone  modulation  	 Filter bank  multicarrier   	 SVD and water filling  	 Communication  over eigen-modes  	 Eigen-beam spatial   division multiplexing   	 Precoding  	 Beamforming      56  ◾  MIMO Processing for 4G and Beyond  1998], and the application of lattices in SISO communications has a long history in  coding for the bandwidth-limited AWGN channel [Forney 1988] and in SISO fading  channels [Boutros et al. 1996]. Despite that, it was only during the boom of research  in MIMO in the last decade that lattices started to be thoroughly investigated in  relation to communication problems as they are the mathematical object underly- ing problems such as the broadcast channel [Taherzadeh et al. 2007], the design of  STCs [Viterbo and Oggier 2004], and, of course, the CVP in SM detection [Larsson  2009]. Interestingly, these MIMO communication problems triggered a series of re- discoveries and novel uses of ideas previously studied in algorithmic number the- ory. Examples of this are  i  the V-BLAST detection as proposed in [Wolniansky  et al. 1998], which turns out to be the Babai nearest plane algorithm [Mow 2003,  Galbraith 2013];  ii  SD was already used in SISO [Viterbo and Boutros 1999] but  improved ways for traversing a tree were rediscovered in [Agrell et al. 2002] making  use of the much earlier findings of [Fincke and Pohst 1985] and by [Schnorr and  Euchner 1994] in number theory;  iii  the use of lattice reduction techniques such as  the Lenstra–Lenstra–Lovász  LLL or L3  algorithm or Seysen’s reduction remained  unknown to the communications community until 2002 [Yao and Wornell 2002]  and 2007, respectively  the advantages of Seysen’s reduction for MIMO were simul- taneously indicated by [Seethaler et al. 2007] and [Niu and Lu 2007] . However, in  2007 the 25th anniversary of the LLL algorithm was celebrated by the algorithmic  number theory community with a special event and the publication of a book listing  its profound implications in many problems [Nguyen and Vallée 2010].  Now that communication theory is evolving from point-to-point transmission  problems  to  network  coding  ideas,  lattices  remain  an  essential  tool  [Feng  et  al.  2010, Nazer and Gastpar 2011].  Although lattices are simple to define mathematically, and have an apparent geo- metrical simplicity, they are, as already mentioned, closely related to many of the  most difficult algorithmic problems with NP-hard complexity. As a natural conse- quence, lattice problems also assumed a central role in cryptography in the last decade  [Micciancio and Goldwasser 2002, Micciancio and Regev 2009, Galbraith 2013],  given the complexity of the algorithms and the difficulty they pose to an attacker who  does not possess a trapdoor to solve the problem  such as a “good” basis for the lattice .  2.2.1  Definitions 2.2.1.1  Lattice There are several ways of specifying a lattice* Λ. The most common method involves  a set of linearly independent generator vectors hi [Nguyen and Micciancio 2005],   *  The term lattice has two meanings in mathematics. The same name appears in order theory   in discrete mathematics and abstract algebra  [Anderson 2003, Lidl and Pilz 2010], a subject  totally unrelated to the lattices in number theory or geometry of numbers.      MIMO Detection Methods  ◾  57  which constitute a basis for the lattice. A  real  lattice is then defined as the infinite  set defined by  Λ =  y  ∈  n   cid:31   :  y  =  h  i  x  i  =  H x  ⋅  ,  x  i  ∈   cid:30  ,  h  i  ∈  n   cid:31    2.5        n  ∑  i  = 1       .        The definition can be extended to complex lattices but, because it is possible to  transform any complex lattice into a real lattice  as will be seen in Section 2.3.2 ,  one can settle for limiting the description to real lattices.  The integer combination of real or complex n-dimensional vectors generates a dis- crete set of points with the properties of a group, namely: closure, associativity, identity,  and inversion [Biggs 2002, Chapter 20]. Indeed, the shortest possible definition of a   real  lattice is the following: a lattice is a discrete Abelian  i.e., additive or commuta- tive  subgroup of Rn. The two definitions are equivalent [Siegel 1989, p. 44].  A consequence of the last definition given for Λ is that for any two elements  x, y ∈ Λ, then the difference x – y ∈ Λ  i.e., a lattice is closed under subtraction .  Notice that for a structure to be a lattice, the group property by itself does not suf- fice; the structure also needs to be discrete  i.e., for each lattice point there exists  a hyper-ball with radius ε > 0, which is centered at the lattice point and not con- taining any other lattice point inside; that is, the distance between lattice points is  larger than ε . This caveat is sometimes forgotten by some authors. For example, the  group property is preserved as the linear projection operator. However, that projec- tion is not necessarily constituted by discrete structure [Banihashemi 1997, p. 20]. According to Equation 2.5, a lattice is an infinite set of points resulting from  integer combinations of the columns of the generator matrix h. It should be noted  that some authors prefer to span the row space of a matrix, which then reflects alge- braically in some of the definitions that follow.  There are other ways of specifying a lattice that do not have a set of generator  vectors; however, Equation 2.5 is the most prevalent one while these other tech- niques remain largely unmentioned in the literature on lattices. In MIMO litera- ture, Equation 2.5 is the only way used for specifying a lattice, perhaps because  it follows directly from the natural vector description of SM. In [Lenstra 2008,  Section 4], Hendrik Lenstra describes several alternative ways of specifying a lattice  but comments that some are recognizably difficult to convert into Equation 2.5 or  even to convert between themselves. None of the unconventional techniques seem  to have played any role so far in the study of MIMO.  One of the alternative techniques to define a lattice is only applicable to the so- called cyclic lattices. These lattices are endowed with a specific structure that allows  them to be defined by means of one modular equation  lattices with one cycle   [Paz and Schnorr 1987] or by d modular equations  said to have d-cycles  [Trolin  2004]. Interestingly, there is a connection to the field of numerical integration of       58  ◾  MIMO Processing for 4G and Beyond  multidimensional  functions  where  cyclic  lattices  are  closely  related  with  the  so- called lattice rules [Sloan and Joe 1994].  2.2.1.2  Fundamental Region Given a certain basis of a lattice, the fundamental region that is associated to that  basis is defined as     R   H     =  {  Hx  :  0  <  xi  <  }. 1      2.6   The fundamental region cannot contain any lattice point inside it. If there was  at least one point inside, it could not be represented by an integer combination of  generator vectors, which are precisely the sides defining that fundamental region   c.f. Figure 2.1 . If that happens, then the set of vectors is not a basis of the lattice  but a basis of one of its sublattices. A sublattice Λ′ is also a lattice and the volume is  vol Λ′  > vol Λ   the technical definition of the volume of a lattice will shortly be  given .  Note that different sets of vectors may generate the same lattice. Indeed, the num- ber of admissible bases for a lattice is infinite; it is easy to infer from Figure 2.1 that  it is always possible to select some point further distant from the origin to replace a  generator and still have a fundamental region without including any lattice point in  its interior. Moreover, all these different bases are related by unimodular transforma- tions, as will be described below.  2.2.1.3  Voronoi Region The  region  of  the  space  where  the  lattice  is  embedded   i.e.,  in  the  continuous  Euclidian space where the lattice exists  that contains all the points in the span of      2 n o i s n e m D  i  0  h2  h1  R  Dimension 1  Figure 2.1  A lattice in R2 and the fundamental region associated with a particu- lar basis.      MIMO Detection Methods  ◾  59  the lattice which are closer to a given lattice point x than to any other point in the  lattice is called the Voronoi region and is defined by  V   Λ     =  ∈    span  Λ    :  ∀ ∈  y  Λ  x  −  z  <  y  −  z   2.7   {  z  }  .     This  open  region is a characteristic of the lattice and independent of any par- ticular generating matrix, and is the most interesting fundamental region amid the  infinite number of other possible fundamental regions one can define to tile the  entire space as it constitutes the optimal decision region for the CVP in a lattice.  2.2.1.4  Gram Matrix The Gram matrix of a lattice generated by the columns of h, as in Equation 2.5, is  defined by  in the real case transposition replaces the Hermitian operator   =  H .   G H H   2.8   By  construction,  the  Gram  matrix  contains  all  the  possible  inner  products  between all the generator vectors: gij = 〈hi, hj 〉; in particular, the diagonal elements  2. This fact implies that g is Hermitian and positive  are the squared norms  hi definite. Moreover, it defines a positive-definite quadratic form [e.g., Meyer 2000,  Section 7.6] because  2  y  Hx  2  =     =  H x H Hx  H  =  =        H Hx Hx N N R T ∑∑  i  = 1  j  = 1  H x Gx  =  g x x ij i  j  ≥  0 ,  for all  x  0≠ ,   2.9      where  xi denotes the conjugate of xi and  0 is the zero vector. Like the Voronoi  region, the Gram matrix is another invariant of a lattice but only in respect to a  particular basis.  2.2.1.5  Volume When h is nonsingular, the lattice is full rank. In that case, the volume of the lat- tice  the volume of R  is  however, for rectangular h, the following more general definition is required:  vol   Λ =     det     , h    vol   Λ =     det   H  H H     =  det   G   .      2.10    2.11                      60  ◾  MIMO Processing for 4G and Beyond  The volume of the lattice is also an invariant of the lattice, that is, is independent  of the choice of basis.  2.2.1.6  Unitary, Orthogonal, and Unimodular Matrices An  n × n  unitary  matrix  u  has  complex  entries  and  uHu = I   i.e.,  the  identity  matrix  and its determinant is det u  = ±1  positive values account for rotations  and negative values account for the existence of reflections . An orthogonal matrix  q  has  real  entries  and  qTq = I.  Both  unitary  and  orthogonal  matrices  form  a  group [Edelman et al. 1998]. A unimodular matrix M is a square matrix with integer  entries and with determinant det M  = ±1 [Schrijver 1986, Section 4.3, Banerjee  1993]. The inverse of a unimodular matrix is also unimodular  this is because these  matrices also form a group [Siegel 1989, Section XV, p. 148] . Unimodular matrices  can always be generated by starting from an identity matrix and successively apply- ing any of the following elementary column operations  or row operations according  to the convention :  1. Change the signs of all the elements in a column;      2. Swap the two columns;   3. Add and integer the multiple a of one column to another columns.  Examples for these three cases are, respectively:  i      M  =      ii      M  =     i  iii      M =      where   a  =  2.        1 0 0   0 0  − 1 0   0 1          0 1 0  1 0 0   0 0 1          1 2 0  0 1 0   0 0 1   All  these  three  elementary  operations  which  can  generate  any  unimodular  matrix have clear geometric interpretations, but for that purpose the notion of lat- tice equivalence up to scaling, orthogonal, and unimodular transformations will  be first introduced.  2.2.1.7  Equivalent Lattices It has already been mentioned that a basis is not unique. Furthermore, one can  observe that a scaled or rotated version of a lattice is isomorphic to it, and there- fore, in a geometric sense, is equivalent to it. One defines then the notion of lat- tice equivalence. A complex lattice generated by a basis h is equivalent to a lattice  defined by a matrix    cid:29  h if and only if   cid:29  H  = c ⋅  ⋅  ,   U H M  ⋅   2.12             MIMO Detection Methods  ◾  61  where u is a unitary matrix, M is a unimodular matrix, and c ∈ R. By applying  a real equivalent  to be defined in Section 2.3.2 , one can henceforth deal instead  with n × n orthogonal matrices q instead of unitary matrices u.  As  pointed  out  in  [Agrell  and  Eriksson  1998],  if  u  is  known  and  M  is  not  known, it is easy to show that the lattices are the same. One option is to compute  the  unique  Hermite Normal Form  HNF  for both bases and verify whether both  HNF are the same [Schrijver 1986]. One alternative to this method would be to  write each vector in one of the bases as an integer combination of the vectors in the  other basis—as hinted by Micciancio in [Micciancio and Goldwasser 2002, p. 19].  Knowing M, it is also possible to find which orthogonal  unitary, in the complex  model  matrix q would transform one basis into the other by framing the problem  as the Procrustes orthogonal problem [Higham 1989, Gower et al. 2004, Gower  2010]. Note that the QR decomposition is unique up to the sign of the elements  in the diagonal [e.g., Agrell et al. 2002]. Hence, one alternative to the problem of  finding q would be to compute the QR decomposition of both matrices  h and  h cid:28    and verify that the r triangular matrix in both cases was the same up to the  negation of its columns.  2.2.1.8  Geometry of Unimodular Transformations While the first two kinds of elementary unimodular operations,  i  and  ii , change  the sign of the determinant of the lattice, they do not change its modulo. In other  words, they can include reflections but the volume remains the same. The concept  of operation  iii  is illustrated in Figure 2.2 for a 2D case and with a = 2.  It is easy to see that the determinant of the lattice remains unchanged after the  later type of elementary operation too. It should be noted that if the restriction on  a ∈  cid:27  is dropped and a is allowed to be real, the volume of the associated region  also remains unchanged. In fact, the volume is solely dependent on the length of  the Gram–Schmidt orthogonalized vectors. However, it should be noted that when  a ∉ Z, the new set of vectors no longer constitutes a basis for the lattice as the vector  may no longer lie on the lattice.  Volume independency for any vector on this line  h2 + 2h1  h2  i  t d m h c S – m a r G  h1  Figure 2.2  The elementary operation that skews the fundamental region of a  lattice preserves the determinant. The two shaded areas are the same.      62  ◾  MIMO Processing for 4G and Beyond  2.2.1.9  Shortest Vector and Successive Minima Lattices have a shortest vector  and at least its symmetrical with the same norm .  Many times one is interested in finding the shortest vectors that are also linearly  independent  so that a vector and its symmetrical cannot be both considered .  Hence, λi is the ith successive minimum of a lattice if λi is defined as the smallest  real number which is the smallest radius of a sphere containing i pairwise inde- pendent vectors, all with norms smaller or equal to λi. The shortest vector clearly  has norm λ1.  2.2.2  Dual Lattice Every lattice has a dual lattice*  the first being known as the primal lattice . The dual  lattice is traditionally defined for real lattices, though the definition has also been  extended to complex lattices [Ling et al. 2006]. In the real domain, given a primal  lattice Λ with a basis h, the dual lattice is defined as  Λ  D =  {  z  ∈   cid:31   :  , z x  ∈   cid:30  ,  ∀ ∈  x  Λ  }  .    The dual lattice can be expressed in terms of the dual basis h D  as  where h D  involves the Moore–Penrose pseudo-inverse  to be defined in Section  2.5.2 .  ΛD  =  z  ∈   cid:31   :  z       +    =   T H x  cid:30  cid:29  cid:28  H      D  ,  x  ∈  n   cid:27        ,     D       h  = =  +    T  =   h    h h h  T  T     h h h −       T 1  −   1 h h h    T T T  =  −   1  .     Note that there is a unique dual lattice for each primal lattice. However, because  a lattice holds an infinite number of bases, there is also an infinite number of bases  for its dual, always observing h D  =  h+ T , in the case of real lattices, as given in  Equation 2.14.  *  The dual lattice appears in the literature also as the polar lattice or, more commonly, as the  reciprocal lattice. All these names were already in use in 1971 [Cassels 1971, p. 24]. Since then,  the name polar fell into disuse, though reciprocal is a name that is still common to be found  in the literature.   2.13    2.14    2.15                               MIMO Detection Methods  ◾  63  Consider the case of full-rank real matrices. In fact, for x x1 ,  2  ,∈  cid:27 n  , z y  =  T z x  +  T     =   H x Hx  cid:31   cid:30  cid:29   cid:28  cid:29   cid:27  2 ∈ Λ z    ∈ Λ  1  D  y     =  +  T x H Hx 1  2  =  T x x 1  2  ∈   cid:26   .  It is also possible to show that each point in the dual lattice can be written as an  integer combination of the columns of h D . Denoting the rows of h−1 by r1, r2, . . .,  rn, for any point z ∈ Λ D  it is possible to write  T z  = =  − 1  T z HH  cid:30   cid:30   cid:29   cid:30        T T z h r z h r 1 1 n    T z h r 2  +  +  +        2  n  ,  ∈  cid:31   ∈  cid:31   ∈  cid:31      which shows that the point in the dual lattice is defined by a linear combination of  the rows of h−1, that is, a linear combination of the columns of  h−1  T. These argu- ments can be extended to the cases where the Moore–Penrose inverse is required  and also to complex lattices.  One interesting relation between the two bases is that  , which is equivalent to saying that  h hi     D   j  ,= δ , using the Kronecker delta.  i j  The volumes of the primal and the dual lattice are related by         H    D T  = ,   H I  vol   Λ  D =    1 vol   Λ        and their Gram matrices are related by     D     G  = =         D T   H − T 1 H H       H −   1  D     =    − 1     H T H H  − 1        T T = −   1  H − 1 G    T .  =     Obviously, the dual of the dual lattice is the primal lattice itself. The geom- etry  of  the  dual  lattice  is  closely  related  to  the  geometry  of  the  primal  lattice.  The connection is that each point in the dual lattice defines a family of parallel   n − 1 -dimensional hyperplanes, where translates of an  n − 1 -dimensional sub- lattice lie. The union of those planes captures all the points of the primal lattice.  This means that the shortest vector in the dual lattice will define the most distant   n − 1 -dimensional  hyperplanes,  whose  union  builds  up  the  whole  primal  lat- tice. These hyperplanes can be interpreted as parallel layers and  as a consequence  of  being  the  ones  farthest  apart   are  the  densest  ones  in  the  lattice.  In  MIMO    2.16    2.17    2.18    2.19       64  ◾  MIMO Processing for 4G and Beyond  literature, the geometrical interpretation of the dual lattice as a tool for improving  detection seems to have been first noted in [Agrell et al. 2002, p. 2207] for SD, and  then in [Ling et al. 2006] for SIC [Ling and Mow 2009], though it is also implied  in the detector in [Su and Kschischang 2007, p. 1944].  From the definition in Equation 2.13, for both Λ and Λ D  in n dimensions, the  inner product between some given point z in the dual lattice and any vector in the  primal lattice is always an integer. Therefore,  , z x  ∈   cid:27  ,  z  ∈  Λ     D     ,  x  ∈ ⇔  Λ  z x  θ cos     =  z  Proj      xe  z  ∈   cid:27   ,   2.20            where e  z =    z z  .  z=  From Equation 2.20, it is then possible to define a family of parallel hyperplanes  −1ν . These are planes in dimension n − 1  P   ν , for ν ∈  cid:27 , such that Projez    x with a distance D = ‖z‖−1 between them, as illustrated in Figure 2.3. Note that  vectors a1, a2, a3 all have the same projection onto the vector z that defines the set  of parallel hyperplanes that is shown. ν is then the index of the hyperplane with  respect to the distance between hyperplanes, that is, D = ‖z‖−1.  Figure 2.4 shows an example of two different partitions  i.e., a family of parallel  hyperplanes  of a lattice associated with two different choices of vectors of the dual  lattice. The example is set for     h  =  3 7 − 1 7      − 2 7 3 7         and       h  D     =  3 1 2 2      .      z ∈Λ D   v = 3  v = 2  D = 1 z  a2 θ3  θ2  θ1  a1  O  ak  =  cos θk  1 , ∀ ak P v = 1  z  ∈  v = 1 a3 v = 0  v = – 1  Figure 2.3  A primal lattice in n dimensions as the union of translates of a sublat- tice and these translates lie on  n − 1 -dimensional hyperplanes.      MIMO Detection Methods  ◾  65   D  h2   D  h1   –2, 1    a      2 n o i s n e m D  i   b      2 n o i s n e m D  i  1 0.8 0.6 0.4 0.2 0 –0.2 –0.4 –0.6 –0.8 –1 –1 –0.8–0.6–0.4–0.2 0  1  D  λmin  =  1   –2, 1   1 0.8 0.6 0.4 0.2 0 –0.2 –0.4 –0.6 –0.8 –1 –1 –0.8 –0.6 –0.4 –0.2 0     2 n o i s n e m D  i     2 n o i s n e m D  i  10 8 6 4 2 0 –2 –4 –6 –8 –10  10 8 6 4 2 0 –2 –4 –6 –8 –10  0.2 0.4  0.6 0.8  1  –10 –8 –6 –4 –2  0  2  4  6  8 10  Dimension 1  Dimension 1  1  −  –1, 4    –1, 4    D  h2  D  h1  0.2 0.4 0.6 0.8  1  –10 –8 –6 –4 –2  0  2  4  6  8  10  Dimension 1  Dimension 1  Figure  2.4  Identification  of  the  hyperplanes  in  the  primal  lattice   on  the  left  side   associated  with  a  certain  point  in  the  dual  lattice   on  the  right  side .   a   Selection of  −2, 1  in the dual lattice.  b  Selection of  −1, 4  in the dual lattice.  2.3  Communication with Vectors 2.3.1  System Model In MIMO SM with NT transmit antennas and NR receive antennas  with NR ≥ NT , the  × 1 cid:26  relation between the transmitted  input  vector  xc   c N , T … y , , and the received  output  vector  y c  is modeled in  the baseband as  … , , x c , 2 × 1 cid:26  N  = [ c N ,  x , 1 c ] T  x , ∈  ∈  ] T  =  N T  y  y  [  , 2  ,  , 1  R  R  c  c     y  c  =  H x c  c  +  n  c  ,     2.21       66  ◾  MIMO Processing for 4G and Beyond  ∈  c  R  , 1  N  , 2  [  =  ] T  ∈  × cid:26  N NR T  … , ,    ,    n R c N ,  where  hc   is  the  channel  matrix,  with  its  entries  hij  representing  the  complex  coefficient  associated  with  the  SISO  link  between  the  ith  receive   Rx   ∼ N 0 1 , that is, taken  antenna and the jth transmit  Tx  antenna, and with hi j , from a zero-mean circularly symmetric complex Gaussian distribution with uni- tary variance  i.e., variance 1 2 in both the real and imaginary components . The  phase of these elements is uniformly distributed in [0 2π], and their amplitude has  a Rayleigh distribution. This corresponds to the i.i.d.  independent and identically  distributed  Rayleigh fading channel model. The subscripts denote that the ele- ments in the vectors and the entries in hc are all complex variables. Furthermore,  there is noise added to each entry of the received vector, modeled by the column  vector  nc   with  independent  circularly  symmetric  2σ , that is, with zero aver-   , 0 complex Gaussian random variables taken from Nc age and variance σ n 2  corresponding to a variance σ n 2 2   in both real and imaginary  components . This noise model is often dubbed in MIMO literature as zero-mean  spatially white  ZMSW  noise [e.g., Goldsmith 2005]. For independent input data,  its covariance is R . Similarly, the covariance of the indepen- dent noise vector is R . Henceforth, the subscript in In will be  I n n abandoned.  σ 2 I x n = } σ 2  { x x c E= {  E= n  } H c n n  × 1 cid:26   n n , c c  It should now be clear that with integer input symbols xi, any of these possible  vectors is a point on the Zn lattice. The effect of the channel is that of warping Zn  according to the linear transformation hc  as illustrated in Figure 2.5 .  Both phase shift keying  PSK  or quadrature amplitude modulation  QAM   constellations can be used in MIMO, however, only the latter lends itself for a lat- tice interpretation and most of the literature on MIMO SM concentrates on QAM,  which is also the modulation that is considered in this chapter. Consequently, the  input symbols in each transmit antenna are taken from a finite complex constella- tion Ac, which is some M-ary QAM  quadrature amplitude modulation . The sym- bols have zero mean, so that E{xc} = 0. This complex constellation is constructed   = H c     n  x  c  x1     4 3 3x2 2 n 1 o i 0 s n e 1 m 2 D 3 –4 4  x3  i  Tx  Channel     4 3 2 3 n 1 o i 0 s n e 1 m 2 D 3 –4 4  i  y1  y2  y3  4  Rx  2  0  Dimension 2  –2  –4  –4  4  2  0  Dim ension 1  –2  2  Dimension 2  0  –2  2  0  Dim ension 1  –2  –4  –4  Figure 2.5  SM with real inputs.  Zn is transmitted and then skewed by the effect  of the channel.      MIMO Detection Methods  ◾  67              from the Cartesian product A  c =  A A  ×   where   A   is the real alphabet  { A = −    M  −    , a 1  …  ,  − a 5  ,  − 3  a  ,  − + + 3 a ,  a  ,  a  ,  + 5  a  ,  +   cid:31   +     M  −    a 1   2.22   Traditionally, a = 1, and the alphabet in each real dimension is  { A = −    M  −  …  , 1  ,  − − − + + + + , , 5 3 1 1 3 5  ,  ,  ,  ,   cid:31   +     M  −   2.23   }  .     }   . 1     Without loss of generality, one can assume Rx filters with impulse response h t   normalized  to  ∫ 1,  and  therefore,  the  average  energy  of  the  complex  dt symbols in A  is given by      2 h t  =  E  s  =   E x    2  c i ,   =  1 M  ∑  x  c i ,  ∈ A    x  c i ,   2  =  1 M  ∑∑  x  c i ,  ∈ A     ℜ x  c i ,    2  + ℑ     x  c i ,    2  ,   2.24      which coincides with their average power  Es for the modulations used later in this work.  The “overall” SNR at the receiver is  x= σ 2 . Table 2.2 lists the values of Es   ρ  cid:24   { {  E  E  y  n  2  2  } } =  E  {  E  =  2 x  N N R σ R  T N  σ 2 n  =  N  {  H x c 2  2  n  } } = σ σ ,  2 x 2 n  T  E     i  R  1  N  N T = j 1 N  = ∑∑ =∑ E   1  R  ii  h c i j , ,    n 2 c  x  j  2      2.25      which  is  actually  the  same  as  NT  times  the  SNR  of  a  SISO  channel.  This  comes from the fact that each antenna receives the incoming power from NT  antennas, while each receive antenna perceives the same amount of noise as in  ∼ N 0 1 , that is, each  SISO. The result is valid on average and only when hi j , yi receives the sum of NT symbols weighted by unit power random variables   E[hij2] = 1 .  Particular  channel  realizations  will  lead  to  different  instanta- neous  SNRs.  In  this  chapter,  when  assessing  the  performance  of  a  receiver,  the SER will be plotted against the SNR as defined in Equation 2.25. One     ,    c  Table 2.2  Symbol Energy for the Used Modulations  QPSK  16-QAM  64-QAM  Es  2  10  42      68  ◾  MIMO Processing for 4G and Beyond                 other important metric that will appear in the capacity formula is the SNR per  transmit antenna, which is  This latter normalized SNR is in fact the same as Es N0  where N0 is the unilat- eral power spectral density of the noise  because, assuming the Nyquist bandwidth  and a raised-cosine filter,  ρ a  ρ N= T  =  σ σ  2 x 2 . n     σ σ  2 x 2 n  =    E T s ⋅ N B 0  =  E R s N B  0  =  E N  s  0  .      2.26    2.27   Unlike what happens in SISO systems, in MIMO most performance results  are  given  as  a  function  of  the  SNR.  However,  some  literature  uses  the  average  energy per bit,* Eb = Es log2 M , and the unilateral spectral density of noise, N0.  Accordingly, the SNR given by Equation 2.25 is the same as  ρ =  N  T  =  N  T  log   2  M     s  E N  E b N  ,  0    which allows comparisons across the two different approaches seen in the literature. It is also worth mentioning that an equivalent model for SM assuming unit  noise variance and unit Es is also often found in the literature. Maintaining all that  was said for the SNR, this model must be written as     0   2.28   y  c  =  H x c  c  +  n  c  or also as  y  c  =  H x c  c  +  n  c  ,   2.29   E s σ 2 n  ρ N T  where now the real alphabet in each dimension is  A =  3 M  2    −  1    {  −    M  −  …  , 1  ,  − − − + + + + 5 3 1 1 3 5 , ,  ,  ,  ,  ,   cid:31   +     M  −   2.30   to assure that E x xi *  {  i  }  = 1 and E{xH x} = NT.  The norms in Equation 2.25 are the Euclidian norm. Notice that for the case of   matrices several norms may be defined [Stewart 1973, Chapter 4]. = ∑∑  trace   trace   A A  AA  A  =  =        H  H  F  a 2 ij  i  j      2.31   *  The error rate is also sometimes given in the MIMO literature in terms of the bit error rate   BER , which is obtained from the SER taking into consideration the number of bits per com- plex symbol.     } 1           MIMO Detection Methods  ◾  69  It is not difficult to see that in this norm  {  E  h 2 c F  } =  N N  T  R  .   2.32        In this chapter, the uncorrelated channel is considered, as seen in the definition of  hc. When correlation exists between the multipath components, a more general  model is necessary and that implies a full characterization of the correlation matrix  involving the cumbersome vectorization of hc [see, e.g., Oestges and Clerckx 2007,  Section 3.1.1]. The Kronecker model is a popular way of avoiding this, by decou- pling  the  effect  of  correlation  at  the  transmit  side   characterized  by  rc,Tx   from  effects at the receive side  characterized by rc,Rx . Then, the model consists only of  matrix multiplications*  hc  =  R H   1 2 c , Rx  c  ,ind  1 2R   c , Tx  .      2.33   The separation of Tx and Rx effects can be interpreted as if the multipath com- ponents at the receiver had “forgotten” about the effects of antenna coupling and  scattering close to the Tx, which can be considered as separate from what happens  in terms of antenna coupling and scattering close to the Rx.  For signals with symbol time T and bandwidth B, as a rule of thumb, the coher-  ence time and the coherence bandwidth are given by  Bcoh  ≈  rms delay spread  Doppler spread  ,  τ  coh  ≈  .     1  1   2.34   When assessing the performance of SM systems, in this chapter we will always  consider the channel to be  i  flat  nonselective in the frequency domain , that is,  B < Bcoh, and  ii  slow  nonselective in time for a transmit vector , that is, T < τcoh.  For typical values for the coherence time in different mobility scenarios in LTE, see  [Ghosh et al. 2010, Section 2.4]. Typical descriptions of the wireless channels can  be found in, for example, [Ghosh et al. 2010, Section 2.4], [Giannakis et al. 2007,  Section 1.3] and a deeper discussion is offered by [Oestges and Clerckx 2007].        2.3.2  Real Equivalent Model The  model  for  SM  was  described  in  Equation  2.21  in  terms  of  complex  vector  spaces, however it is not difficult to prove that, by stacking the real and complex  parts of the vectors  respectively denoted by ℜ and ℑ , and by appropriate con-  *  The square is root of a matrix defined as  A H , where u and v are the unitary  matrices of the SVD of A, with Σ the diagonal matrix made of the singular values of A [Biglieri  and Taricco 2005, p. 18].  V  1 2    1 2    = Σ U      70  ◾  MIMO Processing for 4G and Beyond  struction of a modified channel matrix, the problem can equivalently be described  by means of real variables as  y Hx  =  + ⇔  n        c  ℜ   y ℑ   y  c          =     c  ℜ   H ℑ   H  c           −ℑ   ℜ    H H          c  c  c  ℜ   x ℑ   xx  c          +         c  ℜ   n ℑ   n  c           2.35      ,  y  , y 1 ] T  y = [ … n N , 2  … y N , , 2 2 ∈ × cid:23  1 N R  n = x = with  T   notice that the “c” subscripts in the  [ , n n 2 1 variables will be dropped from now on . Expanding Equation 2.35, each compo- nent of y is  × 1 cid:23  ] T N ,   and h ∈ × cid:23 N NR  × 1 cid:23   , x x 1  … , ,  x N 2  ∈  ∈  ] T  N T  ,   [  ,  2  T  R  R  R  n i  ,  i N  ≤  RR  y  i  y  i          h i  x 1  , 1 h i  = ℜ ⋅ ℜ + + ℜ h i N , T − ℑ  cid:30  x h 1 i N , T + ℑ  cid:30  h x − 1 i N N T ⋅ ℑ + + ℜ  cid:30    cid:30  − ℑ ⋅ ℑ − ⋅ ℜ + h − i N + ℜ x h − 1 i N  ⋅ ℜ x N T ⋅ ℑ x  = ℑ  , 1  , 1  R  ,  N T ⋅ ℜ  + ℜ x N T ⋅ ℑ x  R h − i N N TT    R  + ℑ  < ≤  ,  R  R  R  , 1  ,     i       2  N T  N  N   R  2.36  and therefore these components have a χ2 distribution with 2NT degrees of free- dom, before the noise is added.  n − i N  The equivalent real model is the one that will be used throughout this work  and, therefore, the transposition operator, T, will replace the Hermitian operator,  H  conjugation followed by transposition . Moreover, orthogonal matrices play the  role of singular matrices, for instance in the singular-value decomposition  SVD  or  for performing orthogonal rotations on lattices. In this model, the discrete inputs  in the elements of x that are considered in this chapter are taken from the real  alphabet A , as defined in Equation 2.23. In this model, both real and imaginary  components of n    have variance  + ℑ    = ℜ    n  n     j  c  c  c     σ  2 n  =  1 2  sN E  T ρ  .      2.37   Another consequence of this model is that, henceforth, full-rank real lattices   will be considered to have n dimensions.  2.3.3   Capacity with Channel State Information   at the Receiver  Assuming that there is perfect channel state information at the receiver  CSIR , that  is, perfect knowledge of h, it can be proven that the maximization of the mutual  information  between  the  input  and  output  in  MIMO  amounts  to  maximizing                   and  MIMO Detection Methods  ◾  71  2  πe  log  det  therefore the capacity is      yr . The output covariance is R  =  E  y  {  H  yy  } =  HR H  x  H  + σ 2  I n N  R   and   C  =  max log det R  2  x  + I   ρ N T  HR H  x  H     ,      2.38   where trace  rx  = E{xHx} < 1 is the transmit power constraint in the optimization  problem. When the channel is known at the transmitter  Tx , that is, there is CSIT,  the input covariance can be built to match the channel. When CSIT does not exist,  the input is made to have R  , leading to a capacity  = σ 2  x  I x NT  C  =  log det  2  + I   ρ NT  HH  H     ,      2.39   where CSIR is assumed. This implies that the receiver is able to accurately estimate  the channel matrix.  The matrix hhH can be interpreted as the Gram matrix associated with the  lattice  generated  by  the  rows  of  h.  Therefore,  as  shown  in  Section  2.2.1,  hhH  is  a  semidefinite-positive  matrix  with  r = rank h   eigenvalues,  whose  values  are  is= 2, that is, they are the square of corresponding r singular values si. Applying  λi the SVD to hhH, and remembering that a Gram matrix is symmetric, its left and  right unitary matrices in the SVD are the same. Hence, Equation 2.38 becomes  log det  2  + I   ρ N T  U U  Σ  H  log det  2    =     + U I   ρ N T   Σ   H  U         2.40   C  =  r  ∑ log  k  = 1  2  + 1   ρ λ NT  i     .      2.41   As  known  from  Section  2.3.1,  h  is  not  deterministic  but  rather  a  random  matrix. One should note that in the case of slow fading  when a code word does not  span more than one coherence period of the channel , regardless the choice of rate  and coding scheme, there will always be a nonzero probability that the rate is higher  than the capacity of the channel. Hence, the capacity that the channel can commit  to is zero [Tse and Viswanath 2005, p. 188]. Even in that case, one can speak of the  instantaneous capacity C h , as a function of the current channel.  This chapter assumes a channel with a block fading model  i.e., when a code- word goes through many different and independent channel instances [Tse and  Viswanath  2005,  p.  199] .  In  this  model,  the  channel  remains  constant  over  a                    2.42    2.43    2.44   72  ◾  MIMO Processing for 4G and Beyond  certain duration  the duration of a block , only changing from block to block. In  this case, by taking the average of over many instances of the channel coefficients,  a channel capacity can be obtained by applying an expectation to Equation 2.41:  C  erg =  E  r    ∑λ    = 1  k  i  log  2  + 1   ρ λ N  T  i          .     This expectation depends on the eigenvalues λi, which are independent random  variables, each with a Wishart distribution [Tulino and Verdú 2004, Oestges and  Clerckx  2007,  Appendix  B],  as  Teletar  first  noted  in  [Telatar  1999].  While  the  number of receive antennas is not explicit in the capacity formula, its effect is hid- den in the rank r of hhH, which is  It is not difficult to show [Tse and Viswanath 2005, Khan 2009, pp. 148–149,  Section 8.2] that for low SNR, using the approximation log2 1 + x  ≈ xlog2e valid  for small x, and noting that E{λi} = Trace hhH , as seen in Equations 2.39 through  2.40, then the capacity in Equation 2.42 is  r  = min   N Nt  ,  R   .    C  erg ≈  N  R  ρ log  .2 e     This result shows that, for the low SNR, the number of transmit antennas does  not play any role, because what is important is the fact that NR receive antennas  can coherently combine the incoming signals working as a “spatial matched filter.”  This result will be revisited in Section 2.5, when both linear receivers are shown to  approach the matched filter when noise is high compared to the mutual interfer- ence between layers. In the high SNR regime, it is also not difficult to conclude that  expression  2.42  becomes  C  erg ≈  r  log  2     ρ N T    +  r  ∑  i  = 1  E  λ i  {log   2  λ i   },      2.45   which, remembering Equation 2.43, shows the famous linear increase of the ergo- dic capacity with the minimum number of antennas on each side.  In STC a code word spans more than one transmit vector, as a matrix assumes  the role of xc in model  2.21  and several vectors may experience different channel  realizations hi over time. Moreover, using outer-codes the code words may experi- ence enough channel realizations and the average of the capacities of the channels  may be close to the ergodic capacity. In the case of uncoded SM, those situations  do not exist and therefore the outage capacity and the outage probability are the  concepts best suited to describe these systems.      MIMO Detection Methods  ◾  73  In 2004, Guo, Verdú, and Shamai made a breakthrough in information the- ory, finding a very simple relation between mutual information and the minimum  mean square error at a receiver. Debbah in [Sibille 2011, Chapter 2] shows how  that approach eventually leads to an elegant  average  geometrical interpretation for  the capacity of a MIMO system, much similar to that of the traditional geometri- cal interpretation of capacity of the binary symmetric channel, as first observed by  Shannon. The determinant of the auto-correlation matrix of the transmitted sym- bols measures the volume of space associated with a MIMO code word. The deter- minant of the covariance matrix of the MMSE estimate measures the small volume  around the received vector, where the signal is expected to lie with high probability.  It can be proven that the MIMO capacity is  C  = log  2  det   r    xx r MMSE  det    ,      2.46   which amounts to the sphere packing problem in lattices [Conway and Sloane 1999,  Aste and Weaire 2000]. It is worth noting that Stoica et al. have independently  arrived at the exact same lattice interpretation solely by signal processing consider- ations [Stoica et al. 2005].  2.4  Detection in MIMO Spatial Multiplexing While in STC the central research problem is finding codes that maximize the code  word pairwise distance and thus that minimizes pairwise error probability [e.g.,  Viterbo and Oggier 2004], the main research problem in SM in the last 10 years  has been detecting x given the noisy observation y. For that problem, the maximum  a posterior probability  MAP  of x is  x  =  argmax   P x  ∈ A  x y     =  argmax ∈ x A  P     x y P        P x     y  .      2.47   As all vectors  x are equiprobable,  P xy  is a sufficient statistics for the detec- tion process. Therefore, MAP detection can be reduced to maximum likelihood  ML   without any performance loss. For the independent and identically distributed  i.i.d.   Rayleigh channel with i.i.d. transmitted symbols with  R ,  I n n one has the N-dimensional probability distribution   and  R  = σ 2  = σ 2  I x n  n  x  P     x y     =  1 πσ 2 2 n     1 πσ 2 2 n        2    N     2    N  =     −  exp  ex  pp  −              −  −      T y Hx y Hx σ 2 2 n  y Hx 2    − 22σ n  ,      2.48                74  ◾  MIMO Processing for 4G and Beyond  and therefore the detection problem becomes that of minimizing the exponent of  Equation 2.48:      cid:22 x  ML =  argmax ∈ x A  −{  y Hx  2  }  .      2.49   This problem now has a clear geometrical interpretation: the optimal x  the one  that best explains the observation y  is the one that, among all possible input vec- tors, and after the linear transformation, generates the closest vector hx  in the  Euclidian sense  to the received vector y. This problem is known in integer opti- mization as integer least squares and in lattice theory as CVP  as mentioned above :  “given a target vector off the lattice, y, which point in the lattice is the closest one?”  The problem is exemplified in Figure 2.6 for the simple cases of Z, Z2, and Z3  lattices  the CVP in these lattices is not NP-hard; for Zn lattices the algorithmic  detection complexity of the optimal detector is actually polynomial O   n3 , due to  the orthogonal structure .  The solution of the CVP is equivalent to drawing a Voronoi cell around the target  point and finding which single lattice point lies inside the region. Conversely, this  is equivalent to having the lattice tiled by the Voronoi region and in selecting which  region the target is. Obviously, computing the Voronoi region is also NP-hard.  Notice  that  the  complex-valued  lattice  in  a  MIMO  link  with  NT  transmit  antennas and an M-QAM modulation will have M NT  complex points within its  border. In the equivalent real model the number is obviously the same,   .   M NT2   a    –4  –3  –2  –1  0  1  2  3  4   b   Dimension 2   c   –4  –3  –2  –1  +1 +2 +3 +4  Dimension 1  +4 +3 +2 +1 0 –1 –2 –3 –4     3 n o i s n e m D  i  4  2  0  –2  –4 4  2  0  –2  Dimension 2  –2  –4  –4  4  2  0 Dimension 1  Figure 2.6  The CVP in  a  one,  b  two, and  c  three dimensions, given an off- lattice target point.      MIMO Detection Methods  ◾  75  2.4.1  Optimal Detection and Complexity The algorithmic complexity of the CVP is proven to be NP-hard, which, in the cur- rent state of understanding of the complexity of algorithms, places it in the worst tier  in the hierarchy of complexity classes. One should not conclude from this that any  hope of finding accurate solutions should be deemed unrealistic. In fact, very good  approximations to the optimal solution can be found, especially when the number of  dimensions is small [Hochba 1996]. As the number of dimensions grows, the com- plexity of the problem, measured as the number of operations, grows exponentially   this is what is known as “the curse of dimensionality” [Bishop 2006] ; however,  the  complexity  of  some  approximate  detection  techniques  grows  only  polynomi- ally. Usually, the number of operations  flops or algebraic operations  required by  an algorithm is expressed in the “big O” notation* and in practice this suffices for  comparing the complexity of algorithms, when it is feasible to test them. However,  the complexity theory of algorithms is a vast and convoluted topic [e.g., Talbot and  Welsh 2006], and the precise definition of each of the complexity classes falls beyond  the scope of this work. Nonetheless, there are simpler and insightful working defini- tions describing these classes, for example, [Welsh 1988], [Cormen et al. 2001], and  [Bertsimas and Weismantel 2005, Appendix B]. The most broad complexity classes  are P, NP, NP-complete, and NP-hard and, according to what is known today, are  related as shown in Figure 2.7  if P ≠ NP, as is believed to be the most likely case . The P class encompasses the problems that can be solved in polynomial time  mak- ing a correspondence between the number of operations and time . NP stands for  nondeterministic polynomial complexity. It means that, if a certain certificate is provided   NP-hard  NP-complete  NP  P  Figure 2.7  Complexity classes.  *  For an input data of size n  e.g., n bits are necessary to represent the data, or, in the particular  case of MIMO, n is the number of dimensions of the lattice , complexity O       f n  means that  the function f n  is an upper bound, up to a constant multiple factor, for the function of the  number of operations as a function of n—a detailed description of this and other notations is  given in [Epp 2011].      76  ◾  MIMO Processing for 4G and Beyond   i.e., a possible “solution” to the problem , it is then possible to verify in polynomial  time if that certificate is a valid solution to the problem or not. This involves a mere yes  no answer because the problem is formulated as a decision problem. As every problem in  P can also be posed as a decision problem  one just needs to use the solution as a certifi- cate , then P ⊂ NP. The problems in the NP-complete class all share the property that  if one of them is proven to be in P, then all the other problems in the class would also  be in P, unless the polynomial hierarchy collapses.  It is worth mentioning that the vast  majority of NP problems are in fact NP-complete.  Technically, these “entanglements”  are proven through a “P time” reduction of one problem to the other. A simple defini- tion of the NP-hard class unavoidably ends up vague: it consists of the problems that are  “at least as hard as the NP-complete ones.” NP-hard problems hold some property that,  if solved in “P time,” would make any problem in class NP-complete to be solvable in  “P time,” though they cannot be included in the NP-complete family. Obviously, given  the definition, all problems in the NP-complete class are also NP-hard; however, there  exist problems that are in the NP-hard class but not in NP-complete. A useful theorem  states as follows: if an optimization problem has a decision version that is NP-complete,  then the optimization version is NP-hard. In the CVP, one can think of the following  decision version: “is there a lattice point at a distance shorter than some distance d from  the target point?” Given a certificate, it is trivial to compute the distance and verify  that such a point exists. The optimization version is the CVP itself: “what is the point  at the shortest distance from the target point?” There are thousands of NP-hard prob- lems [Bertsimas and Weismantel 2005, Appendix B], such as the subset sum problem   an example of a decision problem , the knapsack problem  a problem of combinatorial  optimization, [Kreher 1999, Bertsimas and Weismantel 2005] , the binary optimiza- tion problem, the traveling salesman problem, or the CVP.  The CVP was first proven NP-hard by van Emde Boas in 1981, but the tech- nicalities of that proof are considered cumbersome. In 2001, [Micciancio 2001]  was able to show a reduction from the subset sum problem  known to be NP-hard   to a CVP in a lattice, which finally proved, in a very simple and elegant way, the  NP-hardness of the CVP.  As is the case of many problems in the class NP-hard, being in this class does  not mean that the problem cannot ever be solved in an optimal manner. When  both the number of dimensions n and the modulation order M are low, a “brute  force” approach is affordable. Furthermore, when ML-type detection is no longer  possible, the challenge of finding suboptimal affordable solutions can be quite suc- cessful. The next section will describe how the geometry of lattice is closely related  with the detection strategies used in MIMO.  2.5  Traditional Receivers In the following, the most important type of MIMO receivers will be introduced with  a geometric perspective in mind, which explains their performance loss in respect to       MIMO Detection Methods  ◾  77  the optimum detector. The linear receivers, which are the simplest ones, but also the  ones having the worst symbol error rate  SER , are the first ones to be geometrically  interpreted. Then, the OSIC technique is described, followed by the lattice-reduction- aided  LRA  approach, and finally the sphere-decoding concept is introduced.  2.5.1  Linear Receivers Linear receivers consist of  i  a linear transformation W of the received vector which  then is followed by  ii  a quantization to the symbol alphabet  also known as slic- ing . The linear transformation is a filter that can be designed with two different  criteria, leading to the zero-forcing  ZF  detector or to the minimum mean square  error  MMSE  detector. These receivers constitute the simplest set of  nonoptimal   receivers to be widely used for MIMO receivers. The detected solution  cid:22 x given by  these techniques is obtained by applying     xW  = Wy,  WQ= x   cid:30 [   cid:31 x W  ],     2.50    2.51     where Q cid:27 [ ]⋅  denotes rounding to the nearest integer and the subscript W in   cid:22 xW   indicates the filter design criterion: ZF or MMSE.  D-BLAST was the first technique to be proposed [Foschini 1996], followed  by the more practical OSIC [Golden et al. 1999], but, as will be seen below, OSIC  includes a linear inversion  either ZF or MMSE . As mentioned in Section 2.1.3,  both ZF and MMSE techniques are well known in other contexts of detection and  equalization in SISO  c.f. Table 2.1 , but the formalism that is used in MIMO is the  one that was first developed for multiuser detection [Verdú 1998].  In both types of linear receivers, the linear transformation W can be seen as  a focusing process of the points in the received lattice back onto  cid:27 n or  cid:26 n . This  “backwards transformation” is of interest because it maps the received lattice back  onto  cid:27 n, which lends itself to simple orthogonal slicing. This is the primary motiva- tion for this particular design. In [Monteiro and Kschischang 2011], the concept of  having a linear transformation as the first stage of a detection technique has been  generalized to the concept of focusing a received lattice onto some other given lat- tice, whose geometric structure is also of interest.  Noticeably, despite the early use of both ZF and MMSE detectors, a thorough  theoretical understanding of their performance seems not to have been pursued  until [Jiang et al. 2011].  2.5.2  Zero-Forcing Detection It is natural to think first of a solution to Equation 2.49 involving the linear trans- formation  that  undoes  the  linear  transformation,  which  is  obviously  the  inverse  matrix.      78  ◾  MIMO Processing for 4G and Beyond  The inversion of h is a trivial operation  e.g., by applying Gauss elimination to  an extended matrix , but can only be defined for matrices with nonzero determinant   i.e., invertible or nonsingular matrices . Hence, the need for NT < NR. A geometrical  interpretation for the cases with singular matrices is simple. A singular matrix that  defines a lattice in   cid:23 n  the extension to   cid:26 n is always implied  performs a linear  transformation whose outcome is a “flat” lattice that lies on a “flat subspace” of that  space, that is, a lattice that does not fill all the dimensions in  cid:23 n and consequently  can be fully described in a smaller dimensional space. For example, think of lattices  that lie on a 2D plane or on a straight line embedded in an n-dimensional real space.  In the space in which they are defined, these lattices have zero volume  i.e., zero  determinant . Even so, an inverse correspondence to the original lattice seems still  impossible. This would only not be possible if NR < NT, since the higher dimensional  transmit lattice in NT cannot, in general, be captured in a lower dimensional space. The  algebraic  interpretation  of  the  channel  inversion  problem  of  an  n × n  singular channel matrix h is related to its SVD h = uΣv T, where u and v are  λ λ λ unitary matrices and Σ = diag  ,… r , the diagonal matrix with the sin- , ,   1 2 = − − gular  values  of  v.  The  inverse  is  H  T ,  1 V 1 −Σ 1 T , as both  u and  v. Since the inverse of the diagonal matrix is  or  H V U , when there are only r < n nonzero singular values  Σ = diag    λ λ   1 , 1 1  i.e., the rank is r , then n − r singular values cannot be inverted in a finite domain. The pseudo-inverse matrix, also known as the Moore–Penrose*  inverse  matrix, is  the solution to the normal equation hHy = hHhx, obtained from Equation 2.35.  The straightforward solution to this equation is to make  hHh −1hHy = x, where  hHh is invertible because it is positive definite  indeed, it corresponds to the Gram  matrix of the lattice . The Moore–Penrose inverse of h ∈ T , when NR > NT,  always exists and is defined as  λ ,… r ,   1  ,  or  H  × cid:26 N NR  −  T 1  − 1 U  − 1 U  Σ  Σ  V  =  =  − 1           2  +  h  =    H  −   H1 h h h  .      2.52   From Equations 2.50 and 2.51, the ZF receiver is formed by the pseudo-inverse  matrix   the  linear  filter   followed  by  a  quantization  to  the  symbol  alphabet  by  threshold decision, that is,  W  ZF  =     H  H H H  −   1  H  ,  x  ZF  =  W y  ZF  ,   cid:22  x  ZF  =  Q  A  [  x  ZF  ],      2.53   and therefore   cid:22 x  ZF  =  Q  A  [  W Hx  ZF     +  n   ]  =  Q  A  [  x  +  ].W n  ZF      2.54   The  filtered  noise  is  transformed  by  WZF = h+,  which  constitutes  a  noise   enhancement factor. The receiver structure is shown in Figure 2.8.           *  Discovered first by E. H. Moore in 1920 and later rediscovered by Roger Penrose in [Penrose   1955].      MIMO Detection Methods  ◾  79  y  WZF = H+  Slicing  ˆ x  Figure 2.8  Zero-forcing receiver.  The detected vector  cid:22 x ZF, as obtained from Equation 2.54, is in fact the solution to      cid:31 x  ZF  =  argmin ∈ x  cid:30   NT  −{ y Hx  }  .      2.55   Comparing Equation 2.55 with Equation 2.49, one should note how the search  is now made in the continuous domain  cid:23 n  or in  cid:26 n, for complex lattices  instead  of the discrete complex alphabet A   or Ac . This is the origin of the suboptimality  of the ZF receiver. As mentioned previously after the inverse transformation, all the  points in the lattice are matched to the initial  cid:27 n. The orthogonal geometry of  cid:27 n  eliminates all the interference between the dimensions of the lattice, that is, between  the MIMO layers; in a system with NT = NR, the ith antenna at the receiver “sees”  the transmission from the corresponding ith antenna at the transmitter cleared from  any interference from the other NT − 1 antennas. If NT < NR, the same happens in  the appropriate subdimensions of y. The name zero forcing is due to the fact that the  interference in each antenna is forced to zero. In a Euclidian signal space, the geo- metrical interpretation is that ZF projects the received vector onto the space that is  orthogonal to space where all the interferers lie  as illustrated in Figure 2.9 .  This generalized pseudo-inverse transformation for singular matrices holds proper- ties that are similar to the properties of the “true” inverse matrix of a nonsingular matrix   for an extensive description of the properties, see [Piziak and Odell 2007, Section 4.4] . Any solution to Equation 2.49 involving the inversion of h will imply a number  of operations that depends on the inversion methods used. The number of those  operations is given in [Piziak and Odell 2007, p. 170] and is listed in Table 2.3. The  common assumption in MIMO literature is that the number of operations involved   y  Zero-forcing  Matched ﬁlter  Subspace with the interferers  Figure 2.9  Geometric interpretation of ZF filtering in a signal space.      80  ◾  MIMO Processing for 4G and Beyond  Table 2.3  Number of Operations Involved in Solving y = Hx by Several  Methods Based on Channel Inversion  with a Square H   Gauss elimination with  back substitution  Gauss–Jordan  elimination  reduced  Echelon form   Cramer’s rule [Westlake  1968]  Inversion of H , when it  is nonsingular  Additions and  Subtractions  Multiplications and   Divisions  3 n  +  2  n  −  3 n  +  2  n  −  3 n  +  2  n  −  3 n  +  2  n  −  1 3  1 3  1 2  1 2  5 6  5 6  n  n   n + 1 !  n3 − n2  1 3  1 3  n  n  1 3  1 3   n + 1 !  n3 + n2  in ZF  or in any stage involving channel inversion  is O  rates that this is the case for all the inversion methods listed.   n3  and Table 2.3 corrobo-  2.5.2.1  Geometry of Zero-Forcing Detection As is mentioned in the previous section, ZF solves the CVP by relaxing it to a  search in a continuous neighborhood instead of computing the distance between  the received vector  also called the target  and every point in the lattice. The geo- metrical implication can be better understood thinking of the linear transforma- tion of the hypercubic Voronoi regions of  cid:27 n by h. The resulting regions are called  the ZF decision regions and correspond to the space where a lattice point will be  interpreted as being close to the lattice point associated with that region.  The decision regions associated with ZF criterion are simple to obtain as they  are the fundamental region R   H , as defined in Equation 2.6. Because the lattices  in MIMO are the Gaussian lattices defined in Section 2.3.1, the basis generated by  a channel may have some highly correlated vectors. Geometrically, this corresponds  to lattices with very narrow fundamental regions, which are generated by ill-con- ditioned matrices, that is, when one or more singular values are close to zero, and  consequently the volume of the lattice vanishes. Figure 2.10 shows the ZF decision  regions associated with the following equivalent bases:     h 1  =  6 2 1 5          and  h  2  =  6 8 1 6          .      2.56   Let us concentrate in the case where the transmit point was the origin. The  shaded areas indicate regions which will lead to wrong decisions when using the ZF       MIMO Detection Methods  ◾  81   a   10     2 n o i s n e m D  i  8  6  4  2  0  –2  –4  –6  –8  –10   b   10     2 n o i s n e m D  i  8  6  4  2  0  –2  –4  –6  –8  –10  ξ1  ξ2  –10 –8  –6  –4  4  6  8  10  –10 –8  –6  –4  4  6  8  10  0  –2 2 Dimension 1  0  –2 2 Dimension 1  Figure  2.10  Decision  regions  associated  with  the  two  different  bases  of  the  same lattice.  a  H1 and  b  H2.  technique: either because the point is inside the Voronoi region and outside the ZF  decision region or because the closest lattice point would be decided as being the  origin while the Voronoi region shows that to be false. It is possible to observe in  Figure 2.10 that different bases will output different decisions given a target point.  For the examples at a given SNR, the SER with h1 will be always lower, because  the coverage of the MLD  i.e., Voronoi  regions is larger than in the case of basis  h2. The notion of coverage is essential to understand MIMO detection [Su and  Kschischang 2007]. To simplify the operational meaning of coverage, [Ling 2011]  was introduced the notion of proximity factors dependent on the notion of the larg- est sphere that can be fitted inside the region of coverage. These spheres are also  shown in Figure 2.10 for the two basis, having decoding radii ξ1 and ξ2, respectively. Note that a receiver with a better performance is one whose decision regions better  approximate the shape of the regions associated with MLD, that is, with a better cover- age of the Voronoi regions. This is the central concept in the design of novel detection  techniques such as [Su and Kschischang 2007] and [Monteiro and Kschischang 2011].  2.5.2.2  Algebraic Analysis of ZF It is also possible to explain the behavior of ZF analytically. One starts by notic- ing that the covariance matrix of the noise affecting the decisions after any linear  transformation W is  for complex lattices      R  n  ,  W = =  Wn Wn  E    {  H WR W  .  n    } H  =  E  {  Wnn W  H  H  }      2.57       82  ◾  MIMO Processing for 4G and Beyond  The output SNR of ZF-detected vector  before slicing  at the ith layer is  ρ ZF i ,  =  x  R R n ZF ,  =  σ  2 x  I W R W  ZF  n    H ZF    , i i  ,  1  ≤ ≤  i  n .   2.58   For WZF given by Equation 2.52 and for the model with R n= σ 2 , this SNR becomes  I  x  R  n  x= σ 2  and with   I  H  h h h h h h  H  H      −   1  −   1    H H  H    h h h h h h HH  −   1  −   1  H  H  ρ ZF i ,  =          =  1  1    H  h h h h h h  H  −   1  − 1     H  −   1    H     1    1  ρ a  =  ρ a  =    , i i    , i i              H  H  −   1  − h h h hh 11  cid:31   cid:30   cid:29  cid:28  cid:28  I  I  H  −     1 h  cid:27  cid:28  cid:28   =  1 h h  H  [   −   1  ] i i ,  ρ a  ,  1  ≤ ≤  i  n .  ρ a  ρ a    , i i        i i ,     2.59           This expression relates the input SNR per transmit antenna with the output SNR  at each receive antenna and quantifies the noise enhancement that explains the poor  performance of ZF detection when deciding for   cid:22 x ZF. One may note in Equation  2.59 that the denominator  hH h −1 is the inverse of the Gram matrix g, that is, it  is the Gram matrix of the dual lattice, according to Equation 2.19. When this Gram  matrix is close to the identity matrix, that means the lattice is generated by some uni- tary matrix u  orthonormal in the real model , with uuH = uHu = I. In this case,  the interference between all layers is zero, and no noise enhancement will happen     in ZF detection. However, when the lattice is not orthogonal,      corresponds to the quadratic norm of the generators of the dual vector. According to  the interpretation given in Section 2.2.2, when these generators of the dual are large,  the lattice will have a narrow separation between the parallel hyperplanes where the  lattice points lie, and so have a small decoding radius. This brings together the alge- braic analysis and the geometrical interpretation.  The diversity order collected by the ZF is NR − NT + 1, as known since the early  papers on MIMO, however, the analytical proof of that was only later given in [Ma  and Zhang 2008].   =  H H  −   1    D ii  G  , i i  H  2.5.3  Minimum Mean-Squared Error Detection The other  and more sophisticated  linear receiver aims at finding the filter that  minimizes the mean-squared error between the estimated vector and the original  vector, that is, the filter should be      MIMO Detection Methods  ◾  83  W  MMSE  =  argmin W  E  Wy  −  x  {  } 2 .     2.60   This criterion does not aim at cancelling all the interference between layers as does  ZF. Instead, the MMSE criterion takes into consideration both the interference and  the noise in order to minimize the expected error. This minimization implies find- ing the point where the gradient of the objective function in Equation 2.60 is zero.  There is however a fast track to finding this estimator by applying the orthogonality  principle, well known in estimation theory and widely used in equalization problems  in the ISI channel [Haykin 1996, Section 5.2, Fischer 2005, Sections 2.2.3 and 2.3.4,  Madhow 2008, Section 5.6].* The optimum estimator for Equation 2.60 is the one  that produces an error vector Δ = WMMSE y − x that is orthogonal to received signal,  that is, the two vectors are uncorrelated  as illustrated in Figure 2.11 .  The minimum norm ‖Δ‖ occurs when W y  MMSE ⊥ ∆ , that is  E  {   W y  MMSE  −  H    x y  }  = 0   .  Applying this principle, WMMSE can be obtained from  using complex vectors   W  E W W W  MMSE ⇔ ⇔ ⇔  H  {  yy  MMSE  MMSE  MMSE  H  E  } +  xy H  − } {   HR H   R =  = R n x + H HHR H n x R H R  0     +  H     n  x  =  0  −   } E {   H x Hx = − 0 R H − .   H 1 HR H  H  x  x      2.61    2.62            y  x  WMMSEy  ∆ = x – WMMSEy  Figure 2.11  Orthogonality principle: the expected error is made orthogonal to  the space where the solution lies.  *  The principle is valid for in general estimation theory and can be derived in a Bayesian frame-  work for linear estimation [Kay 1993, Chapter 12, Poor 1994, Sections V-C, VII-C1].      84  ◾  MIMO Processing for 4G and Beyond  At this point most authors commonly invoke the matrix inversion lemma* [Kay  1993, p. 571, Haykin 1996, pp. 565–566], and immediately obtain from it one of  the two possible formulas of the MMMSE filter. That path is cumbersome and  eventually ends with an expression for WMMSE that is not even the expression that  is concluded from that derivation  although it will be proven later on that they are  equivalent . In the following is presented a derivation of the filter involving much  simpler algebra†:  W  MMSE  = = =  x  n  +  H  H  −   1  HR H R H R x + − 1 R H R I R HR H n − −   11 1 R H I R HR H n            n +  x H  H  H  H  x  x  x  −    1 − 1 R n   .      2.63   For the correlation models that were considered, Equation 2.63 is reduced to  WMMSE  =  σ  2 x  H    σ  2 n  ⋅ I H    − 1     ⋅  σ 2 x − 1  ⋅ I H σ σ  2 n 2 x  I  ⋅    H  ⋅ I H    H  =  H  H HH  H  +  =  H HHH  H  +   2.64   − 1  1 ρ a  I     .     It should be highlighted that the final expression in Equation 2.64 is not the  only one that appears in the literature. Just as often, one may encounter the follow- ing distinct version for the MMSE filter:  W  MMSE  =  H  H H  +     1 ρ a  − 1   I H   H  .      2.65   Expressions  2.64  and  2.65  are equivalent, although this is rarely men- tioned in the literature. The equivalence is a consequence of the following matrix  identity:           Theorem:  AB + I −1 A = A BA + I −1.  Proof. The identity‡ A BA + I  =  AB + I A holds because  *  The matrix inversion lemma,  A + BCd −1 = A−1 − A−1B dA−1C−1 −1 dA−1, is actually one of  the several variants of the Woodbury identity [Petersen and Pedersen 2008, p. 17]. Moreover,  the lemma is a particular case of the Hendersson–Searle formulas [Piziak and Odell 2007,  Section 1.2.1].  †  The steps taken here are mostly used when proving several of the Hendersson–Searle formulas. ‡  This  identity  can  be  seen  as  a  particular  case  of  one  of  the  Searle  identities  [Petersen  and   Pedersen 2008, p. 18].      MIMO Detection Methods  ◾  85     +  +    +  AB I A B    ⇔    AB I A =      = = + A ABA A BA I + +        A BA I BA I  cid:31   cid:30  cid:29   cid:28  cid:29  new term + + −            1 AB I A BA I BA I A + + + = − −         1 11 AB I A AB I  cid:31   cid:30  cid:29   cid:28  cid:29   cid:31   cid:30  cid:29   cid:28  cid:29  new new ++ −I  + .1 A BA  ⇔ = ⇔  AB I A  +     AA I  cid:31   cid:30  cid:29   cid:28  cid:29  new term + −     1 BA I +     AB I A BA I  ⇔  −   1  +  =           −   1      2.66            Similarly to Equation 2.53, the filtering matrix WMMSE is given by Equations   2.64 or by Equation 2.65,* and so the MMSE receiver can be described by  x  MMSE  =   cid:22  W y x  MMSE  ,  MMSE  =  Q  [  x  MMSE  ],      2.67   with the block diagram as the one in Figure 2.12.  It should be mentioned that, as shown in [Hassibi 2000], expression  2.67  is in   fact equivalent to Equation 2.53 if h is replaced by the extended matrix  H  =      H σ n NR 2  I  2  .          2.68   As it is often mentioned in the literature, a careful comparison of Equation  2.64 or Equation 2.65 with Equation 2.53 allows one to conclude that the MMSE  filter  tends  to  the  ZF  filter  at  high  SNR.  Therefore,  one  could  expect  a  similar  performance for both of them in the high SNR regime. However, it is well known   from very early on  that this is not true and this fact seems to be forgotten when- ever such comment is made. It was only in 2011 that the existing gap between ZF  and MMSE detection was characterized in [Jiang et al. 2011]. The authors finally  proved  for the ideal Rayleigh channel  several other assertions taken for granted  in the last decade for the ZF, MMSE, and SIC receivers based on ZF or MMSE  filters. Furthermore, analytical expressions for the BER for the correlated channel  have been devised in [Hong and Armada 2011]. In [Kim et al. 2008], the MMSE   y  WMMSE =   HHH + ρa  –1INT   –1HH  Slicing  ˆ x  Figure 2.12  MMSE receiver.  *  The simulations for the performance of the MMSE receivers to be presented at the end of this   chapter make use of Equation 2.65 adapted for the real equivalent model.      86  ◾  MIMO Processing for 4G and Beyond  receiver had already been analytically studied but only for low number of antennas   and also for the ideal Rayleigh fading channel .  For low SNR, the effect of interference is less important than the effect of the  Gaussian  noise,  hence  the  MMSE  filter  tends  to  hH,  which  corresponds  to  the  matched filter to that channel. In this case, the detection is treated as a maximum  correlation problem.  The covariance matrix of the noise after the MMSE transformation is  R  =  W R W  n MMSE  H  ,     MMSE  n MMSE ,    and, similarly to Equations 2.57 through 2.59, }        W n W n  n MMSE ,  MMSE    H  R  E  E  H  H  = = = =  {   {     {   {    E E  + H H + +  H H H H  H  H     MMSE ρ − −   1 1 I H n H H a ρ − −   1 1 I H nn H H H a ρρ − −   1 1 I H nn H H H a         +  H  H  H  H  H  H  H   2.69   ρ − − 1    1 I a + ρ − 1 I a + ρ − 1 I a  H  H n  −   1 −   1    H   H  }  H    } }  .   2.70      It is possible to show that the output SNRs at the ith layer after the MMSE   filter becomes  ρ , MMSE i  =  1 ρ + − 1 I a  − 1        , i i       H  H H  ρ a  ,  1  ≤ ≤  i  n .   2.71      It was seen before that the detection based in ZF is extremely problematic when  its decision regions become too long and narrow. This happens for channels that  are ill conditioned, with one or several of the eigenvalues very small in compari- son to the others. This means that the  hyper-  ellipse associated with the linear  transformation of an  hyper-  sphere is highly eccentric. In these cases, one may  consider penalizing the solutions to the problem that would imply having a large  norm for the detected  cid:22 x. One other way of interpreting the MMME solution is in  the context of the optimization problem generated from a relaxation of Equation  2.49. Following the proposal in [Jaldén and Ottersten 2006], one may generalize  the problem for binary symbols, to the problem with  M  symbols per dimension.  In doing this, the problem becomes equivalent to  y  MMSE  =  arg min ∈ A  x  y Hx  −  2  +  2  x  −  1 ρ a  s  N E T ρ a  }  ,      2.72   noting  that  for  x .  The  MMSE  criterion  in Equation 2.72 is attained by relaxing the search in  x ∈ A to a search in the   N E  ∈ ⇒  ρ − 1 a  A  +  E  0  x        T  s  } =  {  { ρ − 1 a  2               MIMO Detection Methods  ◾  87  continuous space where x ∈  cid:26 n . As the last term in Equation 2.72 does not involve  x, the minimization is also  y  MMSE  =  x  {  2 − arg min y Hx  cid:31   cid:30   cid:29  cid:28   cid:27  cid:28  n ∈  Squared   Euclidean   distance  +   cid:30  cid:29  cid:27  } 2x σ nn 2 Penalization   on longer   solutions      2.73   corresponding to the solution of the typical CVP but with a term that penalizes  large ‖x‖ and is proportional to the energy of the noise. This explains why MMSE  performs better than ZF for ill-conditioned channel realizations.  2.5.3.1  Projection Matrices Denoting h j  as the matrix obtained from h by deleting the  column  generator hj,  it is indicated in [Jiang et al. 2011] that Equation 2.59 can also be written as  ρ ZF j ,  =  =  =  j  j  j     H j  H j  H j  H j  −  −   1  h h   h I H H H  h H H H H h   ρ   a  h P h         ρ a  H     −  h  H j  H j  H j  H j  − 1  .  j  j  j  j     H  ⊥ j    j  ρ a   2.74      This expression can be better interpreted evoking the notion of projection matri- ces. A projection matrix is always  i  symmetric,  ii  idempotent  i.e., the successive  application of a projection, twice or more times, does not change the result , and   iii  positive semidefinite [e.g., Meyer 2000, p. 386].  Consider a linear space spanned by the columns of h, that is, span h . The pro- jection of a vector a onto that space is denoted as Projh  a , the projection onto the  space orthogonal to span h  is denoted as ProjH a⊥    , and they are given by [Piziak  and Odell 2007, Section 8.3]:  ProjH    a  H=  + P a HH a  =  ,     ProjH⊥      a  =  P a ⊥ H  =       . I HH a  −  +     From Equations 2.75 and 2.76, the projection onto the span    h j   is  P H j  =  H H  j  +   j   2.75    2.76    2.77                      88  ◾  MIMO Processing for 4G and Beyond  and the projection onto its orthogonal complement is  ⊥ = − P H j  + j  j  I H H    j  = −  I H H H  H j  j  −1     H  H j  ,      2.78      where the Moore–Penrose pseudo-inverse was used in the last line.  j  j  H  H  ⊥ j  ⊥ j  The factor h P hHj   that appears in Equation 2.74 is a quadratic form, as defined  ≥ 0 as it corresponds to the norm of the projec- in Equation 2.9, hence,  h P hHj tion of generator hj onto space spanned by the remaining generators in the basis h j . Figure 2.13 shows the geometry of these projections in the same bidimensional  example of Figure 2.10, with basis h2, given in Equation 2.56. One can observe that  the factor  h P hHj  corresponds to the distance between parallel layers where the  lattice points lie and it measures the separation between the decision thresholds for  the jth layer, associated with hj. When that distance is ≥1, there is an SNR gain in  that layer in respect to the SNR in the expected average layer. It is worth mentioning that in the case with ZF, h P hHj   has a χ2 distribution  with 2 NR − N + 1  degrees of freedom [Jiang et al. 2011]. A similar expression to   ⊥ j  ⊥ j  H  H  j  j  10 8  6  4  2  0  –2  –4  –6  –8     2 n o i s n e m D  i  HP  2  h2  h2  h1  span H  2     HP  1  h1  span H    1  –10  –10 –8  –6  –4  0  –2 2 Dimension 1  4  6  8  10  Figure 2.13  Geometry of the SNR relation factor in Equation 2.74. It includes  the Voronoi regions and the ZF decision regions of the lattice Λ H2 , as given in  Equation 2.56.      MIMO Detection Methods  ◾  89  Equation 2.74 can be obtained for MMSE if the factor     H H  −   1 in Equation 2.74.  a+ − ρ 1 I  j  H j  H  h hj  j  −1 is replaced by     2.5.4   Geometry of Optimally Ordered Successive   Interference Cancellation  As  mentioned  in  Chapter  1,  D-BLAST  was  the  first  scheme  to  be  proposed  by  Foschini. Given its detection complexity, V-BLAST ended up being the standard  architecture for SM. The detection algorithm first proposed in [Wolniansky et al.  1998] and [Golden et al. 1999] uses the principles of SIC, already known in ISI  control and MUD and is known as the V-BLAST detector  as mentioned, in this  chapter the name V-BLAST is identified with that particular detection method .  The general principle of SIC is that an initial “best” layer is detected and then,  assuming that the symbol was correctly detected, the interference caused by that  symbol is replicated and subtracted from all the other layers. The procedure is then  applied to the “next best” layer: one symbol more is detected, its interference recre- ated and then subtracted from the remaining ones.  One important question that arises is the one of determining the order of detec- tion of the NR antennas. For a MIMO n × n system, one has to find the optimum  permutation Π k  of the column indexes {1,2, . . ., n} that minimizes the SER amid  all  the  n!  possible  permutations.  An  exhaustive  search  over  all  the  permutations  would rapidly become unbearable as n increases. The optimal solution to this prob- lem was found early on in [Wolniansky et al. 1998] and [Golden et al. 1999], in the  first implementations of the V-BLAST detector.  The optimal criterion at each stage is to select the layer that less emphasizes the  noise power after a ZF or an MMSE filter. Consider the following example  for one  an alternative example see [Windpassinger 2004]  with input data x = [ 1 1 1 T   and a noise vector that does not induce an error in the MLD sense, that is, that does  not take the point out of its Voronoi region:  ]  y =        − 0 3 . 2 4 . − 1 28 .        =   − 0 97 0 48 . .  0 12 1 35 . .   − 1 2 1 04 . .   cid:31   cid:29  cid:29  cid:29  cid:29   cid:30  H   0 31 .  1 43 .   −− 1 94 .   cid:29  cid:29  cid:29  cid:29   cid:28         x 1 x x  2  2        .      + −        cid:31  cid:30  cid:28   0 5 . 0 5 . 0 5 . n      2.79   Considering that ZF is used,  W      1 ZF  =  +  H  =  − 1 0296 . . 0 5980 . 0 9219        . 0 2954 0 8239 . . 0 35 112     . 0 3823 . 0 5118 . 0 4039        ← ← ←  2  2  2    ,:  1 w 1   ,:  2 w w ,,:  3    1  1  = = =  . 1 2936 . 1 2983 . 1 1363 ,    −  where the energy of each row in the filtering matrix is indicated on the right.            90  ◾  MIMO Processing for 4G and Beyond  The lowest noise enhancement factor is the one associated with the third row   i.e., the third layer , so this third symbol is decided via a decision threshold to the      1 alphabet as*   cid:22 x Q A WZF y  Next, the effect of that symbol, after, is sub- tracted from the other layers:  3      1 .  =  =  ]  [     2     y  =  y H  −   :,   3   cid:22  x      3  =  y  −  0 31 . 1 43 . − . 1 94              1  =  0 01 . 0 97 . . 0 66              .  The third generator vector in the channel matrix is now nulled:  2     h   =        − 0 97 0 48 0 . . . 1 35 0 12 0 . − 1 04 0 . . 1 2  ,        and the associated ZF matrix is now      2 WZF  =  − . . 0 2185 0 6045 0 0270  0 0837 . 0 6279 0 7371 .     . .  0  0  0        ← ww ← w  1   ,:  2   ,:   2  2  2  2  = =  0 4139 . 0 9446 . .  At this stage one observes that the first row is the one that less enhances the  noise and thus x 1   i.e., the element transmitted in the first layer  is now decided as   cid:22 x  1  Q[   and its interference subtracted from y 2 : 1  =  =  y  ]  2           2   WZF      3  y  =     2     y  −  H   :,   1   cid:22  x      1  =  . 0 01 . 0 97 . 0 66              −  − 0 97 . . 1 35 − 44 1 0 .              1    = −     . 0 98 . 0 38 . 1 70        .  Now, the first generator of h is zeroed  3 h     =  0 0 48 0 0 0 12 0 0 0  . . . 1 2                             *  The notation is slightly abused, as the quantization is applied only to the third element of      1 y. Moreover, some Matlab will be used to denote matrices rows and columns.  WZF      MIMO Detection Methods  ◾  91  and the corresponding pseudo-inverse is  W      3 ZF  =  0.2849 0.0712 0.7123  ←  w  2    ,:  2  2  =  0.59366.        0  0  0     0     0  0                 =  =  [  ]  y      3  1 ,      2      3 Q WZF  Finally,  cid:22 x  that is once again a correctly detected symbol. The ordering strategy described in this example by means of algebraic argu- ments is in fact is a direct application of a fact that, until the paper by [Wolniansky  et al. 1998], was known as a rule of thumb in the MUD literature, but whose opti- mality had never been proven. The rule consists of selecting at each step the vector  that minimizes noise enhancement and in [Wolniansky et al. 1998] the authors  pointed out that the SNR at layer i is  ρ i  OSIC = ,  ]  E x [ 2 i =∑ N T  l  1  w 2 i  σ  2 n  =  E x [ 2 n  ] , 2 i 2w i  σ      2.80   and used Equation 2.80 to justify the optimality of the criterion.  In the following, it is shown that further insight concerning this optimization  process can be enlightened, and indeed proven to be optimal, if a geometric perspec- tive is applied using the projection tools introduced in Section 2.5.3.1 and using the  geometric ideas of the Babai nearest plane algorithm [Babai 1986, Micciancio and  Goldwasser 2002, Chapter 2] in algorithmic number theory, which corresponds to  SIC in MIMO, as first noticed by [Agrell et al. 2002] and [Mow 2003].  To minimize the error probability when deciding layer j, the generator vector hj  has to be selected at any given decision step k, with k ∈{1,2, . . ., n}, should be the  vector that maximizes the projection onto the orthogonal space to the space spanned  by the matrix that remains after that same vector is taken out from h.  The initial step is to find the column vector h1 that, when removed from h,  transforms h into  h1  as  h j  denotes the matrix that is obtained from h after  removing  column  j .  h1  is  the  generator  of  an   n − 1 -dimensional  lattice  Λn−1.  Hence, the original lattice can be written in the form  Λ Λ=  −n 1  +  i  1h ,  i  ∈  , cid:27      2.81   signifying that Λ can be created from the union of translates of the Λn−1 sublattice. Once a decision is produced for one layer, the subsequent step is to repeat the  process, now in the sublattice with basis h j , that is, by removing generator hj from  the set. The process repeats itself until a decision is made in a one-dimensional lat- tice, corresponding to the decision of the last layer to be detected.      92  ◾  MIMO Processing for 4G and Beyond  Figure 2.14 depicts SIC applied to a lattice partitioned as in Equation 2.81. In  a first stage, the nearest hyperplane is found and a decision for the layer associated  to hj is produced. In a second stage, depicted at the bottom of Figure 2.14, the same  procedure is applied but now conducted in the sublattice Λn−1.  Figure 2.15 shows the SIC decision region for the origin of the lattice with basis     h =  3 1 1 3          .      2.82   The example shows a target point located in a region where SIC outputs an  erroneous decision. The first SIC step in the example in Figure 2.15 is to select  which plane is the nearest one to the target point. In the example, SIC would  decide for plane 1 while the Voronoi region indicates that the correct point lies in  plane 2.  The diversity attained by SIC is NR − NT + 1 and sorting the layers does not  contribute to any improvement in this respect, as recently proven in [Jiang et al.  2011]. Sorting can only yield a power gain in SM detection.  span H    j  1st: select this  hyperplane  Proj hj   hj  –hj  span H    j   n – 1 -dimensional  2nd: select among the  n – 2 -D hyperplanes  hj+1  Figure 2.14  The nearest plane algorithm with sorting. Choosing the jth genera- tor vector that maximizes the distance between parallel hyperplanes. The lattice  is the union of such translates.      MIMO Detection Methods  ◾  93  h i c  e   1    w  n  P l a  e  s  e   c l o  h  h  i s t  s t  p  e  s  e   c l o  h  e  t  r  e  h     e  n  s t  p l a  s    t li e  o i n     2 n o i s n e m D  i  Maximum distance between  planes  Target  e   2    w  n P l a Closest  lattice point  8  6  4  2  0  –2  –4  –6  –8  –8  –6  –4  –2  0  2  Dimension 1  4  6  8  Figure  2.15  Error  events  in  SIC.  Plane  1  is  selected  because  it  is  the  closest  plane, however, the closest lattice point lies in plane 2. The SIC decision region  for the origin is shown.  The decision regions associated to SIC are hyper-rectangular and it is not dif- ficult to perceive  e.g., from Figures 2.14 and 2.15  that these decision regions are  unequivocally  defined  by  the  Gram–Schmidt  vectors  on  the  basis  of  the  lattice  [e.g., Ling 2011].  The fastest implementation of the original OSIC idea was provided in [Shang  and Xia 2008] and was made cubic in n, that is, with complexity O   n3 , nevertheless  other O   n3  algorithms were known for OSIC much before  c.f. [Windpassinger  2004, p. 39] and references therein . Ling et al. also proposed an OSIC algorithm  with O   n3  complexity based on the geometric insights offered by the dual lattice  [Ling et al. 2006, 2009]. In doing that, the same optimal ordering known for OSIC  [Golden et al. 1999] is proven and the same performance is attained without need- ing a matrix inversion for each layer to be detected. This approach makes use of the  shortest vector in the dual basis at each detection step.  One can now formalize SIC in a very concise manner; the hth index for the   permutation is then selected from     Π    k  =  argmax  j  ∈ A k  T h j  ,  hHProj       j  ⊥ j            ,      2.83       94  ◾  MIMO Processing for 4G and Beyond  where Ak is the set of columns that have not been chosen yet. From Section 2.5.3.1,  Equation 2.83 becomes     Π    k  =  argmax  j  ∈ A k  { h T j  −  I H H H  T k j ,  T k j ,     −   T H1 k j ,  k j ,     h  j  }  ,      2.84   which is a very concise expression that summarizes the entire OSIC with optimal  ordering  [Trujillo  et  al.  2009].  Starting  with  A1 = {1,2,  . . .,  n}   i.e.,  with  all  the  columns of h , the set Ak is reduced by one element each time a column is selected,  and continues until only one is left. Although concise, this formulation for finding  the permutation Π  k  does not lead to a practical implementation.  There is however a very elegant way of finding Π  k  remembering that the dis- tance between hyperplanes in the primal lattice is established by the lattice points  in the dual  as proved in Chapter 2 . Selecting the smallest basis vector in the dual  basis ensures that the decision for that layer will be made from selecting between  the  most  distant  hyperplanes  associated  to  that  specific  basis.  Nonetheless,  it  is  important to highlight that these are not necessarily the most distant hyperplanes  in the lattice. This observation confirms why there is room for improving a receiver  based on the OSIC principle.  It is thus natural to look for short vectors in the dual lattice rather than search- ing among the generators constituting the basis. Shorter vectors in the dual lattice  would maximize the distance between the parallel hyperplanes and thus minimize  erroneous decisions. Finding shorter vectors in the dual lattice is accomplished by  means of lattice-reduction-aided  LRA  techniques, which will be presented later.  Lattice reduction provides an equivalent basis with shorter  and more orthogonal   generator vectors.  It is noteworthy that the geometric interpretation presented in this section  also sheds light on the finding by Taherzadeh et al. that reducing the dual matrix  is preferable to reducing the primal basis [Taherzadeh et al. 2007, Taherzadeh  2008].  2.5.4.1   Gram–Schmidt Orthogonalization and QR   Decomposition  The  Gram–Schmidt   GS   orthogonalization   Algorithm  2.1   is  a  well-known  method that takes one set of generating vectors of space and obtains another set  of vectors that span the same space but which are all mutually orthogonal. Notice  that although the new basis spans the same continuous real  or complex  space, it  does not span the lattice. In general, the GS vectors are not members of the lattice  and therefore cannot be members of any of its bases. Finding a basis that is close to  orthogonal while still spanning the same discrete space is the much more difficult  problem of lattice reduction, which will be described in Section 2.5.5.      MIMO Detection Methods  ◾  95  n  1  H  ,...,  H q q n  H q q 1  = diag   The Gram–Schmidt vectors process can create a matrix q, with all columns  mutually orthogonal, that is, Q Q   . However, it is possible  to make its column vectors orthonormal, that is, qH q = I and ‖qi‖ = 1. The two  sets of vectors of the two versions are obviously related by the respective norms. The  matrices that perform the transformation of the original matrices to the orthogonal  or orthonormal forms are triangular in each of the two cases. The relation between  the two triangular matrices is less obvious, though important in the MIMO context. The orthogonal version is  i  relevant in lattice reduction techniques such as the  LLL algorithm, and  ii  an essential tool in the interpretation of SIC. However, the  orthonormal form of GS orthogonalization corresponds to the QR decomposition  and is  i  much used in sorted or unsorted OSIC detection, and  ii  central to SD.  Algorithm 2.1 computes the set of orthogonal vectors as  h  j  =  h  j  −  h k  =  h  j  −  µ  h  k  .  j k ,   2.85   j  − 1  ∑  k  = 1  h h , j k h h , k k  j  − 1  ∑  k  = 1    In matrix form, the original column vectors can be related with the GS vectors by       h h h 1  2  3   cid:31   h  n   =     cid:31  h h h 3 1 n  cid:30   cid:29  cid:28  cid:28   cid:27  cid:28  cid:28   h  2  Orthogonal but not orthonormal collumns     1 0 0 0 0           µ 2 1 , 1 0 0 0  3 1 ,  µ µ 3 2 , 1 0 0  1 ,  2 ,  3 ,  n  µ  cid:31  µ  cid:31  n µ  cid:31  n  cid:26   cid:25  1 0              .   2.86   Algorithm 2.1: gram–schmidt Orthogonalization  ,..., h n ∈ ] h n  n∈ cid:23  n cid:23   and coefficients µ j k, ∈ cid:23   1  [  =  Input: linearly independent vectors  h h , 2 Output: Orthogonal basis H h h ,..., , 1= h h 1 for j = 2:n j=   h h    2  1  j    µ j k  for k = 1:j –1 h h k −  , =    h  =  h  j  j  j  ⋅ ⋅        h k h k n ∑ µ ,  k  = 1  ⋅  h  k  j k    end end      96  ◾  MIMO Processing for 4G and Beyond  h  Note that det    ,  as the upper triangular  u.t.  matrix has unit deter- minant. An orthonormal basis can also be constructed from the GS vectors if they  are normalized:  det   h     =  GS orthogonalization can also be used to compute the QR decomposition of a   channel matrix as  q  j  =  ,  j  =  , 1 2  ,...,  n .  h h  j  j     h = qr,    2.87    2.88   with q orthogonal and r upper triangular  u.t .  To compute Equation 2.88, one starts by computing the GS vectors using  h  j  =  h  j  −  ,  j  =  1 2 … ,  ,  ,  n .   2.89   N  ∑ , h q  j  k  k  = 1     Moreover, each of the n vectors of the original basis h can be expressed in terms   of the orthonormal vectors qj as  h  j  =  h q q  ,  1  j  1  +   cid:30   +  , h q  j  j  − 1  q  j  − 1  +  h q  j  .  j      2.90   This relation can be conveniently written in matrix form as  [  h h h 1  2  3   cid:31   h  n  ]  =   q    cid:31  q q q n 1 2 3  cid:30   cid:29  cid:28  cid:28   cid:27  cid:28  cid:28  Q  with orthonormal columns            h 11 0 0 0 0  1  , h q 2 h 2 0 0 0  1  2  , h q 3 , h q 3 h 3 0 0   cid:31   cid:26  0  Since det q  = 1, the volume of the lattice is the product of the orthogonal vectors  vol   Λ =     n  ∏ h  cid:22   i  = 1  ,     which corresponds to the volume of the hyper-rectangular decision regions in SIC.  1  2  3  , h q n , h q n , h q n  cid:25  h  n  .            2.91    2.92                           MIMO Detection Methods  ◾  97        A comparison of Equation 2.85 with Equation 2.89 reveals that  µ j k k h  ,  =  , h q  j  k  =  Projq  k     h   ,  j      2.93   each of which is the projection of the original generator vector onto the one-dimen- sional space spanned either by qk or hk.  2.5.5  Lattice-Reduction-Aided Detection As was exemplified in Figure 2.10, the two bases given by Equation 2.56 generate  the same lattice but their fundamental regions have different coverage. To maxi- mize the coverage of the MLD region, one is interested in bases with vectors that  are both short and close to orthogonal, which is called a reduced basis. Figure 2.16  shows a lattice with a rather “skewed” basis and a reduced basis.  It was seen in Chapter 2 that two different bases of a lattice are related by a uni- modular transformation M. In particular, the two basis in Equation 2.56 are related by  H 1  =  H M  2  ⇔  6 2 1 5        =   6 8 1 6              1 1  , 0 1       2.94   and in this case it is easy to see that det  M  = 1.  As observed in Section 2.5.2.1, it is preferable to invert a well-conditioned chan- nel matrix, and therefore having a more orthogonal basis contributes to a smaller  noise enhancement factor whenever a ZF or an MMSE filter is applied  standalone  or included in the OSIC stages . In LRA receivers, a preprocessing stage is intro- duced before the detection algorithm, as shown in Figure 2.17.  The  application  of  lattice-reduction-aided   LRA   techniques  to  MIMO  detection was first brought to light in [Yao and Wornell 2002], and since then  the research in LR applications to MIMO has boomed not only for the detec- tion but also for precoding in the BC  as mentioned in Chapter 1 . These authors   b2  b2  b1  0  b1  Figure 2.16  A reduced basis  with short vectors  and a skewed basis  with longer  vectors  for the same lattice.      98  ◾  MIMO Processing for 4G and Beyond  Λ  Lattice reduction  preprocessing   Λ red  Detection algorithm  xˆ  Figure 2.17  MIMO detection with lattice-reduction preprocessing.  applied  the  Lenstra  Lenstra  Lovász  reduction   LLL,  also  sometimes  denoted  as  L3   [Yao  2003]  to  reduce  the  channel  matrix.  In  2007,  Seysen’s  reduction  was simultaneously rediscovered for MIMO in [Seethaler et al. 2007] and in  [Niu and Lu 2007]. This technique is based on the simultaneous reduction of  both the primal and dual basis. One other important lattice reduction approach   LR  that delivers a more reduced basis than the others is the Hermite–Korkin– Zolotarev   HKZ   reduction  [e.g.,  Banihashemi  1997,  Chapter  3];  however,  HKZ has not been used in MIMO until recently in [Zhang et al. 2012], prob- ably due to its high complexity. The quality of the output of an LR algorithm  can  be  measured  by  the  orthogonality  defect,  defined  as  [e.g.,  Micciancio  and  Goldwasser 2002, p. 131]  n  ∏ = = i 1 det   h  i    .  H     OD     H      2.95         Shorter  generator  vectors  correspond  to  a  lower  orthogonality  defect.  Clearly,  OD h  ≥ 1, with equality attained only by the  cid:27 n lattice.  An  overview  of  the  applications  of  lattice  reduction  techniques  in  MIMO   including SM and BC  exists in [Wübben et al. 2011]. LRA detection achieves the  maximum diversity available in SM, as proved in [Taherzadeh et al. 2007]* for the  case of LLL reduction.  Seysen’s algorithm and HKZ also achieve that maximum  diversity since, on average, they output bases even closer to orthogonal bases.   The idea is that the system model can be rewritten as  y Hx  =  + ⇔  n  + ⇔  n  H z red  +  n  .   2.96    cid:21  cid:21 1 HM M x H red  − z     In this model, z is a modified data vector that can be detected with a lower SER  than would x without LR. This is true regardless of the type of receiver that follows   *  The same result was also proved in [Ma and Zhang 2008] for the complex-LLL algorithm   CLLL , where the real equivalent model is not used and LLL is applied directly to the complex  lattice.      MIMO Detection Methods  ◾  99  the LR preprocessing  usually ZF, MMSE, or OSIC . The original data vector can  then be recovered from z noting that  −1 z M x  =  ⇒ =  x Mz  .     2.97   Because M-QAM constellations and their PAM equivalent alphabets are defined  without the origin and have nonunitary distance between the symbols  c.f. Section  2.3.1 , in order to apply the lattice tools as in Equations 2.96 and 2.97, it is neces- sary to make a translation of the constellation, creating the modified received vector  y  red =       y H 1  +  ⋅  =     Hx  +   , n H 1  +  ⋅     1 2  1 2   2.98   where 1 is the column vector of n elements all equal to 1. This latter modification   2.98  applies to real lattices only and its extension to complex lattices is described  in the next section.  Now, in the case of a ZF criterion,  and in performing  z H yred  =  +  red,     cid:31  x  =  2 Q  cid:30  cid:29     M z  −  , 1   cid:31  z      2.99    2.100               the symbol  cid:22 z is detected and put back in the alphabet A.  The LLL algorithm was first derived for integer lattices and then applied to  real lattices. It has also been shown that a complex-LLL  CLLL  algorithm can be  defined and that by applying it directly to a complex hc  see the next section , the  complexity becomes half of the one involved in the application of Algorithm 2.2  to the real equivalent lattice [Mow 2004, Gan et al. 2009]. The LLL algorithm  can be seen as an extension to higher dimensions of Gauss’s algorithm [Micciancio  and Goldwasser 2002, p. 28], which operates in two dimensions only  c.f. exam- ple in Figure 2.18 . It is also noteworthy that the LLL algorithm can be derived  by making appropriate changes to the GS orthogonalization  Algorithm 2.1 , as  shown in [Fischer 2010] and is also closely related to sorting in OSIC [Ling and  Mow 2009].  Ling et al. proved that the complexity of the LLL reduction is O    not only  for integer lattices [e.g., Park et al. 2011] but also proved that for Gaussian lattices  [Ling et al. 2013]. They further proposed a change to the algorithm that maintains a  similar performance while having complexity O   It was shown in [Jaldén   log    .  n log    n  n  n  4  3      100  ◾  MIMO Processing for 4G and Beyond  Algorithm 2.2: lenstra lenstra lovász  lll   , Input: a basis h with generator vectors  h h Output: a ζ-LLL reduced basis hred hred, a unimodular matrix M 1:  Preliminaries   ,...,  h  2  1  n  n∈  cid:23   in its columns  , Compute the GS orthogonal vectors h h Set M = In  1  ,...,  h  n using Algorithm 2.1  2  2:  Reduction step   for i = 2 to n    for j = i − 1 down to 1           −  =  h  h  i  i  j  j  j  , h h i , h h      , h h i , h h  j  j  j  h  j       m  j  m  i  =  m  i  −  3:  Swap step   i  h  swap columns hi and hi+1 swap columns mi and mi+1  if there is i such that ζ       go to 1 end  4: return h1, h2, . . ., hn and M    end recompute the GS orthogonal vectors h h ,  1  ,… n using Algorithm 2.1 ,  h  2  2  >  h  i  ++ 1  µ i  h  i  + , i 1  2   then  et al. 2008] that for some instances of lattices, the complexity of the LLL algorithm  for noninteger matrices is not polynomial but that probability tends to zero.  2.5.5.1  Complex Lattice Reduction Lattice reduction can also process directly complex numbers  i.e., the constellation  symbols in the antennas  rather than using the real-valued equivalent model intro- duced in Section 2.3.2. Let us now reconsider a complex-valued transmission model     y  c  =  H s c  c  +  n  c  ,     2.101       MIMO Detection Methods  ◾  101  1st step: Replace b2 by b2 – b1 which gives us b2 2nd step: Replace b1 by b1 – b2 which gives us b1     2 n o i s n e m D  i  0  Startb2   b2  1st step  b1  2nd step  b1  Dimension 1  Figure 2.18  The Gauss algorithm  i.e., LLL in 2D .  such as in Equation 2.21, where hc is the NR × NT complex channel matrix, s is  the NT × 1 complex column vector whose elements are the complex-valued sym- bols transmitted on the NT antennas and n is the NR × 1 complex column vector.  Assuming that the transmitted symbols are drawn from a constellation isomorphic  ∈  , through  to a subset of the Gaussian integers  denoted as  cid:27  shifting and scaling operations  e.g., M-QAM constellations  one can write  a b ,  [ ] j  bj   cid:27   +  =  a  }  {  :  s  c  =  α  x  c  −        1 2  +  1 2  j     I  N T  ,         2.102   where xc is the NT × NT identity matrix. One can rewrite Equation 2.101 as  ∈  cid:27  [ ], α represents the factor used for energy normalization, and INT    NT  j  c  =  α   y H x  c α H x c  =  c  =  H x c  c  −  n  c    + ++  n  c    1 2  −  c  −    1 2     1 2  +  1 2  j     I  N T  +  1 2  j     α H I c N T  +  1 2  j     H n  +  c  c  ,   2.103      h  c  h  = α .    c   2.104            where      102  ◾  MIMO Processing for 4G and Beyond  A complex-valued lattice in the NR-dimensional complex space  cid:26 N R  is therefore   defined as    or in matrix form,  Λc  =       N T  ∑ h x  i  i  i  = 1  :  x  i  ∈ [ ]  cid:31  j  ,  h  i  ∈   cid:30   N  R  Λc  =  { Hx  :  x  c  ∈   cid:31   N T  [ ] j  ,  H  c  ∈   cid:30   N N T  R  ×       ,     }  ,      2.105    2.106            From Equation 2.103, it is easy to realize that, apart from the shifting opera- tion, the received vectors correspond to noisy versions of the lattice points defined   cid:22  by the basis hc. One is interested in the estimate  w H x  which is closest to the  shifted received vector  y  Let   cid:31 hc be a new basis for the lattice obtained by right multiplying the original   cc .Λ c  = c ∈  ∀   cid:22  w  w  w  −  ≤  −  y  basis by a unimodular matrix u containing only Gaussian integers, that is,   cid:22   ,  c  c  c  c  c  c   cid:31 h  = U,  hc  c   2.107   the received vector can be rewritten as  y  c  =   cid:31  − 1 H U x  c  c  −     1 2  +  1 2  j      cid:31  H U  c  − 1  +  n H z c c  =  c   cid:31   −     1 2  +  1 2  j      cid:31  H U  c  − 1  ++ nc,       2.108  with zc = u−1 xc. Because u is unimodular, the elements of zc are also Gaussian  integers. If the new basis has a smaller orthogonality defect, the performance of the  detector gets improved. The complex LLL algorithm  CLLL  was proposed in [Gan  et al. 2009] and outperforms the real LLL both, attaining smaller orthogonality  defects while further reducing the complexity. It can also be combined with the  linear receivers and with OSIC to accomplish the decoding. Note that the MMSE  criterion can be applied as if it was a ZF detector by using an extended system  model approach [Wübben et al. 2003, 2004]. The extended channel matrix and the  extended received vector are  considering α = 1 for simplicity   H  c  =       H c σ 2 I  N T       and  y  c  =  y  c  0  N T  × 1      ,          2.109   where 0NT ×1 is an all zeros size NT column vector  note that in Equation 2.109 one  has a complex model while in Equation 2.68 the real complex model was consid- ered, hence the  2 . As suggested in [Wübben et al. 2004], one can apply LLL       MIMO Detection Methods  ◾  103              reduction to the extended model and in this case the reduced basis   cid:31 hc can be “QR  decomposed” as   cid:31 H  c =  QR  .     2.110    The  extended  received  vector  is  multiplied  by  qT  and  added  to  1  2  NT  to allow rounding over  cid:27 [ ],j   resulting in  RU I−1  1 2+   j   cid:29 y Q y  =  T  c  c  +     1 2  +  1 2  j     − 1 RU I  N T  =  Rz Q  +  c  T       −  n c σ 2 I  x  c  N T       ,      2.111   where the second term takes into account both noise and residual interference. Since  r  is  triangular,  one  can  start  by  computing  the  estimate  of   cid:22 zNT   as   cid:29 y   where   cid:29 yi and ri,j represent elements of   cid:29 y c  and r, respectively, drop- r N N T, N T ping the c subscript  and then proceed to obtain the remaining elements through  the successive application of  T  The function “round  ” corresponds to standard rounding to the nearest Gaussian  integers  as  proposed  in  the  conventional  SIC  algorithm  [Babai  1986].  The  final  transmitted vector estimate can then be achieved through shifting and rescaling as   cid:22  z i  =  round  y  cid:22  i  −  r z  cid:22  , i j  j  N T  = +∑ r i i ,  i  j  1            .      cid:22  s  c  =  α   cid:22  Uz  c  −        1 2  +  1 2  j     I  N T     .      2.112    2.113   As the decoding is performed assuming an infinite lattice, it is necessary to  restrict the estimate to a valid constellation vector  this can be accomplished apply- ing the restriction to Uzc cid:22   .  2.5.6  Randomized Lattice Decoding Lattice-reduction-aided decoding can achieve full diversity in MIMO transmissions,  although its performance gap to ML decoding depends on the detection algorithm  employed and on the dimension NT [Ling 2011, Liu et al. 2011]. In fact, while LLL  lattice-reduction-aided MMSE detection can achieve near ML performance for small  MIMO systems [Wübben et al. 2004], the performance gap widens as the dimension  increases [Liu et al. 2011]. To narrow down this gap, a randomized version of SIC was  proposed in [Liu et al. 2011], and based on [Klein 2000], leading to impressive per- formance results. In the following, a description of this algorithm will be presented.      104  ◾  MIMO Processing for 4G and Beyond  In  the  SIC  algorithm  described  in  the  previous  section,  standard  rounding  to the nearest Gaussian integers was applied in Equation 2.112. Instead, we can  replace the standard rounding by Klein’s randomized rounding [Klein 2000]  see  Algorithm 2.3  and implement a randomized lattice decoder. In this case, we com- pute the elements zi cid:22   using   cid:31  z i  =  randround  c  i   2.114    cid:30  y i  −  N T  = +∑ r , i i  i  j  1  r z  cid:31  , i j  j            .     where function randroundc r  rounds the real and imaginary parts of r  denoted as  rre and rim  to integers qre and qim, respectively, according to the discrete Gaussian  distribution defined as   2.115    2.116    2.117    2.118   for the real part and  P Q q    =  re     =  −    c r re  −  q re     e +∞∑  q  e  =−∞  −    c r re  −  q re        P Q q   im  =     =  −    c r  im  −  q im     e +∞∑  q  e  =−∞  −    c r  im  −  q     im     for the imaginary part, and the parameter ci is computed as    with ρ being another parameter whose optimum value is obtained from     j  c  i  =  ρ   log    r min , 2 j  j     r 2 , i i  K  =    e  NT 4 ρ ρ    ,     where K is the number of candidate lattice points that are considered in the algo- rithm. The candidate list is built by repeating K times the procedure for comput- ing a lattice point with Equation 2.114. If the transmission is uncoded, the final  estimate will then correspond to the closest of the K lattice point candidates. Due  to  the  randomized  nature  of  the  algorithm,  to  avoid  the  possibility  of  the  final  estimate being further away than the one produced by the MMSE-SIC decoder,  one of the K candidates should be obtained through standard rounding. The final  transmitted vector estimate is computed using Equation 2.113.                  MIMO Detection Methods  ◾  105  Algorithm 2.3: randomized decoding  Inputs:   y c, hc, K, δ, ρ  the variable 1 2 < δ ≤1 selects the complexity perfor-  mance tradeoff of the CLLL algorithm   Output: s cid:22  1  2  3  4  5  6   _  H  ← Complex LLL c δ   , ← QR Decomposition   Q y      cid:31  c H −   1 RU I  1 2    +  j  T  _ +   cid:31 hc, U q, R  cid:29 y ← 1 2     c for k = 1 to K do      for i = 1 to NT do    if k = =1  c  N T   cid:31  z 1 i  ←   Round y  i   N T  ∑ cid:30  −  j  = + 1 i   cid:31  r z i j ,  1 j  r i i ,      c  i  ρ   ← log   , min  r 2 j j  r 2 i i ,  j  ˘ z k i  ←  randRound  c  i      N T  ∑ cid:29  − y  i  j  = + i 1  ˘, r z i j  k j  r i i ,      Closest Vector  _   cid:22  Uz  c  −     1 2  +  y    1 2  +  c    1 2  j     I  N T     +  1 2  j   cid:22  H z  ,  c  1  … , ,  K   cid:22  z        7   8   9      10  11  12  13   14   15     else                                    end if   end for end for  cid:22  z  ←  c  c   cid:22  s  α  ←    Return  cid:22 sc  2.5.7  Sphere Decoding SD is an exact detection method  i.e., it achieves the same performance as MLD   with a complexity that, on average, is much lower than MLD. The idea is that a  rigid rotation q can be applied to the ensemble {Λ, y} , for which the CVP needs to  be solved, so that the lattice can be described by an equivalent lattice in u.t. form.  The u.t. property allows describing the norm of any lattice point to be detected as  a sum that can be computed incrementally, taking into consideration the cumula- tive effect of each vector components. Consider now that an upper bound  UB  on       106  ◾  MIMO Processing for 4G and Beyond  the norms is established. The u.t. property of the basis allows all the possible values  in the last component of the data vector, x n , to be detected. As the norm can be  computed as a sum of “ordered” contributions, if some of the tested values in x n   generates a total vector norm that is larger than the UB, then those values of x n   need not be considered further as possible values in the solution. This procedure  can be extended to the next layer x n − 1 , where only the possible values of x n   are considered. In conclusion, finding vectors with norm smaller than the UB is  a problem that can be solved by expanding and pruning a tree that represents the  lattice points. All these ideas can be converted into the CVP, if the lattice is shifted  to the target y.  A sphere decoder has the structure shown in Figure 2.19. After traversing  the  tree  with  a  particular  symbol  enumeration,  the  MLD  solution  is  always  found  if  the  initial  radius  that  is  chosen  is  large  enough  to  contain  a  lattice  point inside the hypersphere. Figure 2.20 gives an example tree associated with  3 × 3 antenna and 4-PAM, showing the branches that have been expanded at  each tree level.  As mentioned previously, one can define an UB for the radius  or, equivalently,   for the squared radius  of the sphere around the received point, that is,     y Hx  −  ≤2  2ξ ,     2.119   y  H = QR  Tree  exploration  xˆ  Unitary matrix  rigid rotation   Upper triangular  Figure 2.19  Receiver based on SD.  –3  –1  +1  +3  +1  +1  Closest vector  Figure 2.20  Tree exploration of a tree with three layers, considering a 4-PAM  alphabet.      MIMO Detection Methods  ◾  107  y Q Q  −  [  1  ]  2  2  R 0          x  ≤  ξ  2  .      2.120               Applying the inverse rotation qH  remembering that q is unitary, or orthogo-  nal in the real case ,  2  Q Q  H 1 H 2        − y   R 0          x  ≤ ⇔  ξ  2  Q H 1  y Rx  −  2  +  2  Q y  H 2  ≤  ξ . 2   2.121      If one defines   ′ =y  yQ H  1  ξ  and   ′ = ′ − 2  ξ  2  Q yH  2  ,  then the CVP can be writ-  2  ten as  Finally, remembering that r is u.t., the problem can be written as the sum  y  ′ −  Rx 2  ≤  2ξ .    m   ∑ y    = 1  i  ′ − i  m  ∑  j  =  i  2   ≤ r x j     ij   2ξ  .      2.122    2.123   The complexity of SD is usually measured by the number of nodes that need to  be visited in the tree until the MLD solution is found. The fact that the complexity  is a random variable is a limitation of SD. To circumvent this problem, it is pos- sible to expand only say, K branches at each level of the tree, as is the case in the  K-best receivers and its variations [Detert 2007, Okawado et al. 2008, Roger et al.  2010], which will be a central tool in Chapter 10. Nonetheless, there are different  approaches as to how the tree should be traversed. Historically, the Fincke–Pohst  method [Su 2005] was the first to be used, followed by the more efficient Schnorr– Euchner  node  enumeration  [Agrell  et  al.  2002],  which  attains  the  same  perfor- mance, while expanding a smaller number of tree branches. Su showed in [Su and  Wassell 2005] and [Su 2005] that a dramatically more efficient exploration of the  tree could be made if not only the channel is taken into consideration when enu- merating the symbols in the alphabet, but also the particular target point was also  taken into account during that sorting process. Furthermore, Su’s ordered traversal  of the tree also eliminated the need for an initial radius and provides automatic  boundary control for spherical lattice codes [Su et al. 2009]. Recently, simplifications  to  the  Fincke–Pohst  and  Schnorr–Euchner’s  enumerations  have  been  proposed,       108  ◾  MIMO Processing for 4G and Beyond  eliminating about 75% of the operations previously required [Ghasemmehdi and  Agrell 2011].   M NTα  The  average  complexity  of  SD  is  exponential  [Hassibi  and  Vikalo  2005],    with  0 ≤ α ≤ 1  [Jaldén  and  Ottersten  2005],  however,  for  given  by O  low-dimensional lattices, that number is affordable. A celebrated improvement  to  SD  was  the  development  of  fixed-complexity  sphere  decoding   FCSD   in  [Barbero and Thompson 2008]. FCSD splits the tree exploration into two: one  where all valid branches are further expanded, and a second phase, conducted  for  the  remaining  layers,  where  only  one  branch  is  expanded  from  any  node.  Recently, an automatic adjustment of the switching point was proposed in [Lai  et  al.  2011].  The  performance  of  FCSD  was  described  analytically  in  [Jaldén  et al. 2009].  SD is typically used to obtain the MLD performance curves for the more chal- lenging configurations such as 4 × 4 with 64-QAM. The SD described here is a  simple implementation of the Fincke–Pohst enumeration, such as the one given in  [Hassibi and Vikalo 2005] or [Bölcskei et al. 2006, Chapter 15], where the output  of the algorithm is not just one point but the set of all points inside the defined  sphere. The implementation of this SD is given in Algorithm 2.4.  Algorithm 2.4: sphere decoding  Fincke–Pohst   Input:  q, orthogonal, r, upper triangular, a target vector y = q1 x, radius ξ Output:  an MLD solution to the CVP,  cid:22 xSD 2x , y ξ ′ =  + =1 1:  Set k = m,  2 y m m m ξ ′ + ′  y  k k k  r  kk  2:   Bounds for sk  Set UB   ξ − ′ + ′ y  k k    −   m         r kk  Q  −  =  =  ξ  1  + 1  + 1  x  x     ,  2  2  k  k  k  3:   Increase xk  xk = xk + 1 4:   Increase k  k = k + 1 if k = m + 1     Terminate  no lattice point found      else go to 3 5:   Decrease k           if k = 1   go to 6 else   k = k − 1        y  ′ k k   + 1  = ′ −  y  k  m  ∑  = + j k 1  r x kj  j      MIMO Detection Methods  ◾  109     y  k  +  1  k  +  2  −  r k  + , 1  k  + 1  k  + 1  x    2  k  ξ  2 + 1  ′ = ′ − 2 k  ξ     go to 2      6:   Solution found    x    return  cid:22 x go to 3  SD =  ′ + yk k  1 denotes the symbol   The algorithm starts by detection of the last element in x. Note that the sub- ′yk, in the kth layer, incorporating the effect of  script in  the layers already detected, in agreement with Equation 2.123. In this algorithm  the option was made to denote the elements in a vector by xn instead of x n , in  order to accommodate notation such as  1 that also reflects the updates of a vec- tor over time or the updates of the radius over time.  ′ + yk k  2.6  Performance Comparison In  this  chapter,  one  could  find  descriptions  and  insights  about  the  most  popu- lar  techniques  for  detecting  MIMO  signals,  including  complexity  comparisons.  This chapter ends with a graphical comparison of the performance of some of the  algorithms described, namely, the ZF, MMSE, OSIC, SD  i.e., the same as MLD  performance , LRA combined with ZF, MMSE, and with OSIC. The results of one  receiver recently proposed in [Monteiro and Kschischang 2011] is also plotted in  Figures 2.21 and 2.22.  R E S  100  10–1  10–2  10–3  10–4  10–5  10  ZF MMSE OSIC-ZF LLL-ZF LLL-OSIC-ZF Focusing  E[Φ] = 66  ML  SD   15  20  25 30 SNR  dB   35  40  45  Figure 2.21  Detection in n = 8 real dimensions  4 × 4 antennas  with 16-QAM.   E[Φ] is the average of a complexity metric associated with the novel receiver.       110  ◾  MIMO Processing for 4G and Beyond     R E S  100  10–1  10–2  10–3  10–4  10–5     20  ZF MMSE OSIC-ZF LLL-ZF LLL-OSIC-ZF Focusing  E[Φ] = 38  Focusing  E[Φ] = 506  ML  SD   22  24  26  28  30  32  34  36  38  40  SNR  dB   Figure 2.22  Detection in n = 8 real dimensions  4 × 4 antennas  with 64-QAM.   E[Φ] is the average of a complexity metric associated with the novel receiver.   Acknowledgments This work was partially supported by FCT  Fundação para a Ciência e Tecnologia   through  project  PEst-OE EEI LA0008 2013.  F.  Monteiro  also  received  scholar- ships from the Gulbenkian Foundation and FCT  in Portugal , and grants from  the  Royal  Academy  of  Engineering,  the  Cambridge  Philosophical  Society,  The  Computer  Laboratory  of  the  University  of  Cambridge,  and  Fitzwilliam  College   in the UK .  References Agrell, E. and Eriksson, T. Optimization of lattices for quantization, IEEE Transactions on   Information Theory, 44 5 , 1814–1828, September 1998.  Agrell, E., Eriksson, T., Vardy, A., and Zeger, K. Closest point in lattices, IEEE Transactions   on Information Theory, 48 8 , 2201–2214, August 2002.  Ahmadi,  S.  An  overview  of  next-generation  mobile  WiMAX  technology,  IEEE   Communications Magazine, 47 6 , 84–98, June 2009.  Alamouti, S.M. A simple transmit diversity for technique wireless communications, IEEE   Journal on Selected Areas on Communications, 16 8 , 1451–1458, October 1998.  Anderson, J.A. Lattices, in Discrete Mathematics with Combinatorics. Upper Saddle River, New   Jersey, USA: Pearson Prentice Hall, 2nd ed., 2003, Chapters 9.2–9.3, pp. 357–371.  Aste, T. and Weaire, D. Packings and kisses in high dimensions, in The Persuit of the Perfect  Packing. Bristol, UK: Institute of Physics Publishing, 2000, Chapter 12, pp. 113–118.      MIMO Detection Methods  ◾  111  Ayanoglu,  E.,  Larsson,  E.G.,  and  Karipidis,  E.  Computational  complexity  of  decoding  orthogonal  space–time  block  codes,  IEEE  Transactions  on  Communications,  59 4 ,  936–941, April 2011.  Babai,  L.  On  Lovász’  lattice  reduction  and  the  nearest  lattice,  Combinatoria,  6 1 ,  1–13,   January 1986.  Bai, D., Nguyen, H., Kim, T., and Kang, I. LTE-Advanced modem design: Challenges and   perspectives, IEEE Communications Magazine, 50 2 , 178–186, February 2012.  Banerjee, U. Unimodular matrices, in Loop Transforms for Restructuring Compilers. Dordrecht,   The Netherlands: Kluwer Academic Press, 1993, Chapter 2.  Banihashemi,  A.H.  Decoding  complexity  and  trellis  structure  of  lattices,  PhD  thesis,   University of Waterloo, Waterloo, Ontario, Canada, 1997.  Barbero, L.G. and Thompson, J.S., Fixing the complexity of the sphere decoder for MIMO   detection, Transactions on Wireless Communications, 7 6 , 2131–2142, June 2008.  Bertsimas, D. and Weismantel, R. Optimization over Integers. Belmont, MA, USA: Dynamic   Ideas, 2005.  Biggs, N.L. Discrete Mathematics. Oxford, UK: Oxford University Press, 2002. Biglieri, E. and Taricco, G. Transmission and Reception with Multiple Antennas: Theoretical   Foundations. Hanover, Massachusetts, USA: now Publishers, 2004.  Bishop, C.M. The curse of dimensionality, in Pattern Recognition and Machine Learning. New   York, NY: Springer, 2006, Chapter 1.4, pp. 33–38.  van Emde Boas, P. Another NP-complete partition problem and the complexity of comput- ing short vectors in a lattice, Mathematisch Instituut, Amsterdam, The Netherlands,  Report 81-04, April 1981.  Bölcskei,  H.,  Gesbert,  D.,  Papadias,  C.B.,  and  van  der  Veen,  A.-J.  Space–Time Wireless  Systems—From  Array  Processing  to  MIMO  Communications.  Cambridge,  UK:  Cambridge University Press, 2006.  Boutros, J., Viterbo, E., Rastello, C., and Belfiore, J.-C. Good lattice constellations for both  Rayleigh  fading  and  Gaussian  channels,  IEEE  Transactions  on  Information  Theory,  42 2 , 502–518, March 1996.  Cassels, J. An Introduction to the Geometry of Numbers, 2nd ed. Berlin, Germany: Springer,   Conway, J.H., and Sloane, N.J. Sphere Packings, Lattices and Groups, 3rd ed. New York, New   1971.  York, USA: Springer, 1999.  Cormen, T.H., Leiserson, C.E., Rivest, R.L., and Stein, C. NP-completeness, in Introduction  to Algorithms, 2nd ed. Cambridge, Massachusetts, USA: MIT Press, 2001, Chapter 34. Detert,  T.  An  efficient  fixed  complexity  QRD-M  algorithm  for  MIMO-OFDM  using  per-survivor  slicing,  in  Proc.  of  ISWCS’07,  4th  International  Symposium  on Wireless  Communication Systems, Trondheim, October 2007, pp. 572–576.  Dubois, E. The sampling and reconstruction of time-varying imagery with applications in   video systems, Proceedings of the IEEE, 73 4 , 502–522, April 1985.  Edelman, A., Arias, T.A., and Smith, S.T. The geometry of algorithms with orthogonality  constraints, SIAM Journal on Matrix Analysis and Applications  SIMAX , 20 2 , 303– 353, July 1998.  El-Hajjar, M. and Hanzo, L. Multifunctional MIMO systems: A combined diversity and mul- tiplexing design perspective, IEEE Wireless Communications, 17 2 , 73–79, April 2010. Epp, S.S. Analysis of algorithm efficiency, in Discrete Mathematics with Applications, 4th ed.   Boston, Massachusetts, USA: Brookes Cole-Cengage, 2011, Chapter 11.      112  ◾  MIMO Processing for 4G and Beyond  Erez,  U.  and  Zamir,  R.  Achieving  1 2 log   1+SNR   on  the  AWGN  channel  with  lattice  encoding and decoding, IEEE Transactions on Information Theory, 50 10 , 2293–2314,  October 2004.  Feng, C., Silva, D., and Kschischang, F.R. An algebraic approach to physical-layer network  coding, in Proc. of ISIT’10—The Inter. Symp. on Information Theory, Austin, TX, USA,  June 2010, pp. 1017–1021.  Fincke, U. and Pohst, M. Improved methods for calculating vectors of short length in a lat- tice, including a complexity analysis, Mathematics of Computation, 44 170 , 463–471,  April 1985.  Fischer, R. Precoding and Signal Shaping for Digital Transmission. Chichester, UK: John Wiley   & Sons, 2005.  Fischer, R. From Gram–Schmidt orthogonalization via sorting and quantization to lattice  reduction, in Proc. of the 6th Joint Workshop on Coding and Communications  JWCC ,  Santo Stefano Belbo, Italy, 2010, pp. 13–17.  Forney,  G.D.  Coset  codes—Part  I:  introduction  and  geometrical  classification,  IEEE   Transactions on Information Theory, 34 5 , 1123–1151, September 1988.  Foschini, G.J. Layered space–time architecture for wireless communication in a fading envi- ronment when using multi-element antennas, Bell Labs Technical Journal, pp. 41–59,  Autumn 1996.  Galbraith, S. Mathematics of Public Key Cryptography. Cambridge, UK: Cambridge University   Press, 2013, Chapters 18,19,20, and 22.  El Gamal, H., Caire, G., and Damen, M.O. Lattice coding and decoding achieve the optimal  diversity–multiplexing tradeoff of MIMO channels, IEEE Transactions on Information  Theory, 50 6 , 968–985, June 2004.  Gan, Y.H., Ling, C., and Mow, W.H. Complex lattice reduction algorithm for low-com- plexity full-diversity MIMO detection, IEEE Transactions in Signal Processing, 57 7 ,  2701–2710, July 2009.  Ghasemmehdi, A. and Agrell, E. Faster recursions in sphere decoding, IEEE Transactions on   Information Theory, 57 6 , 3530–3536, June 2011.  Ghosh,  A.,  Zhang,  J.,  Andrews,  J.G.,  and  Muhamed,  R.  Fundamentals  of  LTE.  Boston,   Massachusetts, USA: Prentice-Hall, 2010.  Giannakis,  G.,  Liu,  Z.,  Ma,  X.,  and  Zhou,  S.  Space-Time  Coding  for  Broadband Wireless   Communications. Hoboken, New Jersey, USA: Wiley, 2007.  Golden, G.D., Foschini, C.J., Valenzuela, R.A., and Wolniansky, P.W. Detection algorithm  and initial laboratory results using V-BLAST space–time communication architecture,  IET Electronics Letters, 35 1 , January 1999.  Goldsmith, A. Wireless Communications. Cambridge, UK: Cambridge University Press, 2005. Gower, J.C. Procrustes methods, Wiley Interdisciplinary Reviews: Computational Statistics, 2,   Gower,  J.C.  and  Dijksterhuis,  G.B.  Procrustes  Problems.  Oxford,  UK:  Oxford  University   503–508, July August 2010.  Press, 2004.  Hassibi, B. An efficient square-root algorithm for BLAST, in Proc. of ICASSP ‘00—IEEE  Inter. Conf. on Acoustics, Speech, and Signal Processing, Vol. 2, Istanbul, Turkey, 2000,  pp. II737–II740.  Hassibi, B. and Vikalo, H. On the sphere-decoding algorithm I. Expected complexity, IEEE   Transactions on signal Processing, 53 8 , 2806–2818, August 2005.  Haykin, S. Adaptive Filter Theory, 3rd ed. Upper Saddle River, New Jersey, EUA: Prentice-  Hall, 1996.      MIMO Detection Methods  ◾  113  Heath, R.W. and Paulraj, A.J. Switching between diversity and multiplexing in MIMO sys-  tems, IEEE Transactions on Communications, 53 6 , 962–968, June 2005.  Higham, N.H. Matrix nearness problems and applications, in Applications of Matrix Theory,  M. J. C. Gover and S. Barnett, Eds. Oxford, UK: Oxford University Press, 1989, pp.  1–27.  Hochba, D.S. Ed., Approximation Algorithms for NP-Hard Problems. Boston, Massachusetts,   USA: Course Technology PWS Publishing Company, 1996.  Hochwald, B.M. and ten Brink, S. Achieving near-capacity on a multiple-antenna channel,   IEEE Transactions on Information Theory, 51 3 , 389–399, March 2003.  Hong, L. and Armada, A.G. Bit error rate performance of MIMO MMSE receivers in cor- related Rayleigh flat-fading channels, IEEE Transactions on Vehicular Technology, 60 1 ,  313–317, January 2011.  Jafarkhani,  H.  Space-Time  Coding—Theory  and  Practice.  Cambridge,  UK:  Cambridge   University Press, 2005, Chapter 9, pp. 221–234.  Jaldén, J. and Ottersten, B. On the complexity of sphere decoding in digital communica-  tions, IEEE Transactions on Signal Processing, 53 4 , 1474–1484, April 2005.  Jaldén, J. and Ottersten, B. High diversity detection using semidefinite relaxation, in 40th  Asilomar Conference on Signals, Systems and Computers, Pacific Grove, California, USA,  2006, pp. 2082–2086.  Jaldén,  J.,  Seethaler,  D.,  and  Matz,  G.  Worst-  and  average-case  complexity  of  LLL  lat- tice  reduction  in  MIMO  wireless  systems,  in  Proc.  of  ICASSP’08—The  IEEE  Inter.  Conf. on Acoustics, Speech and Signal Processing, Las Vegas, NV, USA, April 2008, pp.  2685–2688.  Jaldén, J., Barbero, L.G., Ottersten, B., and Thompson, J.S. The error probability of the  fixed-complexity sphere decoder, IEEE Transactions on Signal Processing, 57 7 , 2711– 2720, July 2009.  Jiang, Y., Varanasi, M.K., and Li, J. Performance analysis of ZF and MMSE equalizers for  MIMO systems: An in-depth study of the high SNR regime, IEEE Transactions on  Information Theory, 57 4 , 2008–2026, April 2011.  Kannan, R. Algorithmic geometry of numbers, Annual Review of Computer Science, 2, 231–  267, June 1987.  Kay,  S.M.  Fundamentals  of  Statistical  Signal  Processing:  Estimation  Theory,  Vol.  I.  Upper   Saddle River, New Jersey, USA: Prentice-Hall, 1993.  Khan, F. LTE for 4G Mobile Broadband: Air Interface Technologies and Performance. Cambridge,   UK: Cambridge University Press, 2009.  Kim, N., Lee, Y., and Park, H. Performance analysis of MIMO system with linear MMSE  receiver, IEEE Transactions on Wireless Communications, 7 11 , 4474–4478, November  2008.  Klein,  P.  Finding  the  closest  lattice  vector  when  it’s  unusually  close,  in  Proc.  ACM-SIAM   Symposium on Discrete Algorithms  SODA , San Francisco, CA, 2000, pp. 937–941.  Kreher,  D.L.  and  Stinson,  D.R.  Combinatorial  Algorithms:  Generation,  Enumeration,  and   Search. Boca Raton, FL: CRC Press, 1999.  Lai, K.-C., Huang, C.-C., and Jia, J.-J. Variation of the fixed-complexity sphere decoder,   IEEE Communications Letters, 15 9 , 1001–1003, September 2011.  Larsson, E.G., MIMO detection methods: How they work, IEEE Signal Processing Magazine,   26 3 , 91–95, May 2009.  Larsson, E.G. and Stoica, P. Space-Time Block Coding for Wireless Communications. Cambridge,   UK: Cambridge University Press, 2003.      114  ◾  MIMO Processing for 4G and Beyond  Lenstra, H.W. Lattices, in Algorithmic Number Theory, J. P. Buhler and P. Stevenhagen, Eds.   Cambridge, UK: Cambridge University Press, 2008, pp. 127–181.  Lidl, R. and Pilz, G. Lattices, in Applied Abstract Algebra, 2nd ed. New York, New York, USA:   Springer, 2nd ed., 2010, Chapter 1, pp. 1–53.  Ling, C. On the proximity factors of lattice reduction-aided decoding, IEEE Transactions on   Signal Processing, 59 6 , 2795–2808, June 2011.  Ling, C. and Mow, W.H. A unified view of sorting in lattice reduction: From V-BLAST to  LLL and beyond, in Proceedings of the IEEE Information Theory Workshop, Taormina,  Italy, 2009, pp. 529–533.  Ling, C., Gan, L., and Mow, W.H. A dual-lattice view of V-BLAST detection, in Proc. of  ITW’ 06, The IEEE Information Theory Workshop, Chengdu, China, October 2006, pp.  478–482.  Ling, C., Mow, W.H., and Gan, L. Dual-lattice ordering and partial lattice reduction for  SIC-based MIMO detection, IEEE Journal in Selected Topics in Signal Processing, 3 6 ,  975–985, December 2009.  Ling, C., Mow, W.H., and Howgrave-Graham, N. Reduced and fixed-complexity variants  of the LLL algorithm for communications, IEEE Transactions on Communications, 61,   1040–1050, March 2013.  Liu, S., Ling, C., and Stehlé, D. Decoding by sampling: A randomized lattice algorithm for  bounded distance decoding, IEEE Transactions on Information Theory, 57 9 , 5933– 5945, Sep. 2011.  Lovász,  L.  An  Algorithmic  Theory  of  Numbers,  Graphs  and  Convexity.  Philadelphia,  Pennsylvania, USA: Society for Industrial and Applied Mathematics  SIAM , 1986,  Chapter 1, pp. 15–38.  Lozano,  A.  and  Jindal,  N. Transmit  diversity  vs.  spatial  multiplexing  in  modern  MIMO  systems, IEEE Transactions on Wireless Communications, 9 1 , 186–197, January 2010. Ma, X. and Zhang, W. Performance analysis for MIMO systems with lattice-reduction aided  linear equalization, IEEE Transactions on Communications, 56 2 , 309–318, February  2008.  Madhow,  U.  Fundamentals  of  Digital  Communication.  Cambridge,  UK:  Cambridge   University Press, 2008.  Magarini,  M.  Spatial  loading  in V-BLAST  systems  with  limited  feedback  and  ZF-OSIC  detection, in Proceedings of the 4th International Symposium on Wireless Communication  Systems  ISWCS , Trondheim, Norway, 2007, pp. 350–354.  Meyer,  C.D.  Matrix  Analysis  and  Applied  Linear  Algebra.  Philadelphia,  PA:  Society  for   Industrial and Applied Mathematics  SIAM , 2000.  Micciancio,  D.  The  hardness  of  the  shortest  vector  problem  with  preprocessing,  IEEE   Transactions on Information Theory, 47 3 , 1212–1215, March 2001.  Micciancio,  D.  and  Goldwasser,  S.  Complexity  of  Lattice  Problems—A  Cryptographic   Perspective. Norwell, Massachusetts, USA: Kluwer Academic Publishers, 2002.  Micciancio, D. and Regev, O. Lattice-based cryptography, in Post-Quantum Cryptography,  D.J. Bernstein, J. Buchmann, and E. Dahmen, Eds. Berlin, Germany: Springer, 2009,  pp. 146–191.  Monteiro, F.A. and Kschischang, F.R. Trellis detection for random lattices, in Proceedings of  ISWCS’11—The 8th International Symposium on Wireless Communication Systems 2011,  Aachen, Germany, November 2011.  Mow, W.H. Maximum likelihood sequence estimation from the lattice viewpoint, MPhil   thesis, Chinese University of Hong Kong, Hong Kong, Hong Kong, 1991.      MIMO Detection Methods  ◾  115  Mow,  W.H.  Universal   lattice  decoding:  Principles  and  recent  advances,  Wireless   Communications and Mobile Computing, 3, 553–569, March 2003.  Mow, H.W. Universal lattice decoding: A review and some recent results, in Proc. of the IEEE   Int. Conf. on Comm.  ICC , 5, 2842–2846, Paris, France, June 2004.  Nazer, B. and Gastpar, M. Reliable physical layer network coding, Proceedings of the IEEE,   99 3 , 438–460, March 2011.  Nguyen, P.Q and Micciancio, D. Entries on lattice, shortest vector problem, closest vector  problem, and lattice based cryptography, in Encyclopedia of Cryptography and Security,  Henk C. A. van Tilborg, Ed. New York, New York, USA: Springer, 2005, pp. 345–349.  Nguyen, P.Q and Vallée, B. Eds., The LLL Algorithm. Berlin, Germany: Springer, 2010. Niu, J. and Lu, I-T. A new lattice-reduction-based receiver for MIMO systems, in In Proc.  of CISS—41st Annual Conf. on Information Sciences and Systems, Baltimore, Maryland,  March 2007, pp. 499–504.  Oestges, C. and Clerckx, B. MIMO Wireless Communications: From Real-World Propagation   to Space–Time Code Design. Oxford, UK: Academic Press Elsevier, 2007.  Oggier, F. Algebraic methods for channel coding, PhD thesis, École Polytechnique Fédérale   de Lausanne, Lausanne, Switzerland, 2005.  Oggier, F., Rekaya, G., Belfiore, J.-C., and Viterbo, E. Perfect space-time block codes, IEEE   Transactions on Information Theory, 52 9 , 3885–3902, September 2006.  Okawado, A., Matsumoto, R., and Uyematsu, T. Near ML detection using Dijkstra’s algo- rithm with bounded list size over MIMO channels, in Proc. of ISIT’08—IEEE Inter.  Symp. on Information Theory, Toronto, Canada, July 2008, pp. 2022–2025.  Park, J., Chun, J., and Luk, F.T. Lattice reduction aided MMSE decision feedback equalizers,   IEEE Transactions on Signal Processing, 59 1 , 436–441, January 2011.  Parkvall, S., Furuskär, A., and Dahlman, E. Evolution of LTE toward IMT-advanced, IEEE   Communications Magazine, 49 2 , 84–91, February 2011.  Paulraj, A., Nabar, R., and Gore, D. Introduction to Space–Time Wireless Communications.   Cambridge, Cambridge: Cambridge University Press, 2003.  Paz, A. and Schnorr, C.P. Approximating integer lattices by lattices with cycle factor groups,  in Proc. of the 14th Inter. Conf. on Automata, Languages and Programming, Karlsruhe,  Germany, LNCS 267, July 1987, pp. 386–393.  Penrose, R. A generalized inverse for matrixes, Proc. of the Cambridge Philosophical Society,   Vol. 51, pp. 406–413, 1955.  Perahia,  E.  and  Stacey,  R.  Next  Generation  Wireless  LANs—Throughput,  Robustness,  and   Reliability in 802.11n. Cambridge, UK: Cambridge University Press, 2008.  Petersen, K.B and Pedersen, M.S. 2008, February The Matrix Cookbook. http:  matrixcookbook.com Piziak, R. and Odell, P.L. Matrix Theory—From Generalized Inverses to Jordan Form. Boca   Raton, FL: Chapman & Hall - CRC, 2007.  Poor, H.V. An Introduction to Signal Detection and Estimation, 2nd ed. USA: Springer, 1994. Roger, S., Gonzalez, A., Almenar, V., and Vidal, A.M. Limassol, Cyprus, March 2010. Schnorr, C. P. and Euchner, M. Lattice basis reduction: Improved practical algorithms and   solving subset sum problems, Mathematical Programming, 66, 191–199, 1994.  Schrijver, A. Theory of Linear and Integer Programming. Chischester, UK: John Wiley & Sons,   1986, Chapters 4, 5, 6.  Seethaler, D., Matz, G., and Hlawatsch, F. Low-complexity MIMO data detection using  Seysen’s  lattice  reduction  algorithm,  in  Proc.  of  ICASSP’07—IEEE  Inter.  Conf.  on  Acoustics, Speech and Signal Processing, Honolulu, Hawaii, USA, April 2007, pp. 15–20.      116  ◾  MIMO Processing for 4G and Beyond  Shang, Y. and Xia, X.-G. An improved fast recursive algorithm for V-BLAST with optimal  ordered  detections,  in  Proc  of  ICC’08—IEEE  Inter.  Conference  on  Communications,  Beijing, China, May 2008, pp. 756–760.  Sibille,  A.,  Oestges,  C.,  and  Zanella,  A.  Eds.,  MIMO:  From  Theory  to  Implementation.   Amsterdam, Netherlands: Academic Press, 2011.  Siegel, C.L. Lectures on the Geometry of Numbers. Berlin, Germany: Springer, 1989, Chapter 5. Sloan, I.H and Joe, S. Lattice Methods for Multiple Integration. Oxford, UK: Oxford University   Press, 1994.  Stewart, G.W. Introduction to Matrix Computations. London, UK: Academic Press, 1973. Stoica, P., Jiang, Y., and Li, J. On MIMO channel capacity: An intuitive discussion, IEEE   Signal Processing Magazine, 22 3 , 83–84, May 2005.  Su, K. Detection and decoding of signals transmitted over linear MIMO channels, PhD   thesis, University of Cambridge, Cambridge, UK, 2005.  Su,  K.  and  Kschischang,  F.R.  Coset-based  lattice  detection  for  MIMO  systems,  in  Proc.  of ISIT’07 - IEEE Inter. Symp. on Information Theory, Nice, France, June 2007, pp.  1941–1945.  Su, K. and Wassell, I.J. A new ordering for efficient sphere decoding, in IEEE Inter. Conf. on   Communications, 3, Seoul, Korea, 2005, pp. 1906–1910.  Su, K., Berenguer, I., Wassell, I.J., and Wang, X. Efficient maximum-likelihood decoding  of spherical lattice codes, IEEE Transactions on Communications, 57 8 , 2290–2300,  August 2009.  Taherzadeh, M. Lattice-based precoding and decoding in MIMO fading systems, PhD the-  sis, University of Waterloo, Waterloo, Ontario, Canada, 2008.  Taherzadeh, M., Mobasher, A., and Khandani, A.K. Communication over MIMO broad- cast channels using lattice-basis reduction, IEEE Transactions on Information Theory,  53 12 , 4567–4582, December 2007.  Talbot, J. and D. Welsh, Complexity and Cryptography: An Introduction. Cambridge, UK:   Cambridge University Press, 2006.  Tarokh, V., Seshadri, N., and Calderbank, A.R. Space-time codes for high data rate wireless  communication: Performance criterion and code construction, IEEE Transactions on  Information Theory, 44 2 , 744–765, March 1998.  Tarokh, V., Jafarkhani, H., and Calderbank, A.R. Space-time block codes from orthogonal   designs, IEEE Transactions on Information Theory, 45 5 , 1456–1467, July 1999.  Telatar,  Ì.E.  Capacity  of  multiple-antenna  Gaussian  channels,  European  Transactions  on   Telecommunications, 10 6 , 585–595, November-December 1999.  Trolin, M. Lattices with many cycles are dense, in Proc. of the 21th Inter. Conf. on Theoretical  Aspects of Computer Science  STACS , Montpellier, France, LNCS 2996, March 2004,  pp. 370–381.  Trujillo,  R.A.,  Garcia,  V.M.,  Vidal,  A.M.,  Roger,  S.,  and  Gonzalez,  A.  A  gradient-based  ordering for MIMO decoding, in Proc. of the 9th IEEE Inter. Symp. on Signal Processing  and Information Technology  ISSPIT , Ajman, United Arab Emirates, 2009, pp. 5–8.  Tse,  D.  and  Viswanath,  P.  Fundamentals  of  Wireless  Communication.  Cambridge,  UK:   Cambridge University Press, 2005.  Tulino,  A.M.  and  Verdú,  S.  Random  Matrix  Theory  and Wireless  Communications.  Delft,   Netherlands: Now, 2004, Chapter 2, pp. 24–38.  Verdú, S. Multiuser Detection. Cambridge, UK: Cambridge University Press, 1998. Viterbo,  E.  and  Boutros,  J.  A  universal  lattice  code  decoder  for  fading  channels,  IEEE   Transactions on Information Theory, 45 5 , 1639–1642, July 1999.      MIMO Detection Methods  ◾  117  Viterbo,  E.  and  Oggier,  F.  Algebraic  Number  Theory  and  Code  Design  for  Rayleigh  Fadign   Channels. Hanover, MA, USA: now Publishers, 2004.  Welsh,  D.  Computational  complexity,  in  Codes  and  Cryptography.  Oxford,  UK:  Oxford   University Press, 1988, Chapter 9, pp. 143–148.  Westlake,  J.  Handbook  of  Numerical  Matrix  Inversion  and  Solution  of  Linear  Equations.   Chichester, UK: John Wiley & Sons, 1968, Chapter 2.6.  Windpassinger, C. Detection and precoding for multiple input multiple output channels,   PhD thesis, University of Erlangen-Nürnberg, Erlangen, Germany, 2004.  Wolniansky, P.W., Foschini, G.J., Golden, G.D., and Valenzuela, R.A. V-BLAST: An archi- tecture for realizing very high data rates over the rich-scattering wireless channel, in  Proc. of URSI Int. Symposium on, Pisa, Italy, September 1998, pp. 295–300.  Wübben, D., Böhnke, R., Kühn, V., and Kammeyer, K.D. MMSE extension of V-BLAST  based  on  sorted  QR  decomposition,  in  IEEE  Procedings  of  Vehicular  Technology  Conference  VTC , Orlando, Florida, USA, October 2003.  Wübben,  D.,  Böhnke,  R.,  Kühn,  V.,  and  Kammeyer,  K.  D.  Near-maximum-likelihood  detection of MIMO systems using MMSE-based lattice reduction, in Proc. IEEE Int.  Conf. Communications  ICC , Vol. 2, pp. 798–802, Paris, France, June 2004.  Wübben, D., Seethaler, D., Jaldén, J., and Matz, G. Lattice reduction, IEEE Signal Processing   Magazine, 28 3 , 70–91, May 2011.  Yao,  H.  Efficient  Signal,  Code  and  Receiver  Designs  for  MIMO  Communications  Systems,   Massachusetts Institute of Technology, Cambridge, MA, USA, PhD thesis, 2003.  Yao, H. and Wornell, G.W. Lattice-reduction-aided detectors for MIMO communication  systems, in Proc. of GLOBECOM’ 02—IEEE Global Telecommunications Conference,  Taipei, Taiwan, 2002, pp. 424–428.  Zamir, R. On lattice quantization noise, Transactions on Information Theory, 42 4 , 1152–  1159, July 1996.  Zhang, W., Ma, X., Gestner, B., and Anderson, D. Designing low-complexity equalizers for   wireless systems, IEEE Communications Magazine, 47 1 , 56–62, January 2009.  Zhang, W,. Qiao, S., and Wei, Y. HKZ and Minkowski reduction algorithms for lattice- reduction-aided MIMO detection, IEEE Transactions on Signal Processing, 60, 5963– 5976, Nov. 2012.  Zheng, L. and Tse, D.N.C. Diversity and multiplexing: A fundamental tradeoff in multiple  antenna channels, IEEE Transactions on Information Theory, 49 5 , 1073–1096, May  2003.       Chapter 3 Precoding for MIMO  Dzevdan Kapetanovic´  and Fredrik Rusek  Contents 3.1   Introduction to Precoding ........................................................................120 3.1.1  SU-MIMO ...................................................................................120 3.1.1.1  Channel State Information .............................................120 3.1.1.2  Information Rate ............................................................121 3.1.2  Precoding for Linear Channels .....................................................124 3.1.2.1  Linear Precoding ............................................................125 3.1.2.2    Nonlinear Precoding and the Multiuser Broadcast  Channel ..........................................................................126 3.1.3  Construction of Linear Precoders .................................................127 3.1.3.1  Optimal Linear Precoders for Linear Receivers ...............127 3.1.3.2  Optimal Linear Precoders for the ML Receiver ..............128 3.1.3.3  Linear Precoders for Minimizing the BER ......................130 3.1.3.4  Linear Precoders without CSI at the Transmitter ............130 3.1.4  Linear Precoders for Maximizing the Minimum Distance ............131 3.1.5  Optimization Problem ..................................................................131 3.1.6  Suboptimal Constructions ............................................................134 3.1.7  Summary of Precoding Techniques ..............................................135 3.2  Precoding from a Lattice Point of View ....................................................136 3.2.1  Lattices .........................................................................................137 3.2.2  Introduction to Lattice Precoding .................................................138 3.2.3  Optimal Two-Dimensional Lattice Precoders ...............................139 3.2.3.1  Optimal Precoding Lattices ............................................142 3.2.3.2  Optimal z Matrix...........................................................148  119   120  ◾  MIMO Processing for 4G and Beyond  3.2.3.3  Applications ....................................................................150 3.2.4  Current Status and Future Research ............................................. 155 References .........................................................................................................156  3.1  Introduction to Precoding 3.1.1  SU-MIMO In this chapter, we focus on the single-user MIMO  SU-MIMO  scenario, with  short remarks on the closely related multi-user MIMO  MU-MIMO  broadcast  channel. We state the model here again for convenience:        y Hx  =  +  n.      3.1   In Equation 3.1, y is the NR × 1 received vector, h an NR × NT matrix that rep- resents the MIMO channel and x is the NT × 1 vector of transmitted data symbols.  Throughout the chapter, white Gaussian noise is assumed, hence n is an NR × 1  vector of complex Gaussian noise variables  n  ∼ CN    0,    .  I  N 0 NR NR×  3.1.1.1  Channel State Information The  MIMO  channel  depends  on  the  environment,  which  determines  how  the  channel changes over time and frequency. As soon as the channel variations are  small, characterized by the coherence time TC and the coherence bandwidth BC,  it is possible to track the channel and obtain reliable CSI. To obtain CSI at the  receiver, a popular method is to send known pilot symbols from the transmitter to  the receiver [Hassibi and Hochwald 2003]. Decoding them at the receiver makes it  possible to obtain an estimate h cid:22   of the channel h, which can be made accurate by  devoting more resources to the training phase. The amount of pilot data that needs  to be transmitted is a well-researched topic and has been analyzed in, for example  [Hassibi and Hochwald 2003]. Note that transmitting pilot symbols, estimating  the channel based on the pilot observations and using the estimate as if it is correct  in the subsequent data detection phase, is not the optimal approach as it is inferior  to performing a noncoherent detection. The ultimate limits of noncoherent detec- tion have been studied in [Zheng and Tse 2002]. However, pilot transmission yields  significantly less computational complexity at the receiver side. In order for the  transmitter to obtain h, two common techniques are  1. Feedback: In this approach, the estimated channel h cid:22   is sent from the receiver  to the transmitter on a feedback link. This feedback inherently gives rise to  some delay δ. In order for h cid:22   to be reliable at the transmitter, we must have  δ ≪ TC. If the channel varies rapidly, this approach requires more frequent  estimates h cid:22   and feedback.      Precoding for MIMO  ◾  121    2. Channel Reciprocity: This technique uses the assumption that the estimated  channel from the transmitter to the receiver is the same as the channel from  the receiver to the transmitter. Problems with this technique include calibra- tion issues as well as the fact that the forward and backward channels are not  necessarily close in time and frequency [Paulraj et al. 2003].    3. Despite the practical difficulties in obtaining perfect CSI, in situations when  the channel varies slowly and the feedback link has sufficient capacity, the  perfect CSI assumption is assumed to hold throughout this chapter.  3.1.1.2  Information Rate An important performance measure for a MIMO system is its mutual information,  which determines the achievable information rates for the MIMO channel. Assume  that  the  MIMO  channel  does  not  change  from  one  slot  to  another   quasistatic  channel . Let pX x  denote the joint pdf pmf* of the vector  X = [  of  1X 0= NT  and covari- NT random variables.† It is assumed that X has zero mean E{ ance matrix R Y X  between the input  ; x and output y for a MIMO channel is defined as  }H . The mutual information  I   X = E{  }X    X NT  XX  … ,  ] T  ,  I     Y X  ;       H  Y     −    H  Y X     ,  ∆ =      3.2   where  H  ⋅  is the differential entropy operator [Cover and Thomas 2006]  H   Y     = −∫ p  y      y  log  Y    2  p  Y       d y  y  .  I   Y X  is the number of bits that can be carried by X through h, given the      ;        specified pdf pX x .  definition 3.1  The information rate I h, px  = I  use that can be carried error free through the MIMO channel h, given the pdf pX x .  Y X  is the maximum number of bits per channel   If one maximizes I h,pX  over the pdf pX x , but keeps the correlation matrix rX      ;  fixed, one obtains the constrained capacity for the MIMO channel.  *  Probability density function or probability mass function. †  Capital and bold symbols denote vectors of random variables, except for matrices which always   are in capital and bold.      122  ◾  MIMO Processing for 4G and Beyond  definition 3.2  The constrained capacity for a MIMO channel is  C     H R  ,     X  =  sup E { XX  p    X x   :  H  }=  R X  I     , H  p  X   .           Soon we will present a closed-form expression for the constrained capacity of  the MIMO channel. Finally, maximizing C h, rX  over rX yields the capacity for  a MIMO channel. This maximization is valid only if there is a constraint on rX,  and the average transmit power constraint is commonly used.  definition 3.3  The capacity for a MIMO channel is   cid:22    C P 0  ,  H    =  max tr   RX  ≤     C P 0  RX  :     H R  ,   .  X  Note that the information rate per channel use is given by the mutual informa-  tion between two sequences of random variables, y and X.  Telatar derived exact analytical expressions for the constrained capacity C h, rX   , 0 H  of a MIMO system [Telatar 1999]. The constrained capacity   and the capacity C P cid:22    of a MIMO system is given by     C     H R  ,  X  ∆ =     max { XX  H  p  X     x E  :  =  }  R X  I     , H  p  X    =  log det  2  I  NT  +  HR H  X  H   3.3      1 N 0    .           The constrained capacity in Equation 3.3 is attained by a multivariate Gaussian  distribution on X, with the correlation matrix rX. The capacity is obtained by sub- sequent  maximization  of  Equation  3.3  as  in  Definition  3.3.  The  solution  to  this  optimization is the well-known waterfilling technique. Let h = usvH be the SVD  X = Σ T  be the eigenvalue decomposition  decomposition of the channel h and R of rX. Further, let σj,j be the diagonal elements of Σ and sj,j the diagonal elements of  s, respectively. The optimization in Definition 3.3 can be shown to be equivalent to  Q Q   cid:22    C P 0  ,  h    =  r  max ∑ σ  j  j  =1  j P , = 0  r  ∑  k  =1  log  2  1  +     σ  s  2 , j  j  j j , N  0     ,      3.4                Precoding for MIMO  ◾  123  where r is the rank of the channel h. The unitary matrix q is equal to v. The solu- tion to Equation 3.4 is   3.5   where one defines  σ  opt j , j  =  µ  −     N s , j  0  j     , +    x  +  =  x 0      x x  ≥ 0 < 0  for a number x, and m is such that the power constraint is satisfied. Hence, to achieve  Σ ,  the rate in Equation 3.4, the transmitted vector x is constructed as  x a where a is a zero mean circularly symmetric complex Gaussian  ZMCSCG  with  ×NT NT . This transforms the linear channel in Equation 3.1 into a set of  R parallel channels,  A =  V  =  I  y  k  =  s  k k ,  ,σ opt k k  a k  +  n k  ,  k  = 1,  …   r , .   3.6   Thus,  optimal  transmission  over  the  linear  channel  occurs  over  its  eigen- modes {sj,j}. Note, however, that this is only true if the data can be a multivariate  Gaussian. As soon as the symbols xj in x are drawn from a discrete constellation,  which will be the main focus later in this chapter, signaling as in Equation 3.6  is not optimal!  Transmitting at bit rates in Equations 3.3 and 3.4, the probability of detecting  an erroneous message at the receiver can be made arbitrarily close to 0 with long  data blocks, in theory. Assume that the transmitter wants to convey one out of  2k different messages to the receiver. A bit pattern b of k bits is used to represent  each message. This bit pattern is represented by a sequence of vectors {x1, . . . , xn},  which are sent through h in n different channel uses. The rate R of the system is  defined as R k n=∆    bits channel use. Assuming that channel is used indefinitely, that  is, k,n → ∞ but with a fixed ratio R = k n, it is possible to recover the transmitted  message with error probability tending to zero as long as R , 0 H , if the encod- ing of the 2k messages to the sequence of n vectors is done in an optimal fashion.  <  cid:22   C P  However,  signaling  exactly  at  this  rate  in  practice  is  impossible  for  several  reasons. First of all, it requires that the transmitted symbols xj are taken from a  Gaussian alphabet, which is not very practical. Moreover, the number of messages,  k, has to be infinite  in theory , that is, the transmission has to occur for an indefi- nite amount of time. Infinitely many vectors xi, i = 1, . . ., need to be transmitted,  and the receiver has to receive the whole signal yi, i = 1, . . ., in order to make opti- mal detection. Still, it is possible to come close to these rates by modern coding          124  ◾  MIMO Processing for 4G and Beyond  b Binary source  LDPC  c  QAM mapper  x1, . . . , xn  S P  H  Figure 3.1  A practical transmission system that can come close to the rates in  Definitions 3.1 through 3.3. The bit sequence b is encoded into a much longer  bit sequence c by an LDPC encoder. The bits in c are mapped onto a QAM con- stellation, which results in a sequence of vectors {x1, . . .,xn}, each with NT sym- bols. After the serial to parallel converter S P, each vector is transmitted from the  antenna array across the channel H.  j  ,1  ]  x  = [  systems. A popular method [Brink et al. 2004] is to code the bit stream b with,  for example, a low-density parity-check  LDPC  code, into a new bit sequence c  of length m > k. Thus, the rate of the encoder is Rc = k m. Next, the bits in c are  mapped  onto  a  discrete  alphabet  X    e.g.,  quadrature  amplitude  modulation—  X  = M. This creates a sequence of n = m NT log2 M  symbol  QAM  of cardinality  , j = 1, .. . ,n. The sequence of vectors is passed through  vectors x j ,… x , , T j NT a serial to parallel converter and then transmitted from the antenna array. Hence,  there are n = m NT log2 M  channel uses, and the total rate of the system is R =  Rclog2 M NT bits per channel use. This transmitter is shown in Figure 3.1. At the  receiver, an iterative decoding algorithm is applied, that iterates between decoding  the MIMO channel and the LDPC encoder, in accordance with the Turbo prin- ciple [Hagenauer 1997].  As soon as the alphabet for the symbols xj is constrained to be discrete, the rates  in Equations 3.3 and 3.4 can never be reached exactly. Instead, the limit is I h, px   in Definition 3.1. To achieve high rates, a large QAM alphabet is necessary. Beside a  large QAM alphabet, long code words need to be produced by the encoder in order  to reach I h, px  and thereby approach C h, rx . For an LDPC encoder, the needed  block lengths can be as large as 105 [Brink et al. 2004; Lu et al. 2004; Bennatan and  Burshtein 2006]. For some time-critical applications, it is of interest to send short  code words and have less latency at the receiver side. This will inevitably lead to an  error probability that is bounded away from 0. Furthermore, the alphabet  X  is in  practice  discrete.  Thus,  minimizing  error  probabilities  or  quantities  related  to  it,  without taking advanced codes into account, is a practically important topic.  3.1.2  Precoding for Linear Channels From the previous discussion, it follows that the interest is to find a discrete set of  vectors that can achieve the highest mutual information rate. However, this is also  a nontractable problem if no constraints are put on the discrete set, except for the       Precoding for MIMO  ◾  125           obvious energy constraint. A widely used technique to generate the discrete set of vec- tors, which starts to lend analytical tractability, is to construct the symbol vector x as  x = L   ,a     3.7   where  a is a data vector that comes from a well-defined  B-dimensional discrete  B  , and  is a certain function mapping. Note here that the mapping  alphabet  A L NT→ , where B ≠ NT can hold. In practice, the alphabet A is an  C : C L Lis B M-QAM alphabet,  ∆ { A =  κ    z  r  +  iz  i  :    , z z r  i  ∈ − {   M  +  1  2,     …  ,   M  −  1  2}} ,     where κ is a normalizing constant such that the average energy in A is one.  From now on, we will always let A be the QAM alphabet. In general, to find the optimal mapping  L for a certain receiver structure  and performance measure  e.g., information rate  is a very tough problem. The  mappings can be divided into two classes: linear mappings and nonlinear map- pings. The latter often give rise to higher complexity  either encoding or decoding  complexity , but can in general perform better than linear mappings. However,  linear mappings always have a linear encoding complexity, while the decoding  complexity depends on the receiver. We will now describe these two classes of  mappings.  3.1.2.1  Linear Precoding When L is a linear map, it can be represented by a matrix equation, that is, x = Fa  for some matrix F. A linear map is called a linear precoder. Here, a is a B × 1 vec- tor,  and  F  is  NT × B.  Since  a  is  discrete  and  structured,  so  will  x  be.  We  have  already seen an application of linear precoding. To achieve the capacity C P cid:22      , 0 H  in  Equation 3.4, the vector x is constructed as x = vΣa, where a   ,   I NT NT×  i.e., B = NT . Hence, in this case, F = vΣ. In general, since both the transmitter  and receiver have perfect channel knowledge, it is possible to optimize over a linear  transformation F of the data symbols a, in order to improve a performance measure  imposed on Equation 3.1. Hence, a more general linear model than Equation 3.1  arises from this consideration:  ∼ CN    NT  0  y HFa  =  + .  n   3.8   As in Equation 3.1,  n ∼ CN    =   Fr AFH, where the last equality follows from the linearity of the expectation opera- tor E{ }⋅  and the fact that F is not stochastic. Assuming uncorrelated QAM symbols   . Since x =  Fa, R    INR NR NR×  H H Faa F  X =  E{  0  }  ,      126  ◾  MIMO Processing for 4G and Beyond   a practical assumption , rA = IB×B and rX = FFH. In this case, F determines the  correlation matrix of x. The average transmit energy constraint is now  tr   FFH     P≤ .0      3.9   3.1.2.2   Nonlinear Precoding and the Multiuser Broadcast   Channel  If L is a nonlinear function, then we obtain a nonlinear precoder. A common non- linear precoding technique is vector perturbation [He and Salehi 2008, Ryan et al.  2009, Razi et al. 2010], which perturbs the data vector a with another vector p that  comes from a lattice, in order to reduce the transmit energy. The data symbols aj are  assumed to belong to a bounded region in the complex-valued plane. Usually, this  , that is, a j ∈ K and a ∈ KB,  region is the cube K = { : a the B dimensional cube. Next, a vector s is constructed as  { }< 0.5, a  { } 0.5} a  Im <  Re  where h+ is the Moore–Penrose pseudo inverse of h and p is the solution to    s H a  =  +  +  p   ,     p  =  arg min Z i B [ ]  q∈   cid:30   +    H a  +  q      cid:30  2  .     In Equation 3.11, Z[ ]i B denotes the set of B dimensional Gaussian integer vec-  tors. The transmitted vector x is then  where κ  h  is the average energy  with respect to the data vector a. Hence, the received signal is  x  =  0P   , H s    κ     κ    H    =  EA  cid:30   cid:30    }2  s  {  y  =  0P   H a      κ   + p  +  n  .     Decoding a is now a simple matter. Since  p ∈ Z[ ]i B  and  a ∈ KB ,  the lattice  vectors p translate the cube KB  so that it tiles the complex-valued B dimensional    3.10    3.11    3.12    3.13    3.14                         Precoding for MIMO  ◾  127  space CB; that is, the translated cubes cover CB and they do not intersect. Let a j cid:22    denote the jth decoded data symbol. Then      cid:22  = a j  y  j  , modK     3.15   where mod  K  means that yj is translated to  K , that is, yj − zj ∈  K  for a  unique   zj. Thus, a simple modulo operation for each received stream yj recovers aj. Note  that the decoded a j cid:22   is corrupted by a modulo Gaussian noise, nk mod  K .  Vector perturbation finds applications in MIMO broadcast channels as well  [Hochwald et al. 2005]. A MIMO broadcast channel, with single-antenna users, is  modeled as in Equation 3.1, where each entry in the vector y is the received symbol  at a certain user. Each entry i, xi, in the vector x is the symbol intended for user  i. Hence, in contrast to SU-MIMO, all other symbols except xi act as interference  to user i. By applying vector perturbation at the transmitter, it is readily seen from  Equation 3.14 that no interference occurs at the user terminals.  Vector perturbation gives rise to a simple decoding method, by inverting the  channel and translating the data vector a to reduce the transmit energy. Moreover, it  is shown in [Hochwald et al. 2005] that vector perturbation comes close to the sum  capacity of a MIMO broadcast system. In [Taherzadeh et al. 2007], it is shown that  vector perturbation achieves the maximum diversity in MIMO broadcast chan- nels. The main bottleneck of vector perturbation is the computational complexity  needed to find the optimal p in Equation 3.11, which is a well-known NP-hard  problem [Razi et al. 2010]. Hence, an NP-hard problem needs to be solved online  for every realization of h and a. Suboptimal low-complexity implementations of  vector  perturbation  exist  [Windpassinger  et  al.  2004]  that  achieve  performance  close to the original vector perturbation.  3.1.3  Construction of Linear Precoders The  low  encoding  complexity  of  linear  precoders  is  very  desirable  for  practical  applications. For this reason, linear precoders have been an active area of research  throughout the history of MIMO communications and are, for example, incorpo- rated in the long-term evolution  LTE  standard [Dahlman et al. 2011]. However,  depending on the receiver and the different performance measures of interest, dif- ferent optimal precoders are obtained. We will now review some linear precoding  techniques for different receiver structures.  3.1.3.1  Optimal Linear Precoders for Linear Receivers The Wiener filter is the optimal linear receiver for many performance measures of  interest. Employing this filter at the receiver, the next task is to find linear precod- ers  that  maximize  different  performance  measures.  A  thorough  investigation  of       128  ◾  MIMO Processing for 4G and Beyond  this  problem  is  performed  in  [Palomar  and  Jiang  2007],  [Palomar  et  al.  2003],  and [Scaglione et al. 2002]. The optimization problems that arise are efficiently  solved with majorization techniques, and it turns out that the optimum precoder  can be derived in a relatively easy fashion. Let N ≤ min  NR, NT . If an arbitrary  objective function f e1,1, . . .,eN,N , where e1,1,. . .,eN,N are the MMSE values across  each  received  antenna  after  the  Wiener  filter,  is  increasing  in  its  arguments  and  minimized when its arguments are sorted in decreasing order, the solution to the  optimization problem   { e  }  min f j j , F subject to ≤ ρ e j j , j     tr H FF  , ≤  j P 0  = 1,  …  ,  N      3.16         =  p Q  diag     is of the form F V . Here, v is the right unitary matrix of h, q is a  unitary matrix such that ej,j = ρj, j = 1, . . ., N,  q can be obtained by a rather simple  algorithm, Palomar and Jiang 2007, Algorithm 2.2 , and  diag    p  is a diagonal  matrix with the vector  p  on its main diagonal.  It turns out that the BER function is convex as soon as it is below a certain  threshold ≈10−3. Thus, the problem in Equation 3.16 becomes a convex optimiza- tion problem, that is, minimizing the BER is a convex problem that can be solved  efficiently with convex optimization techniques.  Instead,  if  the  interest  is  to  maximize  the  mutual  information,  the  problem  reduces to minimizing the determinant of the MMSE matrix [Palomar and Jiang  2007], and the optimal F has Q I= NT NT, , where m is such  that ∑ P 0 holds. Hence, it is thus possible to derive closed-form solutions to  the optimal precoder in the case of simple functions f, and also optimal numerical  solutions when f is convex.  − − λh  , 1 + i   and  pi  N j =1  jp  µ  =  =     3.1.3.2  Optimal Linear Precoders for the ML Receiver The  Wiener  filter  is  after  all  a  suboptimal  receiver,  which  thus  gives  a  subopti- mal performance of a MIMO system. If instead the optimal ML decoding rule is  employed at the receiver, the analysis of the optimal linear precoders is significantly  tougher for discrete alphabets. For coded systems, the main goal is to maximize  the information rates in Section 3.1.2, which describe the performance of the ML  decoder. Henceforth, in all sections, we assume that the ML decoder is employed  at the receiver. Note that since x = Fa,  p A  and RX = FFH.  The information rate I h,pX  in Definition 3.1 can be denoted as I h, F , where  the optimization variables are explicit. The information rate optimal precoder is  found by solving      x  1         a  =  =  p  X  A  B      Precoding for MIMO  ◾  129        , maxI H F F subject to ≤   tr .0 P FF     H      3.17         Note that it is trivial to solve Equation 3.17 with C P cid:22     , 0 H  as objective func- tion, that is, when the alphabet A is Gaussian: the optimum linear precoder then  performs waterfilling. However, since the alphabet A is discrete, there is no closed- form expression available for the objective function I h, F . Finding the precoder F  that solves Equation 3.17 is a challenging problem. In [Perez-Cruz et al. 2010], the  Karush–Kuhn–Tucker  KKT  conditions were derived for Equation 3.17, which  produced  a  fixed  point  equation  for  the  optimal  F.  Based  on  this  equation,  an  iterative optimization technique was developed that produced precoders providing  high information rate. However, the problem with this approach is that the itera- tive optimization technique is not guaranteed to converge to the optimum, since  Equation 3.17 is a nonconvex problem in F.  In [Lozano et al. 2006], an optimal F adhering to a diagonal structure is derived.  Combining this with the result in [Payaro and Palomar 2009], that the optimal F is  such that its SVD factorization F = uF PF vF satisfies uF = v, where h = usvH is the  SVD of h, it is concluded that the optimal F is known up the right unitary matrix in  its SVD factorization. Furthermore, in [Perez-Cruz et al. 2010], it was shown that in  the low SNR-regime, the right unitary matrix of the optimal precoder is the identity  matrix. Thus, for low SNRs, the optimal precoder is of the form F = vhPF, with PF  constructed as in [Lozano et al. 2006]. The work in [Lozano et al. 2006] showed that  the diagonal elements in PF are obtained by a procedure named as mercury waterfill- ing, which is the analogue of waterfilling for Gaussian alphabets, but now for discrete  alphabets instead. In contrast to classical waterfilling for Gaussian alphabets, mercury  waterfilling amounts to first pouring mercury in tubes corresponding to each data  stream; the mercury is poured up to a certain precalculated level. Thereafter, water  with a certain volume is poured on top of the mercury until the water level in all tubes  is the same. The height of the water in each tube is the power to be allocated to each  data stream. A graphical illustration of this process, as well as analysis, is presented in  [Lozano et al. 2006]. A recent advance in [Xiao et al. 2011] shows that I h,F  is con- cave over the Gram matrix g = FHhHhF. This enables construction of an algorithm  that converges to the optimal F. However, this algorithm is of very high complexity  and is not very feasible for large QAM constellations and MIMO dimensions.  The work in [Perez-Cruz et al. 2010] showed an interesting connection between  information rate and the minimum distance of the received signal vectors. Since  the bit error rate  BER  at the receiver is decreasing with the minimum distance  of the received signal vectors for high SNRs, it is desirable to maximize the min- imum distance between the received vectors. Theorem 3.4 in [Perez-Cruz et al.  2010] shows that for high SNRs, the precoder solving Equation 3.17 is the one       130  ◾  MIMO Processing for 4G and Beyond  maximizing the minimum distance. Thus, for high SNRs, the solution to Equation  3.17 is obtained by optimizing the minimum distance. Hence, an interesting con- nection exists among the three well-known optimization criteria: the minimum  distance, BER, and information rate. The precoder that minimizes the BER at high  SNRs maximizes the data rate and the minimum distance at the same time!  3.1.3.3  Linear Precoders for Minimizing the BER Owing to difficulty in finding the precoder that maximizes the mutual information  rate for moderate SNR, an alternative is to minimize the BER. This is also directly  applicable  to  systems  not  using  advanced  error  correcting  codes.  Since  the  BER  expression for an ML decoder cannot be put in closed form, different approxima- tions of it are minimized, such as the Chernoff upper bound. In [Lokesh et al. 2008],  a general expression for the precoder that minimizes the BER was presented. Similar  results are derived in [Payaro and Palomar 2009]. However, these expressions are  given in terms of unknown matrices, and to determine these matrices is a nontrac- table task in dimensions higher than two. Works such as [Lee et al. 2007], [Vu and  Paulraj 2006], [Scaglione et al. 2002], [Mohammed et al. 2011], and [Jian et al.  2005] present suboptimal constructions to minimize the BER. In general, finding  the precoder that minimizes the BER is a nontractable problem, and approximations  to the BER are made, which relax the problem into a tractable one.  3.1.3.4  Linear Precoders without CSI at the Transmitter When the transmitter has no knowledge about the channel coefficients h, the con- struction of precoders is of a different nature than before. In many cases, the receiver  has the capability to obtain a good enough estimate of the channel. One alternative  then is to feed back the CSI to the transmitter, as mentioned in Section 3.1.1.1,  so that the transmitter has a channel to work with. However, due to the inherent  delay, and in the case of low rate feedback links, this method is not viable. Instead,  in this scenario, it is desirable that the receiver only feeds back a small amount of  information to the transmitter, which is sufficient for determining the precoder at  the transmitter. In [Jindal 2006], it was shown that for MIMO broadcast* channel  with a zero forcing precoder  ZF  at the base station, the number of feedback bits  required increases linearly with the SNR.  Usually, the transmitter is equipped with an already static, finite collection of pre- coders, a precoder codebook, and the receiver only feeds back a string of bits across the  MIMO channel, that represent the position of the precoder in the codebook that the  transmitter should use. This is known as limited feedback precoding, and is a part of  the LTE standard [Dahlman et al. 2011]. Hence, the art of limited feedback precod- ing is in designing the finite precoder codebook. Many different techniques exist for   * MIMO broadcast is also refered to as MU-MIMO.      Precoding for MIMO  ◾  131  ,   N kT  this purpose. In [Love and Heath 2005], precoders with k orthogonal columns are  designed, where k < NT. It is shown that the optimal such precoder, for many perfor- mance measures, has its k columns isotropically  i.e., “evenly”  distributed across the   of NT × k matrices with k orthogonal columns. Hence, the  unitary space  U  optimal codebook should consist of precoders that are evenly spread across  U     . By constructing different distance measures between the subspaces that each such  precoder  spans,  it  is  possible  to  construct  codebooks  of  different  sizes  containing  evenly  spread  precoders.  Beside  orthogonal  precoding,  other  methods  exist  that  feedback a few bits representing different elements of a precoder that optimizes, for  example, the minimum distance [Ghaderipoor and Tellambura 2006].  , N kT  3.1.4  Linear Precoders for Maximizing the Minimum Distance Owing to the difficulty in finding a precoder that minimizes the BER, a common  method is to minimize a quantity directly related to the BER. As discussed ear- lier, the minimum distance is the dominant factor in the BER for an ML decoder  at high SNRs, and the precoder that maximizes it not only minimizes the BER,  but also maximizes the information rate. There have been many attempts to con- struct precoders that increase the minimum distance, see, for example, [Payaro and  Palomar 2009], [Vu and Paulraj 2006], [Scaglione et al. 2002], [Bergman 2009],  among many others. All of these attempt to produce suboptimal constructions for  moderate dimensions of the MIMO system. However, in [Collin et al. 2007], the  precoder that maximizes the minimum distance for MIMO channels with two  data streams  B = 2 and NR ≥ 2  and 4-QAM alphabet was found. It is shown that  there are essentially only two different precoder “structures” that are optimal. With  “structure,” it is meant that the mathematical expression for the precoder takes on  two different forms, but the precoder itself changes continuously with the channel,  c.f. [Collin et al. 2007]. For any MIMO channel h with a ratio of its singular val- ues that is above a certain threshold, one of these structures is always optimal, while  for a channel with a ratio below the threshold, the other structure is optimal. Thus,  in a way, the optimal precoder behaves in a discrete fashion. Later, this analysis  was extended to 16-QAM alphabets in [Ngo et al. 2009], where it was found that  there are only eight different precoder structures. Hence, these results hint upon  a discrete structure of the optimal precoder. This chapter will reveal this optimal  structure and provide new insights into the design of linear precoders F that maxi- mize the minimum distance of the received signal vectors. The analysis for MIMO  systems with two data streams is covered in Section 3.2.  3.1.5  Optimization Problem Let Dmin HF A  denote the minimum distance of the received signal points at the  2 receiver. The problem of finding the NT × B precoder F that maximizes the mini- mum distance can be formulated as        ,      132  ◾  MIMO Processing for 4G and Beyond                 Let e D   2 min  = a , HF  − ∈ E B, where  E  is the difference set of the alphabet A. We now have  a A =    H H e F H HFe  . Define  ≠e 0  H  min  B  to be the Gram matrix of hF. Then Equation 3.18 becomes  It is readily seen that the optimal Fopt is such that it minimizes tr FFH  subject to  a fixed constraint on the minimum distance, for example,  1   . Thus, we can rewrite Equation 3.20 as  min  B H e  Ge  ≠ e 0  ≥  ∈ E  B  e  ,  F opt  =  , HF  A     F     D  arg max min 2 subject to ≤ P tr   FF 0     H  .  G F H HF   cid:24  H  H     F opt  =  H e Ge  B  F  ≠ e 0  arg max min ∈ , e E B subject to ≤ tr   P FF 0     H  .        F opt  =  H  FF     tr arg min   F subject to H e Ge  ≥  1  min ∈ , e E B =  ≠ e 0 . G F H HF  H  H  B      3.18    3.19    3.20    3.21   Let  h = usvH be the singular-value decomposition of  h. From the defini- tion  of  g  in  Equation  3.19,  it  follows  that  u  has  no  impact  on  Dmin ,   HF A   2 and can therefore be removed at the receiver. Furthermore, the matrix v can be  absorbed into F without changing the value of the objective function in Equation  3.21. Only the N × N diagonal submatrix in s, that contains the singular values,  is of interest, since the other elements are zero. Hence, an equivalent model to  Equation3.1 arises:     ,  y  =  SFa  + ,   n   3.22   where s is an N × N diagonal matrix with nonzero diagonal entries, F is an N × B  matrix subject to tr FHF  ≤ P0, and a a B × 1 vector. Further, y is now N × 1 and so  is n. In total, the system in Equation 3.1, where x = Fa, can without loss of general- ity be reduced to Equation 3.22. g is now g = FHs2F, a B × B matrix. It is further       Precoding for MIMO  ◾  133  assumed that B ≤ N, that is, the number of spatially multiplexed data streams is  determined by the rank. Thus, we can now rewrite Equation 3.21 as  F opt  =  tr arg min   F subject to H e Ge  min ∈ e E B = . G F S F  H  B  2  ,  ≠ e 0  H  FF     ≥  1                 In [Payaro and Palomar 2009], it was shown that solving Equation 3.23 is an  NP-hard problem. Thus, at first sight, this problem seems mathematically intrac- table, and finding a solution to it online amounts to solving an NP-hard prob- lem. Therefore, the first natural approach is to construct suboptimal solutions to  Equation 3.23, as was done in [Scaglione et al. 2002] and [Vrigneau et al. 2008].  This is the rationale behind Section 3.1.7.  Assume that the Gram matrix g in Equation 3.23 is given. We will now find  the F that solves Equation 3.23 for the given g. Since g is Hermitian, and thus a  normal matrix, its eigendecomposition is  G QDQ  =  .H      3.24   The factorization in Equation 3.24 is unique if the diagonal elements of d are  ordered in a decreasing order. From the definition of g and Equation 3.24, we  H is a precoder such that FHs2F = g. The 0B,N−B  see that F matrix is a B × N − B zero matrix, accounting for the case when B < N. Next, we  prove that this F has the lowest energy of all possible g satisfying g = FHs2F.  = − 1 S  D 0  B N B  Q    T     −  ,  Theorem 3.1  Let  g = qdqH where the diagonal elements of  d are ordered in decreasing order.  Then, of all F satisfying g = FHs2F,  is the one with least energy tr FHF . Proof.  Combining  g = FHs2F  and  Equation  3.24  we  get  FHs2F = qdqH.  Rewriting, we have  F  = − 1 S     D 0  B N B  −  ,    T  Q  H     . Q F S FQ D  H H 2 H  =      3.23    3.25    3.26       134  ◾  MIMO Processing for 4G and Beyond  Assume  that  FHrF,  where  r  is  a  positive  semidefinite  matrix,  is  equal  to  a  diagonal matrix Λ, where the diagonal elements in Λ are in decreasing order  in  our case Λ is B × B . Then, in [Palomar and Jiang 2007, Lemma 3.16], it is proved  −1 2 Λ, where vr contains the B eigenvectors  that we can always choose F R of r corresponding to the B largest eigenvalues of r and dr contains the B largest  eigenvalues of r, respectively, in order to minimize tr FHF . Hence in our case,  = − we choose FQ S H and  1 completes the proof.   which gives F  = − 1 S  V DR  D0  B N B  B N B  D  Q  B B    T  =    T  0  I        −  −  ×  ,  ,  3.1.6  Suboptimal Constructions Numerous suboptimal constructions of F exist for maximizing the received mini- mum distance. One of the first suboptimal approaches is presented in [Scaglione  et al. 2002]. Therein, it is noted that  D  2 min     , HF  A     ≥  λ  N     G    min ∈ ≠ ,˘ ˘ , a a a a A   cid:30   a  −   cid:30  cid:22  2 a  ,  where λB .  is the B-th largest eigenvalue of its argument  since B is the dimension of  the Gram matrix g, it is the smallest eigenvalue in this case . Hence, by constructing  F such that the smallest singular value of hF is maximized, the lower bound on the  minimum distance is maximized. It is shown that the optimal F takes on the form  F VD= ,        where as before v denotes the right unitary matrix in the SVD decomposition of h.  Although providing performance superior to no precoding, this method has been  outperformed by later suboptimal constructions.  In [Vrigneau et al. 2008], a suboptimal construction based on the optimal two- dimensional precoder in [Collin et al. 2007] is presented. The precoder in [Collin  et al. 2007] is only optimal for 4-QAM alphabets. The idea is to pair off the largest  and smallest singular values of the channel, and apply the optimal two-dimensional  precoder  for  each  pair.  Namely,  let  s i   denote  the  i:th  largest  singular  values  of  h. The singular values are paired as  s 1 , s N  ,  s 2 , s N−1  , . . .,  s N 2 , s N 2+1  . Let  s i  denote the i:th pair. The optimal precoder Fi is constructed for each pair s i ,  1 ≤ i ≤ N 2, and scaled such that the minimum distance for each channel s i  Fi is  the same. The performance of this precoding will be presented in later sections.  Another approach for constructing precoders is presented in [Bergman 2009].  Therein, a lattice theoretic approach is undertaken to construct precoders with large  minimum distances. By using densest lattice packings in different dimensions, and  optimizing the lattice basis, precoders with large minimum distances were found. It  was shown with bounds and numerical observations that, in general, the performance  of lattice precoders is close to the optimum. However, the precoder construction is       Precoding for MIMO  ◾  135  heuristic, and it is not known whether densest lattice packings are optimal or not.  Section 3.2 will present a proof that, for MIMO systems with two input streams,  well-known lattices are indeed optimal for precoding with large discrete alphabets.  Recent works in [Kapetanović et al. 2012] shows that densest lattice packings are  not always optimal for a higher number of input streams. Further suboptimal con- structions can be found in [Rusek and Kapetanović 2009], [Mohammed et al. 2011],  [Ngo et al. 2010, 2013], and [Kapetanović and Rusek 2011].  3.1.7  Summary of Precoding Techniques In Table 3.1, we present current knowledge at hand when it comes to optimal linear  precoding. The complexity of a decoder is measured by the conventional ordo nota- tion, that is, the complexity is proportional to the argument of O   ⋅ . Complexity of  preprocessing before decoding, that is, matrix vector operations, is not considered.  For the MMSE receiver, the decoding complexity does not depend on the alphabet  size  A , and for Gaussian alphabets, decoding complexity is not really a definable  concept  Gaussian alphabets are approximated by discrete ones in practice .  As seen in the table, for the optimal ML receiver, the optimal precoder construc- tion is found in [Xiao et al. 2011], which produces an optimal precoder maximizing  the mutual information. However, due to the high computational cost in generating  these precoders at the transmitter, it is of interest to study alternative methods, espe- cially in the high low SNR regime. For low SNRs, the solution is given by mercury  waterfilling. For high SNRs, the optimal precoder is the one that maximizes the min- imum distance of the received signal points. Moreover, this precoder is also useful for  delay-sensitive applications not using advanced coding techniques. In Table 3.2, we  list the current knowledge at hand for precoders maximizing the minimum distance.  Table 3.1  Summary of Current Results on Optimal Linear Precoders  Receiver  SNR  Constellation  Optimal Precoder  Decoding  Complexity  ML  ML  ML  ML  Any  Low  Gaussian  Discrete  High Discrete  Any  Discrete  Waterfilling  Mercury waterfilling  [Lozano et al. 2006]  Maximum min. dist.  precoders  Precoding in [Xiao et al.  2011]  NA   B O A    O A    B   O A    B   Linear   MMSE   Any  Any  Constructions in  [Palomar and Jiang 2007]  O    B  Note:  The dimension of the MIMO system is arbitrary.      136  ◾  MIMO Processing for 4G and Beyond  Table 3.2  Current Status on Precoders Maximizing the Minimum Distance  No. of Input Streams B  Constellation Size  Optimal Precoder  2  2  2  2  >2  >2  4  16  >16  Precoders in [Collin et al. 2007]  Precoders in [Ngo et al. 2009]  Unknown  Infinite  Presented in Section 3.2  Small to moderate Unknown  Infinite  Precoders in [Kapetanovic´  et al. 2012]  Note that for infinite discrete alphabets  e.g., an infinite QAM alphabet , the  optimal precoders are known by work presented in Section 3.2 and in [Kapetanović  et al. 2012]. The infinity assumption comes from using lattice theoretic tools for  characterization of the optimal solution, while in practice, as will be demonstrated  in Section 3.2, this can be relaxed to large alphabets  ≥16-QAM for MIMO sys- tems with two input streams . The main result is that there are a discrete number  of  optimal  Gram  matrices  g,  from  which  the  optimal  precoder  is  obtained  by  means of the construction in Theorem 3.1. This implies that for small variations of  the MIMO channel, the Gram matrix of the optimal precoder does not change.  Hence, the Gram matrices can be enumerated offline for different sets of MIMO  channels, and used for online precoder construction. This can be efficiently accom- plished in the case of two input data streams  B = 2 , while for a larger number of  streams, efficient enumeration of the Gram matrices as well as identifying which  ones are optimal for different channel sets remains a topic for future research.  3.2  Precoding from a Lattice Point of View This section will explore the connection between optimal minimum distance pre- coders and lattice theory. Hence, the minimum distance problem will be viewed  from a lattice theoretic perspective, and this will enable us to explain the structures  observed in [Collin et al. 2007] and [Ngo et al. 2009] for B = 2 data streams. For  convenience, this section only focuses on the case N = B = 2, with the remark that  the results also hold for all N × N MIMO channels with two input data streams,  that is, N × B precoders with B = 2. This follows from the expression of the optimal  precoder in Theorem 3.1, which shows that if B < N, the optimal precoder is an  N × 2 matrix with an  N − 2  × 2 zero matrix in the last rows. Hence, effectively,  this corresponds to employing a 2 × 2 precoder across the strongest eigenmodes of  the MIMO channel.      Precoding for MIMO  ◾  137  3.2.1  Lattices We now present a brief account on lattice theory  c.f. Section 2.2.1 in Chapter 2   needed for our purposes. All matrices and vectors in this section are assumed to  be  real-valued.  This  covers  complex-valued  matrices  and  vectors  too,  since  any  complex-valued  matrix  A  is  isomorphic  to  a  real-valued  matrix  Ar  through  the  transformation   3.27    3.28    3.29     and similarly  A  r =  { } A Re − { A Im  }      { Im { Re  A A  } }         s  r =  Re Im  { } s { } s            for complex-valued vectors s, where, Re{ }⋅  and Im{ }⋅  denote the real and imaginary  parts of a matrix vector, respectively.     Let l ∈  ×RN N  and let the columns of l be denoted by l1, . . ., lN. A lattice Λl   is the set of points  ΛL = {  Lu u ∈ ZN  :  }.           In Equation 3.29, u is an integer vector and l is called a generator matrix for the   lattice Λl. The squared minimum distance of Λl is defined as  D  2 min     L    =  min = u v   cid:30     L u  −  v      cid:30  2  =  min = e 0 N   cid:30   Le   cid:30  2  =  , T e G e L  min = e 0 N  j  L        Λ    = {  − Λ L  ≤  cid:30   cid:30  p + p j  where u, v and e = u − v are integer vectors and gl is the Gram matrix for the  lattice Λl. The fundamental volume is Vol Λl  = det l , that is, it is the volume  spanned by l1, . . .,lN. Let pj denote a lattice point in Λl. A Voronoi region around a   cid:30   cid:30  lattice point pj is the set Vp , : . Due to  the symmetry of a lattice, it holds that V , where the Voronoi    p  ΛL . region around 0N is denoted by  V   w w p j   =  − w p Λ   L  As can be seen from the definition of ΛL, the column vectors l1, . . .,lN form a basis  for the lattice. There are infinitely many bases for a lattice. Assume that l′ is another  basis for Λl. It holds that l′ = lz, where z is a unimodular matrix, that is, z has  integer entries and det  z  = ±1 [Conway and Sloane 1999]. Hence, the generator  matrix l′ generates the same lattice as l, that is, Λl ≡ Λl′ where ≡ denotes equality  between sets. Two Gram matrices G  are isometric if there   and G 1 . Geometrically,  exists a unimodular z and a constant c such that  G L this means that l1 and l2 are the same lattice up to rotation and scaling of the basis   = T L L 2 = c T Z G Z  = T L L 1  L2 L 1  k V  ∈  Λ  L1  }  L  2  2  k  j      138  ◾  MIMO Processing for 4G and Beyond  Vol  ΛL   L2  L1  pj  Vpj  ΛL   Figure 3.2  The hexagonal lattice depicted with a geometrical description of the  introduced lattice quantities.  vectors. Figure 3.2 shows a geometrical visualization of a hexagonal lattice and the  definitions above.  From the definition of the different lattice measures, it follows that     D  2 min     WLZ    =  D  2 min     ,   L     3.30   where W is any orthogonal matrix. Similarly, Vol ΛWlz  = Vol Λl .  A  number  of  lattices  are  especially  interesting  and  have  been  given  formal  names in the literature. In particular, the densest lattices in the sense that they  maximize the quotient Dmin 2    are of interest. In 2, 4, 6, and 8 dimen- sions, the densest lattices are the hexagonal A2, Schläfli D4, E6, and the Gosset E8  lattices, respectively [Conway and Sloane 1999]. Apart from these 4, we will also  make use of the two-dimensional square lattice Z2.       Vol  Λ  Λ     3.2.2  Introduction to Lattice Precoding To study the minimum distance problem from a lattice point of view, the QAM  alphabet  A  has to be infinite, that is, a ∈ A B , the set of B-dimensional  Gaussian integer vectors. We will use this assumption for the purpose of the anal- ysis,  while  practically,  as  will  be  demonstrated  by  simulations,  this  corresponds  to a large enough QAM alphabet. Hence, the error vectors e are B dimensional  Gaussian integer vectors. From now on A  will not be explicitly written out, since  it is implicit that it is equal to Z[ ]i . Thus, Dmin .  SF   2 Since there are infinitely many error vectors e, the B × B Gram matrix g must have  rank B in order for the inequalities eHge ≥ 1 to hold. If not, then the minimum   SF A  will be denoted as Dmin 2  [ ]Z B i  =           ,      Precoding for MIMO  ◾  139     SF  2 min    =  distance D e Ge is arbitrarily close to 0, since e can be arbitrarily close  H to the eigenvectors that corresponds to zero eigenvalues. Thus, g is a positive-def- inite matrix, and N ≥ B must hold  the reader is reminded that the precoder F in  Equation 3.22 has dimensions N × B, and g = FH s2 F .  Using  notions  from  Section  3.2.1,  we  start  by  reformulating   3.23   as  a  lat- tice problem. Let M = sF be the lattice generator matrix at the receiver, which, as  described above, must have full rank. M can be factorized as M = WBz, where  W is a unitary orthogonal matrix, B is an N × N matrix and z is a unimodular  matrix. The lattice structure of M is determined by the matrix B, while z is the  basis through which the lattice is represented. The matrix W is merely a rotation  of the lattice, but plays an important role in the optimization to follow. With this  factorization of M, it follows that F can be written as  F  =  − 1 S M S WBZ  − 1  =  .     Hence, Equation 3.23 can be formulated as    tr min W B Z, , subject to  H H  Z B W S WBZ  H  − 2     D  2 min     WBZ    = 1.      3.31    3.32   For completeness, we shall separate between two cases:  i  Real-valued precod- ing, where all quantities in Equation 3.32 are real-valued, and  ii  complex-valued  precoding, where all quantities, except s, are complex valued.  From Theorem 3.1, it follows that the optimization over W is straightforward  once Bz is fixed: the optimal W equals the left unitary matrix of Bz. This leaves  us with the optimization of B and z, and we shall start with B in Section 3.2.3.1,  while optimization over z is treated in Section 3.2.3.2.  3.2.3  Optimal Two-Dimensional Lattice Precoders In [Bergman 2009] and [Forney Jr. and Wei 1989], it is proposed to design F based  on dense lattice packings. A lattice-based construction implicitly assumes that the  signal constellation is a finite but sufficiently “large” set of lattice points, and the  idea is that if the received constellation points sFa’s are arranged as a dense lattice  packing, the minimum distance is expected to be “good.” However, no exact results  on optimality have been presented in either of these articles.  To gain some insight into the problem, let us examine some simple special cases.   First, we rewrite Equation 3.32 in its equivalent form  max minD   2 F subject to tr   FF  SF  H       ≤  P 0  .      3.33                140  ◾  MIMO Processing for 4G and Beyond  The formulation in Equation 3.33 turns out to be easier to analyze numerically.  In real-valued precoding, some specific instances of the problem in Equation 3.33  can be viewed geometrically. Assume that tr FFH  = 4 and the elements of the input  a are identically and independently distributed  i.i.d.  random variables. Normalize  s to have s2,2 = 1, which only scales the optimal solution to Equation 3.33 with a  constant, so that changing s corresponds to varying the value of s1,1. Since there are  only four real-valued elements in F, and they are bounded by the energy constraint,  it is possible to determine the optimal F to Equation 3.33 for some carefully chosen  value of s1,1, say, by empirical means. When s = I  i.e., s1,1 = 1 , one optimal solution  to Equation 3.33 is F = I, while another one is     F =      1 0  0.5 3 4        ,  which spans a hexagonal lattice. However, as soon as s deviates from I  even with  a very small change, say, s1,1 = 1.01 , the optimal F is unique  up to sign changes in  the columns  and it gives rise to an sF that is a generator matrix for the hexagonal  lattice. Varying s1,1 further, the optimal F changes in a continuous way, while the  received lattice sF remains the same  up to scaling . This behavior continues until  s1,1 reaches a certain value, for which the optimal F suddenly changes in a discon- tinuous way, resulting in a discontinuous change in sF. However, surprisingly, sF  still spans a hexagonal lattice, in spite of its subtle changes!  Figure 3.3 depicts such a behavior by plotting as vectors the columns of the  optimal F and the corresponding sF for three different s with s1,1 = 1.5, 2.7 and  2.8, respectively. The received constellation points sFa are shown as discrete points.  The optimal F changes continuously as s1,1 increases from 1.5 to 2.7, and the col- umns of sF are simply being scaled and always span the same hexagonal lattice  up  to scaling . When s1,1 further increases from 2.7 to 2.8, there is a discontinuous  change in the elements of the optimal F. The columns of sF also change discon- tinuously, but they still span the hexagonal lattice  up to scaling and rotation . This  intriguing behavior of the optimal precoder poses a challenging puzzle, and the aim  of this section is to resolve this puzzle.  Although the following results are derived for infinite constellations, by using  lattice  theory,  the  results  are  applicable  to  “large”  QAM  constellations.  In  the  numerical  result  section,  we  shall  investigate  how  “large”  a  QAM  constellation  is sufficient for the presented results to be fruitfully applied. With the solution at  hand, we are able to answer questions, such as the following:   ◾ Is there a general underlying structure of the precoding optimization problem    3.32 ?   ◾ Under  what  conditions,  does  the  solution  to  Equation  3.32  vary  with  the   channel matrix s in a continuous  respectively, discrete  manner?      Precoding for MIMO  ◾  141   a   Optimal F   b   –2  –1  1  2  –3 –2  –1  1  2  3  2  1  –1 –2   c   HFx 3  2  1  –1  –2 –3  HFx 3  2  1  –1  –2 –3  –5  –4  –3  –2  –1  1  2  3  4  5  Figure 3.3  Visualization of the solution to the precoding optimization problem  in Equation 3.33 when E is Z, and H is a diagonal channel matrix S = diag [s1,1 1] .   a  Columns of the optimal real-valued precoding matrix F are depicted. Three  different  S  are  considered:  s1,1 = 1.5   solid  line  arrow ;  s1,1 = 2.7   dashed  line  arrow ; s1,1 = 2.8  dotted line arrow . Columns of the same matrix are plotted as  arrows with the same line style.  b  Columns of the matrices SF and their corre- sponding received constellation points SFa’s for h1,1 = 1.5  solid line arrows, filled  circles  and for s1,1 = 2.7  dashed line arrows, crosses  are plotted.  c  Columns  of the matrices SF and their corresponding received constellation points SFa for  s1,1 = 2.8  dotted line arrows, filled triangles  are plotted.   ◾ Is it possible to offline construct a codebook of optimal precoders so that   there is no need to perform any online optimization?  The answers to these questions are that there is indeed a profound structure  in the solution of Equation 3.32. Remarkably, there is a single precoder structure  which is optimal, and it organizes the received constellation points as a hexagonal  lattice for real-valued F’s, and as a Schläfli lattice for complex-valued F’s. However,  the  basis  through  which  the  lattice  sF  is  observed  changes   up  to  scaling   in  a       142  ◾  MIMO Processing for 4G and Beyond  discrete fashion when s changes. This implies that Equation 3.32 is actually a dis- crete optimization problem and not a continuous one.  3.2.3.1  Optimal Precoding Lattices In this section, the optimal lattice B for the real-valued and the complex-valued  cases is derived.  For the real-valued case, the main result is:  For any non-singular channel matrix s, the optimal lattice B in Equation 3.32 is the  hexagonal lattice, that is,  Theorem 3.2           Proof. First, the constraint in Equation 3.32 will be made more manageable. It fol- ∈ R  be the col- lows from Equation 3.30 that D     = 2 WBZ min ≤ umns of B and assume that  cid:30   cid:30   cid:30   cid:30  . In 1801, C.F. Gauss noted [Gauss 1981]  b b 2 1 ≤  cid:30   cid:30    , where “⋅” is the scalar product between  that if b1 and b2 fulfill,  2  2 b b 1 1 b=  cid:30   cid:30  . Given b1, the set of all b2 satisfying the inequality  vectors, then Dmin 2 2 is the minimum distance region of b1. Figure 3.4 depicts this region geometrically.  B . Let b b1 ,  ⋅ 1  2 min   B  D  b  b1 and b2 are actually the shortest basis for the lattice, since  cid:30   cid:30 b1  of the shortest vector in the lattice, and it can be shown that  cid:30   cid:30 b2 the next shortest vector in the lattice. Hence, by putting  cid:30   cid:30 b1   is the length   is the length of  1=  and letting b2 be      2  2  2  B =        1  0  1 2 3 2        .  b2  b1 1  –1  Figure 3.4  The minimum distance region of b1 is shaded. All b2 inside the shaded  region generate a lattice, spanned by b1 and b2, with a minimum distance equal  to the length of b1.      Precoding for MIMO  ◾  143  any vector in the minimum distance region of b1, the matrix B will be a generator  matrix for any lattice in the plane with unit minimum distance.  Let r =  2 cid:30   cid:30 b . The constraint Dmin 2     WBZ    = 1   can be written as r ≥ 1 and cos    ϕ  ≤1 2r where ϕ is the angle between b1 and b2. Hence, WB can be written as  WB =  α   sin α   cos          r r  α φ   sin α φ   cos  ± ±         .      3.34   Optimization  3.32  can now be formulated over α, ϕ and r:    tr min α φ , , r  H H  Z B W S WBZ  H  − 2     subject to  r  ≥  1,  cos  φ      1 2 . r  ≤      3.35      It follows that the intervals for α and ϕ are 0 Let s1,1,s2,2 be the diagonal elements of s and assume s1,1 ≥ s2,2. For notational   − 1  1 2  .  π φ 2 ,   cos    r  ≤   α  ≤  ≤  convenience, we let zjj be the elements in z. Define s  ∆ s = 2,2  s   1,1   and  a   cid:24   z 2 11  cid:30   + z  z 2 12  cid:30  2  b   cid:24   z z 11 21  cid:30   + z  z z 12 22  cid:30  2  c   cid:24   1  2  s  + 2  .      3.36   To  obtain  easier  expressions,  we  scale  the  objective  function   3.35   with   cid:30 z  which has no impact on the solution, and by doing so we get the fol-   cid:30   2  1 2,2  s lowing objective function:  f  α φ   ,  r ,    − 2  H  H H   cid:24  tr   Z B W S WBZ + − + = 2 a br r c a     α + + −  2  1 cos 2   1   a r   cid:30   cid:30      s 2 Z 2,2 φ + −         cos   1 c a cos + α φ + φ  2 2 2   cos br  2  α  2     .   3.37      Since 0 ≤ s ≤ 1, it follows that 1 2 ≤ c ≤ 1. First, we minimize f α,ϕ,r  over α by making use of the following Lemma.  lemma 3.1      =  Let  g x that  =1∑ n j  a  j    cos  x  +  θ  for some real-valued constants {aj} and {θj}. It holds  j     min  g x     =  −  x  n  ∑  j  =1, =1  k  a a j  k  θ   cos  j  −  θ  k   .   3.38                         144  ◾  MIMO Processing for 4G and Beyond  i x    +θ     ∑  n j   cid:29  ∑      =  },   Proof.  Rewrite  g x   as  g x θ . The minimum occurs when z is rotated to the negative part  i where z j of the real axis, that is, x = π − β, and the minimum value is then equal to − z.  This gives expression  3.38 .  e z { ix  { e Re   } =  { Re  a e j  a e j  a e j  Applying Lemma 3.1 to Equation 3.37 in order to minimize over α, we get  } =  R  =1  =1  n j     ix  j  j  j  ∑  θ i  h  φ   ,   r  α φ  cid:24  min f   , α + − c   +   rb a 4  a 1 [ + r  = ,   r +  1  2  2  4  r −  c a    2  + r −    a  1 2    cos a  −  1 + φ    ]  4 r b 2 2 . 1 2  a     +  rb 2 +  2  cos  r a 2  φ      −   1  a     cos  φ  2               Using the identity cos  2ϕ  = 2 cos2  ϕ  − 1 and defining t  cid:24  cos   φ , we get  q t r   ,     cid:24   h   +  cos 4 rr b 2 2  = − 1 r t    ,   r a 2 2  −  c a   −  1  + a  r    2  −  1 a + r a 4 2  + 2 rbt     − a t  1   2  + +  2  − c   rb a 4    a 1 [ + r  2  +  1  4  r −  −  1   a 2 a t    ] 1 2  .  3.39   From the definition of t, it follows that −1 2r ≤ t ≤ 1 2r. It can be verified that  q t,r  is a concave function in t. This implies that the minimum of h t,r  over t is  attained at one of the two endpoints t = ±1 2r. For these values, and with the vari- able substitution ρ = r2, we get  l  ±  ρ        ±  cid:24    1 2 ,     q r r − + ρ  1 =   c a ρ − −   2 a 11 a  a    ±   + a    b  1  + −    c   a  − ±  2  1 [ a 2   b a  + +  2  ρ ρ  1   1 −  − a    a 2   ] 1 2  + ,  2  4 b  ρ   3.40      where ρ ≥ 1. l+  ρ  has “ + ” instead of ± and l−  ρ  has “ − .” The functions l±  ρ   are both concave in ρ. Now, since l±  ρ  is the objective function of Equation 3.35,  it follows that it must always be positive. Therefore, the minimizer must be ρ = 1,  which gives that r = 1 in Equation 3.39. This implies that the minimum over t  in Equation 3.39 occurs at t = ±1 2, which corresponds to ϕ ∈ {± π 3, ±2π 3} in  Equation 3.37. This shows that the minimum of f α ,ϕ ,r  in Equation 3.37 occurs  at r = 1 and ϕ ∈ {± π  3, ±2π 3}. Inserting these values in the generator matrix B,  one obtains the generator matrix for the hexagonal lattice as stated in the Theorem.  This completes the proof.  While  the  real-valued  case  is  interesting  for  theoretical  purposes,  the  com- plex-valued case is more important for practical MIMO or OFDM applications.  Nevertheless, the real-valued result has immediate applications to precoding for  mitigation of I Q imbalance in scalar complex-valued channels.      Precoding for MIMO  ◾  145  For the complex-valued case, the main result is:  Theorem 3.3  For any nonsingular channel matrix s, the optimal lattice B in Equation 3.32 is the  complex representation of the Schläfli lattice, that is,  B =  1  0          i  1 ± ± 1 2 1 2  ±          .              Proof. It turns out that there is a similar minimum distance preserving condition for  complex-valued B as for real-valued ones. In [Yao and Wornell 2002], the authors  prove that if  cid:30   cid:30   cid:30   cid:30  2   and  b 1  ≤  b  Re {  H b b 1  2   }  ≤  and  I  {  H b b 1  2   }  ≤   3.41   1 2  1 2 ,     then Dmin 2      B  b= cid:30   cid:30  . The matrix W is now  2  1  W =      i  φ   1  −  γ  1   e  0  0 − φ   3  γ  1           α sin   α cos    e   e    −  φ i  1  −  φ ii  3  i  e  2  −  φ i  α e cos     φ − α − ie   sin   4       3.42      and B is    Hence, WB becomes  B =  1      γ i  re 0  ω sin   ω cos    e   e    γ i  2  γ i  3      .      3.43   WB =     r r  α   sin α   cos       α   sin α   cos  ω     sin ω   nn   si    e   e  θ i 1  θ i 1  + −  α   cos α sin         ω   cos ω cos      e   e  θ i  2  θ i  2     ,    where ϕ1 − ϕ2 ≡ ϕ3 − ϕ4  mod 2π , θ1 = γ2 − γ1 and θ2 = γ3 − γ1 + ϕ1 − ϕ2. Conditions   3.41  become      3.44   Re {  ω   sin    e  −  θ i 1   }  ≤  and  I  {  ω   sin    e  −  θ i 1   }  ≤   3.45   1 r 2  1 r 2  ,         146  ◾  MIMO Processing for 4G and Beyond  where r ≥ 1. Define  f  α ω θ θ   ,  ,  ,  1  2  r ,     cid:24  tr    H H  Z B W S WBZ  H  − 2  s      2,2  .  We have  f  α ω θ θ   ,  ,  ,  1  2  r ,    =  2  z  + + + 2 2 2 2  z       z z c r [     21 12 11 22 sin ω θ − + + R i H H rz z     e   rz z 2 {  1 11 12 22 221 + ω + − 2 22    cos  z {  Re  2   2    z 22 21 ω θ − α + i H 22     sin   rz z   e   cos }] 1 12 22 + − ω − 2 2 sin  2       [  z z  1   c 22 ω + + H       cos zz z e 2    rz z r R 12 22  21 H 11 21  −  c   [  r  2     z 11   2  +    z 12     2  + }]  1 H rz z 11 21  θ − θ cos     1 2 θ− α i  ]  2  , sin 2   3.46      where  c on α as  + =  1    s  s   1,1      2   2  2,2  . First, we minimize over α. It is seen that f depends   f  α ω θ θ   ,  ,  ,  1  2  r ,   =  a 1  +  a  2  cos  +  a 3  a 2 3  sin  α  2    + α  2    a 2  + a a 2 2  3 2 ψ α cos  2   sin       α ψ + sin  2  ,  a 2 3 a 2 3  coos  + +  a  2 2  a a  2 2  2 2  =  a 1  +  = =  a 1 a 1  + +  α  2    +  +  ψ co   ss     a 3 + a a 3 2 2 3 α  2    sin  sin   α  2       3.47            where the constants a1, a2 , and a3 are easily read from Equation 3.46 and ψ is such   The minimum of Equation 3.47 over α occurs at α = − π  + ψ . that sin a   2 3  4 − ψ  2, which gives  f π − −     . Since only a3  2 over θ2. We have depends on θ2, minimizing f over θ2 implies maximizing a3  ψ ω θ θ ,    = 2 a  r ,    a 2 3  2,  a 1  +  =  −  4  a  a  2 2  2 2        ,  1  2  a 3  =  1 2 =  1  − − z  [  c  2 21 + rz z Re    H 11 21 − θ − − i e c   { R  2  +    z  2 22 + zz z r H 12 22 + z     2  θ ω −    2   cos sin 1 − θ ω i e  ]     cos   2 ω z sin      2    e 2  21  22     θ  2     θ i 1  +  2  ω   cos      rz z  H 11 21  +  rz z  H 12 22    }.  It follows that the maximizing θ2 is such that eiθ2 rotates the expression it mul-  tiplies to the real axis. We get,  min f θ2 = + +  − π        4  −  ψ θ θ ω  2,     ,  ,  2  1  ,   r  =  l  θ ω   1  ,  ,   r  2  +   [   c r z z 2 11 12 −   1 [   c z   rr  2 11 − Re sin ω θ i e   2 {   1  2       z  +     zz 2 2 21 +    z  2 12 + rz z H 11 21  +  22 +  z  2 21 rrz z H 12 22   2  {  + 2 + z  22 −  }   2    e  ω θ − i Re sin   1  2 4  ω 2    cos         rz z  H 11 21  +  rz z  H 12 22   }]    det  z  2 1 2    ]  .   3.48         Precoding for MIMO  ◾  147  As in the real-valued case, it can easily be shown that the expression in Equation  3.48 is concave in sin ω . Thus, the minimum is attained at the endpoints of sin ω .  The constraints in Equation 3.49 can be written as sin ω  cos θ1  ≤ 1 2r and sin ω  sin θ1  ≤ 1 2r. Assume sin θ1  ≤ cos θ1 . It follows that the interval for sin ω  is  −1  2r cos θ1   ≤ sin ω  ≤ 1  2r cos θ1  , while the interval for θ1 is −π 4 ≤ θ1 ≤ π  4.  Inserting either one of these endpoints for sin ω  in Equation 3.48 and using the  trigonometric identity 1 cos2 x  = 1 + tan2 x , we get that l takes on the following  form:        l  θ   1  r ,    =  c b   1  +      b 2  θ tan   1  b 1     1    2  z  +   4  +     c  −  +    det    −  2  1  r     ,  b 2  θ tan   1  2     +  2       det   z 2 r  t  aan  θ 2   1      3.49      where b1 and b2 are constants with respect to θ1. Again, it is clear that Equation 3.49  is concave in tan θ1 , and thus the minimum is attained at one of the endpoints of  θ1, which are −π 4 and π 4. If we instead assumed that  , the  only difference is that tan θ1  becomes cos θ1  and π 4 ≤ θ1 ≤ 3π 4. This gives rise  to the same behavior of l θ1 ,r  and thus the same results are obtained.  To recap, we showed that the minimum for l θ1, ω, r  in Equation 3.48 over  θ1, ω  occurs  when θ1 = ± π 4  and  at  the  endpoints  for  sin ω ,  which  are  then  = ± ω r sin     . r  We now continue by inserting this expression  1  2   ω θe i−  in Equation 3.48 and obtain a one-dimensional function in ρ = r2  for sin    1 of the form  θ   cos 1  θ   cos 1  θ   sin 1  1 2    ≥      = ±          l 1     ρ     =  k 1  +  k 2  ρ  +     c  −  1   k 3  ρ  2  +  k 4  ρ  +  k 5  +    det z       2   2     ρ  −  4 ,     3.50   2  2              c  −  +  +  −  +  +  =  ρ  ρ  ρ  ρ  k 1  k 5  k 3  k 2  k 4  1     2  2   det z  where the kj are constants with regard to ρ and with k3 positive. If we instead study  the function l , it follows  from the same concavity arguments as before that l2 ρ  is a concave function and  thus the minimum is attained at the endpoints, which are ρ = 1 and ρ = ∞. From  the concavity of l2 ρ  it follows that if the minimum is attained at ∞, then the  minimum value is −∞, which is impossible since the trace function is always posi- tive; thus the minimum of l2 ρ  must be attained at ρ = 1. Now comparing l2 ρ   with l ρ , the only difference is the term   in the square root,  det z  attained at ρ = 1; hence l2 1  = l1 1 . Since c − 1  with maximum value of 2  is always nonpositive, it follows that l2 ρ  ≤ l1 ρ  for ρ ≥ 1, which gives that the  minimum of l1 ρ  occurs when ρ = r = 1  because the minimum of l2 ρ  occurs for  ρ = 1 .  det z   ρ −   2    2   2  4             148  ◾  MIMO Processing for 4G and Beyond  We have now showed that the minimum of l θ1, ω, r  in Equation 3.48 occurs  r  r = 1. Inserting these values into the lattice gen- ,  for θ1 = ± π 4, sin ω = ±     erator B in Equation 3.43, we arrive at the following optimal lattice generator:  1 2     Extending  B  to  its  real-valued  representation  by  means  of  Equation  3.27,  it  holds that for each realization of ± as + or −, that Br is a generator matrix for the  Schläfli lattice D4.  Hence, by “real-valued representation,” it is meant that if the transformation  Equation 3.27 is performed on B in Theorem 3.3, the Schläfli lattice in four real- valued dimensions results. Its real-valued generator matrix is  B =        1  0  i  ± ± 1 2 1 2  ±        .     D4 =         1 1 0 0  1 − 1 1 0  0 0 − 1 1   0  0  0   − 1   .      3.51    3.52   To summarize, the two-dimensional minimum distance optimal precoder for  “large” input constellations is always an instance of the hexagonal or the Schläfli  lattice for real-valued and complex-valued precoding, respectively.  3.2.3.2  Optimal Z Matrix Since B is now known, it remains to find the optimal basis matrix z in order to  solve Equation 3.32. This section describes the core idea of the algorithms that find  the optimal real-valued and complex-valued z, respectively. A complete MATLAB  code for the algorithms can be found at www.eit.lth.se goto Zalgorithm.  By inserting the optimal real-valued B and W into Equation 3.32, the optimi-  zation Equation 3.32 is equivalent to*  z  =  arg minµ± r     z   ,  z  *  The optimization over W is treated in the proofs of Theorems 2 and 3.               Precoding for MIMO  ◾  149  where  µ± r        z  cid:24  =          where    and  z  s   z 2 2,2 11 + c z [ 2 11 + − c   −   z 2 11  + z 2 12 + z 2 12 1 [  z 2 11 + z    2 12  + z 2 21 + z 2 21  2 21 + z 2 12 +  z  + l    1  2 ± 22 ± z   z z 22 22 11 21 + +     z z 2 2 21 ±   2  z z z 11 21    2 22  +  ] z z 12 22 +   4  z z221 2 2 11 22 + z z    z 2 11 12 22  + +  z z   2 12 22 + zz z 2 2 21 12  +  z  2 22   ] 1 2  .         3.53   In the complex-valued case, we have the following optimization:  z  =  arg minµ± c     z   ,  z  µ± c     z      cid:24   cid:30  c   +    +  cid:30  2 z − 1    c  R  ± ± {  1 +  cid:30   cid:30  2 z  i z z    H 11 21 ±± ± {  1 R  + z z H 12 22 i z z     H 11 21   }  +  z z H 12 22   }  2  −  2.   3.54      The ± signs  in  both  Equations  3.53  and  3.54  can  be  absorbed  into  the  elements  of  z,  without  changing  the  unimodularity  of  z.  Define  βr + + + +   −  cid:29  11 z z z z z   z 2 2 2 2 21 12 11 21 22 + H , where we do not explicitly denote the dependency of βr  + Re{ 1 z z     } i z z H 12 22 11 21 and βc on z. Since  det  z  = 1, Equations 3.53 and 3.54 become    and  βc    + z z 12 22  z 12  z 11   cid:29   +  +  +   2   2   2   2  z  z  21  22        µ β   r r    =  c  β  r  +     c  −  1   β  2 r  −   3   3.55    3.56   µ β   c  c    =  c  β  c  +     c  −  1   β  2 c  −  2,       respectively. The difference between Equations 3.55 and 3.53  similarly between  Equations 3.56 and 3.54  is that the former only depends on one variable, that  implicitly depends on the elements {zij}, while the latter is directly expressed in the  elements {zij}. Deriving the optimal βr and βc does not produce the optimal ele- ments {zij}, however, it can provide easier optimality conditions for {zij}. If we for  the moment drop the constraint that βr has to be integer-valued, the function mr   z  in Equation 3.55 will be minimized over βr. It can be verified that mr  z  is a  convex function. Differentiating m  βr  with respect to β and setting the derivative  to 0 gives that βr    is the optimal point. Since mr  z  is convex,  1 the minimum of m  βr   over unimodular matrices can only occur at two specific  matrices. Either it is the z that produces the largest βr smaller than βr,opt, or it is the  z that produces the smallest βr larger than βr,opt. A similar analysis can be applied   c 23  c 2  , opt  −  =            150  ◾  MIMO Processing for 4G and Beyond     c  1  , opt  c 2  = 2  to the complex-valued Equation 3.56, and it follows that the largest βc smaller, or  smallest βc larger, than βc −  is optimal. Hence, in the real-valued  case, an algorithm can be developed that traverses unimodular z’s and stops when  two matrices z1 and z2 are found, such that z1 gives the βr that equals the largest  integer smaller than βr,opt, and z2 gives the βr that equals the smallest integer larger  than βr,opt. An algorithm for the complex-valued case works in the same way. For  the purpose of clarity of this chapter and the fact that the algorithms are ad-hoc, we  omit the implementation details and refer to www.eit.lth.se goto Zalgorithm, where  the MATLAB code for both algorithms can be found.  Since we now know that solving Equation 3.32 is a discrete optimization prob- lem, it is of interest to see how often the solution changes with varying s. Figure  3.5 shows the ratio s1,1 s2,2 on the x-axis, and the markers show the ratios where z  changes. As seen, the same solution can be used for a wide interval.  3.2.3.3  Applications In this section, we consider a number of practical applications of the optimal mini- mum distance lattice-based precoder and make comparisons to other schemes. As  discussed  in  Section  3.1.3.2,  minimum  distance-based  precoders  are  asymptoti- cally optimal in the high SNR regime, but minimum distance plays little role at  low SNR, so significant performance gains cannot be expected there.  Consider first the 2 × 2 channel studied in [Perez-Cruz et al. 2010],     s =       3 0  0 1   .        3.58   In [Perez-Cruz et al. 2010], this channel was studied at asymptotically high  SNR for binary baseband alphabets with real-valued precoding. The objective was   100  Ratio between largest and smallest eigenvalue  101  102  Figure 3.5  Change in Z with respect to the ratio s1,1 s2,2. The solution to Equation  3.32 is constant for all S with a ratio between any two consecutive markers. The  scale on the x-axis is logarithmic.      Precoding for MIMO  ◾  151  to find the real-valued precoder F that maximizes the mutual information. For high  SNR, it is known that the optimal mutual information precoder converges to the  optimal minimum distance precoder, and the numerical optimization framework  in [Perez-Cruz et al. 2010] thus produced the optimal minimum distance precoder.  The precoder is of the following simple form:     F =       −  2 2  2 2       .      3.59   It can be verified by standard techniques that the combined channel–precoder  matrix sF is an instance of the hexagonal lattice—which is precisely the result if an  infinite lattice constellation was used. For such a lattice constellation, the strength  of the results in Theorems 3.2 and 3.3 is that no numerical optimization of the  precoder is necessary since it is known a priori that the hexagonal lattice must be  the solution, and it only remains to find the optimal basis matrix z according to the  algorithm mentioned in Section 3.2.3.2. By doing so, we find that the optimal z for  asymptotically large constellations coincides with the basis matrix that is built into  Equation 3.59. Altogether, for the particular channel  3.58  studied in [Perez-Cruz  et al. 2010], a “large” constellation means binary and it is known beforehand what  structure the solution must have.  In Figure 3.6, we continue to study the channel  3.58 , but now by evaluating  its mutual information that is achieved by 4-QAM inputs when the complex-valued  minimum distance optimal precoder for large constellations is used. As comparisons,  plots of the achieved mutual information for  1  no precoding at all, that is, F = I,  2   mercury waterfilling from [Lozano et al. 2006], and  3  capacity achieved by Gaussian  inputs and waterfilling are presented. The performance of the optimal mutual infor- mation precoder coincides with that of mercury waterfilling in the low SNR regime,  while  it  coincides  with  that  of  the  minimum  distance  precoder  in  the  high  SNR  regime. As can be seen, there is a 2 dB gain offered by the minimum distance precoder  over uncoded systems and mercury waterfilling at high SNR. At low SNR, the mer- cury waterfilling policy is optimal and outperforms the minimum distance precoder. For  the  channel  in  Equation  3.58,  we  observed  that  the  large  constellation  assumption made in this section was not very critical as it produced the same result  as  a  binary  input  constellation  does.  This  is,  however,  not  true  in  general,  and  it  is  necessary  to  investigate  the  impact  of  the  cardinality  of  the  input  constel- lation. Consider diagonal channel matrices h where each diagonal element is a  zero-mean,  unit-variance,  circulary  symmetric  complex  Gaussian  random  vari- able     The average mutual information, against SNR, is computed for  4-QAM and 16-QAM input constellations for  1  the minimum distance optimal  precoder for large constellations,  2  minimum distance optimal precoders for the  particular constellations used, and  3  no precoder. The average is evaluated over  106 channel realizations by straightforward Monte Carlo simulation. For 4-QAM    0,1  .  CN      152  ◾  MIMO Processing for 4G and Beyond  Opt. min. dist. No precoding Capacity Mercury waterfilling  e s u    .  h c   s t i b      X    ;  Y      I  4 3.5 3 2.5 2 1.5 1 0.5  −10 −8  −6  −4  −2  4  6  8  10  12  0 2 SNR  dB   Figure 3.6  Mutual information for the channel  3.58  studied in Perez-Cruz et al.   2010  with 4-QAM inputs under different settings. The solid heavy line shows  the capacity with waterfilling, the curve marked with asterixes shows the ensu- ing mutual information from the lattice precoder in this section and the curve  marked with circles shows the mercury waterfilling mutual information. The bot- tom line is the no precoding case.  and  16-QAM,  the  minimum  distance  optimal  precoders  have  been  reported  in  [Collin et al. 2007] and [Ngo et al. 2009], while the optimal precoder for 64-QAM  has so far not been reported in the literature which is the reason why we do not go  beyond 16-QAM. The results are shown in Figure 3.7.  The uppermost heavy solid line corresponds to the average capacity of the chan- nel achieved by Gaussian inputs with waterfilling. The lower set of curves corre- sponds to 4-QAM, while the upper corresponds to 16-QAM. Within each set of  curves, the lower curve  without markers  shows the no precoder case, the middle  curve  marked with asterixes  is the performance of the precoder constructed from  a  large  constellation  assumptions,  and  the  upper  curve   marked  with  circles   is  the performance of the precoder explicitly constructed for the input constellation  used. For 4-QAM inputs, a small loss of the large constellation construction can  be seen, while for 16-QAM the ensuing mutual information from a large constella- tion assumption is virtually indistinguishable from that of a construction explicitly  made for 16-QAM. Hence, it can be concluded from this example that a 16-QAM  input  constellation  can  be  replaced  by  an  infinite  lattice  constellation  without  appreciably affecting the results. This greatly simplifies the precoder optimization  problem since lattice theoretic tools can be applied.  In Figure 3.8, we turn our attention toward the error probability of 2 × 2 MIMO  systems with  1  the minimum distance optimal precoder for large constellations,  2   minimum distance optimal precoders for the particular constellations used, and  3        Precoding for MIMO  ◾  153  8 7  6 5  4  2  1  e s u    .  h c   s t i b      X    ;  Y  3      I  0 −10  } ˆx = x { r P  100  10−1  10−2  10−3  10−4  10−5  10−6  0  −5  0  5  10  15  20  25  30  SNR  dB   Figure  3.7  Average  mutual  information  for  random  diagonal  channels  with  4-QAM  bottom set  and 16-QAM  upper set . The heavy solid line is the capacity  with waterfilling. Within each set, the line marked with circles shows the per- formance of a precoder constructed explicitly for the input constellation used,  and  the  curve  marked  with  asterixes  shows  the  performance  of  the  precoder  constructed from an infinite lattice constellation assumption. These two curves  are virtually identical for 16-QAM. The bottom line within each set corresponds  to the no precoding case.  16-QAM  4-QAM  64-QAM  5  10  15  25  30  35  40  20  SNR  dB   Figure 3.8  ML receiver tests of various precoders with 4-QAM, 16-QAM, and  64-QAM.  Within  each  set,  the  rightmost  curve  is  the  no  precoding  case,  the  middle curve is the precoder constructed from an infinite lattice constellation  assumption, and the leftmost curve is the performance of a precoder constructed  explicitly for the input constellation used  not present for 64-QAM .      154  ◾  MIMO Processing for 4G and Beyond  no precoding. 4-QAM, 16-QAM, and 64-QAM input constellations, together with  a maximum likelihood detector, are considered. The lines marked with circles corre- spond to the minimum distance optimal precoder for large constellations, the lines  marked with squares correpond to the optimal precoder designed for the particular  input constellations used, and the unmarked lines correspond to the no-precoder  case. As can be seen, there is a large gain from explicitly taking the input constel- lation into account for 4-QAM. However, for 16-QAM inputs, this gain reduces  significantly, so that the precoder designed for large constellations performs close  to optimal. For 64-QAM, the gap to the optimal precoder designed explicitly for  64-QAM  cannot  be  determined.  However,  given  the  large  reduction  of  the  gap  between the 4-QAM and 16-QAM cases, it is expected that the gap for 64-QAM  is minor, so that the precoder designed for large constellations is virtually optimal.   0,1  .  } =1Hk k  As a final example, an OFDM system with N subcarriers {  N  is investigated.  For simplicity, all subcarriers are assumed to be independent zero-mean, unit-variance,  circulary  symmetric  complex  Gaussian  random  variables      In  practice,  adjacent carriers are strongly correlated but for the transceiver system to be considered,  N is large and such correlations are immaterial. The approach taken in [Vrigneau et  al. 2008] is pursued, but now with the 2 × 2 minimum distance optimal precoder  constructed from the large constellation assumption. This precoder is then used as  a building block to construct precoders of larger dimension. The N subcarriers are  first grouped into N 2 pairs. The particular pairing used in [Vrigneau et al. 2008] is  to combine the strongest subcarrier with the weakest subcarrier, the second strongest  with the second weakest, and so on. Let { N , but  sorted according to their strengths so that   . We have N 2 inde- pendent transmissions   cid:31 Hk k N  denote the subcarriers { } =1  cid:31   cid:30   cid:31   cid:31  ≥  H  H HN 1 1  } =1Hk k  CN  ≥   ≥   y  k  =   cid:31  H k 0       0   cid:31  H  N k  − + 1       a F k k  +  n  k  =  S F k  a k k  +  n  k  , 1  ≤  k N  ≤     2    } =1 and we need to construct N 2 precoders { N . A total energy of N P 2 is assumed,   2 Fk k and we allocate a fraction γk to Fk under the constraint that ∑γk = N P 2. The power  allocation policy undertaken here is that all channel–precoder pairs skFk should  have equal minimum distances. We can find the precoders according to this policy  as follows:  } =1 N  according to the constraint Tr   2 Fk k   ◾ Design {  ◾ From  lattice  theory,  it  is  guaranteed  that  the  minimum  distance  for  each  channel–precoder pair equals the length of the shortest vector of the lattice  spanned by skFk. Let Dk  2 denote the minimum distance.  H F Fk k    = 1 .   ◾ The power allocation that equalizes all minimum distance is proportional to   finally yields the   ∝ 1 2  and the overall power constraint ∑γ k NP= kD  2   γ k set of precoders.      Precoding for MIMO  ◾  155  Capacity Opt. min. dist. Mercury waterﬁlling No precoding  e s u    .  h c   s t i b      X    ;  Y      I  9  8  7  6  5  4  3  2  1  0  5  10  20  25  30  15  SNR  dB   Figure 3.9  Average mutual information per sub-carrier pair with 16-QAM inputs  under different settings. The solid heavy line shows the capacity with waterfill- ing, the curve marked with circles shows the ensuing mutual information from  the lattice precoder in this section and the curve marked with asterixes shows  the mercury waterfilling mutual information. The bottom line is the no precod- ing case.  The ensuing average mutual information of this strategy is compared with the  no-precoder case, mercury waterfilling, and the capacity of the channel. The input  constellation is 16-QAM in all cases  except for the capacity case where it is com- plex Gaussian . The results are shown in Figure 3.9. Note that the average mutual  information per channel–precoder pair is plotted. The top heavy solid curve is the  average capacity of the channel, the curve marked by circles is the system based on  the minimum distance optimal precoder described above, the curve marked with  asterixes is the mercury waterfilling system, and the bottom curve shows the per- formance of the no-precoder case. As in the previous examples, there are no gains  at low-moderate SNR by the minimum distance optimal precoder, while the gains  are significant at high SNR. Note that the mercury waterfilling is close to optimal  at low SNR, while it suffers from large penalties at high SNR.  3.2.4  Current Status and Future Research The results in this chapter show that in two dimensions, whether it is real-valued  or complex-valued precoding, the optimal precoder produces well-known lattice  structures at the receiver. Theoretically, this result only holds for an infinite alpha- bet assumption. However, as confirmed by the simulation results in this chapter,  for practical channels these results hold for 16-QAM or larger alphabets. Current  research in this topic has revealed optimal lattice precoders in higher dimensions,       156  ◾  MIMO Processing for 4G and Beyond  as mentioned in Section 3.1.7. The analytical techniques used for two-dimensional  precoding in this section are not easily extendable to higher dimensions. New ways  to look at the problem were developed in [Kapetanović et al. 2012] to characterize  optimal lattices for precoding. Namely, it is shown in [Kapetanović et al. 2012]  that optimal precoders in any dimension give rise to perfect lattices at the receiver,  that is, the optimal precoder is always generated by a perfect lattice. An elaborated  analysis of these results can be found in [Kapetanović et al. 2012].  For small QAM alphabets, it can be beneficial to use a rank-deficient precoder  which avoids data transmission across weak eigenmodes of the channel h. For two- dimensional MIMO systems, the result in Section 3.2 can be combined with the  optimal rank one precoder in [Collin et al. 2007] for 4-QAM alphabets and [Ngo  et al. 2009] for 16-QAM, and further performance enhancements can be obtained.  However, for larger dimensions of the MIMO channel, rank-deficient precoders are  not always instances of lattices as presented in [Kapetanović et al. 2012], and their  structure is not known. Thus, future research into this area should develop efficient  methods that find optimal or close to optimal rank-deficient precoders.  References Bennatan, A. and D. Burshtein, Design and analysis of nonbinary LDPC codes for arbitrary   discrete-memoryless channels, IEEE Trans. Inf. Theory, 52 2 , 549Â–583, Feb. 2006.  Bergman, S., Bit loading and precoding for MIMO communication systems, PhD thesis, Signal   Processing Laboratory, Royal Institute of Technology, Stockholm, May 2009.  Brink,    S.,  G.  Kramer,  and  A.  Ashikhmin,  Design  of  low-density  parity-check  codes  for   modulation and detection, IEEE Trans. Commun., 52 4 , 670–678, Apr. 2004.  Collin, L., O. Berder, P. Rostaing, and G. Burel, Optimal minimum-distance based precoder  for MIMO spatial multiplexing systems, IEEE Trans. Signal Process., 52 3 , 617–627,  Mar. 2007.  Conway, J. H. and N.J.A. Sloane, Sphere Packings, Lattices and Groups, Springer-Verlag, New   York, 1999.  Hoboken, NJ, 2006.  Cover, T. M. and J. A. Thomas, Elements of Information Theory, John Wiley & Sons, Inc.,   Dahlman, E., S. Parkvall, and Johan Sköld, 4G LTE LTE-Advanced for Mobile Broadband,   Academic Press, London, 2011.  Forney,  G.  D.  Jr.  and  L.-F.Wei,  Multidimensional  constellations.  I.  Introduction,  figures  of merit, and generalized cross constellations,  IEEE  J.  Select.  Areas  Commun., 7 6 ,  877–892, Aug. 1989.  Gauss, C.F., Disquisitiones Arithmeticae. Leipzig 1801. German translation: Untersuchungen  über die hohere Arithmetik. Springer, Berlin 1889.  Reprint: Chelsea, New York, 1981.  Ghaderipoor, A. and C. Tellambura, Minimum distance-based limited-feedback precoder for  MIMO spatial multiplexing systems, in Proc. of the IEEE Vehicular Tech. Conf.  VTC ,  Montreal, Canada, Sep. 2006.  Hagenauer, J., The turbo principle: Tutorial introduction and state of the art, in Proc. of   theInt. Symp. Turbo Codes, pp. 1–11, ENST de Bretagne, France, Sep. 1997.      Precoding for MIMO  ◾  157  Hassibi, B. and B. M. Hochwald, How much training is needed in multiple-antenna wireless   links?, IEEE Trans. Inf. Theory, 49 4 , 951–963, Apr. 2003.  He, J. and M. Salehi, A lattice precoding scheme for flat-fading MIMO channels, in Proc.   IEEE MILCOM, San Diego, CA, Nov. 2008.  Hochwald,  B.  M.,  C.  B.  Peel,  and  A.  L.  Swindlehurst,  A  vector-perturbation  technique  for  near-capacity  multiantenna  communicationpart  II:  Perturbation,  IEEE  Trans.  Commun., 53 5 , 537—544, May 2005.  Jian, Y., J. Li, and W. W. Hager, Uniform channel decomposition for MIMO communica-  tions, IEEE Trans. Signal Process.,53 11 , 4283–4294, Nov. 2005.  Jindal,  N.,  MIMO  broadcast  channels  with  finite-rate  feedback,  IEEE Trans.  Inf.  Theory,   52 11 , 5045–5060, Nov. 2006.  Kapetanovic′, D. and F. Rusek, Linear precoders for parallell Gaussian channels with low decod- ing complexity, in Proc. of the IEEE Vehicular Tech. Conf., San Francisco, CA, Sep. 2011. Kapetanović, D., H. V. Cheng, W. H. Mow, and F. Rusek, A lattice-theoretic characteriza- tion of optimal minimum-distance linear precoders, arXiv, available at http:  arxiv.org  abs 1204.1933, 2012.  Lee, H., S. Park, and I. Lee, A new MIMO beamforming technique based on rotation trans- formations, in Proc. of theIEEE Int. Conf. Comm.  ICC , Glasgow, Scotland, Jun. 2007. Lokesh, S. S., A. Kumar, and M. Agrawal, Structure of an optimum linear precoder and its   application to ML equalizer, IEEE Trans. Signal Process., 56 8 , Aug. 2008.  Love, D. J. and R. W. Heath, Limited feedback unitary precoding for spatial multiplexing   systems, IEEE Trans. Inf. Theory, 51 8 , 2967–2976, Aug. 2005.  Lozano, A., A. M. Tulino, and S. Verdu, Mercury waterfilling: Optimum power allocation  with arbitrary input constellations, IEEE Trans. Inf. Theory, 52 7 , 3033–3051, Jul.  2006.  Lu, B., G. Yue, and X. Wang, Performance analysis and design optimization of LDPC-coded  MIMO OFDM systems, IEEE Trans. Signal Process., 52 2 , pp. 348–361, Feb. 2004. Mohammed, S. K., E. Viterbo, Y. Hong, and A. Chockalingam, MIMO precoding with X-   and Y-codes, IEEE Trans. Inf. Theory, 57 6 , 3542–3566, Jun. 2011.  Ngo, Q. T., O. Berder, B. Vrigneau, and O. Sentieys, Minimum distance based precoder for  MIMO-OFDM systems using a 16-QAM modulation, in Proc. of the IEEE Int. Conf.  Comm.  ICC , Dresden, Germany, Jun. 2009.  Ngo, Q. T., O. Berder, and P. Scalart, 3-D minimum Euclidean distance based sub-opti- mal precoder for MIMO spatial multiplexing systems, in Proc. of the IEEE Int. Conf.  Comm.  ICC , Cape Town, South Africa, May 2010.  Ngo, Q.-T., O. Berder, and P. Scalart, General minimum Euclidean distance based precoder   for MIMO wireless systems, EURASIP J. Adv. Sig. Process., March 2013.  Palomar, D. P. and Y. Jiang, MIMO transceiver design via majorization theory, Foundations   and Trends in Communication and Information Theory, 3 4–5 , 2007.  Palomar, D. P., J. M. Cioffi, and M. A. Lagunas, Joint Tx-Rx beam-forming design for mul- ticarrier MIMO channels: A unified framework for convex optimization, IEEE Trans.  Signal Process., 51 9 , 2381–2401, Sep. 2003.  Paulraj, A., R. Nabar, and D. Gore, Introduction to Space–Time Wireless Communications,   Cambridge University Press, Cambridge, UK, 2003.  Payaro, M. and D. P. Palomar, On optimal precoding in linear vector Gaussian channels with  arbitrary input distribution,in Proc. of the IEEE Int. Symp. on Inform. Theory  ISIT ,  Seoul, Jun. 2009.      158  ◾  MIMO Processing for 4G and Beyond  Perez-Cruz, F., M. R. D. Rodrigues, and S. Verdu, MIMO Gaussian channels with arbi- trary inputs: Optimal precoding and power allocation, IEEE Trans. Inf. Theory, 56 3 ,  1070–1084, Mar. 2010.  Razi, A., D. J. Ryan, I. B. Collings, and J. Yuan, Sum rates, rate allocation, and user sched- uling  for  multi-user  MIMO  vector  perturbation  precoding,  IEEE  Trans.  Wireless  Commun., 9 1 , 356–365, Jan. 2010.  Rusek,  F.  and  D.  Kapetanović,  Design  of  close  to  optimal  euclidean  distance  MIMO-  Precoders, IEEE Int. Symp. Inf. Theory, Seoul, Korea, June. 2009.  Ryan, D. J., I. B. Collings, I. V. L. Clarkson, and R. W. Heath, Performance of vector per- turbation multiuser  MIMO  systems with limited feedback, IEEE Trans. Commun.,  57 9 , 2633–2644, September 2009.  Scaglione, A., P. Stoica, S. Barbarossa, G. B. Giannakis, and H. Sampath, Optimal designs  for space-time linear precoders and decoders, IEEE Trans. Signal Process., 50 5 , 1051– 1064, May 2002.  Taherzadeh, M. A., Mobasher, and A. K. Khandani, Communication over MIMO broad- cast channels using lattice-basis reduction, IEEE Trans. Inf. Theory, 53 12 , December  2007.  Telatar, I., Capacity of multi-antenna Gaussian channels, European Trans. Tel., 10 6 , 585–  595, Nov.-Dec. 1999.  Vrigneau,  B.  et  al.  Extension  of  the  MIMO  precoder  based  on  the  minimum  Euclidean  distance: A cross-form matrix, IEEE J. Select.Top. Signal Process., 2 2 , 135–146, April  2008.  Vu, M. and A. Paulraj, Optimal linear precoders for MIMO wireless correlated channels  with nonzero mean in space-time coded systems, IEEE Trans. Signal Process., 54 6 ,  2318–2332, June 2006.  Windpassinger, C., R. F. H. Fischer, and J. B. Huber, Lattice-reductionaided broadcast pre-  coding, IEEE Trans. Commun., 52 12 , 2057–2060, December 2004.  Xiao,  C.,  Y.  R.  Zheng,  and  Z.  Ding,  Globally  optimal  linear  precoders  for  finite  alpha- bet signals over complex vector Gaussian channels, IEEE Trans. Signal Process., 59 7 ,  3301–3314, July 2011.  Yao H. and G. W. Wornell, Lattice-reduction-aided detectors for MIMO communication  systems,  in  Proc.  of  the  IEEE  Global Telecomm.  Conf.   GLOBECOM , Taipei,  Nov.  2002.  Zheng  L.  and  D.  N.  C. Tse,  Communication  on  the  Grassmann  manifold:  A  geometric  approach  to  the  noncoherent  multiple-antenna  channel,  IEEE  Trans.  Inf.  Theory,  48 2 , 359–383, Feb. 2002.      Chapter 4 MIMO Optimized  for OFDM  Nuno Souto and Francisco A. Monteiro  Contents 4.1  System Characterization ...........................................................................161 4.1.1  OFDM Signaling ..........................................................................161 4.1.1.1  SISO-OFDM .................................................................161 4.1.1.2  MIMO-OFDM ..............................................................168 4.1.2  Transmitter Structure ...................................................................169 4.1.3  Channel Coding ...........................................................................170 4.1.3.1  Convolutional Turbo Encoder ........................................170 4.1.3.2  LDPC Codes ..................................................................172 4.2  Conventional Receivers ............................................................................175  4.2.1  Zero-Forcing, Minimum Mean Squared Error, and Maximum   Likelihood Detector ......................................................................175 4.2.2  Channel Decoder ..........................................................................179 4.2.2.1  Turbo Decoder ...............................................................179 4.2.2.2  LDPC Decoder—Sum-Product Algorithm ....................181 4.2.3  Channel Estimation ......................................................................184 Iterative Receivers .....................................................................................186 4.3.1  Receiver Structure .........................................................................186 4.3.2  Iterative Channel Estimation ........................................................189  4.3   159   160  ◾  MIMO Processing for 4G and Beyond  4.3.2.1  Data Multiplexed Pilots ..................................................189 4.3.2.2  Implicit Pilots .................................................................189 4.4  Lattice-Reduction-Aided Receivers ..........................................................195 4.4.1  Soft Metrics from LRA Receivers .................................................195 4.4.2  Performance Results .....................................................................197 4.5  MIMO-OFDM with Signal Space Diversity ............................................199 4.5.1  Complex Rotation Matrices ..........................................................199 4.5.2  Transmitter for OFDM Schemes with CRM ............................... 200 4.5.3  Receivers for OFDM Schemes with CRM ................................... 200 Acknowledgments .............................................................................................207 References .........................................................................................................207  The ever-increasing demand of high transmission rates in broadband wireless sys- tems poses major design challenges especially due to the severe time dispersion  occurring in mobile radio channels. Emergent radio systems often resort to block  transmission techniques with frequency domain equalization  FDE  methods in  order to sustain the envisioned data rates. Owing to the capability of converting  a frequency selective channel into several parallel flat fading channels allied to  their implementation simplicity both at the transmitter and receiver, orthogonal  frequency-division multiplexing  OFDM  schemes have become the most popular  and were incorporated into numerous communications standards, for example,  digital video broadcast  DVB  and 4G systems, namely, LTE-Advanced [3GPP  2012]  and  WirelessMan-Advanced  [IEEE  2011a].  Because  of  its  popularity,  OFDM has been frequently combined with the use of multiple-input multiple- output  MIMO  techniques in order to improve its performance and or capacity.  As a consequence, 4G specifications such as 3GPP LTE-Advanced already include  a wide variety of MIMO transmission modes [3GPP 2012; 3GPP 2013a] support- ing both single-user MIMO  SU-MIMO  and multiuser MIMO  MU-MIMO   in uplink and downlink as well as coordinated multipoint  CoMP  transmission  and reception.  This chapter describes the use of OFDM with MIMO schemes in severely time- dispersive channels. Section 4.1 presents a general explanation of MIMO-OFDM  signal representation and transmitter implementations as well as the combination  with coding. Section 4.2 presents the application of several conventional MIMO  detection  methods  and  channel  decoders  in  OFDM  systems  also  taking  into  account the problem of channel estimation. Section 4.3 describes the use of itera- tive receiver configurations while the use of lattice-based receivers is explained in  Section 4.4. In Section 4.5, it is shown how signal space diversity based on complex  rotation matrices  CRM  can provide good performance gains in MIMO-OFDM  systems without sacrificing spectral efficiency.      MIMO Optimized for OFDM  ◾  161  4.1  System Characterization 4.1.1  OFDM Signaling 4.1.1.1  SISO-OFDM We will start this section by considering a SISO multicarrier transmission where  a stream of N symbols is divided into N parallel streams, each mapped to a dif- ferent subcarrier. Each of the N symbols is transmitted with a duration N times  larger than what it would be if they were transmitted sequentially or, equivalently,  the transmission rate of each subchannel is N times lower than in a single carrier  transmission. In this case, the corresponding complex envelope can be written as  s t      =  S r t k     exp   j  π 2  kFt   ,  1  N  −∑  k  =    where F is the subcarrier spacing, Sk is the modulated symbol mapped onto the kth  subcarrier and r t  is the transmitted pulse. Applying the Fourier transform to this  expression allows us to obtain the equivalent frequency domain representation as     0  S f       =  S R f   k  −  kF   ,  1  N  −∑    where R f   is the Fourier transform of r t . In order to avoid intercarrier interfer- ence  ICI , it is necessary to ensure that R f   obeys the orthogonality condition     =  0  k  R f    −  kF R f       *  − ′  k F df     =  0  ,  ∀  k k ,  ′ ∈  { , 0  …  ,  N  −  } : 1  k  ≠ ′ k  .   4.3      Although a conventional frequency domain multiplexing  FDM  transmission  where R f   has an associated bilateral bandwidth smaller than F verifies the orthog- onality condition, it is also possible to fulfill it even when the bandwidths of the  translated R f   overlap [Marques da Silva et al. 2010]. This happens, for example,  when we employ  R f       =  sinc     f F     ,    which corresponds to a rectangular pulse with duration 1 F in the time domain,  that is      4.1    4.2    4.4    4.5   +∞  ∫  −∞        r t      =  F  ⋅  rect   ⋅ t F   .         162  ◾  MIMO Processing for 4G and Beyond  This type of FDM transmission where the total bandwidth is divided into sev- eral parallel overlapping subbands allows a more efficient use of the bandwidth and  is referred to as OFDM. According to Equation 4.1, an OFDM transmission could  be  simply  implemented  as  N  parallel  single  carrier  transmissions,  each  working  with a different subcarrier frequency fk = fc + kF, where k = 0,. . ., N − 1 and fc is the  frequency of the first subcarrier. However, this approach is not practical for large  N, due to the increasing number of oscillators and multipliers required. A simpler  implementation can be obtained using a sampled version of Equation 4.1 followed  by a digital-to-analog conversion  DAC  and a reconstruction filter applied to the  in-phase and quadrature components of the samples. To understand how work- ing with a sampled version of Equation 4.1 allows a simpler construction of the  signal, let us assume a sampling frequency of Fa = NF. In this case, we can write the  sequence of samples of Equation 4.1 as  s  = t   n NF  1  N  −∑ exp  S r k n     j  π 2  k  n N       = =  = 0 k Nr s n n  ,     where r  n  cid:24    r t  =    n NF   ,        s  n   cid:24  1 N  1  N  −∑  =  0  k  S  k  exp  j  π 2  k     n N    =  IDFT{ S  k  },      4.6    4.7   and IDFT is the inverse discrete Fourier transform  in this case of sequence Sk . Note  that, according to Equations 4.6 and 4.7, apart from the scalar factor N, the sam- pled version of the complex envelope s t  can be simply obtained by multiplying the  samples of the transmission pulse r t  with the IDFT of the block of N-modulated  data symbols Sk, which can be efficiently implemented using an inverse fast Fourier  transform   IFFT   algorithm.  The  corresponding  implementation  is  illustrated  in  Figure 4.1. The “Add CP” block represents the insertion of the cyclic prefix  CP ,  which will be explained further ahead while the “D A” blocks correspond to a DAC.  Sk  1:N  IFFT  N:1  . . .  . . .   Windowing  sn  Add CP  D A  rn  Figure 4.1  OFDM transmitter implementation using IFFT.      MIMO Optimized for OFDM  ◾  163  Multipath replicas of the  preceding block  IBI   OFDM block  Figure 4.2   Interblock interference caused by the multipath propagation.  The use of the minimum sampling rate, Fa = NF, complicates the implementa- tion of the reconstruction filter required for generating the wave shape s t , and thus  oversampling is often applied. A higher sampling rate can be simply obtained by  using Nnull null subcarriers in each block, that is, using Sk = 0 for k =  N − Nnull  2, . . ., N + Nnull  2 − 1, which corresponds to an oversampling factor of     M  os  =  N − N N  null  .      4.8   Apart  from  the  details  of  signal  construction,  the  main  idea  of  OFDM  is  to  convert a large bandwidth channel into several parallel lower bandwidth subchan- nels. Since in a typical wireless environment, a large bandwidth channel will often  undergo frequency selective fading, which results in intersymbol interference  ISI ,  the use of lower bandwidth subchannels allows each of them to experience flat fading  only, thus avoiding the ISI problem inside an OFDM block. Still, as shown in Figure  4.2, it can exist ISI caused by the multipath propagation of the preceding block,  which is often referred to as interblock interference  IBI . To cope with this problem,  a guard period, TG, with duration longer than the channel delay spread, Tm, is usu- ally added to the beginning of each OFDM block in the time domain as shown in  Figure 4.3. Although the guard period can simply be an empty slot  denoted as zero   Multipath replicas of the  preceding block  Guard period  Useful interval  Figure 4.3  Use of an all-zero guard period to avoid IBI.      164  ◾  MIMO Processing for 4G and Beyond  padding—ZP , in order to simplify the equalization in the frequency domain at the  receiver, a repetition of the last NCP samples of the OFDM block is often used instead.  This allows the linear convolution of the channel with the OFDM block to be seen as  a circular convolution. To avoid IBI, we must use NCP ≥ L − 1, with L = Fa Tm being  the length of the channel impulse response. This type of guard period is denoted  as cyclic prefix  CP  and is illustrated in Figure 4.4. Besides ZP- and CP-assisted  schemes, it is also possible to use pseudonoise  PN  symbol sequences.  Taking into consideration the structure of the OFDM signal, after transmis- sion through the channel, the time domain samples, yn n = −NCP,. . .,N − 1 , of the  received OFDM block can be written as  y  n  =  h s l n l  +−  v  n  ,  1  L  −∑  =  0  l      4.9         where hl is the time domain channel coefficients  which we assume time invari- ant  inside  the  block   and  vn  represents  independent  and  identically  distributed  Gaussian noise samples. Since only the CP samples will contain IBI and these are  discarded at the receiver, we can neglect the preceding OFDM block and rewrite  Equation 4.9 in a convenient matrix format as  y  =  Ω in C s  +  v  ,     4.10   Cyclic prefix  NCP samples   Useful interval   N samples   Multipath replicas of the  preceding block  Cyclic prefix  NCP samples   Useful interval   N samples   Figure 4.4  Use of CP to avoid IBI.      MIMO Optimized for OFDM  ◾  165  where y and v are length N + NCP column vectors containing respectively yn and vn  as elements and Ω is a  N + NCP  ×  N + NCP  matrix defined as  ΩΩ =  h 0 h 1  0 0            cid:31  0 h 0 0  cid:30   cid:30   cid:31    cid:31   0  cid:31   h − 1 L 0   cid:31  h L  − 1  h 0  cid:31   0 0  cid:29  0 h 0           .     The length N column vector s contains the time domain-transmitted samples  sj j = 0,. . ., N − 1  as elements, which, following Equation 4.7, can also be written as  s  = 1 N  H , F S     where s is a length N column vector whose elements are the modulated symbols  Sk  k = 0,. . ., N − 1 , and F represents the N × N discrete Fourier transform  DFT   matrix defined as  F =  1   1   1   cid:30    1   1 ω 1 ω  cid:30  N  2     ω  − 1        ω  1 ω 2 ω  cid:30  − N 1 2    4   cid:31   cid:31   cid:31   cid:29   cid:31   1 N  − 1        N  − 1        ω ω 2   cid:30  −      1  N −     N  ω        1     ,     with  ω  being  an  Nth  primitive  root  of  unity,  ω = exp −j2π N .  Note  that  in  Equation 4.12  ⋅ H denotes the conjugate transpose operation, which, when applied  on the scaled DFT matrix  1 N F, converts it into an IDFT operation.  CP  insertion  is  accomplished  in  Equation  4.10  through  the   N + NCP  × N   matrix Cin defined as  ×  CP  −  N N    representing a size NCP ×  N − NCP  matrix full of zeros and IN  with 0N denoting an N × N identity matrix. The CP removal at the receiver can be per- formed using an N ×  N + NCP  matrix Crm defined as  CP  C  in  =  CP  0 × −  N N N          I  N         CP  I  N  CP      ,     C  rm  =  [  0  N N  ×  CP  I  N  ],     4.11    4.12    4.13    4.14    4.15                      166  ◾  MIMO Processing for 4G and Beyond  followed by the conversion of the samples to the frequency domain using a DFT   which can be efficiently implemented using an FFT  according to  R  =  =  =  FC y rm 1 N 1 N  H  ΩΩ  in  C F S  rm  FC  cid:29  ΩΩ F F S N  +  H  ,  +  FC v rm     =  rm .   N FC v   cid:29  ΩΩ  in represents the combination  of the channel with the CP insertion and removal operations. It is simple to verify  that   In Equation 4.16, size N × N matrix   cid:29  ΩΩ is a circulant matrix that can be written as  Crm  = C  ΩΩ   cid:31  ΩΩ  =  C  Crm  ΩΩ  in  =   cid:30  0 h 0 0  cid:29   cid:29   cid:30   h L  − 1  h − 1 L 0   cid:30  h L  − 1   cid:30  h L  − 1  h 2  cid:30   h 0  cid:30  cid:30    cid:30   0  cid:30   h 0 h 1       0   0  h 0 , L  h 1 h 2  cid:28  0 h 0              =  circ h { 0  ,  … 0 ,  ,  … ,  ,  h 1  }.  − 1  Therefore, we can apply the well-known decomposition of circulant matrices  into the product of a conjugate transpose DFT matrix, a diagonal matrix, and a  DFT matrix and write   4.16    4.17    4.18    4.19    4.20    cid:29  ΩΩ = 1 N  HF HF,     H  =  =  }  {   cid:31  ΩΩ 1 F :, 0 H  diag H  0  0    cid:28   cid:29   cid:29   0 0    cid:30   1   cid:30  0  cid:29   cid:28  0 H N         ,  − 1     where  where                     MIMO Optimized for OFDM  ◾  167  with               4.21    4.22    4.23    4.24   H  k  =  DFT{  h n  }  =  h n  exp  1  L  −∑  =  0  n  −   j  π 2  kn N     .     In Equation 4.20, ΩΩ:,1 cid:22    represents the first column of ΩΩ. cid:22   Note that in Equation  4.21 we took into account that since the length of the channel impulse response  is L, we have hn = 0 for n ≥ L. Bearing in mind that the DFT matrix defined in  Equation 4.13  which is not in a unitary form  follows the following property:  H  FF  NN= I  ,    R HS N  =  +  .    R  k  =  H S k  k  +  N  k  ,    then, inserting Equation 4.19 into Equation 4.16 results in  Since h is diagonal, the frequency domain samples in r can thus be simply   expressed as  which  means  that  in  the  frequency  domain,  the  channel  in  each  subcarrier  is  equivalent  to  flat  fading,  represented  by  the  single  multiplicative  coefficient  Hk,  and no ICI exists. This allows very simple equalization at the receiver end since  it can be accomplished with a simple multiplication by 1 Hk. The processing just  described, apart from the equalization, is illustrated in Figure 4.5. It is important  to note that although OFDM is robust in frequency selective channels and can be  implemented with low complexity both in the emitter and receiver, it still has some  weaknesses. For example, being similar to a transmission in a flat fading chan- nel, its uncoded performance is rather poor. Furthermore, its high peak-to-average   A D  yn  Remove  CP  1:N  FFT  N:1  Rk  . . .  . . .  Figure 4.5  OFDM receiver implementation using FFT.      168  ◾  MIMO Processing for 4G and Beyond  power  ratio   PAR   leads  to  difficulties  in  transmitter  amplification  and  receiver  analog-to-digital conversion.  4.1.1.2  MIMO-OFDM Let us now characterize the OFDM signal when combined with MIMO schemes  with Mtx transmitting antennas and Nrx receiving antennas. In this case, the trans- mitter can be implemented using Mtx parallel chains similar to the one presented in  Figure 4.1. After the transmission through the channel, the time domain samples,  n   t = −NCP,. . ., N − 1 , of the received OFDM block in each receiver antenna n  yt  n = 1,. . ., Mtx  can be written as  m n,  represents the lth time domain channel coefficient between transmit  where  hl antenna  m  and  receive  antenna  n,  sl m  is  the  lth  time  domain  sample  transmit- ted  using  antenna  m  and  vt n  represents  independent  and  identically  distributed  Gaussian noise samples in receive antenna n. Considering the use of a CP between  adjacent OFDM blocks, we can rewrite Equation 4.25 in a matrix format as  n as elements, sm contains the time domain transmitted samples sl  where  y n   and  vn  are  length  N + NCP  column  vectors  containing  respectively  yt n   and vt m and Ω is a   N + NCP  ×  N + NCP  matrix defined as Equation 4.11 containing the time domain  channel coefficients hl  m n,  between transmit antenna m and receive antenna n.  The received frequency domain samples for antenna n can be computed through  multiplication by the pilot removal matrix Crm defined in Equation 4.15 and by the  DFT matrix, that is, using  Using the same derivation presented for the SISO scheme, it is simple to verify  that the frequency domain samples for each subcarrier k and receive antenna n can  be expressed as  y  n t  =  M  L  − 1  tx  ∑∑  m  = 1  l  =  0  m n , h l  s  +− m l t  v  n t  ,  n  y  =  M  tx  ∑ΩΩ ,  m n  m  = 1  m  C s in  +  n  v  ,        n  R  =  FC y rm  n  .    R  n k  =  M  tx  ∑ , m n H S k  m  = 1  m k  +  N  n k  .      4.25    4.26    4.27    4.28                   MIMO Optimized for OFDM  ◾  169  According to this expression, the transmission in each subcarrier is equivalent  to a MIMO transmission in a flat fading channel without ICI, allowing the direct  application of well-known MIMO detection methods as will be detailed in some  of the following sections.  4.1.2  Transmitter Structure Figure 4.6 shows a typical configuration for a MIMO-OFDM baseband transmit- ter chain. According to this scheme, an information stream is first encoded, inter- leaved, and mapped onto the constellation symbols from a specific modulation  e.g.,  QPSK, M − QAM . If spatial multiplexing is being used, the sequence of modu- lated symbols is split into several smaller streams that are transmitted simultane- ously by Mtx antennas. Conversely, if transmit diversity is being used, the sequence  of modulated symbols can be coded using a space–time block code  STBC  like the  Alamouti scheme for two antennas [Alamouti 1998]. When STBCs are employed  in OFDM systems, the time domain is often replaced by the frequency domain  and the resulting codes are referred to as space–frequency block codes  SFBC . In  both cases, spatial multiplexing and transmit diversity modes, pilot symbols can  be inserted into the parallel-modulated symbol sequences before conversion to the  time domain using IDFTs. These pilot symbols can be used for channel estimation  purposes, as will be explained in Section 4.2.3. The sequences of symbols are then converted into the time domain through  { s i , ,   is  the  sym-   where  Sk l m m i l , bol transmitted by the kth subcarrier of the lth OFDM block using antenna m.  Although not detailed in the chain of Figure 4.6, as explained in Section 4.1.1,  before being transmitted, windowing is applied to the time domain samples  si l , ,  m , , i = 1,. . ., NCP , DAC, and reconstruc- followed by CP insertion  with s tion filtering.  } = 1  =, m − i l  IDFT  The transmit chain just described corresponds to a unicast transmission but  can be easily extended to broadcast schemes, as presented in [Souto et al. 2008]  for the case of MIMO-OFDM systems combined with hierarchical modulations,   m N i l  { S  } 1  , , 0 1  , , 0 1  …  …  N  N  m k l ,  =  =  −  −  k  s  ,  ,  ,  ,  −  Channel coding  Interleaver  Modulation  mapper  SFBC  serial to parallel  Pilot symbols  ... ...  IDFT  Antenna 1  S1 k,l  Mtx Sk,l  IDFT  Antenna Mtx  Pilot symbols  Figure 4.6  Generic baseband MIMO-OFDM transmitter chain.      170  ◾  MIMO Processing for 4G and Beyond  where multiple data streams with different error protection levels are transmitted  in parallel.  4.1.3  Channel Coding As explained in Section 4.1.1, OFDM allows us to convert a frequency selective chan- nel into several parallel flat fading channels. Although this solves the ISI problem  in severely time-dispersive channels, OFDM does not take advantage of frequency  diversity and, therefore, some subcarriers may experience deep fades thus compro- mising the reliable detection of the respective symbols. As a result, the performance  of OFDM is rather poor when compared with other schemes like single carrier block  transmission [Marques da Silva et al. 2010]. To circumvent this problem, OFDM  is usually combined with the use of channel codes. As examples of codes used in  OFDM systems, we have tail-biting convolutional codes that are specified for LTE- Advanced  [3GPP  2013b]  and  WirelessMan-Advanced  [IEEE  2011a]   for  control  channels , convolutional turbo codes  CTC , which are specified for 4G systems,  namely, LTE-Advanced [3GPP 2013b] and WirelessMan-Advanced [IEEE 2011a],  block  turbo  codes,  which  are  used  as  optional  coding  in  mobile  WiMax  [IEEE  2006], and low-density parity check codes  LDPC , which have been incorporated  into WiMax [IEEE 2006], DVB-T2 [ETSI 2009b], DVB-S2 [ETSI 2009a], and  IEEE Std 802.11n-2009 [IEEE 2011b]. Owing to their importance nowadays, we  will briefly describe CTCs and LDPC codes in the following sections.  4.1.3.1  Convolutional Turbo Encoder A CTC is formed by the parallel concatenation of recursive systematic convolutional   RSC  codes. As an example, Figure 4.7 portrays the turbo encoder employed in LTE- Advanced [3GPP 2013b], which is composed by two RSC encoders and an interleaver  represented by the permutation function Π1 ⋅ . The same information block is applied  at the input of both constituent encoders but one of them sees an interleaved version  of the block. This way, although both encoders are processing the same information  bits, the output code words are different. According to the encoder of Figure 4.7, if  the input block has size Nb, the interleaver will have the same size and the output code  word will be composed of Nb systematic bits and 2Nb parity bits generated by the two  constituent encoders. However, after encoding the input sequence, both constituent  encoders are terminated into the all-zeros state as detailed in [3GPP 2013b], thus  generating 12 additional tail bits. The overall coding rate is thus slightly lower than  1 3. Nevertheless, similar to the convolutional codes, the output of the turbo encoder  can be punctured, usually the parity bits, to increase the coding rate.  If  the  memory  of  each  component  encoder  e   in  Figure  4.7  e = {1,2}   is ν,   f the feed-forward and feedback connections can be defined as ge   = 0 1   For  the  specific  case  and  ge b of  Figure  4.7,  and  since  both  constituent  encoders  are  identical,  we  have   f b     respectively,  with  g e i ,  f 0 … ν e ,  0 … ν b e ,  { , }.  =   =   f e ,  b e ,    g  g  g  g  ,      MIMO Optimized for OFDM  ◾  171  bt  ds t  p d 1,t  p d 2,t  ap 1,t  p a2,t  Π1  ·   p a1,t–1  p a1,t–2  p a1,t–3  p a2,t–1  p a2,t–2  p a2,t–3  Figure 4.7  LTE-Advanced turbo encoder scheme.  1 1 0 1  and ge  f = [ ge of bits is b =  1… , the systematic and parity sequences will be b  1 0 1 1  Considering that the input sequence   b = [  bNb  ].    ]        d  s t  d  p e t  b t  = ∑, =  ν  i  =  0  f g a e i ,  e t ,  −  i  .           In Equation 4.29, the coefficients ae,t are expressed as  a  e t ,  =  b ∏  − 1 − e  ν  ∑1  ⊕  t      i  = 1  g a b e i ,  e t ,  −  i  ,      4.29    4.30   t  1  − ∏ − e  where b 1     is the tth bit at the input of encoder e  after the interleaver . The  interleaver is denoted by the permutation function ∏e ⋅ . For the first encoder, since  there is no interleaver, it simply encodes the input sequence directly, which is equiv- alent to having a permutation function ∏0 t  = t. In all these expressions, the sums  are modulo-2 additions.  Although the interleaver can be a block pseudorandom interleaver, other types are  possible as described in Heegard and [Wicker 1999]. The information sequence fed  to the second component encoder is reordered in such a way that it becomes decor- related from the original input sequence as much as possible. In fact, the use of such       172  ◾  MIMO Processing for 4G and Beyond  R E B  10–1  10–2  10–3  10–4  10–5  10–6  0  Uncoded Turbo code  R = 1 3   1  2  4  5  6  3  EB N0  dB   Figure 4.8  BER performance of 3GPP rate-1 3 turbo code [3GPP 2013b] in AWGN.  type of concatenation of two convolutional encoders separated by an interleaver has  the objective of producing a set of code words where very few of them have low weight.  This does not necessarily mean that the resulting code will have a particularly large  free distance but at least the number of nearest neighbors of each code word will be  substantially reduced. The substantially improved weight distribution of the resulting  code words is one of the main reasons for the good performances of turbo codes. This  weight distribution is also responsible for the typical turbo code performance curve  in additive white Gaussian noise  AWGN , which can be seen in Figure 4.8. These  curves are usually divided in two main zones. The first is located in the low SNR  region and is characterized by an abrupt decrease in the bit error rate  BER , which is  mostly caused by the existence of a low number of nearest neighbors surrounding each  code word. The second zone is located in higher SNR regions and is characterized by  a slower descent of the performance curve. This is caused by the not particularly high  free distance of the turbo code due to the few low-weight code words.  4.1.3.2  LDPC Codes LDPC  codes  were  initially  proposed  by  Robert  Gallager  in  1962,  in  [Gallager  1962],  who  showed  that  with  a  careful  design  of  the  parity  check  matrix,  they  could achieve near Shannon limit performance using iterative probabilistic-based       MIMO Optimized for OFDM  ◾  173  d1  d2  d3  d4  d5  d6  d7  H =  1 0 0 1 0 1 1 0 1 0 1 1 1 0 0 0 1 0 1 1 1  c1  c2  c3  Figure  4.9  Hamming  code   7,4   parity  check  matrix  and  respective  Tanner  graph.  decoders. However, the high complexity associated with the encoding and decod- ing processes made them computationally impractical at the time, and for 30 years,  they  did  not  attract  the  attention  of  the  research  community.  After  the  advent  of the turbo codes, the interest in these codes reappeared with the rediscovery of  Gallager codes in [MacKay and Neal 1995, 1996] who showed that they could  achieve similar performances. For this reason, LDPCs have been incorporated into  several standards: WiMax [IEEE 2006], DVB-T2 [ETSI 2009b], DVB-S2 [ETSI  2009a, IEEE Std 802.11n-2009] [IEEE 2011b], and so on.  LDPC codes are  n,k  linear block codes  although it is also possible to build  LDPC convolutional codes  defined through very sparse  n − k  × n parity check  matrices h* that satisfy  H d  ⋅  =T  0    for any code word d =  Each line of matrix h represents an  equation that must be verified by a sequence d in order to be a valid code word. For  example, regarding a  7,4  Hamming code whose parity check matrix is displayed  in Figure 4.9, its parity check equations can be written as  …  dk  ].  d  d  − 1  [     1  0   4.31    c  c   c   1  2  3  = = =  d 1 d d  2  3  ⊕ ⊕ ⊕ ⊕  ⊕ ⊕ ⊕ ⊕ ⊕  d 4 d d  d 6 d d  4  5  5  6  d 7 d d  7  6  ,   4.32     where ⊕ represents modulo-2 addition. In this case, d is a code word as long as  c1 = c2 = c3 = 0.     *  Although in the previous sections and in most of the chapters, we use h for representing the chan- nel matrix, in this subsection, we use symbol h for representing parity check matrices due  to its  widespread use in the literature. However, this representation is only required in this subsection  and in Section 4.2.2 and thus there is no risk of confusion in the remainder of the chapter.      174  ◾  MIMO Processing for 4G and Beyond        Since LDPC codes are defined through a parity check matrix h, it is necessary  to obtain the k × n generator matrix g from this one in order to perform the encod- ing process using  d  =  ⋅  .   b G   4.33   The traditional method used in block codes consists of transforming matrix h  into a systematic form using Gaussian elimination method and column permuta- tions resulting in  H  ′ =  [  P   cid:20   I − n k  ],    where P is a  n − k  × k parity submatrix and In−k is the  n − k  ×  n − k  identity  matrix. From Equation 4.34, it is simple to obtain the generator matrix as      4.34   G  = [  I  k   cid:20   T P  ].      4.35   Although this method seems straightforward, it does not take into account the  sparseness of the original matrix h and, as such, the resulting generator matrix G is  likely to be dense. As a consequence, the encoding complexity can become significant,  especially for large matrices  which are usually associated with better performances .  Other lower-complexity approaches have been proposed, which take advantage of the  sparseness of h. For example, as proposed in [Richardson and Urbanke 2001b], it  is possible to transform h into an almost lower triangular form using only row and  column permutations, thus preserving the sparseness of the matrix. Then, Gaussian  elimination is applied to the rows that do not match the triangular form. These rows  are called the gap since they will be associated with the high-density part  higher  complexity   of  the  encoding  process.  The  presence  of  the  other  low-density  rows  allows the use of back substitution for the corresponding parity bits.  The LDPC code specified for WiMax [IEEE 2006] is defined using a parity  check matrix h built from circulant submatrices and allows the encoding process  to be efficiently implemented using back substitution with a gap of n 24.  In [Tanner 1981], the use of bipartite graphs, named Tanner graphs, was pro- posed as a simple approach for characterizing a  n,k  linear code. As an example,  Figure 4.9 shows the Tanner graph associated with a  7,4  Hamming code. The  graph is composed of two types of nodes: parity check nodes  cj  and variable nodes   di . Each parity check node is associated with a parity check equation while each  variable node is associated with a code bit. The construction of the graphs is sim- ple. Each parity check node  cj  is connected to all the variable nodes  di  that are  involved in the respective parity check equation  according to Equation 4.32 .  From the Tanner graph, it is possible to know the degree of each node by simply  counting the number of connections to that node. Since LDPC codes are defined  through very sparse matrices, the degrees of the nodes are much smaller than n.       MIMO Optimized for OFDM  ◾  175  If the degrees of all variable nodes are equal and the same happens to the degrees  of all parity check nodes, then the LDPC code is called regular, otherwise it is an  irregular LDPC code [Richardson and Urbanke 2001a]. Tanner graphs are use- ful to find the length of closed cycles. For example, in Figure 4.9, the existence  of a length four closed cycle associated with path c1 → d4 → c2 → d6 → c1 is vis- ible. When constructing LDPC codes, it is important to avoid short-length cycles,  which are associated with worse performances of the decoder algorithm.  4.2  Conventional Receivers 4.2.1   Zero-Forcing, Minimum Mean Squared Error,   and Maximum Likelihood Detector  In  this  section,  we  will  focus  on  conventional  OFDM  receivers  assuming  that  spatial multiplexing is being used. As previously explained, OFDM allows simple  equalization in the frequency domain where the channel can be seen as flat fading.  Therefore, the use of conventional MIMO decoders in an OFDM receiver with  Nrx receiving antennas is straightforward as we show in Figure 4.10. According to  the figure, the signal, which is considered to be sampled and with the cyclic prefix  removed, is converted into the frequency domain after an appropriate size-N DFT  operation. If the cyclic prefix is longer than the overall channel impulse response,  the resulting sequence received in antenna n can be expressed as  R  n k l ,  =  S H m k l ,  m n , k l ,  +  N  , , n k l   4.36   M  tx  ∑  m  = 1           m n ,   denoting  the  overall  channel  frequency  response  between  transmit  with  H k l , antenna m and receiving antenna n for the kth frequency of the lth time block and  N k l ,  denoting the corresponding channel noise sample. The sequences of samples  m  Equation 4.36  enter the MIMO equalizer  spatial demultiplexer block , which  separates the streams transmitted simultaneously by the multiple antennas, while  the other blocks basically reverse the operations applied at the transmitter.  In  the  following,  we  will  briefly  describe  conventional  methods  that  can  be  used in the spatial demultiplexer block for separating the simultaneous transmitted  streams. Details about the channel estimator block will be discussed in Section  4.2.3.  The most direct decoding technique is the zero-forcing  ZF , which simply uses   a straight channel matrix inversion   cid:22  k l S ,  =   cid:22   cid:22  H H H  H k l ,  k l ,   cid:22   ⋅     H k l ,  −    , 1R    k l ,   4.37       176  ◾  MIMO Processing for 4G and Beyond  n o i t a m r o f n I  s t i b  l e n n a h C  r e d o c e d  r e v a e l r e t n i - e D  r o t a l u d o m e D  o t   l a i r e S  l e l l a r a p  .....  l a i t a p S  r e x e l p i t l u m e d  l e n n a h C  r o t a m  i t s e    q    ,  n m ˆH  l , k  l , 1k R  ...  x r N  l , k R  T F D  T F D  T F D  T F D  . e r u t c u r t s   r e v i e c e r   l a n o  i t n e v n o C    0 1 . 4   e r u g i F      MIMO Optimized for OFDM  ◾  177  where k is the subcarrier index, l is the OFDM, S cid:22  k l,  is the Mtx × 1 estimated trans- mitted signal vector with one different transmit antenna in each position, H cid:22  k l,  is  the Nrx × Mtx channel matrix estimate with each column representing a different  transmit antenna and each line representing a different receive antenna, and rk,l is  the Nrx × 1 received signal vector with one different receive antenna in each posi- tion. The ZF approach can result in poor performance for some channel conditions  and, therefore, a minimum mean squared error  MMSE  linear receiver is often  used instead. The MMSE estimate is computed so that the minimum squared error,  s−  cid:22  2 , is minimized. In [Kay 1993], it is shown that the MMSE estimate is  E   s given by   cid:22  k l S ,  =   cid:22  H  H k l ,  ⋅      cid:22   cid:22  H H  k l ,  H k l ,  +  σ 2   − 1I R   , , k l   4.38   where σ 2 is the noise variance. Note that the ZF estimate  Equation 4.37  can be  obtained from Equation 4.38 by setting σ 2 = 0.  A well-known alternative detector for MIMO systems is the vertical Bell Labs  layered space–time  V-BLAST  architecture [Foschini 1996]. In this scheme, the  data bits to be transmitted are divided equally between the transmitting antennas  and are then coded, modulated, and transmitted independently, as seen in Chapter 2.  The decoder employs a relatively low-complexity approach based on nulling and  cancelation, which is an equivalent technique to the successive interference can- celation often used for multiuser detection in CDMA systems. The difference is  that the first performs the separation in the spatial channel domain while the latter  works on the code domain. A brief description of this method is given next. First,  the receiver performs a QR factorization [Friedberg et al. 2002] of the estimate of  the channel matrix H cid:22  k l, , that is  H cid:22  k l,  = QR   ,   4.39   where r is an Mtx × Mtx upper triangular matrix  rm,n = 0, m > n  with nonnegative  real-valued elements in the diagonal and q is an Mrx × Mtx matrix composed of   is the Mtx × Mtx identity  orthonormal column vectors  and thus Q Q I matrix . Multiplying the received vector by the Hermitian of q results in  , I Mtx  =  M  H  tx  y Q R  H  RS  k l ,  = =  = , v  k l , +  H  Q QRS     k l ,  +  N  k l ,         4.40   where  v = qH  nk,l  is  a  column  of  independent  complex  Gaussian  variables.  In  [Foschini 1996], it was shown that instead of multiplying y by r−1  completing a  zero-forcing operation , the transmitted symbols can be better estimated through  quantization and cancelation. This operation is performed taking into account the                178  ◾  MIMO Processing for 4G and Beyond              upper triangular structure of r, which allows a direct estimation of the Mtxth trans- mitted symbol from the last element of y according to  y  M  tx  =  M S r M M k l ,  ,  tx  tx  tx  +  v  M  tx  ⇒   cid:22  M S k l ,  tx  =  Q      M  y r M M  tx  ,  tx  tx      ,      4.41   where Q{} represents a quantization operation, which depends on the modulation  in use. In the case of element Mtx − 1 of y, it will suffer from interference of symbol  Mtx, which has to be canceled for obtaining an estimate of the respective transmit- ted symbol using  y  M  tx  − 1  =  − 1 ,  M  tx  − 1  − 1  tx  S  M k l ,  +  r M  M M k l ,  S  tx  tx  − 1 ,  tx  +  v  M  tx  tx  r M  cid:22  M S k , ll  ⇒  − 1  tx  =  1 − M 1 ,  r M  tx  − 1  tx     y  − 1  cid:22  S     .     M  tx  − 1  −  r M  M M k l ,  tx  tx  − 1 ,  tx   4.42   This approach can then proceed successively for the other elements of y accord-  ing to   cid:31  s m  =  1 r , m m      y  m  −  M  tx  ∑  = + 1 i m   cid:31  r S i , m i , k l  i      ,  m  =  .… 1 tx  M   4.43      Note that the order of the nulling and cancelation operations affects the per- formance  of  this  decoder,  and,  therefore,  a  permutation  specifying  the  order  in  which the symbols are extracted has to be applied before these steps are executed,  as explained in [Foschini 1996].  Another  alternative  decoding  method  is  the  optimal  maximum  likelihood  detector  MLD , which compares the received signal to all the possible transmitted  combination of symbols according to   cid:22  S  k l ,  =  arg min  R  k l ,  −   cid:22  H  S  k l ,  k l ,  .  S  k l ,      4.44   This method can become extremely complex as the number of antennas increases  or when high-order modulations are employed. The MLD generates hard decisions  for the modulated symbols but, when coding is used, it is important to work with  soft decisions so as to avoid a performance loss of the channel decoder. Therefore,  one can use other alternatives to the MLD such as a maximum likelihood-based  soft output  MLSO  decoder. In the MLSO decoder, we use the following estimate  for each symbol:      MIMO Optimized for OFDM  ◾  179   cid:22 S  m k l ,  = =  =   E S ∑  ∈ Λ  s i  ∑  ∈ Λ  si    R  m k l ,  m k l , k l ,   ⋅ s P S i    P S m , k l p   R  s i  ⋅     k l ,    R  p  R    =  s i  =  k l ,  s i    S  m k l ,  k l ,  =  s i    ,      4.45         with        where si corresponds to a constellation symbol from the modulation alphabet Λ, E[⋅]  is the expected value, P ⋅  represents a probability, and p ⋅  is a probability density      = 1  function  PDF . Considering equiprobable symbols, we have P S ,   M where M is the constellation size. The PDF values required in Equation 4.45 can  be computed as  m k l ,  =  s i     p  R  k l ,  S  m k l ,  =  s i    =  1 M  − 1  tx  M  −∑  ΛMtx 1  S  interff ∈ k l ,     p  R  , k l  S  m , k l  =  s i  ,  S  interf , k l   4.46     ,        p  R  k l ,  S  m k l ,  =  s i  ,  S  interf k l ,    =  1 2πσ 2       N  rx  exp       Nrx  ∑  n  = 1  −  R n k l ,  −  ss 2  ⋅   cid:22 H k l , 2σ  n   ,:  2  ,           4.47   interf  is a  Mtx − 1  × 1 vector representing a possible combination of symbols  where Sk l, transmitted simultaneously by all antennas except antenna m, s is an Mtx × 1 vector  composed by Sk l,  interf and si and   cid:22 Hk l n,   ,:  is the nth line of channel matrix   cid:22 Hk l, .  4.2.2  Channel Decoder 4.2.2.1  Turbo Decoder Although  the  code  word  weight  distribution  of  the  turbo  code  is  important  to  achieve good performances, it is also necessary to have a decoder algorithm that  is not excessively complex to be implemented. In fact, this is one of the key ideas  behind the success of these codes. Let us consider a turbo code composed of two- component RSC  like the one of Figure 4.7 . In theory, the turbo code can be mod- eled using a single Markov process but due to the existence of the interleaver at the  input of one of the constituent codes, this representation is extremely complex and  does not allow the direct implementation of computationally tractable algorithms.  Consequently, a maximum likelihood decoder for turbo codes cannot be employed  and some suboptimal decoder must be used in its place.      180  ◾  MIMO Processing for 4G and Beyond  Instead of modeling the whole code using a single Markov process, each of the  constituent codes can be associated with an individual Markov process and both  can be linked by an interleaver. A trellis-based decoding algorithm can be used for  estimating each of the Markov processes and, to improve the estimates, these two  processes can exchange information iteratively. A basic turbo decoder accomplish- ing this is shown in Figure 4.11, where   cid:22 b denotes the information bits sequence  estimate,   cid:22 bΠ  the  respective  interleaved  sequence,  y s  the  systematic  observations,  and y p,1 and y p,2 the two parity observations sequences. The two soft-input soft- output blocks implement a trellis decoding algorithm for the respective component  RSC encoders. Each of these blocks has three inputs and one output. Two of the  inputs correspond to the systematic and parity observations, both weighted by the  channel reliability factor Lc  Lc = 4Ec N0 . The third input is the a priori informa- tion obtained from the other decoder, which is represented in the form        L b   t ap     =  b log Prob  t b Prob  t  = + 1    . = − 1     4.48   The output of the soft-input soft-output decoders is the sequence of log-like- lihood ratios  LLRs  of the information bits, which can be written as the sum of  three terms:  L b   t     =  log  b Prob  t b Prob  t  = +  1 = −  1  y y       =  L y c  s t  +  L b   t ap     +  L b   e t 1 2    .   4.49      In  this  expression,  L be 1 2   t     is  the  extrinsic  information  produced  by  either  decoder 1 or 2. While the first two terms are inputs to the component decoders,  this third term represents new information derived in the decoder, which is used as  a priori information, Lap bt , by the other decoder. To obtain L be  , it is only nec- 1 2   t essary to subtract the weighted systematic observation and the a priori information   – –  ˆLe 1 b  Π1  ·   Soft-in Soft-out Block 1  Soft-in Soft-out Block 2  – –  ˆLe 2 bΠ  –1  ·  Π1  ˆL b  –1  ·  Π1  Π1  ·   Received  bits  Lc  DeMUX  Lcy p,1 Lcy p,2 Lcy s  Figure 4.11  Turbo decoder block diagram.      MIMO Optimized for OFDM  ◾  181  Pin dt  Pin bt  APP block  Pout  Pout  dt  bt  Figure 4.12  Soft-input soft-output APP module.  from the output  Equation 4.49  of the decoder. After passing this information  to the interleaver  or de-interleaver, depending on the target decoder , the other  decoder uses this extrinsic information as new a priori information and computes  new  estimates  for  the  log-likelihoods  of  the  information  bits.  The  exchange  of  extrinsic information between the two decoders can proceed until the information  sequence is correct  checked using CRC  or until a certain number of iterations is  completed. The output of the second decoder is then interleaved and some decision  function can be applied for obtaining the final estimates of the information bits.  This decoding process can be easily extended to multiple turbo codes as presented  in [Divsalar and Pollara 1995].  Each soft-input soft-output decoder can be implemented using a trellis decod- ing algorithm like the optimal maximum a posterori  MAP  algorithm [Bahl et al.  1974], its simplification max-log-MAP [Robertson et al. 1995], or the soft output  Viterbi algorithm  SOVA  [Hagenauer and Hoher 1989]. In [Robertson et al. 1995],  these three algorithms were compared and it was concluded that the MAP algorithm  clearly has the best performance but at the cost of a substantial complexity. The SOVA  exhibits a slight performance degradation compared with the max-log-MAP but has a  lower decoding complexity. Nevertheless, it was shown in [Fossorier et al. 1998] that  the SOVA can become equivalent to the max-log-MAP algorithm after a simple mod- ification. The MAP algorithm can also be used to compute a posteriori probabilities of  the encoder output symbols, as was shown in [Benedetto and Montorsi 1997] allow- ing the implementation of a soft-input soft-output module with four ports, as shown  in Figure 4.12. The two input ports correspond to the a priori probabilities of the  information symbols, Pin{bt}, and the probabilities of the coded symbols, Pin{dt}. The  other two ports output the probabilities associated with the input symbols, Pout{bt}  and with the coded symbols, Pout{dt}. This soft-input soft-output module capable of  outputting encoded symbols probabilities is useful in several applications where feed- back from the turbo decoder to other blocks of the receiver is required, as for example,  when implementing iterative joint estimation schemes.  4.2.2.2  LDPC Decoder—Sum-Product Algorithm Tanner graphs are useful for implementing iterative probabilistic decoding algo- rithms where the different types of nodes exchange messages  probabilities  accord- ing to the graph connections. In the following, we will briefly describe the iterative  sum-product  algorithm   also  known  as  belief  propagation  algorithm   assuming       182  ◾  MIMO Processing for 4G and Beyond  binary codes and working with log likelihood ratios  LLRs . The sum-product algo- rithm is a message passing-based algorithm with two types of messages:   ◾ Message  from  variable  node  dj  to  parity  check  node  ci,  which  takes  into  account all the messages coming from the other check nodes connected to  dj, with the exception of the message coming from the target check node ci:  L q   ij     =  L p    j     +  h L r   ′ ′ i j i j   .  n k  −∑  i i  ′= 1 ′≠ i      ◾ Message  from  parity  check  node  ci  to  variable  node  dj,  which  takes  into  account all the messages coming from the variable nodes connected to  ci,  with the exception of the message coming from the target variable node dj:  L r   ij     =  2  atanh  −  tanh    −  L q   ij  ′       2   4.51         n  ∏  ′= j 1 ′≠ ∧ j h ij  j  ≠′  0      .        In  these  expressions,  hi j′  represents  an  element  of  parity  check  matrix  h*.   Furthermore, the following logarithms of probability ratios are used:  L p    j     =  log  L q   ij     =  log  L r   ij     =  log           p 1 j −  p 1 j  q 1 ij − q 1 ij  1  1        ,  ,        r 1 ij −  r 1 ij     ,  1     p 1 j  =  p y d     j  j  =  1  .       where  p j  1 is the likelihood probability associated with bit dj being 1, that is  In AWGN, Equation 4.52 can be written as  L p    j     =  y  j  =  2 σ 2  2 2  N  0     E y  c  j  ⋅  =  4  c  ⋅ E N y 0  j  =  L y c  j  ,     *  In this subsection, we are repeating the use of symbol, h, for representing the parity check   matrix as in Section 4.1.3.   4.50    4.52    4.53    4.54    4.55    4.56                          4.57    4.58    4.59    4.60   MIMO Optimized for OFDM  ◾  183  with Lc corresponding to the reliability factor defined as  L c  =  2 σ 2  =  2 2     N  0     ⋅  E  c     =  4  c  ⋅ N  E 0      R is the code rate and Eb is the bit energy .  In Equation 4.51, the following hyperbolic functions are used:  E  c  =  R E  ⋅  b     tanh   x  =  2  x  2  x  e e  − +  1 1    atanh    x  =  log  1 2  1 1  + −  x x  ,  x  <  1  .     The algorithm starts with L rij  = 0 for all i and j, followed by the computation  of L qij  using Equation 4.50 and then L rij  using Equation 4.51. The a posteriori  log probability ratios for each variable node dj can then be computed as  L d       j  =  log  Prob Prob    d   d  i  i  = =  1 0    observations   = observations  L p    j      +  n k  −∑ h L r     ij  ij   .  i  = 1      4.61   If the Tanner graph did not have closed cycles, these a posteriori log probabilities  would correspond to the exact ones. With the existence of cycles, it is necessary to  repeat the computation of L qij  and L rij  for several iterations and the estimates  computed using Equation 4.61 will be only approximations. These approximations  are accurate as long as the cycles have long lengths.  In the computation of the message from parity check node ci to variable node  dj, it is possible to avoid the use of hyperbolic functions as well as of the products of  terms present in Equation 4.51 by using the following approximation:  L r   ij     i  = − γ min     1 ′= … , , 1 n j ≠ ′≠ ∧ j h ′ ij  j  0     L q   ij  ′        n  ∏  ′′ = j 1 ≠ ∧ j h ij  ′  j  ≠  0  ′  sign   L q   ij  ′      ,   4.62      and  and                        184  ◾  MIMO Processing for 4G and Beyond  R E B  10–3  100  10–1  10–2  10–4  10–5  10–6  0  Uncoded Information block = 58,320 bits, R = 9 10 Information block = 38,880 bits, R = 3 5 Information block = 21,600 bits, R = 1 3  0.5  1  1.5  2  2.5  3  3.5  4  EB N0  dB   Figure 4.13  BER performance of several DVB-S2 [ETSI 2009a] LDPC codes.  where  γi  is  the  degree  of  check  node  i  and  sign   .   represents  the  sign  function  defined as  sign    x  =   1         , x  0        x ,   −      1 , x   > = <  0 0 0  .      4.63      When using this approximation, the algorithm is named min-sum algorithm. Figure 4.13 presents some simulation results obtained using DVB-S2 [ETSI  2009a] LDPC codes and employing the sum-product algorithm with a maximum  of 50 iterations. Different coding rates are shown. It is visible that very high coding  gains can be obtained using these codes.  4.2.3  Channel Estimation In  wireless  communications,  the  propagation  conditions  lead  to  channels  that  distort the amplitude and phase of the transmitted signal. This distortion has to  be estimated and tracked when performing coherent detection at the receiver. As  an alternative, it is possible to design systems that employ noncoherent detection  [Hanzo et al. 2010]. However, although the use of noncoherent systems eliminates       MIMO Optimized for OFDM  ◾  185  the need for channel estimation, the cost is a significant performance degradation.  Therefore, most mobile communications systems employ coherent detection and  require that the amplitude and phase distortions caused by the channel be correctly  estimated to avoid severe performance degradation.  Typically, the channel estimates are obtained with the help of training sym- bols that are multiplexed with the data symbols, either in the time domain or in  the frequency domain [Cavers 1991, Hoher et al. 1997, Sanzi and Speidel 2000,  Deneire et al. 2001], though the later approach is more common in OFDM systems.  Regarding the transmission of pilot symbols in the frequency domain, it is pos- sible to insert them into all the subcarriers of an OFDM symbol  block-type pilot  arrangement  or periodically inserting the pilot tones inside some OFDM symbols   comb-type pilot arrangement  [Coleri et al. 2002]. In 3GPP LTE-Advanced, the  later approach is used [3GPP 2013a]. The following description concerns the use  of pilot symbols multiplexed with data in the frequency domain  inserted accord- ing to the transmitter scheme of Figure 4.6  and is valid for both block-type and  comb-type arrangements. The assumed frame structure is shown in Figure 4.14.  According to this structure, in a MIMO-OFDM system with N carriers, pilot sym- bols are multiplexed with data symbols using a spacing of ΔNT OFDM blocks in  the time domain and ΔNF subcarriers in the frequency domain. To avoid interfer- ence between pilots of different transmitting antennas, frequency-division multi- plexing  FDM  is often employed for the pilots, which means that pilot symbols  cannot be transmitted over the same subcarrier in different antennas. Data symbols   Freq.  ΔNF ... D D  D D ... ...  P 0 D ...  P 0 D ...  ... D D D D D D D D D D ... ... ... ... ... ... 0PDDD... 0PDDDD DDDDDDDDDDDD ... ...  D D ... ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  IDFT  N·TS  Tx ant. 1  ΔNT  Time  ... D D  D D ... ...  0 P D ...  0 P D ...  ... D D D D D D D D D D ... ... ... ... ... ... P0DDD... P0DDDD DDDDDDDDDDDD ... ...  D D ... ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  ...  . . .  Tx ant. 2  IDFT  Figure 4.14  Frame structure for a MIMO-OFDM transmission with data multi- plexed pilots  P—pilot symbol, D—data symbol, Ts—symbol duration .                  186  ◾  MIMO Processing for 4G and Beyond  are not transmitted on subcarriers reserved for pilots in any antenna and, therefore,  the minimum spacing allowed in the frequency domain is  ΔNF min = Mtx.  With the pilot tones present in the transmitted signal, it is possible to use sev- eral different channel estimation techniques. As an example, we describe a typical  approach where, to obtain the frequency channel response estimates for each trans- mitting receiving antenna pair, the receiver applies the following steps:  1. The channel estimate between transmit antenna m and receive antenna n for   each pilot symbol position is simply computed as   cid:31 H  m n , k l ,  =    *     2  S S  m Pilot , k l , m Pilot , k l ,  , , R n k l      4.64    4.65   , m Pilot  corresponds to a pilot symbol transmitted in the kth subcarrier    where Sk l , of the lth OFDM block using antenna m. The specific indexes k and l that  correspond to pilot symbols depend on the periodicity of pilot insertion, that  is, it depends on the values defined for ΔNT and ΔNF.    2. Channel estimates for the same subcarrier k, transmit antenna m, and receive  antenna n but in time domain positions  index l  that do not carry a pilot  symbol can be obtained through interpolation using a finite impulse response   FIR  filter with length W as follows:   cid:31 H  m n , + k l ,  t   W  2    = ∑  =−  j    −  W    1 2    j   cid:30  h H t  m n , k l ,  + ⋅∆  j N T  ,     where t is the OFDM block index relative to the last one carrying a pilot  which is  j  are the interpolation coefficients of the estimation filter,  block with index l  and ht which depend on the channel estimation algorithm employed. There are several  proposed  algorithms  in  the  literature  like  the  optimal  Wiener  filter  interpolator  [Cavers 1991] or the lowpass sinc interpolator [Kim et al. 1997]. Note that interpo- lation can also be applied between different OFDM symbols with pilots.  4.3  Iterative Receivers 4.3.1  Receiver Structure A  typical  receiver  is  composed  of  several  signal  processing  blocks  dedicated  to  specific tasks. Examples of these tasks are channel estimation, MIMO decoding,  equalization, multiuser detection, channel decoding, and so on. This division in  several separate processing blocks is necessary since a joint processing of all these       MIMO Optimized for OFDM  ◾  187  tasks, although optimal, is too complex to implement. Nevertheless, if these blocks  work with soft decisions, the performance of the receiver can be improved if the  first processing blocks make use of feedback information derived in the last blocks.  This  cyclic  exchange  of  information  between  the  various  processing  blocks  can  occur for several iterations although after a certain number of iterations, the gains  can  become  negligible.  By  analogy  with  turbo  codes,  this  type  of  techniques  is  usually referred to as turbo-processing techniques. One interesting application of  these techniques is turbo equalization [Douillard et al. 1995] where equalization is  combined with channel decoding. The task of the equalizer is to compensate inter- symbolic interference  ISI  present in frequency selective channels. The optimal  equalizer is a trellis-based detector employing maximum likelihood sequence esti- mation  MLSE  algorithm similar to the Viterbi decoder although other algorithms  are available. Iterating the equalization and channel decoding task can result in  substantial improvements in the error rate.  In [Moher 1998], [Reed 1998], and [Wang and Poor 1999], the turbo prin- ciple was used for joint multiuser detection and channel decoding for obtaining  near single user performance. The multiuser detector is implemented as a soft-input  soft-output that uses a priori information from the previous channel decoder itera- tion to improve its performance and produces extrinsic information for the turbo  decoders. Another possible application is turbo estimation [Valenti 2001] where the  channel is reestimated after each iteration of the turbo code using the estimated  transmitted symbols as additional pilots. In this section, we will explain how the  turbo-processing concept can be applied to MIMO-OFDM receivers.  Figure 4.15 presents the basic structure of an iterative receiver capable of jointly  performing channel estimation and data detection through iterative processing. Nrx  receiving antennas are assumed to be used. The details about the channel estima- tion task will be discussed in the following section.  The sequence of steps applied to the received sequence is the same as the con- ventional receiver from Figure 4.10 up to the channel decoder block. In the iterative  receiver,  the  channel  decoder  has  two  outputs:  one  is  the  estimated  information  sequence and the other is the sequence of LLR estimates of the code symbols  see  Figure 4.12 and the description provided in Section 4.2.2 . These LLRs go through  the decision device, which outputs either soft-decision or hard-decision estimates  of the code symbols, and enter the transmitted signal rebuilder, which performs  the same operations of the transmitter  interleaving, modulation, and conversion of  serial to parallel streams . The reconstructed symbol sequences can then be used for a  refinement of the channel estimates and for improvement of the spatial demultiplex- ing task for the succeeding iteration. This can be accomplished using an interference  canceler  IC  inside the spatial demultiplexer block, which can be represented as          n m q   , R k l ,     =  R n k l ,  −       −   ′ 1 m q  cid:22  S k l ,   cid:22  H  ′ m n , , k l ,   4.66   Mtx  ∑  ′= 1 m ′≠ m m         188  ◾  MIMO Processing for 4G and Beyond  n o i t a m r o f n I  s t i b  l e n n a h C  r e d o c e d  r e v a e l r e t n i - e D  r o t a l u d o m e D  o t   l a i r e S  l e l l a r a p  .....  l a i t a p S  r e x e l p i t l u m e d  l , 1k R  ...  x r N  l , k R  T F D  T F D  T F D  T F D  n o i s i c e D  e c i v e d  l a n g i s   d e t t i  m s n a r T  r e d  l i  u b e r  l ,  mk ˆS  l e n n a h C  r o t a m  i t s e    q    ,  n m ˆH  l , k  . e r u t c u r t s   r e v i e c e r   e v i t a r e t I    5 1 . 4   e r u g i F      MIMO Optimized for OFDM  ◾  189    −1  represents the data symbols estimates  m q   where q is the iteration number and   cid:22 Sk l , of the previous iteration for transmit antenna m, subcarrier k, and OFDM block l.        4.3.2  Iterative Channel Estimation In this section, we consider again the same receiver structure of the previous sec- tion but devote our attention to the task of estimating the amplitude and phase of  the channel. Two pilot transmission schemes will be considered: data multiplexed  pilots, which were already discussed in Section 4.2.3 and implicit pilots.  4.3.2.1  Data Multiplexed Pilots When using an iterative receiver in a MIMO-OFDM transmission based on data  multiplexed  pilots,  in  the  first  iteration  the  channel  estimates  are  computed  as  described in Section 4.2.3. However, after the first iteration, the data estimates can  also be used as additional pilots for channel estimation refinement [Valenti 2001].  In this case, the respective channel estimates are computed as      cid:22  H  m n , k l ,        q     =  − 1  *  R n k l ,      m q    cid:22  S k l ,   m q    cid:22  S k l ,     1 2 −    .      4.67      4.3.2.2  Implicit Pilots The  transmission  of  training  symbols  multiplexed  with  data,  either  in  the  time  domain or in the frequency domain, can result in an inefficient use of the available  bandwidth, especially when the channel impulse response is very long. Therefore, it  is often desirable to reduce the overheads required for channel estimation purposes.  A promising method for overcoming this problem is to employ implicit pilots, also  known as pilot embedding or superimposed pilots, which are added to the data  block instead of being multiplexed with it [Farhang 1995, Ho et al. 2001, Zhu  et al. 2003, Lugo et al. 2004]. This means that we can significantly increase the  pilots’ density, while keeping the system capacity. In fact, we can even have a pilot  for each data symbol. However, the interference levels between the data symbols  and pilots might be high. This means that the channel estimates are corrupted by  the data signal, leading to irreducible noise floors  i.e., the channel estimates can- not be improved beyond a given level, even without channel noise . Moreover, there  is also interference on the data symbols due to the pilots, leading to performance  degradation. Therefore, this approach usually requires extra signal processing at the  receiver to reduce the cross interference between pilots and data. In the following,  we will describe how this type of pilot transmission can be used in MIMO-OFDM  systems.      190  ◾  MIMO Processing for 4G and Beyond  ΔNT  Time  ΔNF  Freq.  P 0 ... P 0 ...  0 0 ... 0 0 ...  0 0 ... 0 0 ...  ... P 0 ... ... ... ... P ... 0 ... ...  P ... 0 ... ... ... P ... 0 ... ... ...  0 0 ... 0 0 ...  0 0 ... 0 0 ...  ... ... ... ... ... ...  P ... 0 ... ... ... P ... 0 ... ... ...  +  +  . . .  Tx ant. 1  Tx ant. 2  IDFT  IDFT  ...  ...  D D ... D D ... D ... D D ... D ... ... ... D ... D D ... D D D ... D D ... ... ... ...  ...  ...  ...  ...  ...  ...  D D ... D D ... D D ... D D ... ... ... ... D ... D D ... D D D ... D D ... ... ... ...  ...  ...  ...  ...  Figure 4.16  Frame structure for MIMO-OFDM transmission with implicit pilots   P—pilot symbol, D—data symbol .  The  frame  structure  and  pilot  insertion  process  are  shown  in  Figure  4.16.  According to this structure, the implicit pilots are generated using a grid with a  spacing of ΔNT symbols in the time domain and ΔNF symbols in the frequency  domain.  Similar  to  the  data  multiplexed  pilots  method,  to  avoid  interference  between implicit pilots of different transmitting antennas, FDM can be employed  for the pilots, so that pilot symbols in different antennas are not transmitted over  the same subcarrier. In this case, the minimum allowed spacing in the frequency  domain is  ΔNF min = Mtx and the transmitted sequences are given by     X  m k l ,  =  S  m k l ,  +  S  m Pilot , k l ,  ,      4.68   ,  i  =  m , i l  , , 0 1  , m Pilot where Sk l  is the implicit pilot transmitted over the kth subcarrier, in the lth OFDM  , block using antenna m. The resulting sequences are converted into the time domain  { } through the usual process,  x   1 , before being transmitted. To reduce the mutual interference between pilots and data, which will be par- ticularly high in MIMO systems with implicit pilots, and achieve reliable channel  estimation and data detection, we can modify the previous iterative receiver struc- ture according to Figure 4.17. The main difference from the previous receiver lies in  the addition of the “remove pilots” and “remove data” processing blocks.  } = 1  IDFT  , , 0 1  …  …  {  N  N  m k l ,  X  −  =  −  k  ,  ,  ,      MIMO Optimized for OFDM  ◾  191  n o i t a m r o f n I  s t i b  l e n n a h C  r e d o c e d  r e v a e l r e t n i - e D  r o t a l u d o m e D  o t   l a i r e S  l e l l a r a p  .....  l a i t a p S  r e x e l p i t l u m e d  s t o l i  p   e v o m e R  s t o l i  p   e v o m e R  s t o l i  p   e v o m e R  s t o l i  p   e v o m e R  l , 1k R  ...  x r lN k R  ,  T F D  T F D  T F D  T F D  n o i s i c e D  e c i v e d  l a n g i s   d e t t i  m s n a r T  r e d  l i  u b e r  ,  t o l i P l m , k S +  l ,  mk ˆ S    q    ,  ,  n lm k ˆH  h t i  l e n n a h C  w   r o t a m  i t s e  e c n e r e f r e t n  n o i t a l e c n a c  i  a t a d   e v o m e R  a t a d   e v o m e R  a t a d   e v o m e R  a t a d   e v o m e R  . n o i s s i  m s n a r t   t o l i p   t i c i l p m  i   r o f   e r u t c u r t s   r e v i e c e r   e v i t a r e t I    7 1 . 4   e r u g i F      192  ◾  MIMO Processing for 4G and Beyond                 In this case, after conversion to the frequency domain, the received sampled   sequence can be expressed as  The pilot symbols are removed from the sequence according to  R n k l ,  =  S  m k l ,  +  S  m Pilot , k l ,  H  m n , k l ,  +  N  , . n k l     M  tx  ∑  m  = 1        q       Y  n k l ,     =  R n k l ,  −  S  m Pilot , k l ,      cid:22  H  m n , k l ,        q   ,  Mtx  ∑  m  = 1         4.69    4.70       cid:22 Hk l  m n , ,        q      is the channel frequency response estimate and q is the current  where  iteration. Considering the pilot distribution of Figure 4.16 where only one of the  antennas  can  transmit  a  pilot  over  each  subcarrier,  the  summation  in  Equation  4.70 has only one term. The sequences of samples  Equation 4.70  enter the spatial  demultiplexer block, which can apply any of the methods discussed in Section 4.2.1.  With the existence of implicit pilots, in each iteration, the receiver can apply the  following steps in order to obtain the estimates of the frequency channel response  for each transmitting receiving antenna pair:  1. Data symbols estimates are removed from the pilots using     q         cid:30 R n k l ,     =  R n k l ,  −       m q    cid:31  ′ S k l ,  − 1        cid:31  H  m n , k l ,        q  − 1   ,  Mtx  ∑  m  ′= 1      4.71                    m q   ′ ,  − 1  and     −1  are the data and channel response estimates    where   cid:22 Sk l of the previous iteration. This step can only be applied after the first iteration.    In the first iteration, we set   cid:31 R n k l ,    2. The channel frequency response estimates is computed using a moving aver-  =1   cid:22 Hk l  , . R n k l  m n , ,          q     age with size W as follows:      cid:31 H  m n , k l ,        q     =  1 W  + l W   2  − 1  ∑  l  ′= − l W  2    − 1           q   ′   cid:30  R n k l , m Pilot , S k l ,  ′  .      4.72   N    3. After the first iteration, if a fully dense pilot distribution is not employed  1 , the data estimates can also be used as additional   ≠ ∨   i.e., ∆ pilots for channel estimation refinement.    4. These  channel  estimates  can  be  enhanced  by  ensuring  that  the  cor- responding  impulse  response  has  a  duration  NG.  This  is  accomplished   ∆ N  ≠  1  T  F      MIMO Optimized for OFDM  ◾  193                    q  q  q  ,  1  N  }  {      ; i the       cid:30  m n , w h i l ,  = = … − , , 0 1 truncation  of  = … − i ;  by  computing  the  time  domain  impulse  response  of  Equation  4.72  {    cid:31  m n , through  ,,  1 DFT h i l , this  followed  by  to  {    cid:31 h 1   with  wi = 1  if  the  ith  time  domain sample is inside the cyclic prefix duration and  wi = 0 otherwise.  The  final  frequency  response  estimates  are  then  simply  computed  using  {    = … − , , 0 1 N according    cid:31  m n , k H k l , sequence   … −  … −  DFT  }}.  {    cid:22   0 1 , ,    0 1 , ,    m n , h i l ,  , , 0 1  }  }  m n , i l ,  m n , k l ,  }   cid:22 H  N  N  N     =  =  =  =           1  1  k  i  ,  ,  ;  ,  ,  ;  ;  q  q  q                    i  One of the advantages of using implicit pilots is that it allows us to significantly  increase the density of pilots without sacrificing system capacity. In fact, we can have  a pilot for each data symbol, which can be important for fast-fading channels. As an  example, Figures 4.18 and 4.19 show the performances of a 16-HQAM  nonuniform  hierarchical QAM modulation with parameter k1 =0.4, as defined in [Marques da  Silva et al. 2010] transmission for different speeds employing data multiplexed pilots     = dB  and implicit pilots  ΔNF = 2,   ΔNF = 7, ΔNT = 7,  E S    ΔNT = 1,  E S dB .  These  results  were  obtained  using    an UTRA LTE-Advanced-based Monte Carlo simulator for a 10 MHz bandwidth    E S    = −   E S   m Pilot , k l ,  m Pilot , k l ,  . 4 5    2  m k l ,  m k l ,  0  2  2  2  100  10–1  10–2  R E L B  v = 30 km h v = 120 km h v = 300 km h v = 600 km h  LPB MPB  10–3  0  5  10  20 15 ES N0  dB   25  30  35  Figure  4.18  Performance  of  a  2 × 2  MIMO  16-HQAM   k1 = 0.4   transmission  with data multiplexed pilots  ΔNF = 7, ΔNT = 7  for different speeds.      194  ◾  MIMO Processing for 4G and Beyond  100  10–1  R E L B  10–2  10–3  10–4  0  LPB MPB  v = 30 km h v = 120 km h v = 300 km h v = 600 km h 5 10  15 20 ES N0  dB   25  30  35  Figure  4.19  Performance  of  a  2 × 2  MIMO  16-HQAM   k1 = 0.4   transmis-  sion with implicit pilots  ΔNF = 2, ΔNT = 1,  E S   for    different speeds.   E S   4.5dB  m Pilot , k l ,  −=  m k l ,        2  2  configuration whose corresponding parameters are shown in Table 4.1. The channel  impulse response is based on the Vehicular A environment [from ETSI, 1998] with  Rayleigh fading adopted for the different paths. The channel encoders were rate- 1 2 turbo codes based on two identical recursive convolutional codes as defined in  [3GPP 2013b] with individual data block sizes of 4024 bits.  Table 4.1  Simulation Parameters for 10 MHz Bandwidth  Transmission BW  CP length  samples   FFT size  Number of occupied subcarriers  Subframe duration  ms   Subcarrier spacing  kHz   OFDM symbols per subframe  10 MHz  72  1024  600  0.5  15  7      MIMO Optimized for OFDM  ◾  195  Note that the modulation employed, 16-HQAM, is a hierarchical one, allow- ing the transmission of two data streams with different error protection levels, as  explained in [Marques da Silva et al. 2010]. Therefore, in the graph legends, MPB  curves refer to the most protected bits and LPB corresponds to the least protected  bits. According to the results, the performance for the data multiplexed transmis- sion  is  almost  insensitive  to  speeds  up  to  300 km h,  being  visible  only  a  small  degradation in the performance of the LPB at these speeds. For higher velocities,  the performance quickly degrades for both bit streams, becoming completely unre- liable. With the use of implicit pilots, it is clear that the performance becomes more  robust. In this case, the results are also practically insensitive to velocity for both  streams until v = 300 km h. For v = 600 km h, the performance degrades substan- tially but it is still possible to obtain BLERs below 1% for the MPB, which means  that even at such speeds it would be possible for a user to extract the basic informa- tion stream  e.g., a low-quality video .  4.4  Lattice-Reduction-Aided Receivers 4.4.1  Soft Metrics from LRA Receivers As it was described in Chapter 2 for both real and complex lattices, there are several  relatively low-complexity detection methods that can be applied to MIMO and  those detection techniques can be easily extended to MIMO-OFDM. However,  most of those methods often perform quite far from ML detection and since the  use of ML detectors is only viable for a reduced number of antennas and small sig- nal constellations, other solutions must be applied. As described in Chapter 2, one  of the most promising approaches is the use of lattice reduction using for example  the LLL algorithm [Lenstra et al. 1982] combined with either a linear equalizer, a  successive interference cancelation  SIC  equalizer [Babai 1986], or a randomized  version of SIC [Liu et al. 2011]. As explained in Chapter 2, lattice reduction is one  of the most useful tools of lattice theory that allows us to find a new basis with  improved mathematical properties that result in a gain in performance when a low- complexity detection method is applied.  In order to apply a lattice-reduction-aided receiver in a MIMO-OFDM system,   we can start by writing the Nrx × 1 received vector y for a subcarrier frequency as     Y HS N  =  +  ,     4.73   where  H  is  the  Nrx × Mtx  channel  matrix  for  that  frequency  with  each  column  representing  a  different  transmit  antenna  and  each  line  representing  a  different  receive antenna, s is the Mtx × 1 column vector whose elements are the complex- valued symbols transmitted on the Mtx antennas and n is the Nrx × 1 column vector  containing the noise samples at each receiving antenna. Similar to the procedure       196  ◾  MIMO Processing for 4G and Beyond  described in Chapter 2, if the constellation of transmitted symbols can be mapped  to a subset of the Gaussian integers space  cid:31 Mtx j[ ] through shifting and scaling  e.g.,  M-QAM constellations , we can write  where x ∈  cid:31 Mtx j[ ], α represents the factor used for energy normalization, and IMtx  denotes an Mtx × Mtx identity matrix. In this case, a lattice basis can be represented  by matrix h defined as  The  transmitted  vector  estimate  can  then  be  achieved  through  shifting  and   rescaling as  S  =  α  x  −        1 2  +  1 2 j Mtx     I  ,        H  H= α .     cid:22  S  =   α U    cid:22  z  −     1 2  +  1 2 j Mtx     I     ,     where u is a unimodular matrix  with det u = 1  containing only Gaussian inte- gers that allows us to obtain a new improved basis   cid:31 H  namely, shorter basis vectors  and better orthogonality  using  and  cid:22 z is an Mtx × 1 column vector whose elements can be computed using the round- ing and subtraction procedure of the SIC algorithm [Babai 1986], as described in  Chapter 2. As also detailed in Chapter 2, instead of the ZF criterion, we can use  the MMSE criterion by applying the SIC algorithm to the extended channel matrix  and the extended received vector defined as   4.74    4.75    4.76    4.77    4.78    cid:31 H HU=  ,    H  =       H 2σ Mtx I       Y  =  Y  0  ×Mtx 1      ,                           and      MIMO Optimized for OFDM  ◾  197  where  0Mtx ×1 is an all zeros size-Mtx column vector. Furthermore, to narrow the  performance gap to the ML decoder, instead of the standard rounding to the near- est Gaussian integers employed in the SIC algorithm, we can replace it by Klein’s  randomized rounding [Klein 2000]  c.f. Chapter 2  and implement a randomized  lattice decoder.  As explained in Section 4.1.3, due to its poor uncoded performance, OFDM  systems are usually combined with coding. However, to avoid a performance loss  in the channel decoding task, the MIMO detector should be able to output LLRs  for  the  demodulated  bits.  The  use  of  randomized  rounding  in  the  randomized  lattice decoder eases the computation of the required LLRs. Indeed, these can be  obtained as  λi  =  log  =  log  i  i  =  p c =  p c ∑ p ∑  ∈ ϒ  = 1  p  ci  s  s  ∈ ϒ  ci  =  00  1 0               y y      Y S  Y S                ,      4.79         where p ciy  is the probability of coded bit ci conditioned on y, ϒci =1  ϒci =0  repre- sents the set of all possible transmitted vectors from the candidates’ list containing  ci = 1  ci = 0  and p ys  is the likelihood probability, which can be computed using     p  Y S    =    1 πσ 2     exp  Nrx     −  1 σ 2 2  Y HS  −  2     .      4.80   4.4.2  Performance Results To  compare  randomized  lattice  decoding  against  some  of  the  MIMO-OFDM  receivers described previously in this chapter, we present in Figure 4.20 the per- formance results for a 4 × 4 MIMO configuration, which were obtained using an  UTRA  LTE-Advanced-based  Monte  Carlo  simulator  for  a  10 MHz  bandwidth  configuration whose corresponding parameters are the same as shown in Table 4.1  of Section 4.3.2. The channel impulse response is based on the Vehicular A envi- ronment [from ETSI, 1998] with Rayleigh fading adopted for the different paths.  The channel encoders were rate-1 2 turbo codes based on two identical recursive  convolutional codes as defined in [3GPP 2013b] with individual data block sizes of  4196 bits. At the receiver, 12 turbo decoding iterations are applied, but in the case  of the iterative receiver, we used four receiver iterations with three turbo decoding  iterations per receiver iteration  giving still a total of 12 turbo decoding iterations .       198  ◾  MIMO Processing for 4G and Beyond  12 turbo iter., MLSO 12 turbo iter., MMSE 3 turbo iter., iterative  1 × MMSE + 3 × IC  12 turbo iter., rand. lattice  100  10–1  10–2  R E B  10–3  10–4  10–5  10–6 –2  0  2  8  10  12  4 6 ES N0  dB   Figure  4.20  Performance  of  a  4 × 4  MIMO  QPSK  transmission  with  R = 1 2  turbo coding and different receivers.  In the case of the randomized lattice decoder, the MMSE criterion was employed  combined with a candidate list size of K = 25. Perfect channel estimation and syn- chronization was assumed.  We can see that the iterative receiver achieves the best performance as it is the  only one where the channel decoder also contributes to the MIMO decoding task.  Regarding the non-iterative receivers, as expected, the best performance is achieved  by the MLSO followed closely by the randomized lattice decoder. However, the  MMSE receiver shows a considerable performance gap compared with the MLSO. Although  the  randomized  lattice  decoder  can  achieve  performances  close  to  ML decoding, due to the random nature of the sampling, unnecessary complex- ity is often added  repetition of sampled points  and some performance loss can  occur as a result of some points with low probabilities on the first elements being  missed. To avoid these issues, a deterministic version of the algorithm, referred to  as derandomized sampling algorithm, has been recently proposed in [Wang and  Ling 2012].      MIMO Optimized for OFDM  ◾  199  4.5  MIMO-OFDM with Signal Space Diversity 4.5.1  Complex Rotation Matrices When powerful channel coding schemes are employed, OFDM schemes can have  excellent performance. However, the required code rate must be low, reducing the  system’s spectral efficiency. However, for uncoded systems or when high rate codes  are employed, the performance of OFDM systems can be very poor. In this case,  we can associate a given symbol to different subcarriers so as to take advantage of  the diversity effects inherent to a severely frequency selective channel, which is typi- cal in mobile communication environments. This alternative diversity technique is  often named signal space diversity as proposed in [Boutros and Viterbo 1998] and  is accomplished without additional power or bandwidth required. A simple way of  doing this is to employ real rotation matrices  RRM  [Rainish 1996], which allows  significant gains. Unfortunately, RRM were only designed to spread a symbol over  two subcarriers, which is accomplished using  with           X  =  A  RRM  ⋅  ,   S  A RRM =  ϕ cos    − ϕ sin         ϕ sin  ϕ cos           ,      4.81    4.82   and s being a 2 × 1 vector containing two modulated symbols.  Spreading a symbol over a larger number of subcarriers can be accomplished  using  the  Hadamard  matrix   HM   adopted  in  fully  loaded  multicarrier  code  division multiplexing schemes. The HM for spreading over two symbols can be  obtained from RRM using φ = π 4. A more general alternative lies on the use of  CRM.  CRM  is  a  technique  for  achieving  signal  space  diversity   SSD   in  SISO  and MIMO-OFDM OFDMA systems and can be easily combined with turbo or  LDPC codes in order to improve the system performance without a substantial  reduction of the spectral efficiency.  The process of applying CRM is similar to RRM where a rotated supersymbol   is obtained using  X  =  A  MCRM  ⋅  ,   S   4.83   with S being an MCRM × 1 vector with a set of modulated symbols composing a  supersymbol. Matrix A MCRM belongs to the family of the orthonormal  OCRM  or  nonorthonormal  NCRM  complex matrices, which are defined as      200  ◾  MIMO Processing for 4G and Beyond     OCRM     A  M  CRM  =     and     NCRM     A  M  CRM  =    1  2  A  2  ,  M  CRM  =  2  ϕ j            ϕ j   e  − je  = A 2  A  A   M  M  CRM  CRM     2     2  −  ϕ j  ϕ j  je − e det      =  22    A 2 A M − A  CRM     2  M  CRM     2      A  M  CRM  1    M CRM M  ,  CRM  >  2   4.84     1  2  A  2  ,  M  CRM  =  2             e  − e  A 2  A  A   ϕ j  −  ϕ j  =  −  e e det   M  CRM     2  M  CRM     2  ϕ j  ϕ j       A 2 A M − A  =  2  CRM     M  CRM     ϕ coos      2  2     ,   4.85   A  M  CRM    1  M CRM M  ,  CRM  > 22        = with  M 2 [Correia 2002].  CRM  n     n  ≥  1  ,  A  M  CRM  =  det   A  M  CRM   ,    and φ  being  the  rotation  angle   4.5.2  Transmitter for OFDM Schemes with CRM CRM can be easily incorporated into OFDM systems. Figure 4.21 shows the block  diagram of an OFDM transmitter with CRM and multiple transmitting antennas. An information block is encoded, interleaved, and mapped according to the con- stellation symbols. A rotation matrix  RM  is then applied by grouping the symbols  into  MCRM-tuples  and  multiplying  them  by  rotation  matrix  A MCRM .  The  result- ing sequence is split into Mtx parallel streams, which are interleaved in the symbol  interleaver. The objective of the symbol interleaver is to explore the characteristics  of OFDM transmissions in severe time-dispersive environments whose channel fre- quency response can change significantly between different subcarriers. The inter- leaver ensures that samples of a supersymbol are mapped to distant subcarriers, thus  taking advantage of the diversity in the frequency domain. Pilot symbols are inserted  into the modulated symbols sequence, which is then converted into the time domain  using an IDFT and transmitted as a conventional OFDM transmission  with the  insertion of the CP, which is not explicitly shown .  4.5.3  Receivers for OFDM Schemes with CRM Figure 4.22 represents the receiver block diagram for MIMO-OFDM transmis- sions with CRM. Nrx receiving antennas are assumed to be used. Although the       MIMO Optimized for OFDM  ◾  201  1   a n n e t n A  T F D  I  ......  s l o b m y s   t o l i  P  x t  M    a n n e t n A  T F D  I  s l o b m y s   t o l i  P  l  o b m y S  r e v a e l r e t n  i  l  o b m y S  r e v a e l r e t n  i  l a i r e S  o t  l e l l a r a p  M R  r o t a l u d o M  r e v a e l r e t n I  l e n n a h C  i  g n d o c  n o i t a m r o f n I  s t i b  .  M R C   g n i s u   s n o i s s i  m s n a r t    M D F O O M M  -  I    r o f    m a r g a i  d    k c o  l  b   r e t t i  m s n a r T    1 2 . 4   e r u g i F      202  ◾  MIMO Processing for 4G and Beyond  n o i t a m r o f n I  s t i b  l e n n a h C  r e d o c e d  r e v a e l r e t n i - e D  r o t a l u d o m e D  l a i t a p S  d n a   r e x e l p i t l u m e d  r e t r e v n  i    M R  l e n n a h C  r o t a m  i t s e    q    ,  ,  n lm k ˆH  l , 1k R  ...  x r lN k R  ,  r e v a e l r e t n  i   l  o b m y S  r e v a e l r e t n  i   l  o b m y S  r e v a e l r e t n  i   l  o b m y S  r e v a e l r e t n  i   l  o b m y S  T F D  T F D  T F D  T F D  .  M R C   h t i  w    s n o i s s i  m s n a r t    M D F O O M M  I  -    r o f   e r u t c u r t s   r e v i e c e R    2 2 . 4   e r u g i F      MIMO Optimized for OFDM  ◾  203  structure  presented  in  Figure  4.22  corresponds  to  a  noniterative  receiver  and  assumes data multiplexed pilots, we could easily adopt an iterative receiver as well  as implicit pilots from Section 4.3, since the only blocks that need to be modified  and added are the ‘spatial demultiplexer and RM inverter’ block and the ‘symbol  interleaver’ blocks.  According to Figure 4.22, the signal is sampled, the cyclic prefix removed, and  the resulting signal is converted into the frequency domain with an appropriate  size-N DFT operation. The sequence of symbols is then de-interleaved. If the cyclic  prefix is longer than the overall channel impulse response, each received MCRM- sized supersymbol can be expressed using matrix notation as  R H X N  =  +  ⋅  ,     4.86   where r is a  Nrx. MCRM Mtx  × 1 vector containing the samples of a supersymbol  received in all the antennas and h is the frequency response channel matrix defined  as a blockwise diagonal matrix  H  =   cid:19   H 1  0        0  H  M  CRM  M  tx  ,            4.87   Hk  =        1 1 ,  cid:31  H k  cid:30   cid:29  N  cid:31  rx k  1 ,  H  H  tx  M  1 , k  cid:30  N M rx k  ,  H  tx        ,  k  =  … , 1  ,  M   MMtx .  CRM   4.88      Index k represents a subcarrier position. It is important to note that due to the  presence of the symbol interleaver, the different subcarriers denoted by index k may  not be necessarily adjacent. To simplify the following explanations, we will assume  that MCRM is a multiple of the number of transmitting antennas Mtx. n is a  Nrx.  MCRM Mtx  × 1 vector containing AWGN samples.  The supersymbol’s samples enter the spatial demultiplexer and CRM inverter  block, which has the purpose of separating the streams transmitted simultaneously  by the multiple antennas and invert the rotation applied at the transmitter.  In  the  following,  some  of  the  methods  that  were  presented  for  traditional  MIMO-OFDM systems in Sections 4.2.1 and 4.4 will be extended to MIMO- OFDM with CRM: the MMSE equalizer, the MLSO detector, and lattice-reduc- tion-aided decoders.           with      204  ◾  MIMO Processing for 4G and Beyond  The MMSE criterion can be applied to each individual subcarrier using   cid:22 X k  =     H    H  ⋅  [  H H       H  +  σ 2  − ] 1 I R  ,  k  k  k    where   cid:22 X k is the Mtx × 1 vector with the estimated subset of coordinates from the  supersymbol mapped to subcarrier k,  rk is the  Nrx × 1 received signal vector in  subcarrier k with one different receive antenna in each position and σ 2 is the noise  variance.  Using  the  rotated  supersymbol  estimates,   cid:22 X k ,  the  component  symbol  estimates are computed through     k   4.89   In the case of using the MLSO criterion, each symbol estimate is computed as   cid:22  S  =     A MCRM  ⋅−   1   cid:22  X  .      cid:22 S  l  = =  =    R ⋅   E S l   ∑ s P S l i   P S ∑ l p  ∈ Λ  s i  ⋅  s i  ∈ ΛΛ  s i  =  s i  R        s i  =   R        p  R  S l  =    ,  s i      4.90    4.91   with si representing a constellation symbol from the modulation alphabet Λ, E[⋅]  denoting the expected value, P ⋅  denoting a discrete probability, and p ⋅  denot- ing a probability density function  PDF . Considering equiprobable symbols, we  have P Sl = si  = 1 M, where M is the constellation size. The PDF values required in  Equation 4.91 can be computed as     p  R  S l  =    =  s i  1 M  CRM  − 1  M  ∑  S  compl Λ ∈ l  MCRM  − 1     p  R  S l  =  s i  ,  S  compl l    ,      4.92      p  R  S l  =  s i  ,  S  compl l    =  CRM  M  tx  2  1 N M   N M  CRM  rx  rx  ∑  = 1n     πσ 2      exp  M  tx  −  R n  −  H  ⋅   ,:  n A σσ 2 2  2  ⋅  s  M  CRM  ,           4.93   compl is a  MCRM − 1  × 1 vector representing a possible combination of sym- where Sl bols transmitted together with Sl in the same supersymbol, s is an MCRM × 1 vector            with           MIMO Optimized for OFDM  ◾  205        comprising Sl is the nth line of channel matrix H.  compl and si, Rn is the nth received sample in Equation 4.86, and h n,:    Finally,  regarding  the  use  of  lattice-reduction-aided  decoders,  we  start  by   rewriting Equation 4.86 as  Y HA  =  MCRM  +  ,   S N   4.94   where  y  is  the  same  received  vector  as  r  in  Equation  4.86  and  H  is  the  same  frequency  response  channel  matrix  defined  as  a  blockwise  diagonal  matrix  in  Equation 4.87  we just changed the symbols in order to match the definitions used  in Section 4.4 . With the received vector represented as Equation 4.94, it is easy to  conclude that all the expressions in Section 4.4, including the randomized lattice  decoder algorithm  detailed in Chapter 2  and the corresponding expressions for  computation of LLRs, can be directly applied. The only difference is the definition  of h, which becomes  H  = α  HA  MCRM .     4.95   Independent of the decoding method used, the resulting symbol estimates are  serialized, demodulated, and de-interleaved before entering the channel decoder  block, which produces the final estimate of the information sequence.  Although CRM is usually studied for usage with multiple transmitting anten- nas, the fast-varying channel frequency response of severe time-dispersive environ- ments typical in OFDM systems can make the use of CRM very attractive even for  single antenna transmissions. Figure 4.23 shows the BER performance of a SISO- OFDM transmission with QPSK modulation, LDPC codes with different coding  rates, and two different CRM matrix sizes: MCRM = 2 and MCRM = 16. The angle  used for the CRM matrices, which can affect the system performance as studied in  [Seguro et al. 2011], was φ = 30 . The results we obtained using an UTRA LTE- Advanced Monte Carlo simulator for a 10 MHz bandwidth configuration whose  corresponding parameters are the same as shown in Table 4.1 of Section 4.3.2.  The channel impulse response is based on the typical urban  TypU  environment  [3GPP 2011c] with Rayleigh fading assumed for the different paths. It is visible that  the SSD gain provided by CRM increases with the size of the CRM matrix but is  strongly dependent on the coding rate of the LDPC code. The SSD gain is higher  for higher coding rates because of the lower coding gain of these codes  less chan- nel bit redundancy . When the redundancy of the channel code increases, the SSD  gain is not so noticeable due to the higher diversity gains that channel coding can  offer compared to SSD.  Figure 4.24 illustrates the impact of the type of receiver on a MIMO-OFDM  system with CRM. These curves were obtained for a 2 × 2 MIMO configuration  combined with CRM16, 64-QAM modulation, and without coding. Curves for       206  ◾  MIMO Processing for 4G and Beyond  TypU  No CRM R = 1 2 CRM2 R = 1 2 CRM16 R = 1 2 No CRM R = 0.8 CRM2 R = 0.8 CRM16 R = 0.8  2  4  6  8  10  12  14  16  18  20  Eb N0  dB   Figure  4.23  BLER  performance  of  a  SISO  QPSK  transmission  with  LDPC  and  CRM, TypU channel.  MMSE, no CRM MMSE, CRM16 Rand. lattice, no CRM Rand. lattice, CRM16  10  15  20  25  30  35  40  45  50  55  ES N0  dB   Figure 4.24  BER performance of an uncoded 2 × 2 MIMO 64-QAM transmis- sion, with CRM16 and different receivers, VehA channel.  100  10–1  R E B  10–2  10–3  10–4  0  100  10–1  10–2  10–3  10–4  10–5  10–6  10–7  5  R E B      MIMO Optimized for OFDM  ◾  207  MMSE and randomized lattice decoder  applying MMSE with a candidate list size  of K = 25  are shown. As a reference, performance curves of the receivers without  CRM are also included. It is visible that, besides the large gap between the per- formances of the MMSE receiver and the randomized lattice decoder, which was  already realized in Section 4.4.2, the performance gain achieved with the use of  CRM is substantially larger than with the MMSE receiver.  Acknowledgments This work was partially supported by FCT—Fundação para a Ciência e Tecnologia  via projects ADIN—Advanced PHY MAC Design for Infrastructure-less Networks  PTDC EEI-TEL 2990 2012, LTE-Advanced enhancements using Femtocells PTDC  EEA-TEL 120666 2010, and PEst-OE EEI LA0008 2013.  References 3GPP, Deployment aspects, TR 25.943 v10.0.0, April 2011. 3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA ; LTE physical layer; General   description TS 36.201 v11.1.0, December 2012.  3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA ; Physical channels and modula-  3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA ; Multiplexing and channel cod-  tion, TS 36.211 v11.3.0, June 2013.  ing, TS 36.212 v11.3.0, June 2013.  Alamouti, S. M. A simple transmit diversity technique for wireless communications, IEEE J.   Select. Areas Commun., 16 8 , 1451–1458, 1998.  Babai, L. On Lovász’ lattice reduction and the nearest lattice point problem, Combinatorica,   6 1 , 1–13, 1986.  Bahl, L. R., J. Cocke, F. Jeinek, and J.Raviv. Optimal decoding of linear codes for minimizing   symbol error rate, IEEE Trans. Inform. Theory, IT-20, 248–287, March 1974.  Benedetto S. and G. Montorsi, A soft-input soft-output APP module for iterative decoding   of concatenated codes, IEEE Commun. Lett., 1 1 , 22–24, 1997.  Boutros J. and E. Viterbo, Signal space diversity: A power-and bandwidth-efficient diver- sity  technique  for  the  Rayleigh  fading  channel,  IEEE Trans.  Inform.  Theory,  44 4 ,  1453–1467, 1998.  Cavers, J. K. An analysis of pilot symbol assisted modulation for Rayleigh fading channels,   IEEE Trans. Veh. Technol., 40 4 , 686–693, 1991.  Coleri, S., M. Ergen, A. Puri, and A. Bahai, Channel estimation techniques based on pilot   arrangement in OFDM systems, IEEE Trans. Broadcast., 48 3 , 223–229, 2002.  Correia,  A.  Optimised  complex  constellations  for  transmitter  diversity,  Wireless  Pers.   Commun. J., 20 3 , 267–284, 2002.  Deneire, L., B. Gyselinckx, and M. Engels, Training sequence versus cyclic prefix—A new   look on single carrier communications, IEEE Comm. Lett., 5, 292–294, 2001.  Divsalar  D.  and  F.  Pollara,  Multiple  turbo  codes,  Proceedings  of  the  IEEE  Military   Communications Conference, San Siego, USA, pp. 279–285, November 1995.      208  ◾  MIMO Processing for 4G and Beyond  1962.  Douillard, C., M. Jezequel, C. Berrou, A. Picart, P. Didier, and A. Glavieux, Iterative correc- tion of intersymbol interference: Turbo-equalization, Eur. Trans. Telecom., 6, 507–511,  1995.  ETSI, TR 101 112 v3.2.0, Selection procedures for the choice of radio transmission tech-  nologies of UMTS, Sophia Antipolis, France, 1998.  ETSI EN 302 307 V1.2.1: Digital Video Broadcasting  DVB ; Second generation fram- ing  structure,  channel  coding  and  modulation  systems  for  broadcasting,  interactive  services, news gathering and other broadband satellite applications  DVB-S2 , 2009a. ETSI EN 302 755 V1.1.1 Frame structure channel coding and modulation for a second   generation digital terrestrial television broadcasting system  DVB-T2 , 2009b.  Farhang-Boroujeny, B. Pilot-based channel identification: A proposal for semi-blind identifi-  cation of communication channels, Electron. Lett., 31 13 , 1044–1046, 1995.  Foschini, G. J. Layered space-time architecture for wireless communication in a fading envi-  ronment when using multiple antennas, Bell Labs Tech. J., 1 2 , 41–59, 1996.  Fossorier, M. P. C., F. Burkert, S. Lin, and J. Hagenauer, On the equivalence between SOVA   and Max-Log-MAP decodings, IEEE Commun. Lett., 2 5 , May 1998.  Friedberg, S. H., A. J. Insel, and L. E. Spence. Linear Algebra, Prentice-Hall, USA, 2002. Gallager,  R.  G.  Low-density  parity-check  codes,  IRE Trans.  Inform.  Theory,  IT-8,  21–28,   Hagenauer J. and P. Hoher, A Viterbi algorithm with soft-decision outputs and its applica-  tions, Proc. IEEE GLOBECOM’89, Dallas, U.S., 1989.  Hanzo,  L.  L.,  Y.  Akhtman,  L.  Wang,  and  M.  Jiang,  MIMO-OFDM  for  LTE, WiFi  and  WiMAX: Coherent versus Non-Coherent and Cooperative Turbo Transceivers, Wiley-IEEE  Press, UK, 2010.  Heegard C. and S. B. Wicker, Turbo Coding, Kluwer Academic Publishers, USA, 1999. Ho,  C.,  B.  Farhang-Boroujeny,  and  F.  Chin,  Added  pilot  semi-blind  channel  estimation  scheme  for  OFDM  in  fading  channels,  IEEE  GLOBECOM’01,  San  Antonio, TX,  USA, November 2001.  Hoher, P., S. Kaiser, and P. Robertson, Pilot-symbol-aided channel estimation in time and  frequency, Proceedings of the IEEE Communication Theory Mini-Conference  CTMC ,  IEEE GLOBECOM’97, Phoenix, AZ, USA, pp. 90–96, 1997.  IEEE, IEEE Standard for local and metropolitan area networks—Part 16: Air Interface for   Broadband Wireless Access Systems IEEE Std 802.16e-2005, February 2006.  IEEE, IEEE Standard for local and metropolitan area networks—Part 16: Air Interface for   Broadband Wireless Access Systems IEEE Std 802.16 m-2011, May 2011a.  IEEE, IEEE Standard for Information technology—Telecommunications and information  exchange between systems—Local and metropolitan area networks—specific require- ments—Part 11: Wireless LAN Medium Access Control  MAC  and Physical Layer   PHY  Specifications. Amendment 5: Enhancements for Higher Throughput IEEE Std  802.11n-2009, October 2011b.  Kay,  S.  M.  Fundamentals  of  Statistical  Signal  Processing:  Estimation  Theory.  Prentice-Hall,   Englewood Cliffs, NJ, 1993.  Kim, Y.-S., C.-J. Kim, G.-Y. Jeong, Y.-J. Bang, H.-K. Park, and S. S. Choi, New Rayleigh fad- ing channel estimator based on PSAM channel sounding technique, Proceedings of the  IEEE International Conference on Communication, Montreal, Canada, pp. 1518–1520,  June 1997.  Klein, P. Finding the closest lattice vector when it’s unusually close, Proceedings of ACM- SIAM Symposium on Discrete Algorithms, San Francisco, CA, USA, pp. 937–941, 2000.      MIMO Optimized for OFDM  ◾  209  Lenstra, A. K., H. W. Lenstra, and L. Lovász, Factoring polynomials with rational coefficients,   Mathematische Annalen, 261 4 , 515–534, 1982.  Liu, S., C. Ling, and D. Stehlé, Decoding by sampling: A randomized lattice algorithm for   bounded distance decoding, IEEE Trans. Inform. Theory, 57 9 , 5933–5945, 2011.  Orozco-Lugo, A., M. Lara, and D. McLernon, Channel estimation using implicit training,   IEEE Trans. Sig. Proc., 52 1 , 240–254, 2004.  MacKay  D.  J.  C.  and  R.  M.  Neal,  Good  codes  based  on  very  sparse  matrices,  in  Boyd  C.  Ed. , Cryptography and Coding, 5th IMA Conference, Springer, UK, pp. 100–111,  1995  number 1025 in Lecture Notes in Computer Science .  MacKay D. J. C. and R. M. Neal, Near Shannon limit performance of low density parity   check codes, Electron. Lett., 33 6 , 457–458, 1996.  Marques da Silva, M., A. Correia, R. Dinis, N. Souto, and J. Silva, Transmission Techniques  for  Emergent  Multicast  and  Broadcast  Systems,  CRC  Press, Taylor  &  Francis  Group,  Boca Raton, USA, 2010.  Moher, M. An iterative multiuser decoder for near-capacity communications, IEEE Trans.   Rainish, D. Diversity transform for fading channels, IEEE Trans. Commun., 44 12 , 1653–  Commun., 46 7 , 870–880, 1998.  1661, 1996.  Reed, M. C. Iterative multiuser detection for CDMA with FEC: Near single user perfor-  mance, IEEE Trans. Commun., 46 12 , 1693–1699, 1998.  Richardson T. and R. Urbanke, The capacity of low-density parity-check codes under mes-  sage-passing decoding, IEEE Trans. Inform. Theory, 47 2 , 599–618, 2001a.  Richardson T. and R. Urbanke, Efficient encoding of low-density parity check codes, IEEE   Trans. Inform. Theory, 47 2 , 638–656, 2001b.  Robertson  P.,  E. Villebrun,  and  P.  Hoeher.  A  Comparison  of  Optimal  and  Sub-Optimal  MAP Decoding Algorithms Operating in the Log Domain. Proc. IEEE International  Conference on Communications  ICC ‘95 , vol. 2, pp. 1009-1013, Seattle, 1995.  Sanzi F. and J. Speidel, An adaptive two-dimensional channel estimator for wireless OFDM   with application to mobile DVB-T, IEEE Trans. Broadcast., 46, 128–133, 2000.  Seguro, J., P. Gomes, N. Souto, A. Correia, and R. Dinis, Rotation matrices for OFDM  transmission,  Proceedings  of  EUROCON  and  CONFTELE  2011,  Lisbon,  Portugal,  April, 2011.  Souto, N., A. Correia, R. Dinis, J. C. Silva, and L. Abreu, Multiresolution MBMS transmis- sions for MIMO UTRA LTE systems, Proceedings of the IEEE International Symposium  on Broadband Multimedia Systems and Broadcasting, Las Vegas, USA, March 31–April  2, 2008.  Tanner, R. M. A recursive approach to low complexity codes, IEEE Trans. Inform. Theory,   27 5 , 533–547, 1981.  Valenti, M. C. Iterative channel estimation and decoding of pilot symbol assisted turbo codes   over flat-fading channels, IEEE J. Sel. Areas Commun., 19 9 , 1697–1705, 2001.  Wang  Z.  and  C.  Ling,  Derandomized  sampling  algorithm  for  lattice  decoding,  IEEE   Information Theory Workshop, Lausanne, Switzerland, September 2012.  Wang X. and H. V. Poor, Iterative  turbo  soft interference cancellation and decoding for   coded CDMA, IEEE Trans. Commun., 47 7 , 1046–1061, 1999.  Zhu, H., B. Farhang-Boroujeny, and C. Schlegel, Pilot embedding for joint channel esti- mation and data detection in MIMO communication systems, IEEE Commun. Lett.,  7 1 , 30–32, 2003.       Chapter 5 MIMO Optimized for  Single-Carrier Frequency- Domain Equalization  Rui Dinis, João Carlos Silva, and Nuno Souto  Contents 5.1  Introduction .............................................................................................212 5.2  SC-FDE Schemes ..................................................................................... 215 5.3  IB-DFE Receivers .....................................................................................217 5.3.1  Basic IB-DFE Structure ................................................................217 5.3.2  IB-DFE with Soft Decisions .........................................................219 5.3.3  Multiresolution Systems ................................................................221 5.3.4  Analytical Characterization of Mapping Rules ............................ 222 5.3.4.1  General Mapping ........................................................... 222 5.3.5  Special Cases.................................................................................223 5.3.5.1  PAM Constellations ........................................................223 5.3.5.2  QAM Constellations ......................................................224 5.3.5.3  M-PSK Constellations ....................................................224 5.3.6  Computation of Receiver Parameters ............................................225 5.3.7  Performance Results .................................................................... 228 Iterative Frequency-Domain Detection for MIMO-SC ............................232 5.4.1  System Model ...............................................................................232 5.4.2  Computation of Receiver Coefficients .......................................... 234 5.4.3  Soft Decisions ...............................................................................238  5.4   211   212  ◾  MIMO Processing for 4G and Beyond  5.4.4  Complexity Issues .........................................................................239 5.4.5  Performance Results .....................................................................239 Acknowledgment ..............................................................................................243 References .........................................................................................................243  5.1  Introduction Future wireless systems are required to support high quality of service at high data  rates. Moreover, owing to power and bandwidth constraints, these systems are also  required to operate with small transmit powers, especially at the mobile terminals   MTs , and to have high spectral efficiencies.  It is well known that, by employing multiple antennas at both the transmit- ter and the receiver, we can substantially increase the capacity of a given system  [Foschini 1996]. To exploit this potential, several Bell Laboratory layered space– time  BLAST  architectures have been proposed for flat fading multiple-input, mul- tiple-output  MIMO  channels [Foschini and Gans 1998; Wolniasky et al. 1998].  BLAST techniques were extended to frequency-selective channels through the use  of time-domain MIMO decision feedback equalizers  MIMO-DFE  [Al-Dhahir  and Sayed 2000; Lozano and Papadias 2002].  This concept can be extended to space-division multiple access  SDMA  tech- niques where we employ multiple antennas at the base station  BS  to increase the  number of simultaneous users in a given cell, allowing a significant increase in the  system spectral efficiency, while reducing the transmit power requirements for the  MTs [Winters et al. 1992; Gitlin et al. 1994; Tidestav et al. 1999; Ariyavisitakul  2000; Abe and Matsumoto 2003; Roy and Falconer 2003; Sfar et al. 2003].  However, for the high data rates of broadband wireless systems, we can have  severe time-dispersion effects associated with the multipath propagation. In this  case, conventional time-domain equalization schemes are not practical, since the  number of operations per symbol is proportional to the intersymbol interference   ISI  span. This can be more serious when conventional time-domain equalization  methods are employed in high data rate MIMO systems.  Block transmission techniques, with appropriate cyclic extensions and employ- ing frequency-domain equalization  FDE  techniques, have been shown to be suit- able for high data rate transmission over severe time-dispersive channels, since the  number of operations per symbol grows logarithmically with the block duration   and, therefore, the ISI span , due to the fast Fourier transform  FFT  implementa- tion [Gusmão et al. 2000; Wang and Giannakis 2000; Falconer et al. 2002].  Orthogonal frequency division multiplexing  OFDM  schemes [Cimini 1985;  Bingham 1990] are the most popular modulations based on this technique. Since  an OFDM transmission over time-dispersive channels can be regarded as a paral- lel transmission over a set of nondispersive channels, one for each subcarrier, the  extension  of  MIMO BLAST  techniques  to  OFDM  schemes  is  straightforward,  eventually with some preprocessing at the transmitter and or employing adaptive       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  213  loading  schemes  [Raleigh  and  Cioffi  1998;  Raleigh  and  Jones  1999].  However,  OFDM signals have high envelope fluctuations and a high peak-to-mean envelope  power ratio  PMEPR  leading to amplification difficulties. For this reason, several  techniques have been proposed for reducing the envelope fluctuations of OFDM  signals [Jones and Wilkinson 1996; Müller et al. 1997; Dinis and Gusmão 2004].  However, these PMPER-reducing techniques require an increased signal-processing  effort, especially at the transmitter side, and, possibly, some signal distortion when  a nonlinear signal processing is employed. Moreover, even for the most sophisti- cated techniques, the transmitted signals still have PMEPRs higher than those for  single-carrier  SC  signals based on similar constellations.  SC  modulations,  using  block  transmission  techniques  and  FDE  [Sari  et  al.  1994], are an alternative approach for broadband wireless systems. Similar to OFDM  modulations, the data blocks are preceded by a cyclic prefix  CP , long enough to  cope with the channel length. The received signal is transformed into the frequency  domain,  equalized  in  the  frequency  domain,  and  then  transformed  back  to  the  time domain. The achievable performances as well as the overall implementation  complexities are similar for SC schemes with FDE and OFDM schemes [Gusmão  et al. 2000; Montezuma and Gusmão 2001a; Falconer et al. 2002]. However, the  signal-processing effort is concentrated at the receiver for the SC case. This, com- bined with the lower envelope fluctuations of SC signals, makes them preferable for  the uplink transmission  i.e., the transmission from the MT to the BS , while the  OFDM schemes might be a better choice for the downlink transmission  i.e., the  transmission from the BS to the MT . For this reason, a mixed OFDM plus SC  mode air interface was proposed, employing an SC scheme with FDE in the uplink  and an OFDM scheme in the downlink [Gusmão et al. 2000; Falconer et al. 2002]. Usually  a  linear  FDE  is  employed  at  the  receiver  [Sari  et  al.  1994;  Gusmão  et al. 2000]. However, it is well known that nonlinear equalizers can significantly  outperform linear equalizers [Proakis 1995]. For this reason, it is advantageous to  design nonlinear equalizers for SC-FDE schemes [Benvenuto et al. 2010]. Among  several different nonlinear equalizers, decision feedback equalizers  DFE  are espe- cially popular due to its good performance complexity trade-offs. A hybrid time– frequency SC-DFE was proposed employing a frequency-domain feedforward filter  and  a  time-domain  feedback  filter  [Benvenuto  and  Tomasin  2001].  The  hybrid  time–frequency-domain DFE can have better performance than a linear FDE but,  as  with  conventional  time-domain  DFEs,  it  can  suffer  from  error  propagation,  especially if the feedback filter has a large number of taps.  A promising iterative block DFE  IB-DFE  approach for SC transmission was pro- posed in [Benvenuto and Tomasin 2002] and extended to diversity scenarios [Dinis  et al. 2003, 2004b]  and spatial multiplexing schemes [Dinis et al. 2004; Kalbasi  et al. 2004]. The IB-DFE schemes were also shown to allow excellent performance  in many other scenarios, ranging from reduced cyclic prefix SC-FDE [Gusmão et al.  2007a, 2007b], code division multiple access  CDMA  scenarios [Dinis et al. 2004a;  Silva and Dinis 2006a,b; Dinis et al. 2007a], network diversity schemes [Dinis et al.       214  ◾  MIMO Processing for 4G and Beyond  2007b; Ganhão et al. 2011, 2012, 2013; Pereira et al. 2012, 2013a,b; Marques da  Silva et al. 2012], and offset modulations [Luzio et al. 2012, 2013]. We can also define  highly efficient techniques based on the IB-DFE concept for joint detection and esti- mation [Araújo and Dinis 2004; Lam et al. 2006; Dinis et al. 2008, 2010a; Pedrosa  et al. 2010, 2012a,b; Silva et al. 2013] and to cope with severe nonlinear distortion  effects [Silva and Dinis 2008, 2009; Dinis and Silva 2009; Dinis et al. 2009].  With IB-DFE schemes, both the feedforward and the feedback parts are imple- mented in the frequency domain. Since the feedback loop takes into account not  just the hard decisions for each block but also the overall block reliability, the error  propagation  problem  is  significantly  reduced.  Consequently,  the  IB-DFE  tech- niques offer much better performances than noniterative methods [Benvenuto and  Tomasin 2002; Dinis et al. 2003]. In fact, IB-DFE techniques can be regarded as  low-complexity turbo equalization schemes [Tüchler et al. 2003], since the feed- back loop uses the equalizer outputs instead of the channel decoder outputs.  Earlier IB-DFE implementations considered hard decisions  weighted by the  blockwise  reliability   in  the  feedback  loop.  To  improve  the  performance  and  to  allow  truly  turbo  FDE  implementations,  IB-DFE  schemes  with  soft  decisions  were proposed [Benvenuto and Tomasin 2005; Gusmão et al. 2006, 2007a]. Usual  IB-DFE implementations only consider QPSK constellations. However, larger con- stellations such as quadrature amplitude modulation  QAM  and phase shift keying   PSK  are often required when we want to increase the system’s spectral efficiency.  Furthermore, hierarchical constellations  which may be composed of nonuniformly  spaced constellation points  are particularly interesting for broadcast multicast sys- tems since they are able to provide unequal bit error protection [Cover 1972; Jiang  and Wilford 2005]. In this type of constellation, there are two or more classes of  bits with different error protection, to which different streams of information can  be mapped. Depending on the channel conditions, a given user can attempt to  demodulate only the more protected bits or also the other bits that carry additional  information. An application of these techniques is in the transmission of coded  voice or video signals, where we can have different error protection associated with  different resolutions [Ramchandran 1993; Jiang and Wilford 2005].  An  important  drawback  of  large  constellations,  in  general,  and  nonuniform  constellations, in particular, is that they are very sensitive to interference, namely,  the residual ISI at the output of a practical equalizer that does not invert com- pletely the channel effects  e.g., a linear equalizer optimized under the minimum  mean squared error  MMSE  [Proakis 1995] . Therefore, we can expect significant  performance improvements when we employ IB-DFE receivers with large constel- lations. However, there are some difficulties in the design of IB-DFE receivers for  any constellation, namely, on the computation of the reliability of each block, as  well as problems on the computation of the average symbol values conditioned on  the FDE and or the channel decoder output.  In this chapter, we consider MIMO SC-DFE schemes for different constella- tions. We start by characterizing the basic SC-FDE and IB-DFE schemes. Then       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  215  we present a pragmatic approach for designing the receiver that employs a general  method for the computation of the receiver parameters for any constellation. Our  approach follows [Dinis et al. 2010b,c; Silva et al. 2012] and relies on an analytical  characterization of the mapping rule where the constellation symbols are written as  a linear function of the transmitted bits. This method is then employed to design  turbo receivers implemented in the frequency domain for systems with both con- ventional constellations and multiresolution hierarchical constellations where we  have different error protections. Finally, we describe MIMO receivers based on the  IB-DFE concept.  5.2  SC-FDE Schemes As  already  mentioned  in  Chapter  4,  OFDM  schemes  are  suitable  for  high  data  rate transmission over severely time-dispersive channels, since they have excellent  performance with low-complexity receiver implementations. However, OFDM sig- nals suffer from large envelope fluctuations, which lead to amplification difficulties.  As an attractive alternative, SC-FDE schemes are also suitable for severely time- dispersive channels and the single-carrier nature of the transmitted signals means  that they have much lower envelope fluctuations than OFDM signals based on the  same constellation.  To understand SC-FDE schemes, let us consider an SC-based block transmis- sion with N useful data symbols per block {sn; n = 0, 1, . . ., N–1} resulting from  the direct mapping of the original data into a selected signal constellation. As with  OFDM schemes, a suitable CP is appended to the useful block, which corresponds  to the repetition of the last NG data symbols. The transmitted signal is then     s t     =  s h t   n T  −  nT S   ,  N  −∑  −  = n NG      5.1   =  with TS denoting the symbol duration, NG denoting the number of samples at the  cyclic prefix, and hT t  denoting the adopted pulse shape. The transmitted sym- bols sn belong to a given alphabet  S   i.e., a given constellation  with dimension  M = S and are selected according to the corresponding bits βn  , m = 1,2, . . .,  m  −   throughout  m  m = log2 M   that is, s 1 f b     m    1  n n this chapter, we assume that βn   is the mth bit associated with the nth symbol and  m    = 1−  or  bn m  +1, respectively . As with other cyclic-prefix-assisted block transmission schemes, it      m is assumed that the time-domain block is periodic, with period N, that is, s . − N n If we discard the samples associated with the cyclic prefix at the receiver, then  there is no interference between blocks, provided that the length of the cyclic pre- fix is higher than the length of the overall channel impulse response. Moreover,     is the corresponding polar representation, i.e., βn m     = 0 or 1 and bn m   µ , with bn   m    = 2  b  2  n  ...,  b   n  m   − n  β  =     s  ,  ,  n            216  ◾  MIMO Processing for 4G and Beyond  the linear convolution associated with the channel is equivalent to a cyclic con- volution relatively to the N-length, useful part of the received block, {yn; n = 0,1,  . . ., N–1}. This means that the corresponding frequency-domain block  i.e., the  length-N DFT  discrete Fourier transform  of the block {yn;n = 0,1, . . ., N–1}  is  {Yk; k = 0,1, . . ., N–1}, where   5.2   Y  =  S H k  +  N  ,    k  k  k    with Hk denoting the channel frequency response for the kth subcarrier and Nk  the corresponding channel noise. Clearly, the impact of a time-dispersive channel  reduces to a scaling factor for each frequency.  The simplest FDE is the linear FDE depicted in Figure 5.1, where the frequency- −   1} ; = 0,1, k time-domain  block  1} . If the FDE coef-  domain  signal  at  the  FDE  output  is  given  by  { the  detection  and  −  cid:31  { s n 1} n ficients Fk are given by  F Y k k the  corresponding  − F Y k k  is  based  on  = =  ; = 0,1,  ; = 0,1,  IDFT  …  …  …   cid:31  S k   cid:31  S k  N  N  N  =  {  ,  ,  ,  k  = 1 , F Hk  k       we  eliminate  completely  the  ISI  at  the  FDE  output   i.e.,  the  FDE  is  optimized  under the zero forcing  ZF  criterion . However, for a typical frequency-selective  channel, we can have deep notches in the channel frequency response that lead to  significant noise enhancement effects when the ZF criterion is employed. To mini- mize the combined effect of ISI and channel noise on the equalized samples, the  FDE coefficients should be selected according to the MMSE criterion  minimum  mean-squared error , which corresponds to using    where the SNR  signal-to-noise ratio  is given by  F k  =  H * k +   1   SNR H   2  k  ,        {  yn  }  Yk{  }  ~  Sk{  }  DFT  X  IDFT  sn{   }  Decision device  SNR  =  E S [ k E N [   ] 2  ] 2  k  .     sn{ }  Fk{  }  Figure 5.1  Basic structure of a linear FDE.   5.3    5.4    5.5       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  217  OFDM SC-FDE  ZF  SC-FDE  MMSE  MFB  100  10–1  R 10–2  E B  10–3  10–4  0  5  10  Eb N0  dB   15  20  Figure 5.2  BER performance for SC-FDE with QPSK constellations and a linear  FDE optimized under the ZF or MMSE criterion, together with the corresponding  MFB. For the sake of comparisons, we also include the uncoded BER performance  for the corresponding OFDM schemes.  Contrary to OFDM schemes where ZF and MMSE criterions yield the same  performance, the SC-FDE performance is typically much better for the MMSE  criterion [Gusmão et al. 2003]. An FDE optimized under the MMSE criterion does  not attempt to fully invert the channel when we have a deep fade, reducing noise  enhancement  effects  and  allowing  better  performances.  However,  owing  to  the  residual ISI, the performance of a linear FDE optimized under the MMSE crite- rion is still far from the matched filter bound  MFB , given by [Amaral et al. 2012]  P MFD  =  E Q           b  E 2 N 0  1  N  −∑  k  =0   2  H  k N               5.6       see Figure 5.2 .  5.3  IB-DFE Receivers 5.3.1  Basic IB-DFE Structure Although  the  equalization  can  be  accomplished  employing  a  linear  FDE,  as  explained in Section 5.2, the performance can be substantially improved with the       218  ◾  MIMO Processing for 4G and Beyond  { Yk  }  Fk} {  X  Σ  +  –  X  Bk{  }  }~ Sk{  }~ sn{  IDFT  Dec.  Sk{ }  sn{ }  DFT  Figure 5.3  Basic structure of an IB-DFE.  use of an IB-DFE, whose structure is depicted in Figure 5.3. For a given iteration,  the output samples are given by   cid:31 S k  =  F Y k  k  −   cid:30  B S k k  ,      5.7   with {Fk; k = 0,1, . . ., N–1} and {Bk; k = 0,1, . . ., N–1} denoting the feedforward  and the feedback coefficients, respectively.   cid:31 { … −  is the DFT of  … − , with   cid:22 sn denoting the “hard” estimate of sn from  the block   cid:31 { s n N n the previous FDE iteration.  = 0,1,  = 0,1,  S k k  1}  1}  N  As shown in [Dinis et al. 2003],* the coefficients Fk and Bk that maximize the   ,  ;  ;  ,  overall SNR in the samples   cid:31 Sk are given by  and  respectively, where  and κ is selected so as to ensure that  F k  =  α  +   1  κ H * k ρ − 2      H  k   2  ;     B k  =  ρ   F H k  k   ,− 1     α = [  E N   ]  2  [ E S  k   ] 2  k     N  1 F H N k  −∑    k  k  =0  = 1.      5.8    5.9    5.10    5.11                  *  It should be noted that, contrary to [Dinis et al. 2003], we are considering a normalized feed-  forward filter.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  219  The correlation coefficient ρ, which can be regarded as the blockwise reliability  of the decisions used in the feedback loop  from the previous iteration , is given by  ρ =   cid:22  [ ] E S S * k k  ] [ E S 2 k  =   cid:22  [ ] E s s * n n [  ] E s 2 n      5.12   and can be estimated as described in [Dinis et al. 2003, 2007a] and [Silva et al.  2011].  It  is  important  to  note  that  although  the  IB-DFE  just  described  is  usually  denoted as “IB-DFE with hard decisions,” it would probably be more adequate to  refer to it as “IB-DFE with blockwise soft decisions,” as we will see in the following.  In fact, Equation 5.7 could be written as   cid:31 S k  =  F Y k  k  − ′ Block  B S k  k  ,      5.13   Bk k=   and S k  with ρ ′B chips associated with a given iteration, given by S can be regarded as the blockwise reliability of the estimates   cid:31 {  Block denoting the average of the block of overall time-domain  Block = ρ  cid:22    as mentioned earlier, ρ  … −  . 1}  ; = 0,1,  S n k  M  S  ,  k  k  5.3.2  IB-DFE with Soft Decisions In  order  to  improve  the  performance,  we  can  replace  the  “blockwise  aver- ages”  used  in  the  IB-DFE  structure  described  earlier  by  “symbol  aver- ages,”  leading  to  what  is  usually  denoted  as  “IB-DFE  with  soft  decisions”  [Benvenuto  and  Tomasin  2005;  Gusmão  et  al.  2006,  2007a].  A  simple  way  of  … −   by  achieving  this  is  to  replace  the  feedback  input  { ; = 0,1, k 1} , − , with sn Symbol  … S 1 denoting the average symbol values conditioned to the FDE output of the previous  −  denoting the IDFT of the frequency-  cid:31  iteration   cid:31 sn, with { … n s N , n  cid:31  − . To simplify the notation, we will use sn  and  … , ; = 0,1, domain block { 1} S k k Symbol  in the rest of the chapter. S k  instead of sn Symbol  and S k  =; = 0,1, N  For normalized QPSK constellations  i.e., sn = ±1 ±  j  with Gray mapping, it is   ; = 0,1,  n ; = 0,1,  } =  Symbol n  Symbol k  DFT  S k k  Block k  {  {  }  …  1}  N  N  N  −  1  =  S  s  ,  ,  easy to show that [Gusmão et al. 2006, 2007a]  s n  =  tanh     L I n 2    +  j  tanh     L Q n 2     =  ρ I n   cid:22  s  I n  +  j  ρ Q n   cid:22  s  Q n  ,   5.14     with the log-likelihood ratios  LLR  of the “in-phase bit” and the “quadrature bit,”  associated with s  }, respectively, given by  } and s  Im s {  Re s {  =  =     Q n  I n  n  n  L I n  = 2   I n   cid:31  σ   s  2   5.15                220  ◾  MIMO Processing for 4G and Beyond  L Q n  = 2     Q n   cid:31  σ   s ,2  respectively, where  σ 2  = 1 2 [ E s  n  −   cid:31  s n   ] 2  ≈  1 N 2  1  cid:30  E s [ n  N  −∑  n  =0  −   cid:31  s n   ]. 2     The hard decisions  cid:22 sn  Q , respectively, and ρn  and Ln with the “in-phase” and “quadrature” bits of the nth symbol, given by  I = 1±  and  cid:22 sn I  and ρn  Q = 1±  are defined according to the signs of Ln I   Q  can be regarded as the reliabilities associated   ρn I  = [   cid:22  E s s I I n n  ]   E s [  I n   ] = 2  tanh   L I n   2       ρn I  E s = [  Q n   cid:22  s Q n  ]   E s [  Q n   ] = 2  tanh   L Q n   2       ρ  = 1 2  N  1    −∑ + N n  ρ I n  =0  ρ Q n   .      for the first iteration, ρ I n  ρ Q= n  = 0 and sn = 0 .  The  feedforward  coefficients  are  still  obtained  from  Equation  5.8,  with  the   blockwise reliability given by   5.16    5.17    5.18    5.19    5.20   and  and                 Therefore, the receiver with “blockwise reliabilities”  hard decisions  and the  receiver with “symbol reliabilities”  soft decisions  employ the same feedforward  coefficients; however, in the first, the feedback loop uses the “hard decisions” on  each data block, weighted by a common reliability factor, while in the second, the  reliability factor changes from bit to bit. The receiver structure when we have soft  decisions is depicted in Figure 5.4, which is closely related to the IB-DFE with hard  decisions  Figure 5.3 .  We can also define a frequency-domain turbo equalizer that employs the chan- nel decoder outputs instead of the uncoded “soft decisions” in the feedback loop.  The receiver structure is similar to the IB-DFE with soft decisions, but with a soft-in,  soft-out  SISO  channel decoder employed in the feedback loop. The SISO block,  which can be implemented as defined in [Vucetic and Yuan 2002], provides the LLRs  of both the “information bits” and the “coded bits.” The input of the SISO block is  LLRs of the “coded bits” at the FDE. Once again, the feedforward coefficients are  obtained from Equation 5.8, with the blockwise reliability given by Equation 5.20.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  221  { Yk  }  {  Fk  }  X  }~ Sk  ∑ { –  +  sn{ }~  IDFT  {  m  λn  }  Dec.  LLR  comput.  }– Sk{  X  DFT  sn{ }–  Bk{  }  Average’s comput.  Figure 5.4  Regions associated with Ψ0   8-PAM constellation with Gray mapping.   m  and  Ψ1    m m =     1,2,3    for a uniform   5.3.3  Multiresolution Systems In a multiresolution system, we can have m streams, each one associated with a dif- ferent resolution and with a suitable error protection. Figure 5.5 illustrates the basic  structure of a transmitter. According to this figure, the data stream associated with  the mth resolution is encoded by a different channel encoder and the correspond- … − . The different  ing bits are interleaved, leading to the block { … − , m = 1,2,. . .,m, are mapped onto the block of time- blocks { domain symbols {sn,n = 0,1,. . .,N–1} and the rest of the transmitter is similar to the  transmitter for conventional constellations.*  n , = 0,1,  , = 0,1, n  The  receiver  can  be  the  one  depicted  in  Figure  5.6.  Essentially,  we  have  an  IB-DFE receiver where the demapping block provides LLRs of the bits associated  with each error protection level. The operations of detection decoding and compu- tation of average bit values are preformed separately for each resolution bit stream.   b m   n   b m   n  1}  1}  N  N  ,  ,  Data  Data  bn{ } 1   bn{ } µ   Encoder  1  Encoder  NR  Interleaver  Interleaver  sn{  }  Mapping  Add. CP  Tx  Figure 5.5  Transmitter structure for SC-FDE with multiresolution.  *  Without loss of generality, we are assuming that the bit rate associated with each resolution is  identical. The extension to the case where we have different bit rates for different resolutions is  straightforward.      222  ◾  MIMO Processing for 4G and Beyond  yn{  }  { Yk  }  DFT  ~ Sk{  }  ~sn{  }  IDFT  Demapping  X  Σ  +  –  Fk{  }  Only for turbo FDE  λn{ } 1   λn{ } µ   } 1 – bn{  –  bn{ } µ   Dec.  Dec.  Comp. average  Comp. average   1 out  λn{  }   µ out  λn{  }   1 out  λn{  }   µ out  λn{  }  –Sk{  }  –sn{  }  X  DFT  Remapping  {  Bk  }  Figure 5.6  Iterative FDE receiver structure for SC-FDE with multiresolution  the  dashed part corresponds to the SISO decoders and is only required for a turbo  FDE .  5.3.4  Analytical Characterization of Mapping Rules 5.3.4.1  General Mapping As shown in [Montezuma and Gusmão 2001a,b], it is possible to express the con- stellation symbols as a function of the corresponding bits using*  s  n  =  g  0  +  g b  1  n 1  +  g b  2  n 2  +  g b b  1   2  n n 3  +  g b  3  n 4  +  M  −∑ cid:30   =  1 g  i  µ∏∏  bn   m  i  =0  m  =1     γ    , , m i   5.21      for each sn ∈ S, where  γm,i γm–1,i . . . γ2,i γ1,i  is the binary representation of i. Since  we have M constellation symbols in  S and M coefficients gi, Equation 5.21 is a  system of M equations that can be used to obtain the coefficients gi, i = 0,1,. . .,m–1.  Writing Equation 5.21 in matrix format, we have  s Wg  =  ,     5.22         *  It should be noted that in this section sn denotes the nth constellation point, but in the previ-    that here  ous section, sn denotes the nth transmitted symbol; the same applies to bn m  denotes the mth bit of the nth constellation point  instead of the mth bit of the nth transmitted  symbol .     or βn m       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  223  with     s = [  s s 1 2  ...  sM  ] , T  g = [  g  0  g  1  ...  g  µ− 1    ] ,   T   5.23    5.24     and  W  is  a  Hadamard  matrix  with  dimensions  M × M.  Clearly,  the  vector  of  constellation points s is the Hadamard transform of the vector of coefficients g.  Therefore, for a given constellation, we can obtain the corresponding coefficients gi  from the inverse Hadamard transform of the vector of constellation points.  5.3.5  Special Cases In this section, we present some special cases where the mapping is particularly  simple, avoiding the computation of Hadamard transforms.  5.3.5.1  PAM Constellations } For a uniform M-PAM constellation, we have S = { 1, 3 ± ± … M 1 . ,    ±    −  ,  If we have a natural binary mapping, the only nonzero coefficients are g1,g2,g4,  2 = 2µ− , which   . . . ,gM 2  i.e., the coefficients  g i2 , i = 0,1, . . . ,m – 1 . Moreover,  g i means that  i  s  n  =  g b  1  n 1  +  g b  2  n 2  +  g b  3  n 4  +   cid:30   =  b  1  n  +  b 2  2  n  +  b 4  4  n  m  2  −−1     bn m .   5.25   µ  + ∑  cid:30   =  m  =1     For a Gray mapping, the only nonzero coefficients are the ones with binary  representations  0 … 001 ,  0 … 011 , … ,  111 … 1 , that is, the coefficients  g i2 1 −  , which means that    1 . Moreover, g i 2  0 1 , ...,  = 2  − −µ 1  µ  =  −  − 1  i  ,  i  s  n  = 2  µ  − b 1  1  n  +  µ  −  2  b b 2  1   2  n n  +  µ  −  2  b b b 3  1   2   3  n n n  µ  + ∑ cid:30   =  2  m  =1  µ  −  mm  m  ′   ∏ . mb   n =1  m  ′      5.26            For uniform 4-PAM constellations, we have    for a natural binary mapping and  s  n  = 2  1  b n  +  b  2  n     for a Gray mapping. For uniform 8-PAM constellations, we have  s  n  = 2  1  b n  +  b b  1   2  n n     s  n  b = 4  1  n  +  b 2  2  n  +  b  3  n      5.27    5.28    5.29       224  ◾  MIMO Processing for 4G and Beyond           for a natural binary mapping and  s  n  b = 4  1  n  +  b b 2  1   2  n n  +  b b b  2   1   3  n n n      5.30   for a Gray mapping.  The same approach can be employed for nonuniform hierarchical constellations  such as the ones adopted in multiresolution schemes [Jiang and Wilford 2005]. In  fact, from Equations 5.25 and 5.26, an M-PAM constellation with either natural  binary mapping or Gray mapping can be regarded as the sum of μ binary subcon- stellations, each one with twice the amplitude of the previous one. By reducing  the amplitude of successive subconstellations, we obtain hierarchical constellations  with different error protections.  5.3.5.2  QAM Constellations The mapping of the bits on an M-QAM constellation is often performed inde- pendently to the in-phase and quadrature components, that is, half the bits are  used to define the in-phase component  as in the previous case, for Gray mapping  or natural binary mapping  and the other half is used to define the quadrature  component. Therefore, an M-QAM constellation can be written as the sum of two  M -PAM  constellations,  one  for  the  in-phase   real   component  and  the  other  for the quadrature  imaginary  component. For instance, for 16-QAM with Gray  mapping, we have  s  n  b = 2  1  n  +  b b  1   2  n n  +  2  jb  3  n  +  jb b  3   4  n n      5.31   and for 64-QAM with Gray mapping, we have  n  s  +  = 4 b  1  n  b b 2  1   2  n n   6 .    5.32  The extension to other mapping rules and or nonuniform QAM constellations   b b b  2   1   3  n n n  jb b  4   5  n n  ++ jb b b  5  n n  jb  4  n   4  n  +  +  +  2  4  is straightforward.  5.3.5.3  M-PSK Constellations Whereas the characterization of a BPSK constellation is trivial and QPSK constel- lations with Gray mapping are simply a special case within the aforementioned  QAM class, characterizing analytically a given M-PSK constellation is in general  complex* and we need to employ directly Equation 5.22.  *  Naturally, we could define a PSK constellation as a complex exponential of a suitable PAM  constellation, but this does not help us in the receiver design since the constellation symbols  are not a linear function of the corresponding bits.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  225  2  ,  ,  ,  s  s  ∗ 2  ∗ s 1  { , s 1  − − − , s 1  In the following, we present the analytical characterization of 8-PSK constella- tions  it is better to employ the Hadamard transform, as described earlier when we  want to characterize larger PSK constellations . Let us assume that the constellation  is defined by two points, s1 and s2, as well as their reflections in the real and imagi- nary axis, that is, S = } , corresponding to the “tri-bits”  010, 011, 111, 110, 000, 100, 101, 001, respectively  Gray mapping . Clearly, for a  regular 8-PSK constellation, s1 = exp j3π 8  and s2 = exp jπ 8 . By using other val- ues of s1 and s2, we can define 8-PSK constellations with two or three different error  protections; we can also define some 8-APSK constellations  e.g., for s1 = exp jπ 4   and s1 = 2exp jπ 4  . If  we  define  s + 1 − s =  j s Re s { } =    s    and  Im s s =  ,  then  the  constellation  } { I ∆ ∆  3  is  2 , and bn  2+ + s   2 = s s } Re s = {   and ∆ ∆ point associated with the bits of bn  1 , bn  s =   1    s js R I ∆ ∆  Im s { }  and  ∗ s 1  −  =  =  R ∆  ∗ 2  s  s  s  s  s  ,  ,     R  R  2  I  I  s  n  =  s b R  1  n  +  j s b R  2  n  +  s b b R  1   3  ∆ n n  +  js b b I  2   3  ∆ n n  .   5.33      This means that g  1 = ing being equal to zero.  s R  , g  2  =  j s bR  2  n  , g  5 = ∆, and g  s R  6 =  js I ∆, with the remain-  5.3.6  Computation of Receiver Parameters Taking into account the description provided in the previous sections, an IB-DFE  receiver with soft decisions  as described in Section 5.3.2  has to carry the following  constellation-dependent tasks  see Figure 5.7 :   ◾ Demapping the time-domain samples at the output of the FDE,  cid:31 sn, into the  corresponding bits. This can be implemented by computing the log-likeli- hood ratios associated with each bit of each transmitted symbol.   ◾ Computation of the average symbol values conditioned to the FDE output of   the previous iteration  cid:31 sn, denoted by sn,.   ◾ Computation of the blockwise reliability ρ, required for obtaining the feed-  forward coefficients  see Equation 5.8 .  The log-likelihood ratio of the mth bit for the nth transmitted symbol is given   λ  m   n     =        β   log Pr m   n β Pr   m   n ∑ ∑         log  s  s    m ∈ Ψ 0  m   ∈Ψ    1   cid:31    s n  cid:31    s n −     = 1  = 0    exp   −  exp          cid:31  s n   cid:31  s n  =  −  −  s  s  σ  2   2  σ  2   2  2  2                ,      5.34         by      226  ◾  MIMO Processing for 4G and Beyond   1    2  βn  3  βn βn 1 1 1  1  1  1  0  0  0  0  1  0  0  0  0  1  1  0  0  1  1  0  0  1  s7  s6  s5  s4  s3  s2  s1  s0   3   Ψ1   3   Ψ0   2   Ψ1   2   Ψ1   2   Ψ0   1   Ψ1   1   Ψ1   1   Ψ0   1   Ψ0   1   Ψ1  Figure 5.7   IB-DFE with soft decisions.       =   m  are the subsets of S where βn m   where Ψ1  m  and Ψ0       = 1 or 0, respectively  clearly,  m∪ m∩ ∅ .  As  an  example,  Figure  5.4  shows  the  S  and  Ψ Ψ Ψ Ψ m m   =           1 1 0 0 regions associated with Ψ0  m   m = 1,2,3  for a uniform 8-PAM constella-  m  and Ψ1     tion with Gray mapping.  For obtaining the average symbol values conditioned on the FDE output, sn, we   . These   m  need to obtain the average bit values conditioned on the FDE output, bn are related to the corresponding log-likelihood ratio as follows:  By  taking  advantage  of  the  analytical  characterization  of  the  mapping  rules  Equation 5.21  or, equivalently, the specific formulas of Section 5.3.5  and assum- ing uncorrelated bits  e.g., thanks to the adoption of suitable interleaving , we can  write       m bn  =  tanh     λ   m   n 2     .     s n  =  µ  M  1 g  −∑ ∏   i  m  =1  i  =0     m   n  b  γ  m i ,     .      5.35    5.36             MIMO Optimized for Single-Carrier Frequency-Domain  ◾  227  Finally, the reliability of the estimates to be used in the feedback loop is given   by        5.2.2.  where ρn m     is the reliability of the mth bit of the nth transmitted symbol, given by  ρ  =   cid:22 E s s [ ] * n n [  ] E s 2 n  =  ∑  M  − 1  i  =0    µ  ∏   m =1   g 2  − 11  M  i  i  =0  i   g 2 ∑  m     ρ   n  γ     m i ,  ,     m     ρn       mb   = n   .     5.37    5.38   For QPSK constellations, these results reduce to the ones presented in Section   As an example, let us consider a uniform 4-PAM constellation with Gray map- ping  i.e., the symbols are characterized by Equation 5.31 . Figure 5.8 shows the  LLR values of the different bits, λn  , as a function of the output of the FDE,  cid:31 sn, for  m  different SNR values and Figure 5.9 shows the average value of each bit conditioned    in the same condition. The regions where each bit is 0 or  m  on the FDE output, bn 1 are well defined when we have a high SNR, but for low SNRs, these regions are  not so evident.   o : m = 1  * : m = 2  SNR = 5 dB SNR = 10 dB SNR = 15 dB  80  60  40  20     m     n  λ  0  –20  –40  –60  –80  –4  –3  –2  –1  1  2  3  4  0 ~ sn  Figure 5.8  Evolution of the LLR of the different bits, λn m  constellation with Gray mapping.   , for a uniform 4-PAM       228  ◾  MIMO Processing for 4G and Beyond  1.5  1  0.5   m  0 bn  –0.5  –1  –1.5  –4  –3  –2  –1   o : m = 1  * : m = 2 0 ~ sn  1  SNR = 5 dB SNR = 10 dB SNR = 15 dB  2  3  4  Figure 5.9  Evolution of the average value of the different bits conditioned to the  m  FDE output, bn   , for a uniform 4-PAM constellation with Gray mapping.  Figure 5.10 shows the average symbol value conditioned on the FDE output, sn,  for the same settings of Figures 5.8 and 5.9. Once again, the four levels are clear  for high SNR and the transition between levels becomes smoother as we reduce  the SNR. The corresponding symbol reliability ρn is depicted in Figure 5.11. As  expected, the reliability is lower between levels, becoming 0 for  cid:31 sn = 0. For  cid:31 sn ≈ 0  or ±3, the reliability is close to 1, unless the SNR is very small.  5.3.7  Performance Results In this section, some performance results concerning IB-DFE receivers with soft  decisions for generalized constellations are presented. Blocks with N = 256 sym- bols plus an appropriate cyclic prefix are considered. The results assume a severely  time-dispersive  channel  with  perfect  synchronization  and  channel  estimation  at  the receiver.  Let  us  first  consider  a  uniform  64-QAM  constellation  with  Gray  mapping  based on two separate 8-PAM constellations characterized by g7 g3 = g3 g1 = 0.5.  Figure  5.12  shows  the  BER  performance  for  the  IB-DFE  receivers  described  in  the previous sections. When compared with a conventional linear FDE, the per- formance improves significantly with the iterations, with a gain around 7 dB for  BER = 10−4 after four iterations.  Let  us  consider  now  a  nonuniform  64-QAM  constellation  based  on  two  8-PAM constellations characterized by g7 g3 = g3 g1 = 0.4  Gray mapping . These       3  2  1  0  – sn  –1  –2  –3–4  ρn  1  0.9  0.8 0.7  0.6  0.5 0.4  0.3  0.2 0.1  0 –4  MIMO Optimized for Single-Carrier Frequency-Domain  ◾  229  SNR = 5 dB SNR = 10 dB  SNR = 15 dB  –3  –2  –1  1  2  3  4  0 ~ sn  Figure 5.10  Evolution of sn for a uniform 4-PAM constellation with Gray mapping.  SNR = 5 dB SNR = 10 dB SNR = 15 dB  –3  –2  –1  1  2  3  4  0 ~ sn  Figure  5.11  Evolution  of  ρn  for  a  uniform  4-PAM  constellation  with  Gray  mapping.      230  ◾  MIMO Processing for 4G and Beyond  Linear FDE  Iter. 2 Iter. 4 Iter. 5  100  10–1  R E B  10–2  10–3  10–4  15  20  25  Es N0  dB   30  35  Figure 5.12  BER for a uniform 64-QAM with Gray mapping.  constellations allow bits with three different error protection levels, denoted LPB   least protected bits , IPB  intermediate protected bits , and MPB  most protected  bits .  Figure 5.13 shows the uncoded BER performance for the different type of bits  when we have a conventional IB-DFE receiver. These results are expressed as a  function of Es N0, with Es denoting the average symbol energy and N0 the noise  power spectral density. Clearly, performance improves significantly with the num- ber of iterations, outperforming significantly the linear FDE. This improvement  is higher for LPB  more than 10 dB for BER = 10−4 , since they are more sensitive  to the residual ISI that is inherent to a linear FDE optimized under the MMSE  criterion.  Let us now consider the impact of channel coding on a conventional IB-DFE as  well as on a turbo FDE  i.e., an IB-DFE where the channel decoder is involved in  the feedback loop . We consider a rate-1 2 turbo code [Berrou et al. 1993] based on  two identical recursive convolutional codes with two constituent codes character- ized by G D  = [1 1 + D2 + D3   1 + D + D3 ] and interleaving depth correspond- ing to a single FFT block. We also assume three iterations of the turbo decoder  for each iteration of the IB-FDE. Figure 5.14 shows the BER performance for the  different types of bits. As expected, the turbo FDE outperforms the conventional  IB-DFE  where the channel decoder is not involved in the feedback loop , with  gains around 3 dB for BER = 10−4.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  231  15  20  30  35  40  25  Es N0  dB   Figure 5.13  BER for the different bits of a nonuniform 64-QAM modulation with  Gray mapping.  Linear FDE  Iter. 2 Iter. 4  Conv. IB-DFE  Turbo FDE  MPB IPB LPB  MPB IPB LPB  100  10–1  R E B  10–2  10–3  10–4 10  100  10–1  R E B  10–2  10–3  10–4  0  5  10  15 20 Es N0  dB   25  30  35  Figure 5.14  Coded BER performance for the bits with different error protections.      232  ◾  MIMO Processing for 4G and Beyond  5.4   Iterative Frequency-Domain Detection   for MIMO-SC 5.4.1  System Model Let us now consider a MU-MIMO  multiuser MIMO  scenario where we have  P  MTs  employing  SC-FDE  schemes  and  transmitting  simultaneously  to  a  BS  equipped with R receive antennas, as depicted in Figure 5.15. For the sake of sim- plicity, we assume that each MT has a single transmit antenna, although we could  easily extend it to the case where we have multiple antennas at one or several MTs.  The time-domain block transmitted by the pth user is {sn,p; n = 0,1, . . .,N–1}, with  sn,p denoting the nth data symbol of the pth user, which is selected from a given  constellation  e.g., a QPSK  quadrature phase shift keying  constellation , under  an appropriate mapping rule. A cyclic prefix, preceding each block, is used to avoid  interblock interference and to make the linear convolution associated with the chan- nel equivalent to a cyclic convolution with respect to the useful, length-N, part of  the block. At the receiver, the cyclic prefix is discarded.  The time-domain block at the rth receive antenna is {  1} . The corresponding frequency-domain block, obtained after an appropriate size- … − , where N DFT operation  discrete Fourier transform , is {  = 0,1,  = 0,1,  r    Y k  … −     y r n  1}  N  N  n  k  ,  ;  ;  ,     Y  r     k  =  S H k p ,  r     k p ,  +  N  r     k  ,  P  ∑  p  =1      5.39        denoting the overall channel frequency response from the pth transmit- r with Hk p , r    denot- ting antenna to the rth receiver antenna, for the kth frequency, and  N k ing the corresponding channel noise. The block {Sk,p;k = 0,1,. . .,M–1} is the size-N  DFT of the pth user’s data block {sn,p;n = 0,1,. . .,N–1}.  sm,1  }   1  ym  {  1  Yk  }  DFT  Tx 1  {  {  {  {  }  }  sm,P  }   N  ym  {  N  Yk  }  DFT  Tx P  Iterative multiuser detection  {   sm,1  }  {   sm,P  }  Figure 5.15  System model.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  233  We consider a frequency-domain iterative multiuser detection that combines  IB-DFE principles with interference cancelation. Each iteration consists of P detec- tion stages, one for each user. When detecting a given user, the interference from  previously  detected  users  is  canceled,  as  with  conventional  layered  space–time   LST  receivers. However, in contrast to conventional LST receivers, we also cancel  the residual ISI from the user that is being detected. Moreover, these interference  and residual ISI cancelations take into account the reliability of each of the previ- ously detected users. For a given iteration, the receiver structure for the detection of  the pth user is illustrated in Figure 5.16. We have R frequency-domain feedforward  filters  one for each receive antenna  and P frequency-domain feedback filters  one  for each user . The feedforward filters are designed to minimize both the ISI and  the multiuser interference that cannot be canceled by the feedback filters, due to  decision errors in the previous detection steps. This structure can be regarded as an  equalizer with multiuser interference suppression properties. After an IDFT opera- tion, the corresponding time-domain outputs are passed through a hard-decision  device so as to provide an estimate of the data block transmitted by the pth user.  We can employ two different iterative approaches for detecting the different users:   ◾ A parallel interference cancelation  PIC  approach where we detect all users  simultaneously at a given iteration, while removing interuser interference as  well as residual ISI using data estimates from the previous iteration.   ◾ A  successive  interference  cancelation   SIC   approach  where  we  cancel  the  interference  from  all  users   using  the  most  updated  version  of  each  user ,   {  1  Yk  }  {  N  Yk  }  X  X  {  } 1  Fk ,p  {  } N  Fk ,p  ~ Sk ,p  {  }  ~ sm,p  {  }  IDFT  Hard dec.  {   sm,p  }  Σ  +  Σ –  {  } 1  Bk ,p X  {   Sk,1  }  {   sm,1  }  DFT  {   Sk,P  }  X  DFT  {   sm,p  }  Σ  {  } P  Bk ,p  Figure 5.16  Detection of the pth user, for a given iteration.      234  ◾  MIMO Processing for 4G and Beyond  as well as the residual ISI from the user that is being detected. In this case, the  users should be detected according to their average received power, although  our receiver is robust enough to cope with a wrong detection order  eventu- ally requiring an additional iteration for convergence .  5.4.2  Computation of Receiver Coefficients The frequency-domain samples associated with the pth user at the output of the  equalizer multiuser detector are given by   cid:30 S k p ,  =  r     F Y k p ,  r     k  −  R  ∑  r  =1  P  ∑   cid:31  ′ p     B S k p , k p , =1  p  ′  ′  =  R  ∑  r  =1  r     F Y k p ,  r     kk  −   cid:31  p     B S k p , k p ,  −  ∑  p  ′  ≠   cid:31  ′     p B S , k p , k p p  ,  ′      5.40      p  ≠  p′  = 1,2, = 1,2, 1} 1}  is the DFT of the block   cid:31 { ,s n p′ , = 0,1, n  − r     … … where F   R   , 1 N r ; , k = 0,1,  denotes the feedforward coefficients  k p , ′   p   − …  denotes the feedback coefficients. The  … and B k p N P   1 = 0,1, ;   , , k p ,  B   p … −  are used for residual ISI cancelation and the  coefficients { ; = 0,1, , N k , k p p′    B … coefficients { ; = 0,1, ,    are used for interference cancelation.  k N , k p The block   cid:31 { −… 1} M ; = 0,1, ,S , k ,  k p′ where the time-domain samples  cid:31 s 1  are the latest estimates for the  p′th user transmitted symbols, that is, the hard decisions associated with the block of  − time-domain samples { .  N 1} 1} For the ith iteration of an SIC receiver,  cid:22 sn p, ′ is associated with the ith iteration for  p′ < p and with the  i – 1 th iteration for p′ ≥ p  in the first iteration, we do not have  any information for p′ ≥ p and  cid:22 sn p, ′ is always associ- ated with the previous iteration  for the first iteration,  cid:22 sn p,   ; for the PIC receiver,  cid:22 sn p,  .  − 1} ′ n p,  k ; = 0,1,  n ; = 0,1,  ; = 0,1, n  −…  −…  IDFT   cid:31  S , k p  Owing to decision errors, we have  cid:22 s ≠  . However, the frequency-domain estimates,   cid:22 Sk p, , can be written as   for some symbols. Consequently,   ,≠ s n p   cid:22 S k p ,  = 0  = 0   cid:31  s , n p  …  …  N  N  N  =  −  n p ,  k p ,  S  {  ,  ,  ,  ,  ′  ′  ′  ′   cid:22 S k p ,  = ρ  S p k p ,  + ∆ ,    k p ,   5.41   where ρp denotes the correlation coefficient for the pth user, which can be obtained  as described in the previous section, and Δk,p denotes a zero-mean error term. For  ≈ ,  the computation of the receiver coefficients, it is assumed that  E 0 regardless of k and k′. Therefore,  Sk p k p ′ , ,  ∆  [  ]  E  [  ∆  k p ,   ] =  1 2  − ρ 2 p    NE  S p ,  .      5.42            By combining Equations 5.39, 5.40, and 5.41, we obtain      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  235   cid:31 S k p ,  P  R  r     k p ,  =∑ ∑ H S ′ r =1 =1   −  r     F k p , ∑     ′ p ′ p   B k p , p  ρ p  S  ≠  p     ′  ′  +  ∆  k p ,  ′  k p ,  ′     +  N  r     k  k p ,  ′  p     B k p ,  ρpp k p ,  S  +  ∆  k p ,       −      R  ∑     r F ,, p k  r  =1  =  γ  +  +  S p k p ,    ∑ ∑  R     p  ′  ≠  p  r  =1  H      r , k p  −  γ  p  −  ρ p      p B , k p  S  , k p    ∑ ′   p B , k p =1  P  p  ′         r F H , k p      r , k p  ′′  −  ρ p  ′     ′   p B , k p  S  , k p  ′  −     ∆  , k p  ′  +      rN k   5.43   R  ∑    n   F , k p  r  =1        with  γ p  = 1 N  1  R  N  −∑∑      r F H , k p      r , k p   5.44   r  r  k  R     =1  =0  γ  −   ◾  r     k p ,    denoting the average overall channel frequency response for the pth user, after com- bining the outputs of the R feedforward filters.  This  means  that   cid:31 Sk p,   has  a  “signal”  component,  γp  Sk,p,  and  four  “noise”  components:   ∑ r     F H k p , =1   ∑ ∑ R ∑ p ∑ The forward and backward coefficients, { p′    B , k p  … − , r = 1,2,. . .,R,  , p′ = 1,2, . . .,P, respectively, are chosen so as to maxi- and { mize the “signal-to-noise plus interference ratio”  SNIR  for the pth user, defined as  r     F H k p , r =1 ,∆  accounts for the errors in s k p   is the residual multiuser interference.   comes from the channel noise.  p ′ p   B k p , =1 r     F N k p , =1   is the residual ISI.  k ; = 0,1,  ; = 0,1, k  −…  = 1 2 …   cid:31 n, p P′    p     B k p ,  ′ p   B k p ,  r    F , k p  r     k p ,  r     k  ρ p  ρ p        1}  1}   ◾   ◾   ◾  N  N  −  −  k p ,  k p ,  S  S   .  p P  P  ′≠  ,  ,  R  ′  ,  ,  ,  p  r        ′  ′  ′  ′  ′  eq n p ,  =  cid:31  s  n p ,  −  γ  s p n p ,   denoting the overall noise. The SNIR can also be written   SNIR  p  =  γ   2 p ε [ E  E S  ] 2  ,  eq n p ,     SNIR  p  = 1 N  N  −∑  k  =0  1 SNIR  F , k p  ,      5.45    5.46     with ε as         236  ◾  MIMO Processing for 4G and Beyond  where  SNIRk p ,   denotes  the  SNIR  associated  with  the  corresponding  frequency- F domain samples, defined as  SNIR  F k p ,  =  γ   2 p ε [ E  ME S Eq  ] 2 k p ,  ,      5.47   2   5.48      ; = 0,1,  Eq k ,εk p ; = 0,1,   denoting  the  DFT  of  the  block  with  the  block  { eq n N… − ,εn p { 1} .  Clearly,  the  maximization  of  the  SNIR  in  the  time- domain samples   cid:31 sn p,  is equivalent to the maximization of the SNIR in the corre- sponding frequency-domain samples, SNIRk p , . F  N… −  1}  ,  ,  It is simple to verify that      r F H , k p      r , k p  −  γ  p  −  ρ p  p     B k p ,  NE  S  +  r     F H k p ,  r     k p ,  ′  −  ρ p  ′     ′ p   B k p ,  NE  S  E     ε  Eq k p ,  2     =  R  r  =1  ∑ ∑  +  P  p  ′  =1    2  ′ p   B k p ,   1  −  ρ22 ′ p    NE  S      2 r F , k p  2  N  σ  2 N  ,  ∑  p  ≠′  R  ∑  p r  ==1  2  R  + ∑    =1  r     [      2 r  ] k  = 1 2      N E N    denoting  the  variance  of  both  the  in-phase  and   with  σ N 2 quadrature components of the channel noise at the input of each receive antenna. The optimum feedforward and feedback coefficients are obtained by maximiz-  when γp = 1. This can be   Eq ing SNIRk p , , which is equivalent to minimizing E k p F , accomplished by solving the following set of R + P equations for each frequency:  ε [   ] 2  ∂  E  2     ε  Eq , k p    ∂     r F , k p  = 2  NE H  S  ′ −−     r , k p  γ  p  −  ρ p  p     B k p ,  ′     r  R  =1     * r , k p    ∑ ≠ ′ F  H p p e     2 N k p ,  ∑ ′   r F H , k p   = 0,     * r ′ , k p  R     ′   r F H , k p  ∑ ′ =1 = 1,2, r  r  +  2  NE  S  +  4  N  σ  ′      r ′ , k p  −  ρ p  ′     ′ p   B k p ,  …  ,  R  ,   5.49      p     2     ∂  E  Eq k p ,   ε  ∂ B k p ,  − = 2  NE  ρ p  S     ′ r   F H k p ,  ′ r     k p ,  −  γ  p  −  ρ pp  p     B k p ,  +  2  NE  S  p       B k p ,  = 0   5.50   R   ∑  ′ r =1 − ρ  1 2 p                                 R   ∑  ′ =1 r n     F k p , RR SN  p  and  and           MIMO Optimized for Single-Carrier Frequency-Domain  ◾  237  ∂  E  2     Eq k p ,   ε  ′ p   ∂ B k p ,  ′     − = 2  NE  ρ p  ′  S     ′ n   F H k p ,  ′   r   ′ k p ,  −  ρρ p  ′     ′ p   B k p ,  +  2  NE  S   1     ′ p     B k p ,  = 0,  p  ′  ≠  p   5.51   R   ∑  ′ r =1 − ρ 2 ′ p    .     These equations can be rewritten in the form  H     * r , k p     ′   n F H , k p  ′     r , k p  −  γ  p  −  ρ p  p     B k p ,     ′   n F H , k p  ′     r ′ , k p  −  ρ p  ′     ′ p   B k p ,    +  ∑  p  ′  ≠  H p     * r ′ k , pp     R  ∑  ′  =1  r  +  = 0,  r  = 1,2,  ,…  R   5.52   ρ p  ′     R  ∑  ′  =1  r     ′   r F H , k p  ′     r ′ , k p  −  γ δ p  , p p  ′  −  ρ p  ′  ′   p B , k p  −  ρ 2 ′′ p     ′   p   B , k p  ,  p  ′  ≠  p  ,   5.53      =  1   where SNR  p  =     E  2,   S p   σ .  2 N    p From Equation 5.9, the optimum values of Bk p ,   ′  are  p   B k p ,  =′    ρ p  ′  ′ r i   ,   F H k p ,  ′ r     k p ,  −  δ  γ  p  p p ,  ′   5.54      R  ∑  ′  =1  r    ,     with δ p p,  ′ =  for p = p′ and 0 otherwise.  1  This leads to the set of R equations   1  −  ρ 2 p    H  r    * k p ,     ′   r F H , k p  ′     r , k p  ρ 2 ′ p    H      * r ′ , k p     ′ r   F H k p ,  ′ r     ′ k p ,  +  R  ∑ ′ r =1 ρ H   2 p  −  +  ∑  1 ≠ ′ p ,… R, == 1,2,  p  =  κ   1  p  −  r    * k p ,  ,  r        R  ∑  ′  =1  r  r     F k p , SNR  p   5.55      where κp is selected to ensure that we have a normalized FDE output with γp = 1.  These feedforward coefficients can be used for obtaining the feedback coefficients    p Bk p ,   ′ , p′ ≠ p, respectively.   ′  and Bk p   p ,               238  ◾  MIMO Processing for 4G and Beyond  It can be shown that the solution of this system of equations can be written in   the form  r     F k p ,  =  P  ∑  p  ′     * r ′ k p ,  H C =1     ′   p k p ,  ,      5.56            with the set of coefficients {  p′  C    k  ;  p  ′  = 1,2,  …  satisfying the set of P equations  P  }  ,  P  ∑ C =1  ′′  p     ′′   p , k p   1     R  ∑− ρ 2 ′ p     r  ′  =1  1 SNR  p     H H  ′ r    * ′′ k p ,  ′ r     ′ k p ,  +  δ ′′ p  ,  p  ′′  =  δ  ,  , p p  ′  p  ′  = 1,2,  … . P  ,   5.57      The computation of the feedforward coefficients from Equation 5.57 is simpler   than the direct computation from Equation 5.56, especially when P < R.  For the special case where P = 1  and p = 1 , it can be shown that      r F ,1 k  =  1  +  SNR 1  1  ⋅ SNR H ′∑ρ  1   2 1     * r ,1 k N  −  r  =1    H    k  ′ r ,1    2   ,  r  = 1,2,  ……,  ,R   5.58      which corresponds to the feedforward coefficients of an IB-DFE with R-branch  space diversity [Dinis et al. 2003]. For the first iteration      r F ,1 k  =  1  ⋅ SNR H ′∑ R  =1  r  SNR 1     * r ,1 k  H  1  +    k  ′ r ,1    2   ,  r  = 1,2,  …  ,  R  ,   5.59      corresponding to a linear FDE with R-branch space diversity [Gusmão et al. 2003]. It should be noted that, for the first iteration  i = 0 , we do not have any infor- mation about Sk,p′ for p′ ≤ p, for the SIC receiver, or all Sk,p′, for the PIC receiver.  ′   p   = 0 Therefore, the corresponding correlation coefficients are zero, leading to Bk p .  , After the first iteration, and if the residual BER  bit error rate  is not too high,   cid:22 s ; this means that we can  n p , use the feedback coefficients to eliminate a significant part of the residual ISI, as  well as the residual multiuser interference.  ′  for most of the data symbols, and   cid:22 S  s ,=′ n p  ≈  n p ,  k p ,  S  ′  ′  5.4.3  Soft Decisions The previous IB-DFE receiver considered hard decisions in the feedback loop  or  symbolwise soft decisions . The receiver can be easily modified for soft decisions       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  239  by following the approach described in the previous section. Essentially, the FDE  output is given by   cid:31 S k p ,  R  = ∑  r  =1  r     F Y k p ,  r     k  P  ∑−  p  ′  ′ p     B S k p , =1  ′,  k p ,      5.60   where the average transmitted frequency-domain block conditioned to the FDE  output S k p, ′ can be computed as described in the previous section. It can be easily  shown that the optimum feedback coefficients are still given by Equation 5.52 and  the feedback values are given by     ′ p   B k p ,  =  ′ r i   ,   F H k p ,  ′ r     k p ,  − δ  .  p p ,  ′   5.61   R  ∑  ′  =1  r           5.4.4  Complexity Issues Both SIC and PIC receivers require R size-N DFT operations, one for each receiver  antenna, and a pair of DFT IDFT operations  with size N  for the detection of  each user at each iteration. For the equalization interference cancelation, we need  NRP multiplications for the first iteration of a PIC receiver and NRP + P P–1 N 2  multiplications for the first iteration of an SIC receiver. For the remaining itera- tions, we need  R + P PN multiplications for both SIC and PIC receivers.  The most complex part of the algorithm is the computation of the feedforward  coefficients, since we need to solve R systems of P equations, for each iteration and  each user. Naturally, for slow-varying channels, this operation is not required for  all blocks.  5.4.5  Performance Results In this section, we consider the use of the proposed receiver in an SDMA system  where each user has one transmit antenna and the base station has R receive anten- nas. The data block consists of N = 256 QPSK data symbols, plus an appropriate  cyclic prefix. We consider an uncoded scenario, with square-root raised-cosine fil- tering with zero roll-off and a severely time-dispersive channel with rich multipath  propagation. We have perfect synchronization and channel estimation conditions. Figure 5.17 shows the BER performances for different users and different itera- tions, when we have P = 4 users with the same average receive power and N = 4  receive antennas at the BS. An SIC receiver is assumed. For the sake of compari- sons, we also include the MFB performance.  From this figure, we can observe that, for the first iteration, the users have very  different performances: more than 6 dB from user 1 to user 4, at BER = 10−4. This       240  ◾  MIMO Processing for 4G and Beyond  Iter. 1 Iter. 2 Iter. 3 Iter. 4  User 1 User 2 User 3 User 4  10–1  10–2  R E B  10–3  MFB  10–4  –2  0  2  4 6 Eb N0  dB   8  10  12  Figure 5.17  BER for the different users and the different iterations, as well as the  corresponding MFB, for R = P = 4.  difference decreases as we increase the number of iterations, with all users having  almost the same performance after three iterations. Moreover, the resulting perfor- mance is very close to the MFB after four iterations. This shows that the proposed  receiver is able to eliminate a significant part of the ISI and multiuser interference. Figure 5.18 shows the average BER performances  averaged over all the users   for SIC and PIC receivers for the different iterations. After the first iteration, the  performance of the PIC receiver is almost 2 dB worse than the performance of the  SIC receiver. After iteration 3, this gap reduces to less than 1 dB and after iteration  4 to 0.2 dB. Once again, the BER performances after four iterations are very close  to the corresponding MFB for both structures. It should be mentioned that, for the  PIC receiver, all users have the same average BER.  Figure 5.19 shows the average BER performance after four iterations, for differ- ent values of R and P. Once again, the BER performances after four iterations are  close to the corresponding MFBs, regardless of R and P.  Let  us  consider  now  a  scenario  where  the  received  powers  are  not  the  same  for  all  users   e.g.,  due  to  a  wrong  power  control  and or  different  uncoded  BER  requirements for the different users . We consider P = 4 users and an SIC receiver  with R = 4 receive antennas. The average received power for users 1 and 2 is 6 dB  larger than the received powers for users 3 and 4. For a given iteration, the receiver  detects first the high-power and then the low-power users. Figure 5.20 shows the  BER performances for the different users. Once again, the iterative detection pro- cedure  allows  significant  performance  gains  and  after  four  iterations,  the  BER       MIMO Optimized for Single-Carrier Frequency-Domain  ◾  241  PIC SIC  Iter. 1 Iter. 2 Iter. 3 Iter. 4  10–1  10–2  10–3  R E B  MFB  R E B  10–2  100  10–1  10–3  10–4 –2  10–4 –2  0  2  4 6 Eb N0  dB   8  10  12  Figure 5.18  Average BER of an SIC receiver or a PIC receiver, as well as the cor- responding MFB, for R = P = 4.  P = 1 P = 2 P = 4 MFB  N = 1  N = 4  N = 2  0  2  6  8  10  4  Eb N0  dB   Figure 5.19  Average BER performance for different values of N and P, after four  iterations.      242  ◾  MIMO Processing for 4G and Beyond  High-power users  Low-power users  100  10–1  R E B  10–2  lter. 1 lter. 2 lter. 3 lter. 4  User 1 User 2 User 3 User 4  10–3  MFB  6 dB  10–4 –8  –6  –4  0 –2 Eb N0  dB   2  4  6  Figure 5.20  BER performance for low-power and high-power users, as a func- tion of the Eb N0 of the low-power users.  lter. 1  100  10–1  R E B  10–2  10–3  10–4 –2  lter. 10  MFB  0  2  4 6 Eb N0  dB   8  10  12  Figure 5.21  Average BER performance for R = 4 and P = 6.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  243  performances are similar for users with the same average power. Clearly, the perfor- mance of low-power users asymptotically approaches the MFB when we increase  the number of iterations. However, for the high-power users, we are still 2 dB from  the  MFB  at  BER = 10−4.  This  somewhat  unexpected  behavior  can  be  explained  from the fact that the BER is much lower for the high-power users, allowing an  almost perfect interference cancelation of its effects on low-power users and per- formances close to the MFB. The lower BERs for the low-power users preclude an  appropriate interference cancelation on the high-power users.  Figure 5.21 refers to the situation where R = 4 and P = 6, that is, an overloaded  scenario where the number of users is larger than the number of receive antennas  at the BS. In this case, a perfect multiuser separation is not possible since we have  R = 4 degrees of freedom to separate P = 6 users. However, the iterative receiver  structure presented here has an acceptable performance, with significant interfer- ence cancelation, although, even after 10 iterations, the achievable performance is  still about 4 dB from the MFB.  Acknowledgment This work was supported by the FCT  Fundação para a Ciência e Tecnologia  via  project PEst-OE EEI LA0008 2013.  References Abe, T. and T. Matsumoto, Space–time turbo equalization in frequency-selective MIMO   channels, IEEE Trans. Veh. Tech., 52 3 , 469–475, 2003.  Al-Dhahir, N. and A. H. Sayed, The finite-length multi-input multi-output MMSE-DFE,   IEEE Trans. Signal Process., 48, 2921–2936, 2000.  Amaral, F., R. Dinis, P. Montezuma, and N. Souto, Approaching the MFB with block trans-  mission techniques, Eur. Trans. Telecommun., 23 1 , 76–86, 2012.  Araújo, T. and R. Dinis, Iterative equalization and carrier synchronization for single car- rier  transmission  over  severe  time-dispersive  channels,  in  Proceedings  of  IEEE  GLOBECOM’04, Dallas, USA, November–December 2004.  Ariyavisitakul,  S.  Turbo  space–time  processing  to  improve  wireless  channel  capacity,  in   Proceedings of IEEE ICC’02, 3, 1238–1242, 2000.  Benvenuto, N., R. Dinis, D. Falconer, and S. Tomasin, Single carrier modulation with non  linear  frequency  domain  equalization:  An  idea  whose  time  has  come—again,  Proc.  IEEE, 98 1 , 69–96, 2010.  Benvenuto, N. and S. Tomasin, On the comparison between OFDM and single carrier with  DFE using a frequency domain feedforward filter, IEEE Trans. Commun., 50 6 , 947– 955, 2002.  Benvenuto,  N.  and  S. Tomasin,  Block  iterative  DFE  for  single  carrier  modulation,  IEE   Electron. Lett., 38 19 , 1144–1145, 2002.  Benvenuto, N. and S. Tomasin, Iterative design and detection of a DFE in the frequency   domain, IEEE Trans. Commun., 53 11 , 1867–1875, 2005.      244  ◾  MIMO Processing for 4G and Beyond  Berrou, C., A. Glavieux, and P. Thitimajshima, Near Shannon limit error correcting cod- ing and decoding: Turbo-codes, in Proceedings of IEEE ICC’93, Geneva, Switzerland,  Vol. 2, pp. 1064–1070, May 1993.  Bingham, J. Multicarrier modulation for data transmission: An idea whose time has come,   IEEE Commun. Mag., 28 5 , 5–14, 1990.  Cimini Jr., L. Analysis and simulation of a digital mobile channel using orthogonal frequency   division multiplexing, IEEE Trans. Commun., 33 7 , 665–675, 1985.  Cover, T. Broadcast channels, IEEE Trans. Inform. Theory, IT-18, 2–14, 1972. Dinis, R., T. Araújo, P. Pedrosa, and F. Nunes, Joint turbo equalization and carrier synchroni-  zation for SC-FDE schemes, Eur. Trans. Telecommun., 21 2 , 131–141, 2010a.  Dinis, R., P. Carvalho, L. Bernardo, R. Oliveira, M. Pereira, and P. Pinto, Frequency-domain  multipacket detection: A high throughput technique for SC-FDE systems, IEEE Trans.  Wireless Commun., 8 7 , 3798–3807, 2009.  Dinis, R., D. Falconer, C. Lam, and M. Sabbaghian, A multiple access scheme for the uplink  of broadband wireless systems, in Proceedings of IEEE GLOBECOM’04, Dallas, USA,  December 2004a.  Dinis, R. and A. Gusmão, A class of nonlinear signal processing schemes for bandwidth- efficient OFDM transmission with low envelope fluctuation, IEEE Trans. Commun.,  52 11 , 2009–2018, 2004.  Dinis,  R.,  A.  Gusmão,  and  N.  Esteves,  On  broadband  block  transmission  over  strongly  frequency-selective fading channels, in Proceedings of Wireless 2003, Calgary, Canada,  261–269, July 2003.  Dinis, R., A. Gusmão, and N. Esteves, Iterative block-DFE techniques for single-carrier- based broadband communications with transmit receive space diversity, in Proceedings  of IEEE ISWCS’04, Port Louis, Mauritius, September 2004b.  Dinis, R., C. Lam, and D. Falconer, Joint frequency-domain equalization and channel esti- mation using superimposed pilots, in Proceedings of IEEE WCNC’08, Las Vegas, USA,  March 2008.  Dinis, R., R. Kalbasi, D. Falconer, and A. Banihashemi, Iterative layered space–time receiv- ers for single-carrier transmission over severe time-dispersive channels, IEEE Commun.  Lett., 8 9 , 579–581, 2004.  Dinis, R. and P. Silva, Iterative detection of multicode DS-CDMA signals with strong non-  linear distortion effects, IEEE Trans. Veh. Technol., 58 8 , 4169–4181, 2009.  Dinis, R., P. Silva, and T. Araújo, Turbo equalization with cancelation of nonlinear distortion  for CP-assisted and zero-padded MC-CDM schemes, IEEE Trans. Commun., 57 8 ,  2185–2189, 2009.  Dinis,  R.,  P.  Silva,  and  Gusmão,  IB-DFE  receivers  with  space  diversity  for  CP-assisted  DS-CDMA  and  MC-CDMA  systems,  Eur.  Trans.  Telecommun.,  18 7 ,  791–802,  2007a.  Dinis, R., J. Silva, N. Souto, and P. Montezuma, On the design of frequency-domain equal- izers for OQPSK modulations, in Proceedings of 33rd IEEE Sarnoff Symposium’2010,  Princeton, USA, April 2010b.  Dinis,  R.,  J.  Silva,  N.  Souto,  and  P.  Montezuma,  On  the  design  of  turbo  equalizers  for  SC-FDE schemes with different error protections, in Proceedings of IEEE VTC’2010   Fall , Ottawa, Canada, September 2010c.  Falconer,  D.,  S.  Ariyavisitakul,  A.  Benyamin-Seeyar,  and  B.  Eidson,  Frequency  domain  equalization  for  single-carrier  broadband  wireless  systems,  IEEE  Commun.  Mag.,  40 4 , 58–66, 2002.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  245  Foschini, G. Layered-space–time architecture for wireless communication in a fading envi- ronment  when  using  multi-element  antennas,  Bell  Labs  Tech.  J.,  41–59,  Autumn  1996.  Foschini, G. J. and M. J. Gans, On limits of wireless communications in fading enviroments   when using multiple antennas, Wireless Pers. Commun., 6, 315–335, 1998.  Ganhão, F., M. Pereira, L. Bernardo, R. Dinis, R. Oliveira, and P. Pinto, Performance of hybrid  ARQ for NDMA access schemes with uniform average power control, J. Commun.,  6 9 , 691–699, 2011.  Ganhão, F., R. Dinis, L. Bernardo, and R. Oliveira, Analytical BER and PER performance  of frequency-domain diversity combining, multipacket detection and hybrid schemes,  IEEE Trans. Commun., 60 8 , 2353–2362, 2012.  Ganhão, F., M. Pereira, L. Bernardo, R. Dinis, R. Oliveira, and P. Pinto, Performance analy- sis of an hybrid ARQ adaptation of NDMA schemes, IEEE Trans. Commun., 61 8 ,  3304–3317, 2013.  Gitlin, R., J. Salz, and J. Winters, The impact of antenna diversity on the capacity of wireless   communication systems, IEEE Trans. Commun., 42 2 3 4 , 1740–1751, 1994.  Gusmão, A., R. Dinis, J. Conceição, and N. Esteves, Comparison of two modulation choices  for broadband wireless communications, in Proceedings of IEEE VTC’00  Spring , 2,  1300–1305, 2000.  Gusmão,  A.,  R.  Dinis,  and  N.  Esteves,  On  frequency-domain  equalization  and  diversity  combining  for  broadband  wireless  communications,  IEEE Trans.  Commun.,  51 7 ,  1029–1033, 2003.  Gusmão, A., P. Torres, R. Dinis, and N. Esteves, A class of iterative FDE techniques for  reduced-CP SC-based block transmission, in Proceedings of the International Symposium  on Turbo Codes, Munich, Germany, April 2006.  Gusmão, A., P. Torres, R. Dinis, and N. Esteves, A turbo FDE technique for reduced-CP   SC-based block transmission systems, IEEE Trans. Commun., 55 1 , 16–20, 2007a.  Gusmão, A., P. Torres, R. Dinis, and N. Esteves, A reduced-CP approach to SC FDE block  transmission for broadband wireless communications, IEEE Trans. Commun., 55 4 ,  801–809, 2007b.  Jiang,  H.  and  P.  Wilford,  A  hierarchical  modulation  for  upgrading  digital,  IEEE  Trans.   Broadcast., 51 2 , 223–229, 2005.  Jones, A. and T. Wilkinson, Combined coding for error control and increased robustness to   system nonlinearities in OFDM, in Proceedings of IEEE VTC’96, 2, 904–908, 1996.  Kalbasi,  R.,  R.  Dinis,  D.  Falconer,  and  A.  Banihashemi,  Hybrid  time-frequency  lay- ered space–time receivers for severe time-dispersive channels, in Proceedings of IEEE  SPAWC’04, Lisbon, Portugal, July 2004.  Lam, C., D. Falconer, F. Danilo-Lemoine, and R. Dinis, Channel estimation for SC-FDE  systems using frequency domain multiplexed pilots, in Proceedings of IEEE VTC’06   Fall , Montreal, Canada, September 2006.  Lozano,  A.  and  C.  Papadias,  Layered  space–time  receiver  for  frequency-selective  wireless   channels, IEEE Trans. Commun., 50 1 , 65–73, 2002.  Luzio, J., R. Dinis, and P. Montezuma, SC-FDE for offset modulations: An efficient trans- mission  technique  for  broadband  wireless  systems,  IEEE  Trans.  Commun.,  60 7 ,  1851–1861, 2012.  Luzio, M., R. Dinis, and P. Montezuma, Pragmatic frequency domain equalization for single  carrier  with  offset  modulations,  IEEE Trans. Wireless  Commun.,  12 9 ,  4496–4505,  2013.      246  ◾  MIMO Processing for 4G and Beyond  Montezuma, P. and A. Gusmão, A pragmatic coded modulation choice for future broadband  wireless  communications,  in  Proceedings  of  IEEE  VTC’01   Spring ,  2,  1324–1328,  2001a.  Montezuma, P. and A. Gusmão, On analytically described trellis-coded modulation schemes,   in Proceedings of ISCTA’01, Ambleside, UK, July 2001b.  Müller, S., R. Bäuml, R. Fischer, and J. Huber, OFDM with reduced peak-to-average power   ratio by multiple signal representation, Ann. Telecommun., 52, 58–67, 1997.  Pedrosa,  P.,  R.  Dinis,  and  F.  Nunes,  Iterative  frequency  domain  equalization  and  carrier  synchronization  for  multi-resolution  constellations,  IEEE  Trans.  Broadcast.,  56 4 ,  551–557, 2010.  Pedrosa, P., R. Dinis, and F. Nunes, Analytical performance evaluation of a class of receiv- ers with joint equalization and residual CFO estimation, Trans. Emerg. Telecommun.  Technol., 23 8 , 749–763, December 2012a.  Pedrosa,  P.,  R.  Dinis,  F.  Nunes,  and  J.  Bioucas-Dias,  Phase  drift  estimation  and  symbol  detection in digital communications: A stochastic recursive filtering approach, IEEE  Commun. Lett., 16 6 , 854–857, 2012b.  Pereira, M., L. Bernardo, R. Dinis, R. Oliveira, P. Montezuma, and P. Pinto, Performance  of diversity combining ARQ error control in a TDMA SC-FDE system, IEEE Trans.  Commun., 60 3 , 735–746, 2012.  Pereira, M., L. Bernardo, R. Dinis, R. Oliveira, and P. Pinto, Frequency-domain cross-layer  diversity techniques: An efficient way of coping with lost packets in broadband wireless  systems, IEEE Wireless Commun. Mag., 20 5 , 100–108, 2013a.  Pereira,  M.,  L.  Bernardo,  R.  Dinis,  R.  Oliveira,  and  P.  Pinto,  On  the  use  of  frequency- domain  cross-layer  diversity  techniques  to  cope  with  lost  packets,  Phys.  Commun.,  Elsevier Physical Communication, 8, 56–68, 2013b.  Proakis, J. Digital Communications, McGraw-Hill, New York, USA, 1995. Raleigh, G. and J. Cioffi, Spatio-temporal coding for wireless communication, IEEE Trans.   Commun., 46 3 , 357–366, 1998.  Raleigh, G. and V. Jones, Multivariate modulation and coding for wireless communication,   IEEE J. Select. Areas Commun., 17 5 , 851–866, 1999.  Ramchandran, K., A. Ortega, K. Uz, and M. Vetterli, Multi-resolution broadcast for digital  HDTV using joint source channel coding, IEEE J. Select. Areas Commun., 11, 6–23,  1993.  Roy, S. and D. Falconer, Optimum infinite-length MMSE multi-user decision-feedback space–  time processing in broadband cellular radio, Wireless Pers. Commun., 27, 1–32, 2003.  Sari, H., G. Karam, and I. Jeanclaude, An analysis of orthogonal frequency-division multi- plexing for mobile radio applications, in Proceedings of IEEE VTC’94, 3, 1635–1639,  1994.  Sfar,  S.,  R.  Murch,  and  K.  Letaief,  Layered  space–time  multiuser  detection  over  wireless   uplink systems, IEEE Trans. Wireless Commun., 2 4 , 653–668, 2003.  Silva, P. and R. Dinis, Frequency-domain multiuser detection for CP-assisted DS-CDMA   signals, in Proceedings of IEEE VTC’06  Spring , Melbourne, Australia, May 2006a.  Silva, P. and R. Dinis, Multiuser detection for the uplink of prefix-assisted DS-CDMA sys- tems employing multiple transmit and receive antennas, in Proceedings of IEEE VTC’06   Fall , Montreal, Canada, September 2006b.  Silva, P. and R. Dinis, A turbo SDMA receiver for strongly nonlinearly distorted MC-CDMA   signals, Can. J Elect. Comput. Eng., 33 1 , 39–44, 2008.      MIMO Optimized for Single-Carrier Frequency-Domain  ◾  247  Silva,  P.  and  R.  Dinis,  Joint  turbo  equalization  and  multiuser  detection  of  MC-CDMA  signals with strongly nonlinear transmitters, IEEE Trans. Veh. Technol., 58 5 , 2288– 2298, 2009.  Silva, F., R. Dinis, and P. Montezuma, Estimation of the feedback reliability for IB-DFE   receivers, ISRN Commun. Networking J., 2011, 2011.  Silva, J., R. Dinis, N. Souto, and P. Montezuma, Single-carrier frequency domain equalisa- tion with hierarchical constellations: An efficient transmission technique for broadcast  and multicast systems, IET Commun., 6 13 , 2065–2073, 2012.  Silva, F., R. Dinis, and P. Montezuma, Channel estimation and equalization for asynchro-  nous single frequency networks, IEEE Trans. Broadcast., 2013.  Silva, M., R. Dinis, and P. Montezuma, Iterative frequency-domain packet combining tech- niques for UWB systems with strong interference levels, Wireless Pers. Commun., 9 9 ,  2065–2073, 2012.  Tidestav, C., M. Sternad, and A. Ahlèn, Reuse within a cell—Interference rejection or mul-  tiuser detection?, IEEE Trans. Commun., 47 10 , 1511–1522, 1999.  Tüchler, M., R. Koetter, and A. Singer, Turbo equalization: Principles and new results, IEEE   Trans. Commun., 50 5 , 754–767, 2002.  Vucetic, B. and J. Yuan, Turbo Codes: Principles and Applications, Kluwer Academic publish-  ers, London, 2002.  Wang, Z. and G. Giannakis, Wireless multicarrier communications—Where Fourier meets   Shannon, IEEE Signal Proc. Mag., 17 3 , 29–48, 2000.  Winters, J., J. Salz, and R. Gitlin, The capacity of wireless communication systems can be  substantially increased by the use of antenna diversity, in Proceedings of ICUPC’92,  Dallas, USA, pp. 02.01 1–02.01 5, September–October 1992.  Wolniasky, P. W., G. J. Foschini, G. D. Golden, and R. A. Valenzuela, V-BLAST: An archi- tecture for realizing very high rates over rich-scattering wireless channel, in Proceedings  of ISSSE’98, Pisa, Italy, pp. 295–300, October 1998.       Chapter 6 MIMO Optimized  for W-CDMA  João Carlos Silva, Nuno Souto, and Rui Dinis  Contents 6.1  W-CDMA Fundamentals ........................................................................251 6.1.1  CDMA Concept ...........................................................................251 6.1.2  Fixed Assignment Multiple Access Techniques .............................251 6.1.3  Spread-Spectrum Communications ..............................................253 6.1.4  Narrowband versus Wideband CDMA .........................................254 6.1.5  Narrowband CDMA ....................................................................255 6.1.6  Wideband CDMA ........................................................................257 6.2  MMSE System Matrices for a MIMO DS-CDMA System ......................265 6.2.1  Main System Matrices ..................................................................267  6.2.1.1  Downlink with Equal Scrambling for All Transmit   Antennas—S and C Matrices ........................................ 268  6.2.1.2  Different Scrambling for All Transmit Antennas and   Uplink Modifications—S and C Matrices ......................270 6.2.1.3  Design of the Remaining Structures ...............................271 6.2.2  Receiver Schemes Using the System Matrices ...............................272 6.3  Enhanced Algorithms for Solving the Equalization Matrix ......................274 6.3.1  Matrix Reordering ........................................................................274 6.3.2  Standard Algorithms for the Exact Solution .................................275 6.3.2.1  Optimizations .................................................................277 6.3.3  Partial Cholesky Approximation ...................................................282  249   250  ◾  MIMO Processing for 4G and Beyond  6.3.4  Partitioning...................................................................................282 6.3.5  Solving the Equalization Matrix with the Block-Fourier   Algorithm .....................................................................................288 6.3.5.1  Diagonalizing Circulant Matrices ...................................288 6.3.5.2  Application to Block-Circulant Matrices ........................291 6.3.5.3  Application to the Zero-Forcing Detector .......................299 6.3.5.4  Constant-Channel Conditions ....................................... 304 6.3.5.5  Block-Fourier Algorithm with Partitioning .................... 306 6.3.5.6  Solving the EM for the Unsteady Channel .......................310 6.3.5.7  Application to the LMMSE Detector .............................314 6.3.5.8  Zero-Forcing Results ......................................................319 6.3.5.9  LMMSE Results .............................................................333 6.3.6  Final Remarks ...............................................................................334 6.4  Performance Results of the Equalization Techniques ...............................334 6.4.1  MF Results ...................................................................................335 6.4.2  MMSE and ZF Results .................................................................335 Acknowledgment ..............................................................................................338 References .........................................................................................................338  In this chapter, we will study the use of linear equalizers for wideband code divi- sion multiple access  W-CDMA  using multiple-input multiple-output  MIMO   systems.  The  W-CDMA  concept  will  be  introduced  and  the  minimum  mean  square  error   MMSE   alongside  the  zero-forcing   ZF   methods  will  be  studied  and analyzed.  The  well-known  RAKE  receiver  is  not  sufficient  to  cope  with  the  interfer- ence of fully loaded systems [Brunner et al. 1999]. One of the main problems  consists in the uncanceled multipath components pertaining to the same mes- sage; since the ratio of used channels per spreading factor  SF  is close to one,  the cross-correlation between sequences is very significant, and left uncanceled.  By  employing  an  MPIC   multipath  interference  canceler ,  substantial  perfor- mance gains were observed, although still very far from the single user bound  for fully loaded scenarios. Since the MPIC has its operation stemmed from the  RAKE, it is only able to cancel part of the inter-symbolic interference  ISI   the  RAKE leaves a  significant noise component attached . However, for higher-order  modulations than quadrature phase shift keying  QPSK  and or MIMO systems,  where interference from other transmitting antennas  ICI—interchannel inter- ference  significantly increases the multiple access interference  MAI  and ISI, a  more powerful receiver needs to be employed.  Equalization-based receivers try to take into account all effects that the sym- bols  are  subject  to  in  the  transmission  chain,  namely,  the  joint  compensation  of MAI, ICI, and ISI. In this chapter, linear equalizers were employed, namely,  MMSE and ZF.      MIMO Optimized for W-CDMA  ◾  251  6.1  W-CDMA Fundamentals The fundamentals of W-CDMA are addressed in this section. To begin with, the  CDMA concept is analyzed and compared to the alternative multiple access tech- niques, such as time division multiple access  TDMA  and frequency division mul- tiple access  FDMA . The direct-sequence  DS  spread-spectrum  SS  technique is  also compared to other methods, including the time hopping  TH  and frequency  hopping  FH  methods. Narrowband and wideband channels are also discussed,  with the multipath effect being explained in the latter case.  After  defining  the  W-CDMA  model,  the  conventional  RAKE  receiver  is  described, and the concept of maximal ratio combining  MRC  is analyzed. In  order to obtain better performance results by canceling a substantial part of ISI  MPI  intersymbolic multipath interference , the standard MPIC is also discussed.  6.1.1  CDMA Concept Multiple access  MA  communications refer to a communication system that allows  more than one user to transmit over one physical channel resource at the same time.  This does not imply that the multiple signals are necessarily overlapping in time;  users only need to feel that they are accessing the channel all the time  for instance,  user 1 may be transmitting and receiving short bursts of 100 ms every 1 ms, but the  900 ms gap is imperceptible and of no consequence, as long as all the information  he needs to transmit is accommodated within his periodic 100 ms bursts—this is  the principle of TDMA, explained later on .  MA is distinct from multiplexing, though the two concepts are very similar.  MA is reserved for dynamic systems of channel sharing in which users occupy part  of the channel only if they need to transmit; multiplexing refers to a fixed allocation  of channel resources such as FM radio broadcasting, and the splitting of a given  bandwidth into two segments for uplink and downlink communications  FDD— frequency division duplexing .  The MA techniques can be divided into two classes:   ◾ Fixed  assignment—a  central  controller   base  station   assigns  channels  to  users, who request channels through a common reservation protocol when  they need to establish a connection.   ◾ Random access—users in the system transmit whenever they need to, based  on a common protocol. If two or more data packets are sent at the same time,  collisions occur and the lost packets must be retransmitted.  6.1.2  Fixed Assignment Multiple Access Techniques Three of the most popular forms of fixed assignment MA are   ◾ TDMA—In  TDMA,  users  must  be  time-synchronized,  and  are  assigned  time slots within a frame in which they can transmit. The entire frequency       252  ◾  MIMO Processing for 4G and Beyond  bandwidth is used by each user, but there is no interference because time slots  are nonoverlapping.   ◾ FDMA—In FDMA, users transmit all the time, but each one is allowed only  one segment of the total system bandwidth. Like TDMA, there is no interfer- ence from other users in FDMA, as long as the bandwidth segments of each  user are separated by a frequency guard wide enough to prevent adjacent- band interference. A filter at the receiver is employed to use solely the data  contained in the wanted frequency segment.   ◾ CDMA—In  CDMA,  users  transmit  over  all  the  time  over  the  same  fre- quency, being separated on the basis of their different symbol-pulse wave- forms  or codes . CDMA requires that the bandwidth occupied by each user  be several times that of the data bandwidth; hence CDMA is possible only  with SS modulation.  Both TDMA and FDMA signals can be made noninterfering or orthogonal. In prac- tice, this requires the insertion of guard intervals and guard bands between users,  respectively, to account for nonidealities such as synchronization error and delay  spread caused by the channel. CDMA signals can be made orthogonal only when  the users are perfectly synchronized in time, and the channel has no delay spread.  For the uplink, the first requirement is impossible to meet; the users are not syn- chronized with each other, but even if they were, since they have different channels,  it would be impossible to have the received signals orthogonal to each other. Also, in  wireless channels, the delay spread is usually significant—especially in W-CDMA,  characterized by frequency-selective fading and different delay spreads. Therefore,  CDMA is necessarily a nonorthogonal form of MA and suffers from MAI. There are, however, several advantages to the usage of CDMA, namely   ◾ Capacity  measured as bits second Hz user . In fact, since all of the band- width is used for all the time, the systems’ potential is effectively exploited  [Viterbi 1995].   ◾ Robustness  to  frequency-selective  fading   multipath  diversity  helps  reduce   the channel fading effect—this is also common to TDMA .   ◾ Asynchronous nature of the system  contrary to TDMA .  ◾ Universal frequency reuse  eliminating the need for cell planning in FDMA .  ◾ Linear performance degradation with loading. There is no hard limit on the  number of users allowed—more users can be admitted as long as the quality  of service  QoS  for the existing users remains adequate.   ◾ No periodic on–off switching  huge problem in hospitals for TDMA equip- ment, due to their regular on–off switching , and less peak power require- ment on the amplifiers.  Comparing the three fixed assignment MAs, FDMA is clearly the least attrac- tive scheme. Between CDMA and TDMA, it could seem that CDMA would be the       MIMO Optimized for W-CDMA  ◾  253  obvious choice, although practical implementations of CDMA and TDMA exhibit  little advantages over each other. The European 3G standard, universal mobile tele- communication system  UMTS , has both a CDMA and TDMA standard, whereas  the American standard, CDMA2000, has just CDMA.  6.1.3  Spread-Spectrum Communications SS  signals  are  characterized  for  having  a  bandwidth,  W,  much  greater  than  the  information rate  in bps  [Proakis 2001]. Therefore, if the information bit rate is R,  the bandwidth expansion factor, usually called processing gain or spreading factor   SF—the main designation adopted in UMTS and this chapter , is defined as     SF  =  W R  >> 1      6.1   The concept of SS was introduced by the United States for military communica- tions after World War II, primarily because of its antijamming capabilities. At the  time, an enemy would attempt to jam your communications by sweeping a powerful  narrowband signal  just a tone, for instance  over all likely frequencies. However, with  SS, a matched-filter  MF  detector is just another SS modulator  the narrowband  jamming signal appears at the MF output as a low-level wideband signal, but the  wideband desired signal appears as a high-power narrowband signal . After lowpass  filtering, the desired signal is recovered, while the jamming signal is severely attenu- ated by the filtering. The power level of the jamming signal is reduced by the SF of the  system. The greater the value of SF, the more robust the system is against narrowband  jamming, and frequency-selective fading. A very good introduction to SS is given in  [Proakis and Salehi 2002]. SS communications can be employed using different types  of techniques; the most common techniques are portrayed in Figure 6.1:   ◾ DS—The information symbols are encoded by a high-rate channel code  usu- ally  between  1 2  and  1 3 ,  after  which  they  are  spreaded   with  a  low-rate  code, 1 SF, normally using orthogonal spreading sequences in order to distin- guish between users physical channels , and then modulated in combination  with a pseudorandom sequence  commonly referred to as scrambling, with   DS-CDMA Rate Rb  Rate Rb Rc  Coding  rate Rc   Spreading  rate 1 SF   Modulation and  scrambling  CS-CDMA  Rate Rb  Coding-spreading   rate Rcs   Modulation and  scrambling  Rate SF·Rb Rc  Rate Rb Rcs  Figure 6.1  DS-CDMA and CS-CDMA schemes.      254  ◾  MIMO Processing for 4G and Beyond  unitary rate and generally used to distinguish between transmitters . In the  receiver, the received signal is descrambled, demodulated, despreaded, and,  finally, decoded.   ◾ Code spread  CS —An alternative to DS is to perform all the spreading of  the signal using a low-rate code  equivalent to Rc SF, Rc < 1  and then add- ing the scrambling code to the signal. In [Viterbi 1995], it is shown that this  technique can achieve a greater performance level than the DS technique  if  optimal decoding is employed by the receiver .   ◾ FH—In this case, the available bandwidth is divided into several contiguous  subband frequency slots. A pseudorandom sequence is used for selecting the  frequency slot for transmission in each signaling interval.   ◾ TH—In this method, a time interval is divided into several time slots and  the coded information symbols are transmitted in a time slot selected accord- ing to a pseudorandom sequence. The coded symbols are transmitted in the  selected time slot as blocks of one or more code words.   ◾ Hybrid techniques—DS, CS, FH, and TH can be combined to obtain other  types of SS signals. For example, a system can use a combination of DS and  FH, where the transmitted signal is associated with two code sequences. One  of the sequences is multiplied by the signal to be transmitted while the second  is used to select the frequency slot for transmission in each signaling interval.  6.1.4  Narrowband versus Wideband CDMA In CDMA communications, several users share the same channel bandwidth for  transmitting information simultaneously. Assuming that all the users employ the  same channel encoder, the transmitted signals use the same frequency band and may  be distinguished from one another by using a different pseudorandom  DS-CDMA   coded pseudorandom  CS-CDMA  sequence for each transmitted signal.  CDMA systems can be considered narrowband or wideband depending on the  mobile propagation conditions. If the transmitted signal bandwidth is lower than  the coherence bandwidth of the channel, there will be only one macroscopic dis- tinguishable received replica of the signal. In this case, the system is narrowband  CDMA. If the transmitted signal bandwidth is greater than the coherence band- width of the channel, then it will be possible to resolve several multipath compo- nents resulting in a W-CDMA system.  Formally, the transmitted CDMA signal xT t  can be described as    where     x T  ,  modulated  t      =  Re x { T  t    }.     x t     T  =  c  k i ,  p t    k i ,  −  iT c     ∞  K  ∑∑ ' b  k  = 1  i  =  0      6.2    6.3       MIMO Optimized for W-CDMA  ◾  255  },′bk i  is a  is the baseband representation of the signal transmitted by the user k. { sequence of complex symbols, where each consecutive set of SF symbols is the  repetition of the same modulated symbol  SF is given by SF = Tb Tc . Tb = 1 Rb  is the bit period and Tc is the chip period. The original sequence of unrepeated  symbols is {bk,i}, and the function p t  represents a pulse having a limited band- width. {ck,i} is the sequence of values of the combined spreading, scrambling, and  modulation code  usually periodic  for user k, being composed of two compo- nent sequences cIi and cQi  with amplitudes varying between –1 and +1  for the  in-phase and the in-quadrature components, respectively. To keep the absolute  value of the complex code equal to 1, the sequence is constructed as  QPSK is  considered   c  i  =  2 2 [  c  I  i  +  jc Q i  ].      6.4   There is a significant difference between narrowband and wideband CDMA,  namely, in the channel effect and the appearance of MPI—multipath interference.  A brief discussion on both concepts is given below.  6.1.5  Narrowband CDMA In a narrowband CDMA system, admitting that there are K users transmitting  simultaneously,  the  decision  variable  for  symbol  {b0,i}  of  user  0  obtained  in  the  receiver  Figure 6.2  is  y  0  i ,  =   cid:22  b  0  i ,  =  b  '  0  ⋅ i SF m ,  +  0  ⋅ i SF m ,  +  ⋅  c              * + ⋅ i SF m 0 ,  c  ⋅               + ⋅ , i SF m  α00  ⋅                * + ⋅ , 0 i SF m  ⋅  α  b  ''k i SF m + ,  ⋅  ⋅  c  k i SF m ,  +  ⋅                 α + k i SF m ,  ⋅  ⋅              * + ⋅ i SF m , 0  cc              * + ⋅ i SF m , 0  ⋅  α    ⋅     n ⋅ ii SF m  +     ⋅                 * + ⋅ i SF m 0 ,  c             * + ⋅ i SF m 0 ,  ,  ⋅  α   6.5            SF  − 1  ∑ ∑  = 0 m − 1 K  k  = 1     1 SF − SF 1 ∑ FF −∑1  m S  =  0  m  =  0  +  +  1 SF  1 SF  r t   Matched  ﬁlter  Correlator  y  α0* t   c* t   Figure 6.2  DS-CDMA receiver scheme.      256  ◾  MIMO Processing for 4G and Beyond  where αu i, *  is the complex conjugate of the channel coefficient of user k. To simplify  the notation, it was considered that there were no delays between the received sig- nals of all the users. Since c  ,1 the expression simplifies to  =* i  ⋅ ci  y  0  i ,  =  1 SF  SF  − 1  ∑ ' b 0  m  =  0  ⋅  α              + ⋅ i SF m , 0  ⋅ i SF m ,  +  1 SF  − 1  SF  ∑  m  =  0     K  − 1  ∑ ' b ⋅ , k i S  k  = 1                + k i SF m ,  ⋅  c  ⋅  ⋅  α                + k i SF m ,  ⋅  FF m  +           ⋅ + i SF m ,  c  * 0                * ⋅ + 0 , i SF m  ⋅  α  ×     n ⋅ i SF m  +     ⋅                * + ⋅ 0 i SF m ,  c            * ⋅ 0 i SF m ,     +  ⋅  α  =  1 SF b               + ⋅ , 0 i SF m  − 1  FF S  ∑  m  =  0            ,α + ⋅ 0 i SF m  K  SF  − 1  − 1  ∑∑     m  =  0  k  = 1  b  ' , k i SF m  +  ⋅                + , k i SF m  ⋅  c  ⋅  ⋅  α         ⋅ , k i SF m           +             * + ⋅ i SF m 0 ,  c  ⋅               ,α * ++ 0  ⋅ i SF  +  m  ×  n ⋅ i SF m  +     ⋅               * + ⋅ i SF m 0 ,  c  ⋅           ⋅ i ,  0α SSF m +  *  .  2  +  − 1  SF  ∑  m  =  0  ++ 1 SF 2  1 SF 1  + −∑  SF     m  =  0  1 SF            6.6   In this expression, the second term represents the interference component,Ii,   from the other users  ⋅  ⋅   cid:31 I i  =  1 SF  1 SF  1 SF  K  SF  − 1  − 1  m K  = 0 − 1  = k 1 − 1 SF  ∑ ∑  ∑∑ ∑  = 1 − 1    k K  m  =  0  k  = 1  b , k i SF m  +  ⋅  =  =     − 1  SF  ∑  m  =  0  b  ' , k i SF m  +  ⋅                + k i SF m ,  ⋅  c  ⋅  α           ⋅ k i SF m ,         +            ⋅ + i SF m ,  ⋅           *α ⋅ i SF m 0 ,         +  c  * 0    ⋅  b  ' , k i SF m  +  ⋅                + , k i SF m  ⋅  c  ⋅                 ,α FF m + ⋅ k i S  ⋅              * + ⋅ , 0 i SF m  c  ⋅          *α ⋅ , 0 i SF m          +   6.7                   + , k i SF m  ⋅  c  ⋅              c i SF m * + 0 ,  ⋅                * ⋅ + 0 i SF m ,  ⋅                 α SSF m + k i ,  ⋅  ⋅  α  Admitting that the channel is approximately constant during SF chip period   results in  I  i  =  1 SF  K  − 1  ∑  k  = 1  b k i SF m ,  +  ⋅          * ⋅ 0 i SF ,           α ⋅ k i SF ,  ⋅  ⋅  α                + k i SF m ,  ⋅  c  ⋅             c i SF m * ⋅ + 0 ,   6.8      − 1  SF  ∑  m  =  0  Therefore, to minimize the interference in the received signal, the cross-correla-  tion of the spreading sequences, given by        .        .     SF  − 1  ∑               k i SF m ,  c  +  ⋅  m  =  0           + ⋅ i SF m ,  ,  ⋅  c  * 0      6.9                   MIMO Optimized for W-CDMA  ◾  257  should have an absolute value as low as possible. Ideally, this value should be equal  to zero so that no interference appears in the decision variable but that is only pos- sible when using orthogonal spreading sequences and the users’ received signals are  all synchronized  like the downlink connection of a mobile cellular radio commu- nication system . In the uplink, since there is no synchronization and each user has  a different channel, usually pseudo-noise  PN  sequences are used, which exhibit  small cross-correlation values between misaligned sequences. Figure 6.2 represents  the DS-CDMA receiver scheme.  6.1.6  Wideband CDMA In W-CDMA systems, replicas arrive at the receiver during a certain  continuous   period of time, due to temporal dispersion. In order to facilitate the handling of  the channel, the tapped delay line  TDL  channel model was created, where the  replicas are modeled as being discrete  intervals of Tc , being dubbed as multipaths.  The multipath replicas carry the information about the transmitted signal and suf- fer fading that is uncorrelated between them. So, when a replica is severely attenu- ated due to the fading, there is the possibility that the others are received in good  conditions and can be used to recover the transmitted signal. Owing to the good  autocorrelation properties of the spreading codes usually used in CDMA systems,  it is possible to distinguish and extract the strongest replicas present in the received  signal.  After  the  transmission,  the  signal  passes  through  the  channel.  The  channel  impulse response hc τ,t  can be described using the previously referred TDL model,  where the multipaths are considered discrete and their number is L t :  h c  τ   ,   t  =  t t    ,    l  ⋅  δ τ    −  τ  l  t     .   6.10       L t  ∑α τ    l  l  = 1     This model represents the response of the channel at instant t to an impulse  applied at t − τ. This formulation does not correspond to the usual impulse response  formulation for time-variant linear systems h t,t0′  that represents the response at  time t to an impulse applied at time t0. These two formulations are related through  hc τ,t  = h t,t0  with τ = t − t0. Admitting a channel with a fixed number of discrete  multipath components, L, and respective delays τl, results in the following channel  impulse response:  The signal after the channel is given by  h c  τ   ,   t  =  t      ⋅  δ τ    l  −  τ  l     L  ∑α  l  = 1  x  t channel     =  h c  ⊗τ   ,   t  x T  t    .         6.11    6.12                258  ◾  MIMO Processing for 4G and Beyond  The symbol ⊗ in the last expression represents a superposition integral for time-  variant linear systems:  ∞  ∫  −∞  L  ∑  = 1  l  h c  τ ⊗   ,   t  x T  t      =  h c  τ   ,   t x T  t    −  τ  d    τ  .   6.13         In the case of time-invariant systems, it is reduced to a convolution integral    with the symbol * . At the receiver, the signal yR t  is expressed by  y  R  t      =  h c  τ t   ,    ∗  y T  t      +  I t      +  n t      =  α  l  t      ⋅  x T  t    −  τ  l     +  I t      +  n t      ,   6.14     where I t  represents the overall MAI, while n t  is Gaussian noise.  The replicas at the receiver can be combined using a RAKE receiver, as shown in  Figure 6.3, thus obtaining diversity. According to the RAKE scheme, the received  signal is first filtered using a matched filter. Then, each of the L branches of the  receiver, also called “fingers,” is used to detect separately one of the L strongest  replicas. The L estimates of the signal obtained by the “fingers” are then added to  compute the final estimate of the transmitted signal. MRC is assumed to be used,  which means that each of the L estimates is weighted using the complex conjugate  of the corresponding channel coefficient α i t*   . This technique results in the highest  mitigation of fading effects.  For correct operation, the RAKE receiver must be able to identify the strongest  multipath components present in the received signal and also estimate their relative  delays, amplitudes, and phases. This can be accomplished by transmitting periodic  preambles or pilot codes.  r t  Matched  ﬁlter  Correlator  c * t–τ1   Correlator  c * t–τ2   Correlator  c * t–τL   α1* t   α2* t   αL* t   Delay τmax–τ1  Delay τmax–τ2  Delay τmax–τL  Figure 6.3  RAKE receiver scheme.      MIMO Optimized for W-CDMA  ◾  259  Usually, only one sample per chip is used after the filter, in order to reduce com- plexity and simulation time. These samples are obtained at the optimum sampling  instants according to the Nyquist pulse-shaping criterion. If the multipath com- ponents  taps  are not aligned with the sampling time  real-life scenario , then the  work done in [Silva et al. 2003] should be taken into account, in order to continue  working with only one sample per chip.  In each “finger” of the RAKE, the samples suffer an advance τl identical to  those specified by an environment model and are then multiplied by the samples  of the complex conjugate of the correspondent channel coefficient αl so that the  original signal phase is recovered. For theoretical, perfect synchronization is admit- ted so the delay values, τl, are directly used in the RAKE. After the multiplication  by the conjugates of the channel coefficients, the signal  with components in-phase  and in quadrature since it can be QPSK or M-QAM modulated  enters the cor- relator where it is multiplied by the complex conjugate of the spreading code c t   synchronized with the respective replica. The result is then integrated for each bit  period, thus achieving the despreading of the signal. The resulting symbols are then  demodulated to obtain “soft” estimates of the transmitted symbols. These symbols’  estimates  are  then  summed  with  the  respective  estimates  of  the  other  “fingers.”  Note that this addition is weighted due to the previous multiplication of the esti- mates by the respective complex conjugate of the channel coefficients.  In the RAKE receiver, the signal is sampled and the resulting sequence is mul- tiplied in each “finger” by the samples of the complex conjugate of the respective  channel coefficient. Then, it is multiplied by the complex conjugate of the spread- ing code {  with a delay equal to the delay of the replica being extracted by the  “finger,” and each set of SF symbols is integrated, thus resulting in a despreaded  sequence. The estimates of symbol sequences obtained in each “finger” are all time  aligned and summed, thus obtaining a combined estimate.  }*ci  The decision variable associated with each despreaded QPSK symbol i obtained   in “finger” l is given by  y  l i  ' ⋅ i SF m  +  ⋅  c  ⋅ i SF m  +             * + ⋅ i SF m  c  ⋅  ⋅  α         ⋅ l i SF m ,          +              α , * + l i SF m  ⋅  ⋅     n , l i SF m  +  ⋅  +  I  ⋅ , l i S  FF m  +  +  Z  l i SF m ,  +  ⋅              * + ⋅ i SF m  c  ⋅  α              * + l i SF m ,  ⋅     ⋅  − 1  SF  − 1  b  =  = 0 SF  1 SF  ∑ m 1 ∑ SF SF 1 ∑= SF  m − 1  +  ==  m  = 0             * + ⋅ i SF m  ⋅  c       0 ' b ⋅ i SF m  +               α , + l i SF m  ⋅  2  +  1 SF  − 1  SF  ∑  m  =  0               αll i SF m * + ,  ⋅  ,  ⋅        n l  ⋅ , ii SF m  +  +  I  , l i SF m  +  ⋅  +  Z  , l i SF m  +  ⋅      6.15               where  ci = 1.  αl i SF m +   represent  the  samples  of  the  + , channel  coefficients,  MAI  overall  and  noise,  respectively,  at  time  instants     and  nl i SF m ,  ,   Il i SF m +  , ⋅  ⋅  ⋅  ,      260  ◾  MIMO Processing for 4G and Beyond  =  ⋅ i SF m Tc    t created by the replicas of the transmitted signal  .τ  Zl i SF m l  −  +  , ⋅     ⋅  +  corresponds to the samples of the interference   Z  l i SF m ,  +  ⋅  =  t    j  =  ⋅ i SF m T     c  +  −  τ  l     ⋅  x T  t    =  ⋅ i SF m T     c  +  −  τ  l   .   6.16   L  ∑α  j j  = 1 ≠ l     Note that after the receiver filter and before the sampling, the noise power is  ∞  ∫  −∞  σ n 2  =  G f H f          w  R     2  df  ,   6.17      where Gw f   is the spectral density function, which for additive white Gaussian  noise  AWGN  is Gw = N0 2. HR f   is the frequency response of the receiver filter.  So, in the case of AWGN and square-root raised cosine receiver filter  which outputs  the same noise power of an ideal lowpass filter with bandwidth 1  2Tc   results in  σ n 2  =    H f  R     2  df  =  N 0 2  ∞  ∫  −∞  N 0 2  ⋅  2  ⋅  1 T 2 c  =  N 0 2  ⋅  1 T c  .      6.18   After summing the decision variables of each finger at the output of the RAKE,   we get  y  i  =  ' b ⋅ i SF m  +  L  SF  − 1  l  i  0  ⋅  c  α  ∑∑1 SF = = 0 1 m                           ⋅ α * * ⋅ + ⋅ + l i SF m , i SF m − L FF 1 S 1 ∑∑ b SF  = = 1 l m                           ⋅ α * * ⋅ + ⋅ + l i SF m , i SF m − 1 L SF 1 ∑∑ b SF 1 ∑∑ + SF ∑ information  = 0 m − 1 FF S  = 1 L  α  = 1  c  m  ⋅⋅  =  0  i  l  l  =  =  =  2  2               α , + l i SF m  ⋅  2  +  1 SF  L  SF  − 1  ∑∑  l  = 1  m  =  0     n , l i  ⋅⋅  SF m  +  +  I  l i SF m ,  +  ⋅  +  Z  l i SF m ,  +  ⋅                  + l i SF m ,  ⋅  L  SF  − 1  1 ∑∑+ SF  l  = 1  m  =  0     n , l i SF m  +  ⋅  +  I  , l i SF m  +  ⋅  +  Z  , l i SF m  +  ⋅     , l i SF m  +  ⋅  +  Z  , l i SF m  +  ⋅              * ⋅ + SSF m i  c  ⋅                α * + l i SF m ,  ⋅     ⋅               ++ l i SF ,  ⋅  m  +  1 SF  nn l i SF m ,  +  ⋅              * + ⋅ i SF m  c  ⋅  ⋅     I  L  SF  − 1  ∑∑  l  =  m  = 0 1               α * + l i SF m ,  ⋅  +  ∑  interference  +  ∑  noise.     6.19                   MIMO Optimized for W-CDMA  ◾  261  In this expression, the first term represents the transmitted symbol that must  be decoded at the receiver. The second term represents the interference from other  users  and  multipath  components  that  degrade  the  decoding  of  the  transmitted  symbols and the third term is noise.  This type of signal combination is denominated by “MRC” and results in the  maximization of the received signal-to-noise ratio  SNR . In fact, for the general  case of a received signal y obtained by the combination of L replicas of the transmit- ted signal suffering fading αk t  that are uncorrelated between them, we have  y  =  G  k  α    b  k  +  n k     =  G  k  α  k  b  +  α  n k  .  k   6.20   L  ∑  k  = 1  L  ∑  k  = 1     L  ∑  k  = 1  Gk t  are complex weights that are multiplied by each received signal replica at  the receiver. The received SNR is  assuming a simple binary phase shift keying— BPSK modulation     with Eb denoting the average energy per transmitted bit. The weights Gk t  that  maximize S N can be obtained through the Cauchy–Schwarz inequality:     k  L  ∑  = 1  a b * k k  ≤     L  ∑  = 1  2  a  k        L  ∑  = 1  2  b k     ,  k    in which the equality is verified when ak = c ⋅ bk, for any c. Applying this theorem to the SNR expression results in     k  k    for which the equality Gk = αk results in an SNR that is equal to the sum of the  SNR of the individual “fingers,” that is     k  = 1  S N  =  E b N  2  G  k  α  k  ,  2  G  k  L  k  ∑ ∑0  = 1 L  = 1  S N  ≤  E b N  2  α  k  L  L  k  k  2  = 1  G  ∑∑ ∑0  G  = 1 2  L  k  k  S N  =  L  E b N  ∑0  k  = 1  2 α .  k      6.21    6.22    6.23    6.24             262  ◾  MIMO Processing for 4G and Beyond  The average SNR is  S N  avg  =  L  E b N  ∑0  k  = 1  {  E  2  α     t  k  }  ,      6.25    6.26    6.28      6.29   where E{αk  t 2} is the average value of the channel coefficient αk  t 2.  When using QPSK modulation, for example, for the downlink transmission of   the UMTS, we have:  T c  =  2  ⋅  T R b  ⋅      the 2 factor is due to the modulation being QPSK; log2 M for M-QAM modulations ,       E I Q c  =  ⋅  E  c  =  ⋅  2  A T c  ⋅  =  ⋅  2  A  ⋅  2  ⋅  T R b  ⋅  =  E  b  ⋅  R   6.27   1 2  1 2  1 2      Ec is the average energy by complex chip ,  T c 2    0  =       I Q  ⋅ 2  T   c N  0  E r c  c    2  ⋅     ⋅  T E c N  c  0  =     T c  II Q   2     ⋅  E c N  0  I Q   =     S N     I Q       E   c I Q  ⋅ ⋅ B N 2 E 2 N a  bR  0  =  =    or, equivalently,  N  I Q   =  S I Q  ⋅ R E N     b  0  2  ⋅  .     In these expressions, Ec and Tc correspond to the average complex chip energy  and chip period, respectively. R is the ratio between the total number of informa- tion bits over the total number of transmitted chips, thus including the code rate  and the spreading factor.  In the uplink connection of the UMTS, since each bit is transmitted simultane-  ously in the “I” and “Q” branches, we have:  T c  b=  T R  ⋅  ,     6.30      E  c      I Q  =  1 2  1 2  1 2  ⋅  E  c  =  ⋅  2  A T c  ⋅  =  ⋅  2  A T R  ⋅  ⋅  b  =  ⋅  E  b  ⋅  R  ,   6.31   1 2                           MIMO Optimized for W-CDMA  ◾  263     S N     I Q   2     ⋅   E N  c  0  =   I Q  =  R  E  ⋅ b N 0  ,        S N     I Q   =  R  E ⋅ ⇔ b N  0  N  I Q   =  S  I Q     b  R E N  ⋅  0  .     .     Note that after demodulation, the expression for the SNR is the same of a regu-  lar polar transmission, that is, the SNR doubles     S N    =  2  ⋅  R  E ⋅ ⇔ = b N  N  0  S ⋅  2  ⋅  R E N     b  0  In the case of the UMTS HSDPA connection using 16-QAM modulation, we   obtain:  T c  =  4  ⋅  T R b  ⋅  ,       E  c      I Q  =  1 2  1 2  1 2  ⋅  E  c  =  ⋅  2  A T c  ⋅  =  ⋅  2  A  ⋅  4  ⋅  T R b  ⋅  =  2  ⋅  E  b  ⋅  R  ,   6.36         S N     I Q   2     ⋅   E N  c  0  =   I Q  =  4  ⋅  ⋅  R  E b N  0  ,        S N     I Q   =  4  ⋅  R  E ⋅ ⇔ b N  0  N  I Q   =  S I Q  ⋅ R E N     b  0  .  4  ⋅      6.32    6.33    6.34    6.35    6.37    6.38   In the case of a RAKE receiver, the expression to compute the necessary noise  power to achieve certain average bit energy to noise spectral density value is different:  S N avg  =  E b N  0     L  ∑  k  = 1  2   cid:31  W t      k    ⇔  avg  E b N  0  =  S N avg  ⋅  1  2   cid:31  W t      k        L  ∑  k  = 1  avg     .   6.39   For the downlink connection, the noise power becomes  N  I Q   =  S I Q  ⋅ R E N     b  0  2  ⋅  =  2  ⋅  R S N     ⋅  avg  S  I Q  1    ⋅ ∑    = 1  L k  2   cid:31      W t  k     avg     .   6.40                                  264  ◾  MIMO Processing for 4G and Beyond  Care must be taken when speaking of either receive or transmit Eb N0, since  both values are different. The receive Eb N0 is related to the transmit Eb N0 by a  diversity order factor  DOF , which essentially accounts for all types of diversity in  the transmission, assuming that there is no free-space power loss and normalizing  the most powerful tap to one  wideband system .  Defining txdiv as the transmit diversity  number of transmit antennas , rxdiv as  the receive diversity  number of receive antennas , and mpdiv as the channel diver- sity, that is, the diversity provided by the channel multipaths, given by   6.41    6.42   ∑∑ P  P      α  main  i  α       i  ,     mp  div  =    the DOF is heuristically given by     DOF  =  tx  div  ⋅  rx  div  ⋅  mp  div.    Some DOF values are presented in Table 6.1. The multipath diversity of the  main UMTS channels is presented in Table 6.1a. The transmit diversity may be  accounted for in terms of number of antennas and multipath components, weighed  by their transmit power levels. For illustration purposes, the transmit diversity of  three transmit diversity arrangements is presented in Table 6.1b.  For the receive diversity, it suffices to consider the total number of receive anten- nas for most number of cases. As an example, for the SIMO  single input, multiple  output  case of Figure 6.4, where a two-tap channel is assumed, a DOF equal to 4  would be obtained:  Table 6.1  Multipath Diversity for the Main UMTS Channels  a  and  Different Transmit Diversity Schemes  b   Channel  Pedestrain A  Pedestrain B  Indoor A  Vehicular A  2.46  1.1  2.02  1 antenna  2 antennas equal   Transmit Diversity  power  2  2 antennas 3 dB   difference  1.5   a   1.05   b   1      MIMO Optimized for W-CDMA  ◾  265  Reflector  Transmitter  Receiver  Figure 6.4  SIMO case with two receivers and two equal-channel taps.  DOF  =  tx  div  ⋅  rx  div  ⋅  mp  div  = ⋅  1 2 2  ⋅  =  4.    The relationship between the transmit and receive Eb N0 is simply  b  E N 0  RX  =  DOF  b  E N 0 TX  .            6.43    6.44   Differently from most of the other chapters, in this chapter, the received Eb N0  is used in all simulation results, unless stated otherwise. MIMO simulation results  will reveal comparable system performance for similar values of Eb N0, unaffected  by the order of the receive diversity. Another advantage of using the receive Eb N0  value is the possibility of extrapolating coding results from the performance curves,  since the decoder’s performance depends on the received Eb N0.  6.2   MMSE System Matrices for a MIMO DS-CDMA   System  The design of the system matrices for the MF and the ZF MMSE schemes are pre- sented in this section  note that the MF is also discussed since it is an integral part  of both ZF and MMSE schemes . A MIMO arrangement is assumed, in which the  data streams for each user are either split into different streams for each transmit  antenna to increase the bit rate capacity, or replicated  with interleaving  for each  antenna, to increase the transmit diversity, reducing the necessary transmit power  for nominal operations.  The  transmitted  signal  associated  with  the  kth  spreading  code  and  the  txth   transmit antenna is given by  x  k   tx     t      =     A k   tx  b      k   n SF tx    ,       c  k   n  f  T  t    −  nT C     =     A   kk tx  β      k , n tx  f  T  t    −  nT C   ,   6.45   ∑  n           N SF  ⋅∑  n  = 1      266  ◾  MIMO Processing for 4G and Beyond  k  ,  1  kE    =  1=   E    b    2 k   =   and  E     admitting  fT     0  where  N  is  the  number  of  data  symbols  to  be  transmitted  by  each  antenna,   =  ,  with  Ek    k Atx denoting the symbol energy, SF is the spreading factor, K is the total number of  spreading codes per antenna physical channels  or users, if each user uses only one  physical  channel ,  and  RC = 1 TC  is  the  chip  rate.  The  nth  chip  associated  with  =  the kth user and the txth antenna is  βn tx k     b  .     k  The data symbols to be  , n SF tx     , n = 1,2,. . ., N, and the combined  transmitted at the txth transmit antenna are bn tx   k ,  , n = 1,2,. . ., N ⋅ SF. fT t  is the adopted  spreading and scrambling signature is cn k  pulse shape filter  a square-root raised cosine filtering is assumed .    c      2  k   n  At the receiver, we have NRX antennas. The signal for any given receive antenna   1  c    ,  rx, prior to the reception filter, is given by  y  rx  t      =  K∑  k  = 11  ⋅  N  N SF  TX  ∑∑  n  = 1  tx  = 1     x  k     n tx ,  t     *     h k   n rx tx ,  ,  t        +      n t ,   6.46      with  n t   denoting  the  channel  noise,  assumed  Gaussian,  with  zero  mean  and  the variance of the real and imaginary components denoted by σ2. The channel  impulse response between the transmit antenna tx and the receive antenna rx is     h k   n rx tx ,  ,  t      =     k   n rx tx l , ,  ,  δ    t  −  τ    l  k      ,   6.47   L  ∑α  l  = 1     with L denoting the total number of the channel’s multipath components, αn tx rx l     , denoting the complex attenuation  fading  factor for the lth path, and τ l   is the  k  propagation  delay  associated  with  the  lth  path   for  the  sake  of  simplicity,  it  is  assumed that this delay is constant; the generalization to other cases is straightfor- ward . The received signal associated with each antenna is submitted to a reception  filter, with impulse response fR t , which is assumed to be matched to fT t   i.e.,  f R  −  , leading to the signal t  t      * T  =        k ,  f     ,  r rx  t      =  N  K  Tx  ∑∑  tx  = 1  k  = 1     A k   tx  ⋅  L  N SF  ∑∑  l  = 1  n  = 1  k     b n K tx       ,  c h k     n     k   n rx tx l , ,  ,  pp t    −  nTC  −  k     τ    l   ,   6.48      where  p t  = fT t  * fR t    for  the  Nyquist  pulses  considered  in  this  work,  p t      = This signal is sampled at the chip rate and the corresponding samples can be   −  is such that p nTC  = 0 for integer n ≠ 0 . t  t      t      t      * T  =  ∗  ∗        f  f  f  f  T  T  R  written as               MIMO Optimized for W-CDMA  ◾  267  r rx n ,   cid:24   r nT C rx        A k   tx  L  ∑∑  l  = 1  ' n  +  N  Tx  K  0  =  ∑∑τ   ∑∑  = tx 1 L  k   tx  = 1  k     K  l  = 1  " n  N  Tx  ∑∑ A  tx  = 1  k  = 1  =  β  k     ' n tx ,     kk   h ' n rx tx l , ,  ,  p n     −  ' n T   C  −  τ      l  k     −     τ 0 k        β " k     − n n tx ,  k     h − n n rx tx l ,  " ,  ,  " p n T   C  −        τ kk   l  −  τ0 k       ,   6.49      βn tx     k ,  =  b  k       n K tx  ,   c  k   n   .      6.50   It should be noted that  n ∈  cid:27 , but in practical terms, it is enough to con- sider just a few components in the vicinity of τ  .  The above formulas are  valid for both the downlink and uplink transmissions. In the case of the uplink  transmission, special care must be taken, namely, in the introduction of different  delays per user  that can be accounted for in the symbols from different transmit  antennas .  τ − 0 k      l  k     6.2.1  Main System Matrices Using matrix algebra, the received vector is as follows:  v = r  SCAb  +   n   6.51   where s, C, and A are the spreading, channel, and amplitude matrices, respectively,  built in such a way that the expression in Equation 6.49 is reproduced. The receive  vector rv encompasses the messages for all receive antennas, such that  with                 v = r              t     t  r rx r rx  = 1  = 2  cid:20   r rx  =  NRX      t          Note that the channel matrix encompasses not only the channel coefficients  but also the filter’s coefficients. The spreading matrix accounts for the spreading  and scrambling codes, as well as for the delays between users and channel replicas.  The channel matrix accounts for the fading coefficients for all links between each  transmit and receive antenna. For simplicity, the spreading matrix for the downlink  will be described, and the assumption that the spreading and scrambling codes are       268  ◾  MIMO Processing for 4G and Beyond  the same for all the transmit antennas will be made, having a direct effect on both  the spreading and the channel matrix. The other structures remain the same, for  both the downlink and uplink transmissions.  6.2.1.1   Downlink with Equal Scrambling for All Transmit   Antennas—S and C Matrices  The  downlink  spreading  matrix  s  has  dimensions   SF ⋅ N ⋅ NRX + ψMAX ⋅ NRX  ×   K ⋅ L ⋅ N ⋅ NRX   ψmax is the maximum delay of the channel’s impulse response,  normalized  to  the  number  of  chips,  ψmax   where  Tc  is  the  chip  period ,  and  it  is  composed  of  submatrices  sRX  in  its  diagonal  for  each  receive  antenna  s   Each  of  these  submatrices  has  dimensions   .  SF ⋅ N + ψmax  ×  K ⋅ L ⋅ N , and they are further composed of smaller matrices  L, one for each bit position, with size  sF + ψMAX  ×  K ⋅ L . The sRX matrix struc- sn ture is made of s  diag  s  ]  with  =  τ  RX NRX  ,… ,  ,… ,   Tc  = RX 1  RX =[ s  max  =  s  s    ,  =  ε  ε  ,N  ,1  S  ε,n  =  0    SF     ⋅ − ⋅ ×   K L       n 1 L S n  0    SF  ⋅ ⋅  N-n  K L  ×               .                 L matrices are made of K ⋅ L columns  s  The sn Each of these columns is composed of  L n  =[ s  col  =1, =1 ,  k  l  n  … ,  ,  s  col   = k K L n ,l=  ,  ] .     s  col    , kl n  =    0 × 1 delay      l     ,  c  n  k     × 1  SF  ,  0 × 1 ψ       MAX  −  delay  l        T ,    where cn k  is the combined spreading and scrambling for the bit n of user k.  These sL matrices are either all alike, if no long scrambling code is used, or dif- ferent, if the scrambling sequence is longer than the SF. The sL matrices represent  the combined spreading and scrambling sequences, conjugated with the channel  delays. The shifted spreading vectors for the multipath components are all equal to  the original sequence of the specific user  s  L n  =  n  s 1 1 1 , , ,  cid:30   s 1 ,  SF n 1 , ,          s 1 1 , ,  cid:30   n  K  s  L n ,  1 1 , , ,  cid:30    cid:31   cid:31   cid:31   cid:31   cid:31   cid:31   cid:29    cid:29   , , FF n 1  K S ,  s  SF L n ,  ,  s 1 ,   cid:29    cid:29   .          s  K L n , 1 , ,  cid:30   s  K SF L n ,  ,  ,  Note that, to correctly model the multipath interference between symbols, there  is an overlap between the sL matrices, of ψmax. As opposed to the SISO multipath  case, the matrix is not trimmed for the last multipath components.      MIMO Optimized for W-CDMA  ◾  269  The  channel  matrix  C  is  a   K ⋅ L ⋅ N ⋅ NRX  ×  K ⋅ NTX ⋅ N   matrix,  and  it  is   composed of NRX submatrices, each one for a receive antenna  Each CRX matrix is composed of N matrices CKT alongside its diagonals.  C  =        C  =RX 1  cid:20   C  RX N RX  =        .  C  RX  =   cid:19   KT C 1, RX        .        C  KT , N RX  Each Cn RX KT ,   matrix is  K ⋅ L  ×  K ⋅ NTX  and represents the fading coefficients  for the current symbol of each path, user, transmit antenna, and receive antenna.  The matrix structure is made up of further smaller matrices alongside the diagonal   with CT of dimensions L × NTX,  of Cn RX , KT , representing the combination of fading coefficients and filters’ coefficients for the  user’s multipath and txth antenna component.  T C n RX K K ,  T C n RX K ,  1 … , =  diag  ,  C  KT n RX ,  =        ,  =  ,  ,  By defining  c       k , , n rx tx l  ,   cid:24   ∑ '  α      k − , n n rx tx l  ,  ,  ' n  ' p n T   C  −  k     τ      l  −     τ  k   0    ,   6.52      we have  c 1 ,  1 1 , ,  RX  cid:30    cid:31   c 1 ,  1 ,  TX  RX N ,  cid:30   c 1 ,  RX L 1 , ,   cid:31   c 1 ,  RX N  ,  TX  ,  L  KT Cn RX ,  =   cid:29                           c  c  ,, , 1 1  ,  K RX  cid:30   , , 1 K RX L  ,   cid:31    cid:31   c  c  , 1  TX  ,  K RX N ,  cid:30   K RX N  ,  ,  TX  ,  L  The A matrix is a diagonal of dimension  K ⋅ NTX ⋅ N  and represents the ampli- … , ,    tude of each user per transmission antenna and symbol, A A  diag   A  … , ,  NTX  111 , ,  A  A  =  11 , ,  .    1 … , , ,  N  TX  ,  K N  ,  N  TX  ,  K                  270  ◾  MIMO Processing for 4G and Beyond  6.2.1.2   Different Scrambling for All Transmit Antennas and   Uplink Modifications—S and C Matrices  The previous s and C matrices assume that all antennas use the same spreading and  scrambling code. However, when not operating under full-loading conditions, best  results are obtained when different scrambling sequences are used at each transmit  antenna, in order to increase diversity.  Therefore, the main changes to the matrices would be the sn  L  submatrix for the   s matrix  n  s 1 1 1 1 , , , ,  cid:30    cid:31   ,  n  TX  s N , , , 1 1 1  cid:30   s 1 ,  SF  ,, , , 1 1  n   cid:31   s 1 ,  SF N  , , 1  TX  ,  n  s  L n  =   cid:29   s L n 1 , , 1 1 , ,  cid:30    cid:31   s 1 1 , ,  ,  n  TX  L N ,  cid:30    cid:29   s 1 ,  SF L n , , 1  ,   cid:31   s 1 ,  SF L N  ,  ,  TX  ,  n  s  KK  n  , , , , 1 1 1  cid:30    cid:31   s  K  ,  n  TX  , , , 1 1 N  cid:30   s  K SF  ,  1 , ,, , 1  n   cid:31   s  K SF N  , , 1  ,  TX  ,  n   cid:29   s  , , K L n 1   cid:31   s  K L N  , , 1  ,  TX  ,  n  , , 1  cid:30    cid:29   s  , , 1 K SF L n  ,  ,   cid:31   s  K SF L N  ,  ,  ,  TX  ,  n  ,                  cid:31   cid:31   cid:31   cid:31   and the CKT submatrix for the C matrix        c , , 1 1 1   cid:30   c , 1  L  , 1   cid:31    cid:30    cid:31   c  N  , , 1 1  TX  cid:30   CKT  =  c  N  TX  ,  L  , 1   cid:31                            .                           c , , 1 1  K   cid:30   c 1 ,,  , L K   cid:31    cid:30    cid:31   c  N  , , 1  K  TX  cid:30   c TX N  ,  , L K      MIMO Optimized for W-CDMA  ◾  271  For the uplink transmission, the s matrix should also portray the delays between  L should thus be  different users  in this case, different transmit antennas . The  sn adjusted, with the columns being shifted either upwards or downwards, depending  L matrix  on the offsets between users. Note that the size  number of lines  of the sn can be increased, to account for the delays between users. Although the final s  matrix can have a bigger number of lines than for the downlink case, its overall  structure remains the same.  6.2.1.3  Design of the Remaining Structures The resulting matrix from the sCA operation  henceforth known as sCA matrix   is depicted in Figure 6.5. It is an NRX ⋅  N ⋅ SF + ψmax  × NTX ⋅ K ⋅ N matrix, and it  is the reference matrix for the decoding algorithms. Note that the SCA matrix is  sparse in nature.  The resulting sCA matrix will have the same size as before; only the number of  operations increases while constructing the sCA matrix  the sC multiplication has  an increase in complexity equal to the number of transmit antennas , since values  from different antennas must be treated differently.  Vector b represents the information symbols. It has length  K ⋅ NTX ⋅ N , and it   has the following structure:     b  =    b 1,1,1  … ,  ,  b  N  TX  ,1,1  … ,  ,  b 1,  K  ,1  … ,  ,  b  N  TX  ,  K  ,1  … ,  ,  b  N  TX  ,  K N  ,  T    .      6.53   Note that the bits of each transmit antenna are grouped together in the first  level, and the bits of other interferer in the second level. This is to guarantee that  the resulting matrix to be inverted has all its nonzero values as close to the diagonal  as possible. Also note that there is usually a higher correlation between bits from  different antennas using the same spreading code than between bits with different  spreading codes.  NtxKN  SF+ψmax  SF  NtxK  Nrx NSF+ψmax   rx antenna 1 NSF+ψmax  rx antenna Nrx NSF+ψmax  Figure 6.5  Layout of the SCA matrix.      272  ◾  MIMO Processing for 4G and Beyond  Amplitude estimator  Channel estimator  Spreading codes  MIMO receiver  Compile matrices  Receiver algorithm  Noise estimator  Demultiplex and  Demodulate Bit decision  Figure 6.6  MIMO receiver for W-CDMA schemes.  Finally, the n vector is a  N ⋅ SF ⋅ NRX + NRX ⋅ ψmax  vector with noise compo-  nents to be added to the received vector rv, which is partitioned by NRX antennas  r v   = 1,1,1  r     … ,  ,  r 1,  SF  ,1  … ,  ,  r N  … ,  ,  r N SF  ,  ,1,1  +ψmax  ,1  … ,  ,  r N NRX  ,1,  … ,  ,  r NN ,  SF  +  ψmax  ,  N  RX  T        6.54    the delay ψmax is only used for the final bit, though its effects are present through- out rv . Figure 6.6 illustrates the main blocks from which the receiver is compiled. If transmit diversity is applied, the b vector should be arranged accordingly,   with replicas  after multiplexing  for each antenna.  6.2.2  Receiver Schemes Using the System Matrices Equalization-based  receivers  such  as  the  MMSE  and  ZF  take  into  account  all  effects that the symbols are subject to in the transmission chain, namely, the MAI,  ISI, and the channel effect. Using as basis the  unnormalized  matched filter output   obtained by applying the Hermitian to the sCA matrix and multiplying by the  received vector   y  MF  =    SCA r v  H        R A C  =  ⋅  H  ⋅  H  S  ⋅  S C A  ⋅  ⋅     and defining r as           the equalization matrix  EM  for the MF and ZF can be written as  E  M MFZF  ,  = ,   R  where the normalized MF estimate is given by   6.55    6.56    6.57                    6.58    6.59    6.60    6.61   MIMO Optimized for W-CDMA  ◾  273  and the ZF estimate as  y  NMF  =  diag  E  − 1 M MFZF  ,        y  MF  ,     y  ZF  = − 1 E M MFZF ,  y  MF  ,     which is simply applying the inverse of all effects the message was subject to. Once  again, to prevent an ill-conditioned matrix for inversion  the EM might become ill-con- ditioned when the system is fully loaded [Divsalar et al. 1998], depending on the cross- correlations between the users’ signature sequences , a small value  e.g., 1e−6  should  be added to all elements in the main diagonal of the EM. In order to avoid round-off  problems, the EM should be rounded at a value above the minimum machine precision.  From [Kay 1993], the EM    The MMSE estimate aims to minimize E  b  b−  cid:22  2    .  includes the estimated noise power σ 2, and is represented by  The MMSE estimate is thus  E  M MMSE  ,  =  R  + σ 2 .   I  y  MMSE  =  = cid:22  b  E  −1 M MMSE ,  y  MF  .     Both the ZF- and MMSE-based receivers are seldom used due to their perceived  complexity, especially for wideband MIMO systems  with frequency-selective fading  channels . Owing to the multipath-causing ISI, the whole information block is usu- ally decoded at once  although there are some decoding variants in which the block is  divided into smaller blocks [Shoumin and Zhi 2004; Silva et al. 2005], requiring some  overlapping between symbols, in order to provide the best results , requiring the use  of a significant amount of memory and computing power for the algebraic operations. However, if the sparseness of the matrices is taken into account, only a fraction  of the memory and computing power is required. As can be inferred from the pre- viously described matrices, all system matrices are sparse in nature and consist of  submatrices that are sparse themselves.  The  most  troublesome  matrix  to  deal  with  is  the  EM,  due  to  its  inversion   more  precisely,  the  resolution  of  the  equation  system  leading  to  the  final  esti- mate .  Fortunately,  the  EM  is  also  sparse,  being  possible  to  handle  it  with  sim- plicity.  For  instance,  considering  a  maximum-loading  simulation  case  using  16-QAM modulation, SF = 16  i.e., 16 physical channels , L = 2 multipaths  with  the second multipath with a 1 chip delay, resembling the Indoor A or Pedestrian  A channel , a MIMO of 2-transmit 2-receive antenna system, and a block size of  1024 bits  N = 256 symbols, with 4 bits per symbol  per each physical channel       274  ◾  MIMO Processing for 4G and Beyond  0   a  1000  2000  3000  4000  5000  6000  7000  8000   b   0  50  100  150  200  250  0  0  1000 2000  3000 4000 5000 6000 7000  8000  50  100  150  200  250  Figure 6.7  Equalization matrix for a two-tap channel,  K = 16, NTX = 2  a , and  diagonal close-up for the same case  b .  ⋅  ⋅        96,  ⋅ 3 2 =  of  each  transmit  antenna,  the  matrix’s  diagonal  width   MDW ,  which  in  this  case is     is roughly 1.2% of the matrix’s width  MW  of   K = 16  ⋅  NTX = 2  ⋅  N = 256  = 8192, MDW = 1.2% MW.  K L NTX  Another aspect of the EM is that it is Hermitian positive definite, and thus it can  be decomposed using the Cholesky decomposition. Since it is a banded matrix  with  all elements concentrated on its diagonal , there is no Cholesky fill-in since the band  is dense  cases with small chip delays  Figure 6.7  , and thus it presents itself as if the  sparse reverse Cuthill–McKee ordering algorithm [Liu et al. 1981] had been applied  to it  a good preordering for lower upper factorization of matrices  LU  or Cholesky  factorization of matrices that come from long, skinny problems . The next section  introduces a detailed description of the EM, and enhanced algorithms to solve it.  6.3   Enhanced Algorithms for Solving the Equalization   Matrix  In this section, the complexity of the solution to the LMMSE and the ZF receiver’s  equations is studied. It will be shown that the equation can be solved with opti- mized Gauss, Cholesky, or block-Fourier algorithms, and thus saved some opera- tions when using the normal Gauss method, which has a complexity of d3, d being  the number of lines columns of the matrix to be inverted. Some of these solutions  are very computationally efficient and thus allow for the use of the LMMSE in fully  loaded MIMO systems.  6.3.1  Matrix Reordering Matrix reordering is used in order to simplify solving the MMSE equation. While  in the original version, the sCA matrix is devised in such a way as to make the       MIMO Optimized for W-CDMA  ◾  275  received vector partitioned per receive antenna in order to make the system matri- ces more perceivable, the reordering of the structure of the sCA matrix is done  solely to simplify the processing.   cid:22  = MMSE   and  e  y  = order    V   in  the  r  Replacing  T = order sCA ;  n = σ 2I;  d  MMSE equation, a simpler version is obtained:   cid:22  = d     H  − ,    H1 T T N T e  +    where order x  represents a line reordering of vector or matrix x, where the lines  of each antenna are intercalated with the purpose of making a more compact and  almost block-circulant matrix   6.62   order x      =   6.63                  x TX x TX    ,:  1 1   ,:   = 1  = 2  cid:20   =  x TX N TX  cid:20    N    N 2  cid:20   x TX x TX  = 1  =  1   ,:                ,:    ,:  ,:   x = TX NTX     N           Figure 6.8 shows the reordering result for a two-antenna matrix. For high SNRs, Equation 6.62 becomes the ZF detector equation:   cid:22  = d     − .   H H1 T T T e   6.64   Since usually τMAX ≤ SF, the THT product results in a square matrix with the  structure presented in Figure 6.9 with a = 2 KNTX and n = KNTXN. It can be shown  that TH T is a positive-definite Hermitian matrix.  Earlier works [Machauer et al. 2001; Vollmer et al. 2001] dealt only with the  ZF detector equation for constant-channel situations. Here, the validity of those  algorithms for unsteady channels situations will be evaluated. New algorithms for  unsteady channel situations will be proposed and some optimizations will also be  presented in pseudo-code form. Finally, all the algorithms will be adapted to the  LMMSE detector.  6.3.2  Standard Algorithms for the Exact Solution Equation 6.64 can be written as an Ax = b system with A being a positive-definite  Hermitian matrix, where A = T H T, x = d cid:22 , and b = T He. It can be solved for x using       276  ◾  MIMO Processing for 4G and Beyond  KNTxN  KNTx  SF  tmax  SF  tmax  x a m t + N F S  X R N   X A M  τ + N F S    SCA  T  Figure 6.8  Line reordering sample of SCA matrix for NTX = 2.  1  2  a  a 2  n  a 2  3  4  NTx SF  NTXtmax  d-1  d  Figure 6.9  Typical correlation matrix of the EM.  the Gauss elimination or the Cholesky algorithm. Since the Ax = b system needs to  be solved for a particular b vector only, there is no need to invert the A matrix. The  Gauss elimination can be used to transform the Ax = b system in a ux = b′ where  u is an upper triangular matrix and then x can be obtained by direct substitution.  The Cholesky method is a little bit more complex: first A is factorized in A = uHu       MIMO Optimized for W-CDMA  ◾  277  by the Cholesky algorithm, then uHux = b can be decomposed in uHc = b and  ux = c; these two systems can be solved by direct substitution. The Cholesky algo- rithm can save almost half of the floating point operations needed in the Gauss  elimination because it takes advantage of the symmetry of the A matrix, but the  Gauss elimination is less complex and requires no square roots to be calculated.  Table 6.2 shows the number of floating point operations required by both meth- ods. The additions are separated into real and complex  R+ and C+, respectively .  The extra operations wasted by the Gauss algorithm are partially recovered in the  substitution phase, where the Cholesky method requires the solution of two trian- gular systems and hence twice the operations of the Gauss algorithm. The number  of operations required in this phase is also included in Table 6.2. The “Order” col- umn presents the highest power of the total number of operations considering each  multiplication–addition pair as a single operation.  6.3.2.1  Optimizations A generic positive-definite Hermitian matrix that is nonzero only in equally over- lapped squares centered along the diagonal is represented in Figure 6.10.  Table 6.2  Number of Floating Operations Needed to Solve the Ax = b  System with Standard Methods  Gauss  2  n  Cholesky  2  n  ÷  − 2  − 2  n  n  ×  − 3  − 6  3 n  3 n  n  n  C+  3 n  n  − 3  R+  0  3 n  −  +  n 2  23 n 6  2  n  n  + 2  √ Subs÷  Subs × C+ Order  n  2  n  n  − 2  2n  n2 – n  n3 3  n3 6  0  n  d  a  1  n  2  b  3  a–b  d-1  Figure 6.10  Generalized EM.      278  ◾  MIMO Processing for 4G and Beyond  +  =  −        n  a b    The number of overlapped squares is d  . 1  The Gauss algorithm  can be optimized for this type of matrix by eliminating the operations involving  zero elements. The idea is presented in Figure 6.11.  First, the standard Gauss algorithm is applied to the r1 square submatrix. There  is no need to change the r4 rectangle. The next step is the elimination of the r2  block using the last a–b pivots of r1  the pivots are the diagonal elements after the  elimination phase . During this phase, r3 is updated. Finally, the standard algo- rithm is applied to r3. This process is repeated until all blocks are updated. During  this process, as each line is updated, the correspondent element of vector b is simul- taneously updated. Note that the matrix diagonal is fully contained in the diagonal  squares. Table 6.3 presents the number of floating point operations required in each  of the three described phases.  1  a  r1  r4  2  b  r2  r3  3  n  a–b  d–1  d  Figure 6.11  Optimized Gauss algorithm for the EM.  Table 6.3  Number of Floating Point Operations  Needed for the Optimized Gauss Algorithm  Phase  r1  r2  r3  ÷  − 2  2  a  a  b a–b   2  b  b  − 2  × C+  3  a  a  − 3  3  a 3  2  a− 6 16  3  b  b  − 3      leading to           and  MIMO Optimized for W-CDMA  ◾  279  The total number of operations can be calculated from  N  GaussOpt  =  N  Gauss r  1  +     d  −  1    N  Gauss r  2  +  N  Gauss r  3   6.65         ,     N  ÷ GaussOpt  =   n a   −  b 2  −  1 2    −  a a    b   ,  − 2      6.66   N  × GaussOpt  =  +  N C GaussOpt − a 9  3  =  n  18  a  2  + 16 b 48    b b  2  −    − 1  a  3  9  a  −  2  a  2   + b 8 48 b    + 16 3b  9   6.67   .     A similar adaptation can be developed for the column-Cholesky factorization  algorithm  link node , portrayed in Figure 6.12  note that similar results could be  achieved for the line version of that algorithm . The algorithm is optimized accord- ing to the specific matrix structure of the EM in Figure 6.13.  In  this  case,  only  the  upper  triangle  has  to  be  accessed.  First,  the  standard  column-Cholesky algorithm is applied to the r1 triangle. In a second step, the rect- angle r2 is calculated accessing only the elements of r2 and r1. In the next step, the  triangle r3 is computed using only elements of r2 and r3. The last two steps are  repeated for all remaining blocks, using only elements of the last and current block.  As in the optimized Gauss algorithm, the rectangular blocks do not contain the  diagonal. Table 6.4 presents the number of floating point operations of the three  phases described.  for j  j  = 1 , n = − 1 1 , for k = , j n for i = a a ij ij a jj = + j =  = a jj for k aa  1 , a a   kj  n  kj  jj  −  a ik  ⋅  a  jk  Figure 6.12  Column-oriented Cholesky factorization.      280  ◾  MIMO Processing for 4G and Beyond  a  1  n  r1  2  b r2  r3  3  a–b  d-1  d  C+  23 a 6  Figure 6.13  Optimized Cholesky algorithm for the EM.  Table 6.4  Number of Floating Point Operations Needed for the Optimized  Cholesky Algorithm  ×  − 6  3  a  a  ÷  − 2  2  a  a  b a – b   Phase  r1  r2  r3  b 2  a       − b  2  −  a  +  b    b 2  a       − b  2  −  a  +  b    2  b  b  − 2  a 2  b 6  2     b  −  b    −  2     b 2  −  b 3  +  1    2     b  −  b    −  2     b  −  1    ab  −  b 3  2  b 2  +  b 2  R+  + 2  0  √  a  0  b  3  a  −  +  a 2  2  a  a  The total number of operations can be calculated from  N  Chol Opt  =  N  Chol r  1  +     d  −  1    N  Chol r  2  +  N  Chol r  3   6.68      ,     a 2     leading to           N  ÷ Chol Opt  =   n a   −  b 2  −  1 2    −  a a    b   ,  − 2     N  × Chol Opt  =  n     a 2 2  −  a 2  +  b    +  2  b 2 6  + −  b  1 6    −  a     a 2 3  a 2  −  b    +  2     +  b      b 6  +   6.69      , 1     6.70       MIMO Optimized for W-CDMA  ◾  281  N  C + Chol Opt  =  n     a 2 2  −  a 2  +  b    +  2  b 2 6  +  b 2  +  1 3    −  a     a 2 3  a 2  −  b    +  1    +  b     b 6  +  N  R + Chol Opt  =   n a   −  b 2  +  1 2    +  a b 2    −  a   ,     N  Chol Opt =  n.     Both Gauss and Cholesky methods need final substitution phases. These substi- tutions can also be optimized since the resulting matrices have a structure similar  to the original A matrix but with nonzero elements only above  or below  the diago- nal, as shown in Figure 6.14.  The solution of a system Ax = b with A having a structure similar to the struc- ture presented in Figure 6.14 requires one division for each line of the matrix and  one pair multiplication–addition for each nonzero element. − a  Since there are d a      nonzero elements,       1        2  −  −  −  −  −  2  2  d  b  b  a  a                    2  the needed number of floating point operations can be written as:  N  ÷ SubsOpt  =  n     N  × SubsOpt  =  N  +  C SubsOpt  =   n a   −  b 2  −    − 1     b  −  a a 2  .       1  ,  22    6.71    6.72    6.73    6.74    6.75                  a  1  b a–b  2  n  3  d-1  d  Figure  6.14  Resulting  matrix  structure  after  Gauss  elimination Cholesky  factorization.      282  ◾  MIMO Processing for 4G and Beyond  We are interested in a special type of block-diagonal positive-definite Hermitian   matrices, with     b  a=  2,     6.76   as the one represented in Figure 6.9. Rewriting the above equations for this special  case and keeping only the n-dependent terms  n ≫ a  results in Table 6.5. Figure  6.15 presents the optimized version of the Cholesky algorithm. A block version of  the optimized Cholesky algorithm was developed to take advantage of the basic  linear algebra subprograms  BLAS . In this version, element-by-element and vector- by-vector operations were transformed in matrix operations that can be more easily  optimized by sublayer software or even be executed in dedicated hardware. Figure  6.16 presents such an approach.  The optimized Cholesky algorithm can save almost 30% of the number of oper- ations required for the optimized Gauss algorithm, despite its increased complexity  and need of square root operations.  6.3.3  Partial Cholesky Approximation The  Cholesky  decomposition  of  block-Toeplitz  matrices  is  an  upper   or  lower   matrix approximately block-Toeplitz with the same block size as the original matrix.  This means that the u matrix can be approximated by calculating only the first L  block-rows and assuming that the remaining block-rows are identical to the last  calculated block-row.  Looking at u in Figure 6.17, only the dark shaded part is computed. The last  computed block  marked as L  is then repeated until the full matrix is completed.  This  approximation  is  very  effective  when  the  channel  is  constant.  Figure  6.18  shows the maximum relative error to the solution without any approximation, for  each approximation level  L , that is, the number of calculated blocks, for different  speeds in a Pedestrian A channel with 1 antenna.  As can be seen for a constant channel, calculating only the first one or two  blocks allows approximations in the system solution with relative error below 10−4  or 10−9. This can be used to greatly reduce the number of operations necessary to  solve the system. If only two blocks are calculated, the number of operations can be  reduced approximately by a factor of a n. When the channel changes, even slowly,  this approach cannot be used due to the high errors.  6.3.4  Partitioning Partitioning  the  block-diagonal  system  Ax = b  would  be  very  useful  to  reduce  the number of floating point operations needed to solve the system  if no overlap  is used; i.e., in good channel conditions  and could also permit the introduction  of parallelism in algorithms that are intrinsically sequential, like the algorithms       MIMO Optimized for W-CDMA  ◾  283      1 −  a  3 4   n  1 −  a  3 4   n  2  −  a  3 2   n  2  −  a  3 2   n      n 2−  2 n  n – 2 n  n 2−  2 n  n – 2 n  + C   s b u S  × s b u S  ÷ s b u S  n  n 2  n  n 2  0  n  0  n   1 2  +  a  3 4   n   1 6  −  a  2  −  2 a  4 7 2    n    8  +  a 8 1 −  2 a 7    n  4 2   1 2  −  a  3 4   n  + R  0  n 2+  2 n  0  + C  n 3−  3 n  6  4 2  n 2  +  2 n 3  −  3 n  ×  n 3−  3 n  n 6−  3 n  4 2     8  −  a 8 1 −  2 a 1 1 n       8  −  a 8 1 −  2 a 1 1   n  ÷  n 2−  2 n  n 2−  2 n   1 2  −  a 3 4    n  y k s e o h C  l  s s u a G  y k s e o h C  l  s s u a G     2   a   =   b n e h W d e d e e N       s n o  i t a r e p O    t n o P  i    g n  i t a o l F   f o    r e b m u N     5  .  6    e l b a T      284  ◾  MIMO Processing for 4G and Beyond  Figure 6.15  Matlab code for the optimized Cholesky algorithm for the EM.  for j=1:NB:n-NB  JNB = j+NB; JNB1 = JNB-1; J2NB1 = j+2*NB-1;  M j:JNB1 , j:JNB1   = ccholesky M j:JNB1, j:JNB1 , NB ;  M j;JNB1, JNB:J2NB1   = M j:JNB1, j:JNB1 ' \M j:JNB1, JNB:J2NB1;  M JNB:J2NB1, JNB:J2NB1  =  M JNB:J2NB1, JNB:J2NB1   -M j:JNB1, JNB:J2NB1 '  * M j:JNB1, JNB:J2NB1 ;  end  j = j+NB; JNB1 = j+NB-1; M j:JNB1, j:JNB1  = ccholesky M j:JNB1,j:JNB1 , NB ;  Figure  6.16  Matlab  code  for  the  block  version  in  the  optimized  Cholesky  algorithm.  presented in the previous sections. In this section, different partitioning approaches  will be discussed.  Since A is block-diagonal and has generally decreasing values as we get farther  from its diagonal, it is expected that it can be divided into smaller matrices that  produce smaller systems whose combined solutions would approximate the solution  of the original system.  Figure 6.19 presents a sample solution of a system divided into two  Figure 6.19a ,  with the division sketched in Figure 6.20, and four  Figure 6.19b  subsystems. Note       MIMO Optimized for W-CDMA  ◾  285  a  1  a 2 2  n  L  L  L  L  L  Figure 6.17  Structure of the U matrix for the partial Cholesky approximation.  r o r r e   e v i t a l e r   s b a   x a  M  100  10–5  10–10  10–15  0 km h 1 km h 10 km h 100 km h  0  50  100  150  200  300  350  400  450  500  250 L  Figure 6.18  Relative error to the ZF solution when using the partial Cholesky  approximation, for the Pedestrian A channel with k = 1.  that there are two m × m blocks completely ignored at the middle of the A matrix.  Surprisingly, the maximum relative error is only 12% of the exact solution. Figure  6.19b shows the same data when the A matrix is divided into four slices. The maxi- mum error level is approximately the same as in the previous case, but now there  are three high error regions.      286  ◾  MIMO Processing for 4G and Beyond   a   r o r r e   e v i t a l e R  100 10–1 10–3 10–5  10–10  10–15  10–20   b   r o r r e   e v i t a l e R  100 10–1 10–3  10–5  10–10  10–15  0  20  40  60  120 140 160 180 200  0  20  40  60  120 140 160 180 200  100  80 Chip index  100  80 Chip index  Figure  6.19  Relative  error  to  the  ZF  solution  for  the  Pedestrian  A  channel,  obtained solving a  nonoverlap  partitioned system when M = 192, m = 12, for the  cases of D = 8  192  8 ×12  = 2 blocks  and v = 10 km h  a , D = 4  192  4 × 12  = 4  blocks  and v = 10 km h  b .  Dm  m  M  Figure 6.20  Partitioning without overlapping scheme.  Although the error obtained with the last partitioning method is not extremely  high and appears only around the division lines, much better results can be obtained  if overlapping partitions are considered.  This proceeding is sketched in Figure 6.21. Each slice overlaps the last in 2 × lap  blocks  where lap is the number of blocks that are discarded from each overlapping  side of each computed slice . Note that the last slice can be smaller. From each  slice  D − 2lap m values are obtained for the solution vector x, except in the case  of the first and last slices, where  D − lap m and M −   L − 1 D + lap m values are  obtained, respectively.      MIMO Optimized for W-CDMA  ◾  287   L–1 DM  DM  m  M  2 lap  M- L-1 Dm  Figure 6.21  Partitioning with overlapping scheme.  As seen in Figure 6.19, the error level rises at the beginning and end of each  slice, so the overlapping method should discard these values. In each interaction,  lap × m values are discarded from the beginning and lap × m values from the end,  except in the first end last slice, where only the last lap × m and first lap × m values  are discarded, respectively. The algorithm is presented in detail in Figure 6.22. An  alternative to have a final slice with size smaller than the early ones is to extend the  b vector with zeros until M m − 2lap becomes a multiple of D − 2lap.  Several  simulations  were  run  for  different  channel  changing  speeds   using  the  Pedestrian A channel . Similar results were obtained for all matrices tested. Sample  results are presented in Table 6.6 and Figure 6.23, for a v = 10 km h condition. All the  values presented should be multiplied by the corresponding column factor to obtain  the maximum error of the partition algorithm relative to the exact solution of the  original Ax = b system. The column for lap = 0 corresponds to the lap-less situation. Table 6.6 shows that the maximum error level depends almost exclusively from  the overlapping level, so the proper overlapping can be easily selected just by know- ing the maximum error allowed in the real system. The number of blocks D pro- cessed by each thread can be selected from the total number of threads L that can  be executed simultaneously by the hardware, using the relation     L  =  M m −    D  lap  − 2  2 lap     ,         6.77   where  x  represents the smallest integer greater than or equal to x.      288  ◾  MIMO Processing for 4G and Beyond  Figure 6.22  Pseudo-code for partitioning with overlapping algorithm.  6.3.5   Solving the Equalization Matrix with the Block-Fourier   Algorithm  The block-Fourier algorithm is introduced in this section. The concept of circulant and  block-circulant matrices is boarded, in order to explain the Fourier algorithm in detail.  6.3.5.1  Diagonalizing Circulant Matrices A circulant matrix is a square Toeplitz matrix with each column being a rotated  version of the column to the left of it:  C =  2  c 1 c c 3  cid:30  c  n           c n c 1 c 2  cid:30   c  n  − 1  2  3  − 1   cid:31   cid:31   cid:31   c c n c c n c c 1 4  cid:30   cid:29   cid:30  c c 1   cid:31   3  .               6.78         The  interesting  property  of  circulant  matrices  is  that  its  eigenvectors  matrix  ′Fn  of cor-  is equal to the orthonormal discrete Fourier transform  DFT  matrix  responding dimension n.   ′Fn  can be written as  ′ = F n  n  ⋅  F n  ,     6.79       MIMO Optimized for W-CDMA  ◾  289  Table 6.6  Maximum Relative Error for the Partitioning Algorithm;  v = 10 km h  0  1  2  4  5  6  7  Factor  1.E + 00  1.E–04  1.E–07  1.E–11  1.E–15 1.E–15 1.E–15  1.E–15  Lap  3  D  0.506  0.459  0.152  0.221  0.127  0.082  0.459  0.221  0.083  0.099  0.079  0.033  0.159  0.459  0.127  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  0.911  0.494  0.494  0.494  0.105  0.494  0.640  0.194  0.190  0.082  0.059  0.494  0.845  0.009  0.090  0.123  0.123  0.247  0.021  0.063  0.042  0.038  0.898  0.123  0.063  0.637  0.037  0.222  0.817  0.505  0.020  0.038  0.646  0.623  0.015  0.036  0.642  0.552  0.416  0.018  0.047  0.572  0.432  0.504  0.090  0.033  0.420  0.284  0.252  0.378  0.005  0.066  0.479  0.232  0.432  0.504  where Fn is the nonorthonormal DFT matrix:  Fn  =  1 ω ω 2  cid:30  n   1  1   1   cid:30    1   ω  − 1  ω  4   cid:31  1 ω  cid:31  2 ω  cid:31   cid:30   cid:29  −  cid:31  n 1      2  1 − n 1     n  − 1     ω ω 2   cid:30  − 1     n  − 1        n  ω               6.80      with ω  = −e j  n  2   ;  j = −1. π       a   10–4  r o r r e   e v i t a l e R  10–6  10–8  10–10  10–12  10–14              290  ◾  MIMO Processing for 4G and Beyond   b   10–8  10–10  r 10–12  o r r e   e v i t a l e R  10–14  10–16  10–18  10–20  10–22 0  0  20  40  60  120 140 160 180 200  20  40  60  120 140 160 180 200  100  80 Chip index  100  80 Chip index  Figure  6.23  Relative  error  to  the  ZF  solution  for  the  Pedestrian  A  channel,  obtained solving an overlapped partitioned system, for the conditions of  a  D = 4,  lap = 1, v = 10 km h and  b  D = 8, lap = 2, v = 10 km h.  Using this property, a circulant matrix C can be decomposed in  = ′ − 1 C F n  Λ  ′ = F n  − 1  F  Λ ,   F  where Λ is a diagonal matrix that contains the eigenvalues of C. The Λ matrix can  be easily computed from  where diag x  represents the diagonal matrix whose diagonal elements are taken  from the x vector. Substituting C by Equation 6.81 in the linear system  and solving for x results in  Λ = diag    :,    FC 1    Cx  b=     x  = − 1 F  1Λ −  Fb      6.81    6.82    6.83    6.84   Equation 6.84 can be computed efficiently with three discrete Fourier transforms  and the inversion of the diagonal matrix Λ. The complete solution would require  3n2 complex multiplication–addition pairs for the three DFT matrix vector multi- plications; n complex divisions to invert Λ; and n complex multiplications to mul- tiply Λ−1 by Fb.      MIMO Optimized for W-CDMA  ◾  291  Using the Cooley and Tukey fast Fourier transform algorithm [Vollmer et al.  2001], the complex multiplication–addition operation pair needed to compute a  size n DFT is  C  n FFT  ⊕⊗ =  n  n  log2 2      6.85   This means that Equation 6.84 can be computed spending only n     2 complex floating point operations  considering each multiplication–addition pair  as one operation . The memory requirements to solve the system using such algo- rithm are also very modest. It is only necessary to keep in memory two size n vec- tors: the b vector and the first column of C. All operations can be made in-place  as the solution vector x replaces b. Further economy can be achieved if C is sparse   band or block–diagonal, for example .  log  +     n  3 2  2  6.3.5.2  Application to Block-Circulant Matrices A block-circulant matrix can be visualized as a circulant matrix where each ele- ment is a matrix instead of a scalar value. Consider a block-circulant matrix C PQ   composed of N × N blocks of size P × Q. If C   is block-circulant, it  must satisfy  × cid:26   NP NQ  ∈   PQ  C     PQ i j   ,  =  C  , ,  cid:31   cid:31  j       PQ i      cid:31  i  cid:31  j  = =  i        + P + j Q  −  mod 1 −  mod 1  NP   NQ  +    1 +  . 1     6.86    6.87   This means that each element of C PQ  is repeated P rows below and Q columns  to the right of it. Indices that exceed the NP lines or NQ columns wrap around  to the first lines and first columns, respectively. From now on, only square block  matrices with N × N blocks will be considered, so the N index will be omitted  for simplicity. The block dimensions of the matrix will be represented in subscript  between curve brackets, and in the case of square blocks matrices, only a dimension  is represented.  To deal with block-circulant matrices, the block-Fourier transformation needs  to be introduced. The block-Fourier matrix is defined as [Joy and Tavsanoglu 1995]  F    K     =  F N   cid:16   I  K  ,      6.88               with      292  ◾  MIMO Processing for 4G and Beyond  where FN is a nonorthonormal DFT matrix of dimension N as defined in Equation  6.79, IK is the K size identity matrix, and ⊙ denotes the Kronecker product.  Z  =  X   cid:31   Y  =  N  x 12 x   cid:30   cid:30   Y Y 2 22 N  cid:29   cid:28   cid:29   x 1 x  Y Y  x  M  1  Y  x  M  2  Y   cid:30   x  MN  Y  x 11 x  Y Y  21  cid:29           ,              6.89    6.90    6.91    6.92    6.93                        with  X ∈ circulant matrix can also be decomposed using block-Fourier transforms:  × cid:26 MP NQ . Similar to the last section, a block-  × cid:26 M N ;  y ∈ × cid:26 P Q ;  z ∈  C     PQ     = −1 Λ  F    P     F   Q   ,     PQ        where Λ PQ  is a block-diagonal matrix computed from  Λ   PQ     = diag     F C   Q        PQ      :, 1  :  Q    ,     PQ        with diag PQ  x  representing the block-diagonal matrix whose block elements are  the  P × Q-sized  blocks  of  x.  Similar  to  the  circulant  systems,  a  block-circulant  system can also be efficiently solved using the block-Fourier decomposition. The  block-circulant system  with C   P     ∈  NP NP  × cid:26   ;   x ∈  cid:26 NP ; b ∈  cid:26 NP . It can be solved with  C x  P     = ,   b  x  = − 1 F   P    1Λ −   P     .   F b      P  If  the  blocks  are  not  square,  the  Moore–Penrose  [Ben-Israel  and  Greville  1977]  pseudoinverse  concept  can  be  used.  Consider  a  block-circulant  matrix  C    with P × Q-sized blocks.  × cid:26   NP NQ  ∈  PQ  ,     C     PQ     x  =  , b C        PQ     ∈   cid:26   NP NQ  ×  ;    x  ∈   cid:26   NQ  ;     b  ∈   cid:26   NPQ P  ≤  .   6.94      The system  6.94  can be solved using the Moore–Penrose pseudoinverse of the   complex matrix C PQ   =    x  C C  H   PQ        PQ      − H1 C   PQ  , b         6.95       MIMO Optimized for W-CDMA  ◾  293           H PQ  if C C  PQ  is invertible. This solution is the least squares solution  ZF  to the  system  6.94 , as previously shown. Applying the block-Fourier decomposition of  Equation 6.90 to Equation 6.95 results in  x  =      H     − 1 F     P  Λ  F   Q        PQ     − 1 F     P  Λ  F   Q        PQ     − 1 F     P  Λ  F   Q         PQ      6.96   − 1        ⋅   H b,      PQ  defined as in Equation 6.91. Equation 6.96 can be simplified, consider-  with Λ  ing that F H   K  K= −1 F     :     x  =  − 1 F     Q    Λ H   PQ     Λ    PQ     − 1    Λ H   PQ  . F b      P        This solution can be computed with only three block-Fourier transforms, the  PQ  and the multiplication of two block-diagonal matrices by a           Λ  inversion of Λ H PQ column vector. The multiplication  must  be  performed  from  right  to  left  to  minimize  the  number  of  operations  required, since a matrix–vector multiplication is faster than a matrix–matrix one.  Regarding that  Λ H   PQ     Λ      PQ     −1    ⋅  Λ H   PQ     F b     P  ⋅      ,     NQ NQ  ×    − 1  cid:26   ∈ Λ Λ H   PQ       PQ Λ ∈ ×  cid:26  H   PQ   ∈ F b      cid:26   NP  NQ NP  ,  P      6.97    6.98    6.99   the multiplication  6.98  requires  NP + NQ NQ pairs of complex multiplications  additions. From the definition of block-Fourier transform in Equation 6.88, it can  be shown that given  y  =    F x  K  ,     6.100   , x y  ∈   cid:26   NK  ;  F    K     ∈   cid:26   ×  NK NK ,    i  y  :  K  :    N  −    K 1  +    =  i  F x N    i K N  :    :  −  1 K    +     ,  i      6.101                        with  one has      294  ◾  MIMO Processing for 4G and Beyond  with 1 ≤ i ≤ K, where FN represents a nonorthonormal DFT matrix of dimension N  as defined in Equation 6.80. This simply means that each block-Fourier transform  of block size K can be decomposed in K Fourier transforms of size N. Furthermore,  each Fourier transform can be executed independently of each other and thus the  advantage  of  parallel  hardware  implementations  can  be  taken.  Taking  this  into  consideration, recalling Equation 6.85 and considering that are needed two block- Fourier transforms of block-size Q and one of block-size P to compute Equation  6.97, the number of operations required for that three Fourier transforms is        N  ⊕⊗ C block FFT 3  −  =     Q P 2  +     N  N  2  log 2  .      6.102   There are two options to calculate [  Λ  Λ H PQ       PQ     −1 ]  :   ◾ Start by using the already-calculated Λ PQ  defined in Equation 6.91; then   in the frequency domain; and finally invert the   compute ∑ resultant block-diagonal matrix.  Λ H   PQ  Λ    QQ    PQ  =            ◾ Compute S C C    =   PQ  in the time domain; apply the Fourier transform  H   PQ F S 1  :,     Q   QQ     and then invert ∑   =   diag   QQ .  ∑     ;  Q  QQ  :                          :     PQ  H PQ    :,  Q1  In both cases, the inversion of the ∑    QQ  block-diagonal matrix is needed. Since  Λ PQ  always has to be computed for the solution of Equation 6.97, the second case  needs an extra block-fast Fourier transform  FFT  to calculate ∑   QQ  but because  this extra block-FFT only uses the first Q columns of S there is no need to compute  the remainescence. The calculation of the first Q columns of C C  PQ  is equiva- lent to C C   and requires N2PQ2 operations, while the calculation of  H PQ Λ Λ  PQ  requires only NPQ2 complex operations because Λ PQ  is block-diagonal.  H PQ Table 6.7 compares the number of operations required in both methods.  In general, the first method is less complex, but the number of operations needed  to compute the first Q columns of C C  PQ  can be reduced if C is sparse  band  or block-diagonal, for example . In that case, method 2 can become advantageous  for some matrices. Σ QQ  is block-square matrix with N × N blocks of size Q × Q.  Since Σ QQ  is also block-diagonal, it can be inverted by inverting each one of the  N Q × Q block submatrices separately. Because Σ QQ  is Hermitian positive-definite,  each block matrix is also Hermitian positive-definite and therefore can be inverted  using the Cholesky decomposition. Let Σk be the kth block of the diagonal of Σ QQ .  It can be decomposed using the Cholesky algorithm into  H PQ                 ∑k  =  r r , k  H k  1  ≤  k N  ≤  ,      6.103   where each rk is an upper triangular matrix. Each Σk can then be easily inverted by  inverting the corresponding rk:      MIMO Optimized for W-CDMA  ◾  295   Table 6.7  Number of Operations Required to Compute  Λ Λ  H PQ Two Distinct Methods        PQ       1  −  Using   Method 1  Λ   PQ     = diag  F C 1   :  :, P       Q         PQ     Σ     QQ     =  Λ H PQ       Λ     PQ     Method 2  S  =   H PQ  C C       PQ Q1st      columns    Σ   QQ     = diag  F S 1   :  :, Q       Q         QQ     Number of Operations  0  previously calculated   Number of Operations  NPQ2  N2PQ2  2  NQ  N  2  log 2  Σk − 1  =    r r  H k  k  − 1    =    r r  − 1 k     − 1 k  H  .    6.104   At this point, the straightforward way would be compute each Σ k  −1 by multiply-  independently. This would require N multiplications of   ing each pair r rk Q × Q matrix pairs, which absorb NQ3 complex scalar multiplications.    H  − 1 k  − 1     −1 A better approach is to compose r   QQ   as    r     − 1 QQ           k  −    Q 1  +  1  :  ,  kQ k  −  1   Q  +  1  :  kQ    =  r  − 1 k  ,  1  ≤  k N  ≤  .   6.105      −1 In other words, r   QQ  −1 matri- ces sequentially disposed along its diagonal. r QQ  can be viewed as the Cholesky  decomposition of Σ QQ :   is a block-diagonal matrix composed of the N r k  Therefore, Σ QQ  can be inverted as  Σ    QQ  = r  H r    QQ  QQ     .    Σ  − 1 QQ     =  r  − 1 QQ       r  − 1 QQ          H     .      6.106    6.107                296  ◾  MIMO Processing for 4G and Beyond  −1    P      .    H  In fact, it was ignored that each r k  Some operations can be saved by first multiplying   −1  F b  Next, r   QQ     by the already-cal-  r QQ culated vector obtained from Λ   is multiplied by the result- H  PQ ing vector in a similar fashion as is done in Equation 6.98. In the multiplication of  −1  by an NQ size vector, only NQ2 operations are spent, in opposition to the N2  r   QQ Q3 operations necessary to compute all N Σk  as in Equation 6.104. −1  is a triangular matrix. This means that        16     is block-diagonal with triangular blocks. Its   per block. This means     while the second con-  operations. Therefore, the best solution is to compose   matrix and ban the matrix–matrix multiplications, as deduced initially.   multiplying  by  its  transpose  conjugate  requires  only    −1 operations. In the same way,  r   QQ multiplication by a column vector requires   that the first method requires N Q 9 sumes only N Q −1 the r   QQ Rewriting Equation 6.97, we obtain  −1 blocks of Σ   −1  QQ  Q2 + N      2    16         2    + 3  6 Q  6 Q  9 Q  Q 2  N  Q  +  +  +  +  3           ⋅  ⋅  3  2  3  2     x  =  − 1 F R     Q  − 1   QQ     R  − 1   QQ     Λ   H PQ  . F b      P        H         6.108   To  minimize  the  number  of  operations,  Equation  6.108  must  be  computed  from right to left, avoiding matrix–matrix multiplications. Finally, the number of  −1  block  must  be  calculated.  The  operations  involved  in  the  inversion  of  each  r k −1 block involves a Cholesky factorization and a triangular matrix  inversion of an r k inversion. Table 6.8 presents the number of floating point operations necessary to  compute the Cholesky factor of an n × n complex matrix and required to invert an  n × n triangular complex matrix. The order column presents the highest n power  of the total operation number, considering each multiplication–addition pair as a  single operation.  Considering the data of Table 6.8, it is easy to see that the number of operations  −1 needed to compute r   approximately. To sum it   QQ up, the shortest-length least squares solution of Equation 6.94 can be computed  with the algorithms of Figure 6.24, depending on the calculation method used for  Σ QQ . The complexity of the algorithms of Figure 6.24 is given in Table 6.9.   is  N Q       , 6   Q 29  2 Q  +  +     ⋅  3  Table 6.8  Number of Operations Required by Triangular Matrix Inversion  and Cholesky Factorization of n × n Complex Matrices  Cholesky  decomposition  Triangular  matrix inversion  n  n  2  n  2  n  − 2  − 2   cid:26 ÷   cid:26 ×  3 n  n  − 3  3 n  −  +  n 2  2  n  n   cid:26 +  23 n 6  2  n  n  − 2  R+   + 6  —   cid:23 √  n  —  Order  n3 6  n3 6      MIMO Optimized for W-CDMA  ◾  297   a  Λ   ∑     PQ ← diag Λ = H PQ    QQ          PQ   Λ    PQ        F C    P           PQ      :,  : 1  Q       for k  N  k  = ∑ R R R  k − 1 k − 1   QQ  1 tto ∑← ← ← k        +  −      Q 1  k     QQ   ∑ chol   k Trian ggInv     R k + − :   ,  kQ k Q 1 1  : kQ k 1 ,   −    Q 1  +  : 1 kQ     −  1   Q  +  : kQ 1     x  ←  − 1 F R     Q  − 1   QQ     R  − 1 QQQ             H        Λ  H   PQ     F b  P                   :,  11 :  Q             ← diag PQ   = H C C   PQ PQ     = diag   F S   Q    F C PQ P         1  :, : Q   1  :, : QQ  QQ                      b  Λ S  :, 1 ∑  PQ     :  Q  QQ       for k  k  +  N  1   Q  = ∑ R k − 1 Rkk − 1 R   QQ  1 to ∑ ← k    QQ     ∑ ←   chol ←     TriangInv R k −     1 : ,  kQ k k  1   Q  −    +  k  1 : kQ k ,   −  1   Q  +  1 : kQ     −  1   Q  +  1 : kQ     =  R  − 1 k  x  ←  − 1 F     Q  R  − 1 QQ       R  − 1 QQ             H        Λ H   PQ     F    P b                         Figure 6.24  Pseudo-codes of block-Fourier algorithms to compute the shortest- length least square solution of a block-circulant system, for  a  method 1 and  b   method 2.  Considering expression  6.101  and keeping in memory only the nonzero parts  of the matrices, algorithms of Figure 6.24a and b can be simplified as presented in  Figures 6.25 and 6.26, respectively.  Owing to finite precision round errors, the rk matrices may not be Hermitian  PQ   is  Hermitian  positive-definite.  This  can  be   positive-definite  even  if  C C   H PQ               298  ◾  MIMO Processing for 4G and Beyond  Table 6.9  Number of Operations Required for the Algorithms of  Figure 6.24  Direct Correspondence between  a  and  b    Rep  Number of Operations  Step  Method 1  F P  C PQ  :,1:Q   Λ  Λ H PQ        PQ     chol ∑k   TriangInv Rk   F P b  Λ  H PQ     ⋅   ...   − 1 R QQ            k  ⋅   ...   − 1 R  QQ     ⋅   ...   − ⋅1 F  Q     ...   Method 2  F P C PQ  :,1:Q   C C   H PQ       :,  Q1:        PQ  F Q S :,1:Q   1  1  N  N  1  1  1  1  1  1  1  1  PQN  N  log2 2  NPQ2  3  Q  +  +  Q 2  23 Q 6  Q2  PN  N  log2 2  NQP2  N  N  Q Q2  Q Q2  + 2  + 2  QN  N  log2 2  PQN  N  log2 2  N2PQ2  2  Q N  N  2  log 2  Total =  N  3  Q  +  2  +  Q 8  Q 15 6      +  2  PQ QP  +  2  +  Q QP    +  +  P     N  log 2 2          MIMO Optimized for W-CDMA  ◾  299  Table 6.9  Algorithms of Figure 6.24  Direct Correspondence between  a  and  b     Continued  Number of Operations Required for the   chol ∑k   TriangInv Rk   F P b  Λ  H PQ     ⋅   ...   − 1 R QQ            k  ⋅   ...   − 1 R  QQ     ⋅   ...   − ⋅1 F  Q     ...   N  N  1  1  1  1  1  3  Q  +  +  Q 2  23 Q 6  Q2  PN  N  log2 2  NQP2  N  N  Q Q2  Q Q2  + 2  + 2  QN  N  log2 2  Total =  N  3  Q  +  2  +  Q 8  Q 15 6      +  NPQ QP  +  2  2  +  2  Q Q QP    +  +  +  P     N  log 2 2      corrected  simply  by  removing  the  imaginary  part  of  the  diagonal  elements  and  zeroing all other elements that have complex modulus below some threshold value,  before applying the Cholesky factorization. This new simplified versions require the  same number of floating point operations as derived before because null element  operations were not considered from the beginning.  6.3.5.3  Application to the Zero-Forcing Detector The solution of the ZF detector is [Machauer et al. 2001]  This is the shortest-length least squares solution of  d  =     − H1 T T T e  H     e  Td=            6.109    6.110       300  ◾  MIMO Processing for 4G and Beyond  for k  C     bb  f  f  =  1  to  :   k P N :      k P N :  :   P − 1    −   1  ,  +    P k Q 1 :   ← 1  + P k ,  ←  C    b k P N   :  FFT    PQ    :        FFT     k P N :  :    −  +  k Q ,  1 :  P 1        −    1  P  +  k  K  = 1 ← ← k ←− 1 k     ×  for k  ∑   R  R        b  x  k  f  C  N   k     ∑  to   − ff   chol TTriangInv  K     R  k    ← R      − 1   Q      k  f  +  : kQ 1  ,   1  −    1  P  +  1 :  kP    1  P  +  1 :  kP Q  1 :  ,        H  C  f       k  −    1  P  +  1 :  kP Q  1 :  ,  − 1 k      R  − 1 k  H         C  f       k  −    P 1  +  : 1 kkP Q  1 :  ,         H  for k 1   k Q N : x  =   :  to −  Q   ←   1 QQ k , 1  +  IFFT  x  f  k Q N :    :  −  Q k   1  +                        Figure 6.25  Pseudo-code for the optimized block-Fourier algorithm for the EM— method 1.  where T is not square, in general. Figure 6.27 represents different structures of T  matrices. Figure 6.27a represents the normal structure of T. T is a block matrix  with Vn blocks disposed along its diagonal.  All N blocks are equal in a constant-channel condition. Even if the channel  varies slowly, it can be a reasonable approximation to consider all Vn block equal  as will be investigated later. In a constant-channel condition, it is easy to extend  matrix T to become block-circulant, simply by adding extra block-columns to it, as  shown in Figure 6.27b. The elements below the last Va block wrap around the top  of the columns.  The number of extra columns needed to make T block-circulant is     E  =  N n  −  =   H P      −  1.     6.111   The resulting matrix is block-circulant with N × N blocks of P × Q size. This  new  matrix  will  be  represented  as  T PQ .  Now,  Equation  6.109  can  be  trans- formed in      MIMO Optimized for W-CDMA  ◾  301  =  1  to  P  for k  C     bb  f  f  :   k P N :      k P N :  :   −  1    −    1  ,  +    P k Q 1 :   ← 1  P k  +  ,  ← FFT  FFT   b       PQ  C    k P N :    :        k P N :  :    −  P  +  k Q ,  1 :  1        −    1  P  +  k       S  ←  C C  H PQ          PQ       :: , 1 :  Q     Q  =  1  for k   S f k Q N     :  to −    1 Q k Q  1 , :  +    ←  FFT        S  : k Q N    :  −    1 Q K Q  1 :  ,  +         +  kQ Q 1 :  1 :  ,     K  for k  ∑   R  R        k − 1 k  x  f  =  1  ← ← ←  to  N   S −   k Q 1   f     ∑ chol K nnv TriangI     R  k    ← R      +  : kQ 1  ,   1  −    1  P  +  1 :  kP      ×  k  b  − 1   Q      k  f  − 1 k      R  − 1 k  H         C  f       k  −    P 1  +  : kP Q 1  : 1  ,          H  for k 1   k Q N : x  =   :  to −  Q   Q k 1  +    , 1  ←←  IFFT     x f k Q N  :    :     −   1  Q k  +        Figure 6.26  Pseudo-code for the optimized block-Fourier algorithm for the EM— method 2.  ≈   cid:31  d  =          H T T   PQ       PQ     H T e T   PQ    ,     ′  PQ     ∈   cid:30   NP NQ  ×   cid:31  d  ;  ∈   cid:30   NQ  ;  e  ′ ∈   cid:30   NP  ,  − 1      6.112      and solved with the Fourier method, as done for Equation 6.94 in the last section.  The e′ vector can be obtained from e by padding at its end with  N − n + 1 P − H  zeros, and d cid:22  can be extracted from the first nQ elements of d cid:22 .  There are two approximations in the transformation of T in T PQ :   ◾ All Vn blocks were made equal.  ◾ Extra columns lines were added to the matrix.      302  ◾  MIMO Processing for 4G and Beyond   a   Q  H  V1  P  V2  V3   n–  P+H  NP   b   H  Q  Va  Vb  P Va  Vb  Va  Vb  Vb  Vb  Va  Vb  Va Vb  nQ  NQ  Vb  Va  Vb  Va Vb  Va  V4  V5  nQ  Vn–1  Vn  Figure 6.27  Block structure of the T matrix  a  and structure of the extended T  matrix for a constant-channel condition  b .  The  error  level  introduced  by  each  approximation  will  be  determined  next.  Figure 6.28 shows the relative error introduced in the solution of Equation 6.109  by considering that the Vn blocks are all equal to the first block V1. This error was  determined comparing the solution of Equation 6.109 using the original T matrix  with the solution of the same system using the block-constant version of T.  The e vector was obtained from Equation 6.110 using a random d vector:   a   10  r o r r e   e v i t a l e R  100  10–1  10–2  10–3  10–4  10–5  0   b  10 101 100 10–1 10–2 10–3 10–4 10–5 10–6  r o r r e   e v i t a l e R  100 km h 10 km h 1 km h  50  100 150 200 250 300 350 400 450 500  0  2000  4000 6000 8000 10,000 12,00014,00016,000  Symbol index  Symbol index  Figure 6.28  Relative error to the ZF solution for a constant-channel approxima- tion using the first block and the Pedestrian A channel for  a  k = 1, SISO and  b   k = SF, MIMO 2 × 2.      MIMO Optimized for W-CDMA  ◾  303      d i  =  2 2     ± ± 1     ,  j  1  ≤ ≤  i  . nQ      6.113   As it can be seen, the higher the speed, the higher the error introduced and the  quickest the divergence from the correct value as we get farther from the initial  block position. The approximation is acceptable for the first blocks, but never for  the whole d cid:22   vector, even if low speeds are considered. For high speeds, the relative  error level rises quickly above 100%.  In Figure 6.28, all the Vn blocks were made equal to the first block V1. A better  approximation would be expected if a middle block was used. Let us use the middle  block of T if n is even or the left-middle block if n is odd:  =  V V n      2         6.114         Using  this  method,  better  approximations  in  a  wider  central  range  can  be   attained, as shown in Figure 6.29. Nevertheless, the approximation is very poor for the first and last elements of the  d cid:22   vector. The last figures make it obvious that the methods presented in [Vollmer  et al. 2001] or [Machauer et al. 2001], although valid for constant-channel condi- tion, are not very useful if the channel changes, even if low speeds are considered.    r o r r e   e v i t a l e R  101  100  10–1  10–2  10–3  10–4  10–5  10–6  0  100 km h  10 km h  1 km h   200  400  600  800 1000 1200 1400 1600 1800 2000  Symbol index  Figure 6.29  Relative error to the ZF solution for constant-channel approxima- tion, using the middle block for the Pedestrian A channel, k = 1 and MIMO 4 × 4.      304  ◾  MIMO Processing for 4G and Beyond  Constant-channel conditions will be considered for the remainder of this sec- tion. First, the error level introduced by the addition of extra columns lines to the  T matrix, transforming it in the block-circulant matrix T PQ , will be determined, as  was previously explained, alongside the error of the block-Fourier algorithm. Later,  we will return to the more general case of the varying channel.  6.3.5.4  Constant-Channel Conditions Table 6.10 shows the error level introduced in the determination of vector  d cid:22   by  each phase of the detection process in 12 constant-channel situations. Each value is  the maximum complex modulus of the relative difference between the estimated   cid:22 d   and the real d obtained in 100 runs with distinct random d vectors.  The correlated values described in Table 6.10 were taken from [3GPP 2003].  A squared matrix disposition was considered for the 4 × 4 case. The “Estimation”  column indicates the maximum error of the estimation if Equation 6.109 is solved  directly.  The  “Circulant”  column  shows  the  maximum  error  introduced  by  the  extension of the T matrix to become T PQ  relative to the estimated solution. The  “Fourier1” and “Fourier2” columns show the maximum error introduced by the use  of the Fourier algorithms 1 and 2 compared with the circulant system solution.  Table 6.10  Maximum Absolute Error to the ZF Solution Introduced by Each  Phase of the Zero-Forcing Detector  Antennas Load Correlated  Estimation Circulant  Fourier1 Fourier2  Maximum Absolute Error  1 × 1  2 × 2  4 × 4  1 × 1  2 × 2  4 × 4  Min  Max  Min  Max  Min  Min  Min  Min  Max  Min  Max  Min     A n i a r t s e d e P  A   r a l u c i h e V  —  —  —  —  Yes  —  Yes  —  —  —  —  —  4.E–16  9.E–14  8.E–15  4.E–14  1.E–14  4.E–14  5.E–14  7.E–16  1.E–14  2.E–14  1.E–12  5.E–14  5.E–16  1.E–13  6.E–15  5.E–14  1.E–14  2.E–14  3.E–14  8.E–16  3.E–14  7.E–15  2.E–12  3.E–14  2.E–15  3.E–15  1.E–13  1.E–13  1.E–14  1.E–14  5.E–14  4.E–14  2.E–14  2.E–14  7.E–14  5.E–14  8.E–14  7.E–14  3.E–15  3.E–15  3.E–14  3.E–14  3.E–14  2.E–14  2.E–12  2.E–12  8.E–14  7.E–14      MIMO Optimized for W-CDMA  ◾  305  Since an SF of 16 is considered, the minimum load situation corresponds to 0  interferers while the maximum load situation corresponds to 15 interferers  with  each user having only one physical channel .  As can be seen, the errors are very low for all the tested matrices and are only  slightly above the floating point precision used. Furthermore, the T matrix exten- sion is not the main error cause. Figure 6.30 shows the error at the end of the block- Fourier algorithm relative to the original d vector for a sample case.  It can be seen that the error level is constant along the entire symbol vector and  no beginning or end high error levels appear, since no multipath interference from  adjacent blocks is being considered. Excluding the midamble from the detection  and splitting the process into two independent detections, each one involving only  data symbols, some errors can be introduced at the beginning of the second data  chunk. This can be corrected by including some symbols of the midamble in the  second detection process.  Figures 6.31 and 6.32 show the used algorithms, and Table 6.11 their complex- ity. The algorithm of Figure 6.31 is similar to that of Figure 6.25 but the algorithm  of Figure 6.32 makes use of the structure of T to save some operations. This is done  using only the nonzero elements of T and regarding that        H  A B    H  H=  B A  .      6.115   This saves the computation of the last E blocks of S :,  1:Q   .  10–12  10–13  10–14  10–15  r o r r e   e v i t a l e R  10–16  0  2000  4000  6000  8000  10,000 12,000 14,000 16,000  Symbol index  Figure 6.30  Relative error to the ZF solution introduced by the block-Fourier  algorithm  sample case .      306  ◾  MIMO Processing for 4G and Beyond  =  1  to  P  T  for k         k  e  f  f  k P N :  :   −  1    :PP N  :   −    1  ,  +    P k Q 1 :   ← 1  P k  +  ,  ← FFT  FFT      e  T      : k P N    :  k P N :  :    −  1    P  k Q ,  1 :       +      −    1  P  +  k  1  T  N to     −   k f     ∑ chol nngInv Tria  K  K  =  ∑  for k    R  R        ← ← k ←− 1 k     ×  d  e  k  f  f  −         R  k    ← R        Q 1  +  : kQ 1  ,   1  k  −    1  P  +  : 1  kP  11    P  +  1 kP Q :  1 :  ,  H        T  f       k  −  1    P  +  1 kP Q :  1 :  ,       − 1 k      R  − 1 k  H         T  f       k  −  P 1    +  kP 1 : ,  1::  Q         H  =  1  for k    d  : k Q N  :    Q to −  1   Q k  +    ← 11 ,  IFFT  df k Q N  :    :  −  Q k   1  +              Figure 6.31  Pseudo-code of the block-Fourier algorithm.  Comparing the two methods, it can be seen that method 2 is advantageous if  NPQ NQ  >  2  2  +  2  Q H HE  +  −  P  N  log 2 2     2  E  + 2  E     .      6.116   Since N ≫ Q and N ≫ H ≥ P, the last inequality usually resumes to  N  P  > log 2 2  .      6.117         Since P is the number of antennas multiplied by the spreading factor, it is easily  greater than the right side of inequality  6.117  and the block-Fourier method 2 is  in general advantageous.  6.3.5.5  Block-Fourier Algorithm with Partitioning The  algorithms  proposed  in  last  section  reveal  already  many  parallel  paths  that  could be exploited for parallel processing in adequate hardware. Nevertheless, the       MIMO Optimized for W-CDMA  ◾  307  k Q 1 : , ,   k 1    ←  ← FFT    FFT T − :     k P N :   e −     P 1 : : k P N    1   P + k  +     k Q ,  1 :        H      T : 1 H Q  1 :  ,     kP    T   H   ← S + Q Q   1  k ,  1 :  +  1 :  H Q  1 :  ,     ←←     S  H k  f  ,  1 :  + +  = P for k 1 to  T − 1   P :   k P N :     e − P   1 : P N   :: k    f ←   −   1 H P E ←         S T : Q 1 , : 1 Q 11 : H Q = for k to 1 P  ←     S T − H kp Q , 1 : 1 : k      S + +    Q Q 1 : 1 , k   kQ 1 :    S − − +   N k Q   1 N k :    = for k Q to 1 Sf k Q N − Q k Q   :   : 1   = for k N to 1  ∑   R  R      −       × e − k    f = 1 to for k Q   d − k Q N   1 Q k   :  − ∑ nngInv    S   k f   chol Tria  ← ← ←    1 Q    : kQ 1  k − 1 k    Q 1  ←  ,   1  kP    11  R    1  : 1  1 :  d  +  +  +  +  +  P  k        ,  ,  k  k  k  f  : 1 kQ Q  1 :  ,       ← R      ←     FFT     S    k Q N :  :    −  Q k 1    +  ,,  1 :  Q     − 1 k      R  − 1 k  H         T  f       k  −  P 1    +  : kP 1 ,  1::  Q  H          IFFT     d f k Q N        :  −    1 Q k  +    ,   1  Figure 6.32  Pseudo-code for the optimized block-Fourier algorithm.  algorithm remains globally sequential since it only determines the estimated d cid:22 ≈  vector at the end.  T T    =   H PQ  Figure 6.33 illustrates an approach to split the extended ZF Equation 6.112  in smaller systems. Figure 6.33 represents S   and the estimated vec- Q tor d cid:22 ≈ . The idea is to split the sQ matrix in smaller ones. This can be a reason- able approximation because the sQ has the greater values concentrated around the  diagonal and decreasing modulus as the values are further from the diagonal. This  means that each element of vector d cid:22  depends mainly on the same index value of  ′ and it depends increasingly less on the values as we get farther from  vector T e H    PQ that same index value. Since each partition just approximates well the middle values, the d cid:22  values of  the beginning and end of each partition can be discarded. The first l− and last l+   PQ         308  ◾  MIMO Processing for 4G and Beyond  Table 6.11  Number of Operations Required by the Block-Fourier  Algorithm  Step  Rep  Number of Operations  Block-Fourier Algorithm in Figure 6.31  Tf  ef  ∑k  Rk  1− R1  df  d  Tf  ef  Sk  Sf  S IQ, IQ   P  P  N  N  N  N  Q  P  P  1  1  Q  QN  N  log2 2  N  N  log2 2  PQ2  23 Q 6  Q2  3  Q  +  +  Q 2  Q2 + Q + QP2  N  N  log2 2  QN  N  log2 2  N  N  log2 2  HQ2  2  Q HE  −  P     2  E  + 2  E     QN  N  log2 2  Total =  N  3  Q  +  2  +  Q 8  Q 15 6      +  2  PQ QP  +  2  +  Q QP    +  +  P     N  log 2 2      Block-Fourier Algorithm in Figure 6.32      MIMO Optimized for W-CDMA  ◾  309  Table 6.11  Fourier Algorithm   Continued  Number of Operations Required by the Block-  Rep  Number of Operations  3  Q  +  +  Q 2  23 Q 6  Q2  Q2 + Q + QP2  N  N  log2 2  N  N  N  Q     QL  QI–  Total =  N  3  Q  +  2  +  Q 8  Q 15 6      +  2  QP  +  2  Q Q QP    +  +  +  P     N  log 2 2      +  2  Q HE  −  P  2  E  + 2  E     QI–  QI+  FQ  NQ   E–1 Q  Step  Rk  1− R1  df  d  nQ  EQ  Figure 6.33  Partitioning for the block-Fourier algorithm for d cid:22   and SQ.      310  ◾  MIMO Processing for 4G and Beyond  elements of each d cid:22  partition are thus discarded. Note that since the block-Fourier  algorithm will be applied at each partition, and because each partition has to be  approximated as a block-circulant matrix, high error will also appear in the first ele- ments of the first partition and in the last elements of the last partition. This would  not happen if each partition would be solved with an exact method like Gauss or  Cholesky. This is the reason why those elements are also discarded in Figure 6.33.  Figures 6.34 and 6.35 represent such algorithms, based on the two versions pre- sented earlier. Table 6.12 analyzes their computational requirements.  The overlapping length must be carefully selected according to the precision  required.  The  bigger  the  overlapping,  the  more  expensive  the  computation  will  be.  In  the  derivation  of  the  algorithms,  a  prelap  l−  and  postlap  l+  were  defined  in a similar way as done in [Machauer et al. 2001], but in the simulations, it will  always be used l− = l+ since there is no advantage of defining dissimilar overlapping  lengths; in fact, the best results are obtained with equal overlapping as could be  easily guessed from symmetry considerations.  The partition length can be selected according to the number of intended parti- tions and the overlapping selected, and this is usually determined by the hardware  structure.  6.3.5.6  Solving the EM for the Unsteady Channel As can be seen in the next section, the block-Fourier algorithms presented so far work  well just under constant-channel conditions or with very slow changing speeds. Even  at v = 1 km h, significant errors arise. The standard block-Fourier algorithm cannot  be adapted for unsteady-channel conditions because it just works for block-circulant  matrices, but the partitioned version can be easily adapted just by using in each par- tition a different block of the original T matrix. If the middle block in each partition  of the original T matrix is used to construct each extended approximate T PQ , the  block-Fourier algorithm can be used for each partition as done in the last section,  and   cid:22 d  obtained from the middle elements of each partition computation.  Figures 6.36 and 6.37 represent the two versions of such an algorithm. Table   6.13 analyzes the respective computational requirements.  The overlapping length must be selected according to the precision required as  for the constant channel. The bigger the overlapping, the better the approximation  but more expensive will the computation be.  The  partition  length  now  must  also  be  selected  according  to  the  precision  required: bigger partitions will yield faster results with small precisions, whereas  smaller partitions will require too much computational power. Partition and over- lapping length can also be determined by the hardware structure available, if some  kind of parallel processing is available in an already-developed hardware platform.  Also,  very  small  partitions  or  very  long  overlapping  can  become  incompatible,  making the required error level just not attainable for high-speed channels.      MIMO Optimized for W-CDMA  ◾  311  function  d  =  BFPC  1    LP Q e n Q P H L l 1   : , T   , ,  1 , :  ,  ,  ,  ,  +  −  ,  l     e  ′ =    0     ; ; e 0     Fl  −  Pl  +  l  + − +  n  1    P  −  HH       +  k Q ,  1 :     ←    FFT  T    : :   k P L  −  1    P  +  k Q ,  1 :        P  +  1 :  kPk Q  1 :  ,    H    T  f       k  −    1  P  +  1 :  kPk Q  1 :  ,     +  = N n = − − l L l =   F N l   ←  H P E     −  11  H P   − + l   −  1  for k T    = 1 : k P L    f  to −  P 1 P    k  for k  ∑  RR   R   k − 1 k  = ← ← ←  1 to L     T −     k 1 ∑   chol   TrianInv  k  f     R  k     P  F to −   P 1 LL to  f  k  d  = to for f 1 =  for k 1    e :    k P : L  f  = k for 1     −       ×  e ff   k  = for k 1     d :   k Q L  ′   d − f    == ′d  : d  1 nQ     l  1   Q  +  1 : kQ  ,   1  ← R      1 :  kP  +  −   1 P to Q − 1   Q k  +  lQ   1  +  1 :  flQ  +    ← , 1  k     FFT  e  ′     f  −    lP 1  +  k P  :  :    fl  +  −  l  +  +  l  −  1   P  +  k       − 1 k      R  − 1 k  H          T  f      k  −  P   1  +  1 :  kP Q  1 :  ,  H               ← 1 ,   ←   d  IFFT − l Q  l  f      1 :  d +    : k Q L − +  l  −  l Q      1 Q    ++  k        Figure 6.34  Pseudo-code for the block-Fourier partitioned algorithm for con- stant channels—method 1.      312  ◾  MIMO Processing for 4G and Beyond  function  d =    BFPC O T LP Q e n Q P H L l ,  : 1,  , ,  2  ,  ,  ,  ,  +  −  ,  l       : 1        ]  − 11  [  = N = L l [ = F ← E  −  −  + n H P   − + l l ] N l   [ H P    −  ]  1  e  ′ =     0   Pl  −     ; ; e 0      Fl  ++ l  − + n  1    P H  −        FFT  k  k  ,  :  ,  H  =  T  T  T  +  1 :  ←  S ,  k 1 :  k Q 1 : ,    kP    ←    ←     H Q 1 :  = P for k 1 to   − + P f k P L :   1     ←   Q Q 1 1 1 : ,   : :   S T = 1 E for k to          − QQ H kP 1 1 , : : S T     ←   + + Q Q 1 1 :   , k :   1 kQ S     − + + −   1 : k Q 1 k L     L  QQ Q S   for k 1 Q to   − :     1 k Q L Q k Q S f = for k 1 to L ←    − ∑   k S f  ← ∑   chol R   R −− ← TriangInv   = for k to F 1 =  for k to P 1  e    −   1 : :   f k P L P   = for k 1 L to     −        − ×   1   k P e f  = for k 1 Q to     + − : Q k k Q L   ,   1 d  l    −− + ′ f   1   1 flQ lQ : d   = ′ 1 nQ   :    d d  ← R      ← 1   ←   d  1 kQ Q :    ← 1 ,    1 Q        FFT    1 Q  kQ  1 ,    kP  R k  11 :  1 ::  1 :  − 1 k  +  +  +  +        k  k  d        ,  1  k  k  k  f  l  T      k P L :   : FFT     H H Q 1 , :  1 :  −  P 1    +  k Q ,  1 :         +  H Q 1 :  1 :  ,       ←  S  H k     S      : k Q L  −    11 Q k Q  1 :  ,  +        ′ e     f  −    lP 1  +  k P  :  :    fl  +  −  l  +  +  l  −    P 1  +  k       − R 1 k  H          T  f      k  −  1 P    +  1 :  kP Q  1 :  ,       H       IFFT d − + l Q  f    : k Q L   − +   l 1 :        +  − Q k 1       l Q  Figure 6.35  Pseudo-code for the block-Fourier partitioned algorithm for con- stant channels—method 2.      MIMO Optimized for W-CDMA  ◾  313  Table 6.12  Number of Operations Required by the Partitioned Block- Fourier Algorithm  Rep  Number of Operations  Step  Method 1  Tf  ∑k  Rk  1− R1  ef  df  d2  Tf  Sk  Sf  Rk  Method 2  S IQ, IQ   P  L  L  L  FP  FL  FQ  P  1  1  Q  L  3  Q  +  +  Q 2  Q2 + Q + QP2  QL  L  log2 2  PQ2  23 Q 6  Q2  L  L  log2 2  L  L  log2 2  QL  L  log2 2  HQ2  2  Q HE  −  P     2  E  + 2  E     QL  L  log2 2  3  Q  +  +  Q 2  23 Q 6  continued  Total =  L  3  Q  +  2  +  Q 2  Q 9 6      +  2  F Q Q QP    +  +  2     +  2  PQ Q  +  2  +  QF QP    +  +  FP     L  log 2 2          314  ◾  MIMO Processing for 4G and Beyond  Table 6.12  Block-Fourier Algorithm   Continued  Number of Operations Required by the Partitioned   Number of Operations  Step  1− R1  ef  df  d2  Rep  L  FP  FL  FQ  Q2  L  L  log2 2  L  L  log2 2  Q2 + Q + QP2  Total =  L  3  Q  +  2  +  Q 2  Q 9 6      +  2  Q  HH HE  +  −  P     2  E  + 2  E     +  2  F Q Q QP    +  +  2     +  2  Q QF QP    +  +  +  FP     L  log 2 2      6.3.5.7  Application to the LMMSE Detector The equation of the LMMSE detector is   cid:22  = d     H  T T  +  σ 2  I  nQ  1   −  . H T e      6.118   As done for the ZF detector, a block-circulant version of the MMSE detector  equation can be obtained just by adding some extra columns and lines to matrix T.  In this case, the noise matrix n = σ 2 InQ also has to be extended. This can be done  just by adding E  defined in Equation 6.111  lines columns to it, obtaining the new  noise matrix  N  NQ  = σ 2  I  NQ  .   The block-circulant version of the MMSE detector becomes   cid:31  = d     H T T     PQ    cid:31  ∈  cid:30  dd  PQ  NQ  − 1    NQ  cid:30   N ′ ∈  +  e    ;   NP  H T e T   PQ    ,      ′  PQ     ∈   cid:30   NP NQ  ×  ;  N  NQ  ∈   cid:29   NQ NQ  ×  ;    6.119      6.120                MIMO Optimized for W-CDMA  ◾  315  function     d  =  BFP T n Q P H L l ,  , , e  1  ,  ,  ,  ,  +  −  ,  l        ]     −  1    −  [ + = N n H P   = − − + L l l l [ ] = N l FF     [ ← H P E     ] [ ← m l   2    ]     − 1  f  −  k  Fl  e  P  ++ l  P k  F to  ; ; e 0        to 1  ′ =  0  Pl   = for f 1 =  for k      T − f k P L 1 :   :     + +  k mQ 1 m ,   :      e − k P L 1     : :   = for k L to 1       ←   ∑ T  −   k    ∑ ← chol   R   ← TriangInv R        −        ×  −    k   for k to 1 Q     d − :   1   k Q L Q k  ′   d −     1 lQ flQ f  ← m min m l n    ,   = ′ d : d     1 nQ  + : 1 +    1    e ff =  k − 1 k    Q 1  d f    1  +  +  +  P  k  k  f  l  − + 1 n     P H  −        + k Q P 1 : , + Q 1        ← + 1 ,    ←  FFT     T    mP  +  k P :  :  mm L  +  −  1    P  FFT  e  ′     f  −  lP 1    +  kk P fl :  :       + − + + − l  l    1  P k  +       P  +  : 1  kP Q  1 :  ,  H         T  f       k  −    1  P  +  1 :  kP Q  1 :  ,    +    2  σ  I Q     R  k  kQ 1 :  ,   1     ← R      1 :  kP  − 1 k      R  − 1 k  H          T  f       k  −    P 1  +  kP Q 1 :  1 :  ,  H             IFFT − l Q    ← , 1   ←   d −  1    l  f    :   1  dd +  :   k Q L − +  l  −    l Q  +    1 Q k          Figure 6.36  Pseudo-code for the block-Fourier partitioned algorithm for unsteady  channels, using method 1.      316  ◾  MIMO Processing for 4G and Beyond  function  d =     BFP O T e n Q P H L l ,  , ,  2  ,  ,  ,  ,  +  −  ,  l        ]  −  1  [  = N = L l [ == F ← E ← m  −  −  + n H P   − + l l ] N l   [ H P   [ ] 2   l  ]  − 1  f  −  k  −     Fl  1       e  e  e  T  +  +  ++ l  − + n  1 :     P H  , +  ; ; e 0        ′     + m    mP ,  FFT    mP   T − f  P  ← − + 1 k Q : , 1 P     ← − + , k 1 P   1 FFT    ←   + : , mP H mQ 1 T   + + Q 1   mP H mQ E  ′ =  0  Pl     = to 1 ffor f F =  1 to for k     : : f k P L         k P L :   :     : :   Q Q 1   , 1 S     + 1 mP : ×   = to for k 1        + ++ − ←   1 : m m k P H mQ mP 1 :   S T       + + + +     mP H mQ 1 m k P   1 : m 1 :   Q ,  ×     ←    + +  :: Q 1 , kQ 1 1 :   Q   k S S      − + − +   , 1     1   k Q : Q Q k L L  S    = to for k Q 1     − Q k Q   1 QQ L   : k S f   = to for k 1 L     ∑ ←    k S f   ←  chol   R  k    ←− TriangInv 1 R              = Q to for k 1    + − , 1   :   k Q L Q k  d  ′  + − flQ   lQ 1   1 f : d   ← −− + min  m , m l n  = ′ 1 d :nQ     d    ← 1   ←   d   1    IFFT d − + l Q    ←       ← 1    k Q L   :  1 : kQ Q     Q 1      ←  − ∑  σ I 2 Q    +  FFT  k 1 :    Q 1  − kR 1  kQ       Tf     − 1 k  1 :  1 :  1 ::        −  +  +  +  R  R        H k  k  d  S  S     H  ,  ,  ,  k  k  k  k  f  l  − + k mQ 1    P , + − + + − l P   1  + l  + m 1   :   + k    1   Q       +   :  :   k P :  + k P m L : +   lP 1 ffl    : 1 m    Q 1    +  +  H     T    1 Q  H        T  +    −    Q k Q 1  1 :  ,  +        k  −    1 P  +  : 1 kP Q  : 1  ,  H               k  e  f  −    1 P  +  : 1  kP            −      : 1 k Q L Q k f − +       l Q l 1 :  +        Figure 6.37  Pseudo-code for the block-Fourier partitioned algorithm for unsteady  channels, using method 2.      MIMO Optimized for W-CDMA  ◾  317  Table 6.13  Number of Operations Required by the Algorithms in  a   Figure 6.36 and  b  Figure 6.37  Rep  Number of Operations  Step  Method 1  Tf  ef  ∑k  Rk  1− R1  df  d  Tf  ef  Sk  Sf  Method 2  S IQ, IQ   FP  FP  FL  FL  FL  FL  FQ  FP  FP  F  F  FQ  QL  L  log2 2  L  L  log2 2  PQ2  23 Q 6  Q2  3  Q  +  +  Q 2  Q2 + Q + QP2  L  L  log2 2  QL  L  log2 2  L  L  log2 2  HQ2  QL  L  log2 2  2  Q HE  −  P     2  E  + 2  E     continued  Total =  FL  3  Q  +  2  +  Q 8  Q 15 6      +  2  PQ QP  +  2  +  Q QP    +  +  P     L  log 2 2          318  ◾  MIMO Processing for 4G and Beyond  Table 6.13  Algorithms in  a  Figure 6.36 and  b  Figure 6.37   Continued  Number of Operations Required by the    b   Step  Rk  −1 Rk  df  d2  where                 Rep  FL  FL  FL  FQ  Number of Operations  3  Q  +  +  Q 2  23 Q 6  Q2  Q2 + Q + QP2  L  L  log2 2  Total =  FL  3  Q  +  2  +  Q 8  Q 15 6      +  2  QP  +  2  Q Q QP    +  +  +  P     L  log 2 2      +  2  FQ H HE  +  −  P     22  E  + 2  E     As before, the block-circulant matrices can be decomposed using the block-  Fourier transform as  T    PQ     = −1 Λ  F    P     F   Q        PQ     N  NQ  1 Λ = − F Q      F N Q     ,        Λ    PQ     = diag     F T   Q       PQ      :, Q : 1         PQ        Λ  N  =  diag     F N   Q     NQ   :, 1  :  Q    ,     QQ       Λ  N  ∈   cid:26   NQ NQ  ×  .     Replacing Equations 6.121 and 6.122 in Equation 6.120 results in   cid:22  =    d   − 1 F     P  Λ  F   Q        PQ     − 1 F     P  Λ     PQ     F   Q     +  − 1 F     Q  Λ  F N Q       H     − 1     −  FF    1 Λ   P  ⋅  F   Q        PQ     H     e      6.121    6.122    6.123    6.124    6.125       MIMO Optimized for W-CDMA  ◾  319           Considering that F H   K     K= −1  Equation 6.125 can be simplified to  F     ,   cid:22  = d  − 1 F     Q  Λ  H   PQ  Λ        PQ     +  Λ  N  Λ ⋅  H   PQ  F e      P     − 1            6.126   Since NNQ is a diagonal matrix, and from the definition of the block-Fourier   matrix  6.88 , it can be shown that  diag   QQ        F N   Q     NQ   :, 1  :  Q      =  N  NQ      6.127   This is true only when the NNQ matrix is a block-diagonal matrix composed of   N equal blocks of size Q.  Now, Equation 6.126 can be rewritten as   cid:22  = d  − 1 F     Q  Λ  H   PQ  Λ        PQ     + σ  2  I  NQ  Λ ⋅  H   PQ  F e      P     − 1            6.128   This equation can be used in the derivation of new algorithms based on the  work already done for the ZF detector. The extension is very obvious since σ 2INQ  is a real positive diagonal matrix, which added to  Λ PQ  results in a block- diagonal matrix whose blocks remain positive-definite Hermitian. This means that  they can be inverted with the Cholesky algorithm as done for the ZF detector. The  MMSE algorithms require more NQ real floating point additions in the nonparti- tioned case, more LQ real floating point additions in the constant-channel parti- tioned case, and more FLQ real floating point additions in the partitioned unsteady  channel case. The resulting algorithms and respective computational requirements  are presented from Figures 6.38 through 6.42.  Λ  H PQ           6.3.5.8  Zero-Forcing Results One hundred different T matrices were created for a Pedestrian A without interfer- ers. The simulator created 100 random data vectors and used each of them with  each of the T matrices to create the corresponding e vectors from e = Td. Then all  the algorithms were applied in turn to estimate d from each e vector. Finally, the  estimated and original d vectors were compared and the wrong bits count up. The  large number of bits used was necessary to reach valid statistical results. This pro- cedure was repeated for different velocities and antennas configuration as presented  in Table 6.14.  Tables  6.15  and  6.16  present  the  BER  results  for  the  different  algorithms.  Note that, for the stationary case, no errors would be obtained. Simulations for  the v = 0 km h  stationary situation  were also run, but the results were omitted  from the tables since there were no errors with any of the algorithms. The “Est”       320  ◾  MIMO Processing for 4G and Beyond  f  for k    T     e  k f ← E  =  1  to  P  k P N :  :    −  1    P  +  k  ,  −  +  =  + +  N k Q    − P PP N :   1 :   [ ] 1−     H P   ←   T 1 Q :   :: 1 = 1 to E   ←   T : 1 + : 1 k kQ   −  S Q   : , 1 for k  S    S     S     for k 1 to   S − k Q N : f for k 1 to  ←   ∑  S k   f  ←   chol R  ←← TriangInv R         ×   for k   d : k Q N  −   −   k Q to 1 −   1 QQ k  Q 1      − ∑    =  k − 1 k  e =    Q 1    1  d  +  +  +  +  P  k     ,  k  k  f  f    ←      FFT T     k P N :   :  e  FFT  k Q 1 : ,   ← , 1  k  k P N :  :    −  1    P  k Q ,  1 :  +      −    1  P  +  k        H Q  : 1  ,  H        T    : 1  H Q  : 1  ,     ,  PP  H  k         T : 1 H kP Q   ← S k + Q Q 1   ,  Q Q 1 : 1   −  N k  : 1    1 :  +  1 :  H Q  1 :  ,       ←  SS  H k  Q Q k Q 1   N  1 :  ,    ←  FFT        S  k Q N :     −  Q k 1    +  , QQ 1 :        +  1 :  kQ Q  1 :  ,    +    2  σ  I Q     R  k  : kQ 1  ,   1    ← R      : 1  kP  − 1 k      R  − 1 k  H         T  f       k  −    P 1  +  1::  kP Q  : 1  ,  H           ← 1  IFFT     d  f     : k Q N     −    1 Q k  +        Figure  6.38  MMSE  block-Fourier  partitioned  algorithm  for  steady  channels— method 1.  algorithm represents the “exact” solution of the ZF equation, that is, its solution  with  an  algorithm  that  does  not  include  extra  approximations  further  than  the  numeric floating point precision of the simulator. It can represent the Gauss or  Cholesky algorithms as well as their optimized versions. As expected, the “Est”  algorithm always estimated the correct data vector, since no noise was considered  in the simulation.  The  “Fourier1”  and  “Fourier2”  algorithms  correspond  to  the  two  versions  of  the  unpartitioned  Fourier  algorithm  described  earlier.  The  “Fourier1m”  and  “Fourier2m” are the same algorithms but using the middle block of the T matrix,       MIMO Optimized for W-CDMA  ◾  321  function     d  =  BFPC On  2  T  LP Q  1 :  ,  , , e  n Q P H L l , ,  ,  ,  ,  −  ,  l  +  2  ,σ        : 1        ]  −  1  = N = l L =   F ← E    −  [ +   HH P n − − + l l ] [   N l [ ]   H P  −  1  l  f  +  −  k  +  −     ,  ,  H  Fl  1    e  =  T  +  − + n  1 :     PP H  ←  ′ =  + +  k Q 1 : ,  ; ; e 0        ←    ←     H Q 1 :    P to − + P 1     ←   1 : T E   0    Pl = 1 for k   k P L :   :     , Q Q 1 1 : : S = to 1 for k      − 1 , T HH kP Q : 1 : S     + Q Q   1 1 : kQ , k   : 1 S     − + −    L k k Q   L   : 1 S   Q to for k 1   −     Q k Q 1 k Q L : S f = L to 1 for k ←    ∑ k   S f  ← chol   R   ← TriangInv R   = F for k 1 to =  P for k 1 to    − 1   : :   PP L P k e  f  = for k 1 tto L     − ← d   R          − ××   1   P k e f  = Q to for k 1     ←   + − 1   , 1   : k Q L Q k d     ←   ′  + −   flQ   lQ f 1 : 1 d d   = ′ d  : d    ← , 1  1   Q    − ∑  1 : kP    1 Q  kQ  ,   1  kk − 1 k  1 nQ  : 1  : 1  +  +  +  +  R  k  k        ,  k  k  k     f  l  l    FFT   H 1 :  T  T    k P L :   :   , H Q  1 :  −  P 1    +  k  ,,  1 :  Q        +  H Q 1 :  1 :  ,     T    kP        ← S   , 1 Q Q  k 1 :    ←  S  H k  FFT  SS       k Q L :    −  1 Q k Q    : 1  ,  +        : kQ Q 1    +  σ  2  I Q  FFT  e  ′     f  −    lP 1  +  k P  :  :    fl  +  −  l  +  +  l  −    P 1  +  k             R  − 1 k  H     − 1 k       T  f      k  −  P   1  +  : kP Q 1  : 1  ,       H       IFFT d − + l Q  f      : k Q L − +   l 1 :        +  − 1    Q k   l Q    Figure  6.39  MMSE  block-Fourier  partitioned  algorithm  for  steady  channels— method 2.      322  ◾  MIMO Processing for 4G and Beyond  function     d  =  BFP n 1    , , T e  n Q P H L l , ,  ,  ,  ,  −  ,  l  +  2  ,σ     ]  −  1  [  = N = L l [ = F ← E ← m  −  + n H P   − − ll + l ] N l   [ H P   ] [ 2   l  ]  − 1  e  l  f  f  +  −  k  +  Fl  T  − + n    P 1  + +  −    ; ; e 0      1 P   P 1    ′ =  0  Pl     = for f 1 F to =  for k 1 to P     − : f k P L   :       − k P L :   :  e   = for k 1 to L     ←     ∑ k   T    ∑ ←   chol R    ←  TriangInv R                 −   1 P   k xef    = to Q for k 1     + − k Q L   Q k 1 , :   d  ′  + −  lQ   flQ : 1 1   f d  ← − + , min  m l n m   = ′   1 d :   nQ d  : kP 1    Q 1  k − 1 k  1 :  +  +  −  k  d     k  ff  l        1    P H  −  R  k       ← 1 kQ ,       ← k Q 1 : ,   ← k , 1 FFT  FFT      ′    e  mP   T − f  + + k P m :   : LL + k lP 1   : PP fl :    +  + − k mQ m 1 :   1 P   , + − + + − + P   k 1 l l  +      Q 1         +  : kP Q 1  : 1  ,  H              k  T  f  −    P 1  +  kP Q 1 :  1 :  ,    +    σ  2  I Q  R  − 1 k  R  − 1 k        H           T  f       k  −    P 1  +  1 :  kP Q  1 :  ,  H               IFFT d − + l Q  f     ← 1   ←   d   1  l    : k Q L   − + : 1 l    +  − Q k   1    l Q          Figure 6.40  MMSE block-Fourier partitioned algorithm for unsteady channels— method 1.  while “Fourier1” and “Fourier2” use the first block. As can be seen in the tables,  both versions  1 and 2  have identical results, since they are numerically equivalent.  Also, as expected, the use of the middle block gives the best results except for low  speeds, where both methods are equivalent.  “FourierP2c” refers to the partitioned Fourier algorithm for constant channels  based  in  the  second  version  of  the  basic  Fourier  algorithm,  while  “FourierP2v”  is the corresponding unsteady channel version. As expected, “FourierP2v” always  gives better results, except for very low speeds, where “FourierP2c” can give equiva- lent results with less floating point operations. The numbers after “FourierP2c” or       MIMO Optimized for W-CDMA  ◾  323  function     d  =  BFP On  2  , , T e  n Q P H L l , ,  ,  ,  ,  −  ,  l  +  2  ,σ        ]  −  1  [  −  −−  N n H P   + l l F E m  + − l ] N l   [ H P   ] [ l   2  = = L [ = ← ←  −  ]  1  l  f  +  −  k  +  −     ;  Fl  1    e  e  e       T  +  − + n     P H  ; e 0  P − −    ← FFT  1 P   P 1     T +  + +   mP ,  k Q 1 : ,   ← k 1 , + : 1 ← mP H mQ E  ′ =  0    Pl    = for f to F 1 =  for k 1 to     : : f k P L         k P L :   :       Q Q : :   , 1 1 S     + mP 1 : ×   = to for k 1        + − mP m k P     1 : ← S T       + + + , mP H mQ 1 m k P     :  ×        ← + +  kQ 1 1   : k ,    Q Q 1 : S      − + − + L k L k Q   1     :   Q Q 1  S    = Q for k 1 to     − k Q L Q k Q   1 :   SS f   = to L for k 1     −     k ∑ ← S f   ∑ ← chol   R   k   ←− TriangInv 1 R         ←  , 1 kQ              −      1 P     for k 1 to P      ←  − + 1   : k Q L 1 ,   Q k d    ←   ′  + −  1 :     1 flQ lQ f d d  ← + −  1 , min  m mm l n   1:nQ   d    = ′ d    IFFT dd − + l Q  kQ Q    1 Q      ←   −  k =     Q 1  FFT  k 1 :  kP  S ,  : 1  1 :  1 :  1 :  1 :  +  −  +  +  +  R  R     k  d  e        ,  ,  1  k  k  k  k  k  f  f  l    + mP   FFT T   − lP    1 f   ′ + m   1 :  , mP H mQ   + Q   1  +  +  P 1    + l    ++ − k mQ L , k P m : : + − + + − + P fl P   1 l : ::   k      Q    1  +  T  H  : m   1  + m 1   :   +   k  +  Q 1           Q 1  H        T  + HH mQ   m 1 : + m 1   : 1 Q    , +  +    S  H k    ←     +  S  σ I 2 Q    k Q L :    −    Q k Q 1  : 1  ,  +        R  − 1 k  H           T  f       k  −  1   P  +  1 : kP Q  1 :  ,  H                 : f k Q L − + 1 :   l  +  −   1 Q k     l Q       Figure 6.41  MMSE block-Fourier partitioned algorithm for unsteady channels— method 2.      324  ◾  MIMO Processing for 4G and Beyond  N  3  Q  +  2  +  8 Q  15 Q 6  +  2  QP  +  2    Q  +  Q QP  +  +  P     N  log 2 2       +  2  Q H HE  +  −  P     2  E  + 2  E     L  3  2  +  +  Q  9 Q 6    Q H HE  +  2     8 Q  +  E  −  P    F Q + 2  22  E     2  +  Q QP  +  2    +    Q  2  +  QF QP  +  +  FP  L     log 2 2     3  Q  +  15  2  +  14  Q  +  2  PQ  +  2  QP  +    Q QP  +  +     P  FL  FL       +  Q 6  Q 6     3  Q  +  15  2  +  14  Q  +  2  QP  +  2  +  Q QP  +  +  P    Q  E   2  E  + 2  2  FQ H HE  +  −  P  L  log 2 2     L     log 2 2      a    b    c    d   Figure 6.42  Number of operations required by the algorithm of  a  Figure 6.38,   b  Figure 6.39,  c  Figure 6.40, and  d  Figure 6.41.  Table 6.14  Simulated Conditions for the ZF Detector  Channel  Interferers  Number of antennas  Pedestrain A  0  1; 2; 3; 4  Velocity  0; 1; 10; 100  km h   “FourierP2v” indicate the number of blocks used in each partition and the prelap  and  postlap  blocks  number.  For  example,  “FourierP2v_008_002_002”  refers  to  an eight-block partition with two blocks prelap and two blocks postlap algorithm.  From Tables 6.15 and 6.16, it can be concluded that it is advantageous to reduce  the size of partitions, especially for high speeds  as expected, since in each partition,  the channel is approximated as constant . It is also easy to see that, for a particular  partition size, better results are attained as larger laps are used. For low speeds, the  size of the partitions does not have a very strong influence on the correctness of the  estimation, but greater lap sizes are also advantageous as noticed for high speeds.  The conjunction of these two factors makes it hard to find the best algorithm for  high speeds, since small partitions cannot have large overlaps. In a similar way,       MIMO Optimized for W-CDMA  ◾  325  1 – E 6  .  2  1 – E 2  .  1  1 – E 6  .  2  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  d e u n i t n o c  3 – E 5  .  4  4 – E 2  .  6  3 – E 5  .  4  4 – E 2  .  6  4 – E 4  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  6  0 0 1  0 1     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  0 0 1  0 1       h m k      y t i c o e V  l  4 2  .  0 1    s t i b M      s t i b   f o   r e b m u N     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A 2        d n a    1    g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P   R E B     .  5 1 6   e l b a T  0  2  1  8 4  .  0 2     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  1 – E 7  .  2  2 – E 5  .  9  1 – E 7  .  2  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  3 – E 8  .  9  4 – E 5  .  7  3 – E 8  .  9  4 – E 5  .  7  4 – E 6  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  7  0  1  1  4 – E 6  .  5  4 – E 7  .  1  4 – E 6  .  5  4 – E 7  .  1  4 – E 8  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 7  .  1  s r e r e f r e t n I  s a n n e t n A  m  l r e i r u o F  2 r e i r u o F  l r e i r u o F     m 2 r e i r u o F  t s E  0 0 0 _ 0 0 0 _ 8 2 1 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 2 1 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 8 2 1 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 8 2 1 _ c 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 8 2 1 _ c 2 P r e i r u o F      326  ◾  MIMO Processing for 4G and Beyond  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  4 – E 2  .  6  4 – E 7  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 1  .  7  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  6  4 – E 2  .  8  4 – E 4  .  6  4 – E 2  .  6  3 – E 1  .  1  0  2     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  4 – E 5  .  7  4 – E 7  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 0  .  8  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  8  4 – E 5  .  7  4 – E 5  .  7  4 – E 5  .  9  0  1  4 – E 7  .  1  4 – E 9  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 1  .  2  4 – E 7  .  1  4 – E 7  .  1  4 – E 7  .  1  4 – E 4  .  2  4 – E 8  .  1  4 – E 7  .  1  4 – E 1  .  3  2 3 0 _ 2 3 0 _ 8 2 1 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 4 6 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 4 6 0 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 4 6 0 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 4 6 0 _ c 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 4 6 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 2 3 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 2 3 0 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 2 3 0 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 2 3 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 6 1 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 6 1 0 _ c 2 P r e i r u o F  0 0 0 _ 4 0 0 _ 6 1 0 _ c 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 8 0 0 _ c 2 P r e i r u o F  s r e r e f r e t n I  s a n n e t n A     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A 2        d n a    1   g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P R E B     d e u n     i t n o C        5 1 6  .    e l b a T      MIMO Optimized for W-CDMA  ◾  327  1 – E 2  .  1  1 – E 2  .  1  1 – E 2  .  1  2 – E 0  .  1  3 – E 8  .  8  3 – E 3  .  8  3 – E 3  .  6  3 – E 3  .  4  3 – E 7  .  1  3 – E 7  .  1  3 – E 5  .  1  3 – E 3  .  1  4 – E 9  .  9  4 – E 9  .  5  4 – E 6  .  6  4 – E 0  .  5  4 – E 0  .  4  d e u n i t n o c  4 – E 3  .  7  3 – E 7  .  1  3 – E 1  .  1  5 – E 5  .  1  6 – E 2  .  2  6 – E 2  .  3  6 – E 8  .  6  5 – E 5  .  1  7 – E 8  .  9  5 – E 3  .  2  6 – E 8  .  3  6 – E 7  .  8  5 – E 2  .  1  7 – E 8  .  9  5 – E 5  .  4  6 – E 5  .  2  6 – E 0  .  4     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  2 – E 5  .  9  2 – E 5  .  9  2 – E 5  .  9  3 – E 2  .  6  3 – E 0  .  6  3 – E 1  .  6  3 – E 8  .  4  3 – E 9  .  2  4 – E 3  .  9  4 – E 6  .  9  4 – E 3  .  8  4 – E 7  .  7  4 – E 4  .  5  4 – E 2  .  1  4 – E 7  .  1  4 – E 2  .  1  5 – E 8  .  8  4 – E 5  .  7  3 – E 2  .  1  4 – E 9  .  7  4 – E 8  .  1  4 – E 7  .  1  4 – E 8  .  1  4 – E 2  .  2  4 – E 5  .  1  5 – E 2  .  7  5 – E 4  .  8  5 – E 0  .  4  5 – E 2  .  3  5 – E 4  .  6  5 – E 9  .  5  5 – E 6  .  6  5 – E 2  .  3  5 – E 9  .  2  4 – E 0  .  2  4 – E 4  .  5  4 – E 6  .  3  5 – E 6  .  7  5 – E 5  .  6  5 – E 9  .  5  5 – E 0  .  5  5 – E 1  .  3  5 – E 9  .  1  5 – E 2  .  2  5 – E 0  .  3  5 – E 8  .  3  5 – E 5  .  5  5 – E 9  .  1  5 – E 2  .  2  5 – E 5  .  1     0 + E 0     .  0  2 0 0 _ 2 0 0 _ 8 0 0 _ c 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 4 0 0 _ c 2 P r e i r u o F  1 0 0 _ 1 0 0 _ 4 0 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 8 2 1 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 2 1 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 8 2 1 _ v 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 8 2 1 _ v 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 8 2 1 _ v 2 P r e i r u o F  2 3 0 _ 2 3 0 _ 8 2 1 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 4 6 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 4 6 0 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 4 6 0 _ v 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 4 6 0 _ v 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 4 6 0 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 2 3 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 2 3 0 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 2 3 0 _ v 2 P r e i r u o F      328  ◾  MIMO Processing for 4G and Beyond  4 – E 2  .  1  4 – E 7  .  2  4 – E 1  .  2  4 – E 0  .  2  4 – E 7  .  3  4 – E 5  .  1  4 – E 1  .  4  4 – E 8  .  1  6 – E 5  .  3  5 – E 9  .  8  6 – E 0  .  1  8 – E 9  .  4  4 – E 6  .  1  7 – E 4  .  3  4 – E 7  .  2  7 – E 9  .  3  0  2     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  5 – E 9  .  8  4 – E 4  .  1  5 – E 1  .  6  5 – E 2  .  2  5 – E 8  .  7  5 – E 3  .  1  5 – E 1  .  9  5 – E 1  .  2  5 – E 4  .  2  5 – E 8  .  3  5 – E 4  .  1  5 – E 1  .  1  5 – E 6  .  1  6 – E 3  .  2  6 – E 4  .  6     0 + E 0     .  0  0  1  5 – E 9  .  1  5 – E 3  .  2     0 + E 0     .  0     0 + E 0     .  0  6 – E 2  .  2     0 + E 0     .  0  6 – E 3  .  2     0 + E 0     .  0  8 0 0 _ 8 0 0 _ 2 3 0 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 6 1 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 6 1 0 _ v 2 P r e i r u o F  0 0 0 _ 4 0 0 _ 6 1 0 _ v 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 8 0 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 0 0 _ v 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 4 0 0 _ v 2 P r e i r u o F  1 0 0 _ 1 0 0 _ 4 0 0 _ v 2 P r e i r u o F  s r e r e f r e t n I  s a n n e t n A     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A 2        d n a    1   g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P R E B     d e u n     i t n o C        5 1 6  .    e l b a T      MIMO Optimized for W-CDMA  ◾  329  1 – E 9  .  2  1 – E 6  .  1  1 – E 9  .  2  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  d e u n i t n o c  3 – E 9  .  6  4 – E 4  .  9  3 – E 9  .  6  4 – E 4  .  9  4 – E 6  .  9  4 – E 4  .  9  4 – E 4  .  9  4 – E 4  .  9  4 – E 4  .  9  0 0 1  0 1     0 + E 0     .  0     0 + E 0     .  0  0 0 1  0 1     0 + E 0     .  0     0 + E 0     .  0     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A   r u o F   d n a   e e r h T   g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P R E B        6 1 6  .    e l b a T  8 7  .  0 3    s t i b M      s t i b   f o   r e b m u N  0  4  1  6 9  .  0 4     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  1 – E 9  .  2  1 – E 5  .  1  1 – E 9  .  2  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  3 – E 4  .  1  4 – E 2  .  1  3 – E 4  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  0  3  1     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  s r e r e f r e t n I  s a n n e t n A       h m k      y t i c o e V  l  l r e i r u o F  t s E  m    l r e i r u o F  2 r e i r u o F     m 2 r e i r u o F  0 0 0 _ 0 0 0 _ 8 2 1 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 2 1 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 8 2 1 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 8 2 1 _ c 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 8 2 1 _ c 2 P r e i r u o F      330  ◾  MIMO Processing for 4G and Beyond  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  4 – E 4  .  9  4 – E 8  .  9  4 – E 4  .  9  4 – E 4  .  9  4 – E 4  .  9  4 – E 4  .  9  3 – E 0  .  1  4 – E 4  .  9  4 – E 4  .  9  4 – E 4  .  9  3 – E 1  .  1  4 – E 5  .  9  4 – E 4  .  9  0  4  6 9  .  0 4     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  8 – E 9  .  4     0 + E 0     .  0     0 + E 0     .  0  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  4 – E 2  .  1  4 – E 3  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 5  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 2  .  1  4 – E 9  .  1  4 – E 2  .  1  4 – E 2  .  1  0  3  8 7  .  0 3     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0    s t i b M      s t i b   f o   r e b m u N  2 3 0 _ 2 3 0 _ 8 2 1 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 4 6 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 4 6 0 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 4 6 0 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 4 6 0 _ c 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 4 6 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 2 3 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 2 3 0 _ c 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 2 3 0 _ c 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 2 3 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 6 1 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 6 1 0 _ c 2 P r e i r u o F  0 0 0 _ 4 0 0 _ 6 1 0 _ c 2 P r e i r u o F  s r e r e f r e t n I  s a n n e t n A     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A   r u o F    d n a   e e r h T    g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P R E B     d e u n     i t n o C        6 1 6  .    e l b a T      MIMO Optimized for W-CDMA  ◾  331  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  1 – E 6  .  1  2 – E 3  .  1  2 – E 2  .  1  2 – E 0  .  1  3 – E 0  .  9  3 – E 4  .  5  3 – E 6  .  1  3 – E 7  .  1  3 – E 4  .  1  3 – E 1  .  1  4 – E 0  .  7  4 – E 3  .  2  4 – E 2  .  3  d e u n i t n o c  3 – E 3  .  1  3 – E 0  .  1  3 – E 8  .  1  3 – E 3  .  1  5 – E 1  .  8  5 – E 8  .  8  5 – E 8  .  8  5 – E 9  .  6  5 – E 0  .  5  5 – E 9  .  2  5 – E 3  .  4  5 – E 3  .  2  5 – E 5  .  2  5 – E 2  .  2  5 – E 2  .  1  5 – E 7  .  3     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  1 – E 5  .  1  2 – E 1  .  1  2 – E 1  .  1  2 – E 0  .  1  3 – E 9  .  7  3 – E 4  .  5  3 – E 7  .  1  3 – E 8  .  1  3 – E 1  .  1  4 – E 5  .  9  4 – E 5  .  6  4 – E 6  .  2  4 – E 3  .  3  4 – E 7  .  2  4 – E 2  .  1  4 – E 4  .  4  4 – E 8  .  1  6 – E 8  .  5     0 + E 0     .  0  8 – E 7  .  9  7 – E 6  .  1     0 + E 0     .  0     0 + E 0     .  0  6 – E 1  .  9  8 – E 7  .  9     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  5 – E 9  .  1     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  2 0 0 _ 0 0 0 _ 8 0 0 _ c 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 0 0 _ c 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 4 0 0 _ c 2 P r e i r u o F  1 0 0 _ 1 0 0 _ 4 0 0 _ c 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 8 2 1 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 2 1 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 8 2 1 _ v 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 8 2 1 _ v 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 8 2 1 _ v 2 P r e i r u o F  2 3 0 _ 2 3 0 _ 8 2 1 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 4 6 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 4 6 0 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 4 6 0 _ v 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 4 6 0 _ v 2 P r e i r u o F  6 1 0 _ 6 1 0 _ 4 6 0 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 2 3 0 _ v 2 P r e i r u o F      332  ◾  MIMO Processing for 4G and Beyond  4 – E 4  .  1  4 – E 1  .  1  5 – E 6  .  7  4 – E 9  .  1  5 – E 8  .  7  5 – E 8  .  4  4 – E 8  .  1  5 – E 1  .  6  4 – E 6  .  2  5 – E 9  .  7  5 – E 0  .  1  5 – E 1  .  1  6 – E 5  .  6  5 – E 3  .  4  6 – E 3  .  5  6 – E 7  .  2  5 – E 5  .  6  6 – E 5  .  1  5 – E 8  .  9  8 – E 4  .  2  0  4  6 9  .  0 4     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  4 – E 9  .  1  4 – E 0  .  1  4 – E 1  .  1  4 – E 0  .  2  5 – E 4  .  9  5 – E 2  .  5  4 – E 8  .  1  5 – E 0  .  7  4 – E 5  .  2  5 – E 5  .  9     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0  5 – E 9  .  3  8 – E 2  .  3     0 + E 0     .  0  5 – E 7  .  7     0 + E 0     .  0  4 – E 3  .  1  7 – E 2  .  6  0  3  8 7  .  0 3     0 + E 0     .  0     0 + E 0     .  0  0   + E 0     .  0  0   + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0     0 + E 0     .  0    s t i b M      s t i b   f o   r e b m u N  2 0 0 _ 2 0 0 _ 2 3 0 _ v 2 P r e i r u o F  4 0 0 _ 4 0 0 _ 2 3 0 _ v 2 P r e i r u o F  8 0 0 _ 8 0 0 _ 2 3 0 _ v 2 P r e i r u o F  0 0 0 _ 0 0 0 _ 6 1 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 6 1 0 _ v 2 P r e i r u o F  0 0 0 _ 4 0 0 _ 6 1 0 _ v 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 8 0 0 _ v 2 P r e i r u o F  2 0 0 _ 2 0 0 _ 8 0 0 _ v 2 P r e i r u o F  2 0 0 _ 0 0 0 _ 4 0 0 _ v 2 P r e i r u o F  1 0 0 _ 1 0 0 _ 4 0 0 _ v 2 P r e i r u o F  s r e r e f r e t n I  s a n n e t n A     A n a i r t s e d e P     A n a i r t s e d e P  t n e m n o r i v n E    l  e d o M    l  e n n a h C  s a n n e t n A   r u o F    d n a   e e r h T    g n  i s  U   F Z   e h t   r o f   e c n a m r o f r e P R E B     d e u n     i t n o C        6 1 6  .    e l b a T      MIMO Optimized for W-CDMA  ◾  333  for low speeds, large overlaps imply very large partition and a compromise has to  be made in each situation. Nevertheless, it is clear that for high speeds, the most  important factor is the size of the partitions, while for low speeds, the overlap size  is the key factor.  6.3.5.9  LMMSE Results A Pedestrian A channel with v = 100 km h, k = 16, and a MIMO 2 × 2 arrange- ment was considered, and the performance results for the BER and BLER are por- trayed in Figure 6.43. The “standard” method in the figures refers to estimation  obtained  by  solving  the  LMMSE  equation  with  the  standard  Gauss  algorithm.  The legend “EstPr_xx_yy_yy” represents the results of the application of an “exact”  partitioned algorithm  Gauss or Cholesky, for example , with partitions of size xx  and prelaps and postlaps of size yy.  As expected, the constant-channel approximations are useless for a v = 100 km h  situation. This is evident from the two block flourier simulations  curves above 10−1  for the BER, and of 1 for the BLER  for constant channels run. The partitioned  algorithms revealed to be very effective, since their solutions are only distinguish- able from the standard Gauss algorithm solution for high Eb N0 values. Note also  that the Fourier-partitioned algorithms for variable channels are only slightly worse  than the corresponding partitioned “Est” algorithms.  The  “FourierP2vr_04_01_01”  and  the  “EstPr_32_04_04”  methods  provide  almost identical results as the full Gauss method, while the “FourierP2vr_32_04_04”  and the “EstPr_32_00_00” provide worse results only for high Eb N0 values.   a   100  R E B  10–1  10–2   b   R E L B  100  10–0.1  10–0.2  Standard FourierP2cr032004004 FourierP2cr004001001 FourierP2vr032004004 FourierP2vr004001001 EstPr032000000 EstPr03204004 4  10  6  8  12 Eb N0  dB   Standard FourierP2cr032004004 FourierP2cr004001001 FourierP2vr032004004 FourierP2vr004001001 EstPr032000000 EstPr032004004 4  6  10  8 12 Eb N0  dB   10–3  0  2  14  16  18  20  10–0.3  0  2  14  16  18  20  Figure  6.43  BER   a   and  BLER   b   performance  results  for  MMSE,  under  the  Pedestrian A channel with v = 100 km h, k = 16, and MIMO 2 × 2.      334  ◾  MIMO Processing for 4G and Beyond  6.3.6  Final Remarks In this section, optimized versions of the Gauss and Cholesky algorithms were pre- sented, for usage for the solution of a ZF or LMMSE detector in MIMO BLAST  systems. The optimizations were based simply on the removal of the unnecessary  operations regarding the structure of the involved matrices. However, the simula- tion of an MMSE receiver for a real-life MIMO setting  e.g., a standard-sized block  for a specific channel quality indicator  CQI  in the UMTS  would be very compli- cated to perform without these optimizations.  The block-Fourier algorithms presented in [Vollmer et al. 2001] and [Machauer  et  al.  2001]  for  the  ZF  algorithm  under  constant-channel  conditions  were  also  tested  under  unsteady  channel  situations,  having  revealed  to  be  useless  in  con- ditions of medium or high speeds. New versions of those algorithms, capable of  dealing with detection in unsteady channels with speeds until v = 100 km h, were  derived  and  tested.  These  new  algorithms  were  based  on  the  partitioned  block- Fourier algorithms of earlier works [Vollmer et al. 2001; Machauer et al. 2001],  but  extra  steps  were  added  to  take  into  consideration  the  channel  change  from  partition to partition. Inside each partition, the channel is considered constant. The  new algorithms, although more computationally expensive than the original block- Fourier ones, are not as expensive as the Gauss or Cholesky ones  even if optimized  versions are considered .  The  best  algorithm  must  be  selected  according  to  the  channel  conditions;  for  almost  constant  channels,  constant  block-Fourier  algorithms  could  be  used  with good results, while for high speeds, the new block-Fourier algorithms pro- posed must be used, preferably with small-sized partitions. An optimized Gauss  or Cholesky approach could also be employed if sufficient computational power  becomes  available,  with  the  advantage  of  being  a  velocity-independent  solution.  Also, the benefit of parallel processing that can be exploited with the block-Fourier  algorithms can be extended to the Gauss and Cholesky methods  at least partially   with the introduction of partitioning.  6.4   Performance Results of the Equalization   Techniques  Both the MF and the ZF MMSE schemes were simulated. Since the ZF MMSE  results are based on the equalization of the MF results, it is interesting to compare  the three schemes. Simulations were run considering block sizes of 1024 bits, and  the reference UMTS channels. A MIMO setting with an equal number of trans- mitters and receivers was implemented. An SF of 16 was used  hence 16 physical  channels per transmit antenna . Minimum  usage of 1 physical channel per trans- mit antenna  and maximum  usage of 16 physical channels per transmit antenna   loading conditions were considered.      MIMO Optimized for W-CDMA  ◾  335  6.4.1  MF Results The MF results  Figure 6.44  are important for the MMSE receiver, since it is a  crucial part of the algorithm. It can be seen that, for the minimum loading case   Figure 6.44a , results of Vehicular A are best and of Pedestrian A are worse, due  to multipath diversity. The diagonal of the EM was used for normalization of yMF,  instead of using just the estimated channel coefficients as is usually done for stan- dard RAKE receivers. The extra information from the EM allows minimizing the  correlation effect, and thus the multipath diversity can be exploited for higher-order  modulations when there is little interference, contrary to the normal RAKE.  Owing to interference from other antennas, and the fact that the simple MF  algorithm does not perform any type of interference canceling nor equalization,  the lowest MIMO orders provide the best results. For the fully loaded case  Figure  6.44b , results for Pedestrian A are better than the Vehicular A channel, due to the  high amount of multipath interference. The lowest MIMO orders still provide the  best results, due to the reduced interference.  The uplink transmission of the MF receiver  Figure 6.45  yields worse results,  due to the increased interference caused by the correlation of the spreading codes,  which are no longer orthogonal. Note that the error floor is now over 10%, making  it virtually impossible to operate at full loading with this scheme.  6.4.2  MMSE and ZF Results Figure 6.46 portrays some BER results for the MMSE receivers. As expected, the  best  results  were  obtained  for  the  minimum  loading  case   Figure  6.46a   of  the  highest MIMO orders  highest receive diversity . Since the Vehicular A channel  has greater number of taps, best results are obtained for this channel  note that  perfect channel estimation is assumed . Indoor A is the second-best, since it has a    a   R E B  10–3  10–1  10–2  10–4  10–5   b   10–1  R E B  1TX1RX, Pedestrian A, QPSK 1TX1RX, Vehicular A, QPSK 4TX4RX, Pedestrian A, QPSK 4TX4RX, Vehicular A, QPSK 1TX1RX, Pedestrian A, 16-QAM 1TX1RX, Vehicular A, 16-QAM 4TX4RX, Pedestrian A, 16-QAM 4TX4RX, Vehicular A, 16-QAM 4  6  8  10 12 Eb N0  dB   1TX1RX, Ped A, QPSK 1TX1RX, Ped A, 16-QAM 1TX1RX, Veh A, QPSK 1TX1RX, Veh A, 16-QAM 2TX2RX, Ped A, QPSK 2TX2RX, Ped A, 16-QAM 2TX2RX, Veh A, QPSK 2TX2RX, Veh A, 16-QAM  10  8 12 Eb N0  dB   0  2  14  16  18  20  0  2  4  6  14  16  18  20  Figure 6.44  DL BER performance for MF, using  a  k = 1 and  b  k = SF.      336  ◾  MIMO Processing for 4G and Beyond  MF, SISO, Ped A MF, SISO, Veh A MF, MIMO2x2, Ped A MF, MIMO2x2, Veh A  0  2  4  6  8  10  12  14  16  18  20  Eb N0  dB   Figure 6.45  UL BER performance for MF, using k = SF.  10–0.62  10–0.64  10–0.66  10–0.68  10–0.72  10–0.74  10–0.76  R E B  10–0.7   a   R E B  10–3  10–1  10–2  10–4  10–5  1TX1RX, Pedestrian A 1TX1RX, Indoor A 1TX1RX, Vehicular A 2TX2RX, Pedestrian A 2TX2RX, Indoor A 2TX2RX, Vehicular A 4TX4RX, Pedestrian A 4TX4RX, Indoor A 4TX4RX, Vehicular A  10  8 12 Eh Nn  dB   MMSE, 1TX1RX, Ped A ZF, 1TX1RX, Ped A MMSE, 1TX1RX, Veh A ZF, 1TX1RX, Veh A MMSE, 2TX2RX, Ped A ZF, 2TX2RX, Ped A MMSE, 2TX2RX, Veh A ZF, 2TX2RX, Veh A  10  8 12 Eh Nn  dB   0  2  4  6  14  16  18  20  0  2  4  6  14  16  18  20  Figure  6.46  BER  performance  for   a   MMSE  using  k = 1  and  SF = 16  and   b   MMSE and ZF, with k = SF.  second tap of greater power than the pedestrian A channel, which is predominantly  a one-tap channel.  For the fully loaded system  Figures 6.46b and Figure 6.47 , it can be seen  that  the  situation  is  quite  different,  with  the  lowest  MIMO  orders  yielding  the  best results, due to the reduction of interference. Thus, for both modulations, the    b   10–1  10–2  R E B  10–3      MIMO Optimized for W-CDMA  ◾  337  10–1  R E B  10–2  MMSE, 1TX1RX, Ped A ZF, 1TX1RX, Ped A MMSE, 1TX1RX, Veh A ZF, 1TX1RX, Veh A MMSE, 2TX2RX, Ped A ZF, 2TX2RX, Ped A MMSE, 2TX2RX, Veh A ZF, 2TX2RX, Veh A  2  4  6  8  16  18  20  12  10 Eb N0  dB   14  Figure 6.47  BER performance for MMSE and ZF, using 16-QAM and k = SF.  best and worst channel’s performance are still Vehicular A and Pedestrian A, for  high values of Eb N0. For the 16-QAM case with low values of Eb N0, the channel’s  performance order is modified, with the worst being Vehicular A. This is due to the  nature of the 16-QAM modulation, which is dependent on the symbol’s amplitude,  being highly influenced by high levels of multipath interference. Note also that the  performance of both Pedestrian A and Indoor A are much closer for the 16-QAM  case, due to the modulation’s inaptness to exploit multipath when compared to the  QPSK modulation.  The MMSE results are much better than for the MF alone, due to the equaliza- tion. The only performance curves from both receivers that are closer to each other  are for the case with no interferers and SISO, where interference is minimal, caused  only by the channel’s wideband effect  ISI .  Regarding the ZF results, it can be seen that these are significantly worse that  those of the MMSE algorithm, with differences of performance over 10 dB. Noise  estimation plays a determining role in the MMSE algorithm, especially in fully  loaded systems, where the interference is high.  Some uplink results for both the MMSE and ZF are presented in Figure 6.48.  The performance is also worse than for the downlink, due to the added interfer- ence between spreading sequences. The ZF results are disastrous  above 10% ,  augmenting  the  importance  of  the  estimation  of  the  noise  component  for  the  MMSE.      338  ◾  MIMO Processing for 4G and Beyond  R E B  10–1  10–2  MMSE, SISO, Ped A MMSE, SISO, Veh A MMSE, MIMO2x2, Ped A MMSE, MIMO2x2, Veh A ZF, SISO, Ped A ZF, SISO, Veh A ZF, MIMO2x2, Ped A ZF, MIMO2x2, Veh A 8 4  6  0  2  12 10 Eb N0  dB   14  16  18  20  Figure 6.48  UL BER performance for MMSE and ZF, using k = SF.  Acknowledgment This work was supported by the FCT  Fundação para a Ciência e Tecnologia  via  project PEst-OE EEI LA0008 2013.  1977.  References 3GPP Technical Report 25.996 v6.1.0  2003-09 . Ben-Israel, A. and T. Greville, Generalized Inverses: Theory and Applications. New York: Wiley,   Brunner,  C.,  M.  Haardt,  and  J.A.  Nossek,  Onspace-time  RAKE  receiver  structures  for  WCDMA,  signals,  systems,  and  computers.  Conference  Record  of  the  Thirty- Third  Asilomar  Conference,  Volume  2,  1999,  pp.  1546–1551,  doi:  10.1109  ACSSC.1999.832008.  Cavers, J.K. An analysis of pilot symbol assisted modulation for Rayleigh fading channels,   IEEE Transactions on Vehicular Technology, 40, 686–693, November 1991.  Divsalar,  D.,  M.  Simon,  and  D.  Raphaeli,  Improved  parallel  interference  cancellation  in   CDMA, IEEE Transactions on Communications, 46, 258–268, February 1998.  Joy, M.P. and V. Tavsanoglu, Circulant matrices and the stability of ring CNNs, ISCAS 95,  IEEE International Symposium on Circuits and Systems, 1, 501–504, 28 April–3 May  1995.  Kay, S. Fundamentals of Statistical Signal Processing: Estimation Theory, Englewood Cliffs, NJ:   Prentice-Hall, 1993.  Machauer, R., M. Iurascu, and F. Jondral, FFT speed multiuser detection for high rate data   mode in UTRA-FDD, in Proc. of  the IEEE Vehicular Technology Conference, 2001.      MIMO Optimized for W-CDMA  ◾  339  Proakis, J.G. Digital Communications, New York: McGraw-Hill, 4th ed., 2001. Proakis, J.G. and M. Salehi, Communication Systems Engineering, Harlow, UK: Prentice Hall,   2nd ed., 2002  section 10.3 .  Shoumin, L. and T. Zhi, Near-optimum soft decision equalization for frequency selective  MIMO channels, IEEE Transactions on Signal Processing, 52 3 , 721–733, March 2004. Silva,  J.C.,  N.  Souto,  A.  Rodrigues,  A.  Correia,  F.  Cercas,  and  R.  Dinis,  A  L-MMSE  DS-CDMA  detector  for  MIMO BLAST  systems  with  frequency  selective  fading,  Proceedings  of  the  IEEE  IST  Mobile  &  Wireless  Communications  Summit,  Dresden,  Germany, June 19–23, 2005.  Silva, J.C., N. Souto, A. Rodrigues, F. Cercas, and A. Correia, Conversion of reference tapped  delay line channel models to discrete time channel models, Proceedings of the IEEE  Vehicular Technology Conference—VTC 2003 Fall, Orlando, USA, October 6–9, 2003. Viterbi, J. CDMA: Principles of Spread Spectrum Communication, Reading, MA: Addison-  Wesley, 1995.  Vollmer,  M.,  M.  Haardt,  and  J.  Gotze,  Comparative  study  of  joint-detection  techniques  for  TD-CDMA  based  mobile  radio  systems,  IEEE  Journal  on  Selected  Areas  in  Communications, 19 8 , August 2001.       Chapter 7 Ultrawideband Systems  and MIMO  Vit Sipal, Ben Allen, David J. Edwards,  and Wasim Q. Malik  Contents 7.1  UWB for Wireless Communication: Introduction .................................. 342 7.1.1  Motivation for UWB ................................................................... 342 7.1.2  History and Current UWB Standards ......................................... 344 7.1.3  UWB Regulations Worldwide ......................................................347 7.2  UWB Wireless SISO Channel ................................................................ 348 7.2.1  Path Gain in the UWB Wireless Channel ................................... 348 7.2.2  Channel Impulse Response of the SISO UWB   Wireless Channel ....................................................................... 349 7.2.3  Systematic Errors in Wireless Channel Measurements ..................349 7.2.4  Removal of Systematic Measurement Error from Channel Models ....352 7.2.5  Multipath Fading in UWB Wireless Channels .............................353 7.3  MIMO UWB Wireless Channel ..............................................................356 7.4  UWB Antenna Arrays ..............................................................................358  7.4.1  Difference between Narrowband and UWB Array,   Beam Patterns ...............................................................................359 7.4.2  Impact of Beam Patterns on Practical Systems ..............................362 7.5  UWB MIMO ..........................................................................................363 7.5.1  EIRP-Constrained Radiation ........................................................363 7.5.2  Grating Lobes, Element Spacing, and Antenna Selection .............363 7.5.3  Complexity of MIMO for OFDM Systems ..................................365  341   342  ◾  MIMO Processing for 4G and Beyond  7.6  UWB Localization ...................................................................................365 7.6.1  RSS Ranging ............................................................................... 366 7.6.2  TOA Ranging .............................................................................. 366 7.6.3  AOA Localization .........................................................................368 7.6.4  UWB Localization: Summary ......................................................368 7.7  Microwave Imaging ..................................................................................369 7.7.1  Techniques of Microwave Imaging ...............................................369 7.7.2  Limitations of Microwave Imaging ...............................................370 7.8  Future Perspectives ...................................................................................372 References .........................................................................................................373  Ultrawideband  UWB  technology uses extremely wide bandwidth signals with  low-power spectral density. This approach changes the wireless communications  paradigm  fundamentally  because  the  large  signal  bandwidth  leads  to  the  emer- gence of some interesting and unique channel properties [Allen et al. 2006, Sipal  et al. 2012d]. There has been an enormous interest in the technology during the  last 20 years because UWB, and specifically UWB multiple-input and multiple- output   MIMO ,  enables  very  high  data-rate  wireless  communications,  wireless  asset localization, and microwave medical imaging, with properties and capabili- ties unmatched by conventional wireless technologies. The objective of the chapter  is to introduce UWB MIMO technology and to provide an overview of its major  potential and constraints for these three fields.  7.1  UWB for Wireless Communication: Introduction As  the  name  suggests,  UWB  systems  are  wireless  systems  with  a  very  large  bandwidth.  Based  on  the  current  generally  accepted  definition  and  industry  specifications, a wireless system can be described as UWB if it uses an abso- lute bandwidth larger than 500 MHz, or a relative bandwidth larger than 20%  [Allen et al. 2006].  In this section, we discuss the motivation for UWB wireless systems. This is  followed by a brief overview of the history of UWB systems and their outlook for  the future. Finally, the main modulation schemes and the worldwide regulatory  framework for UWB regulation are discussed.  7.1.1  Motivation for UWB The history of wireless communication started with Hertz’s experimental transmis- sion of short “UWB-like” impulses in the 1880s [Allen et al. 2006]. The practical  applications of these experiments emerged in 1895 when Marconi demonstrated  the transmission of information over a distance of a mile for nonline of sight condi- tions [Falciasecca et al. 2009]. Since then, the advances in wireless communications       Ultrawideband Systems and MIMO  ◾  343  technology have been rapid. For wireless engineers, this presents many interesting  challenges, of which two key challenges are the following:   ◾ Currently,  the  radio  spectrum  suitable  for  wireless  transmission  is  almost  fully allocated; therefore further expansion of the bandwidth for wireless ser- vices is limited [Goldsmith et al. 2009].   ◾ Despite all the progress we have made in the past 100 years, the main force  behind the increase of data rate in a single link is the increase of bandwidth.  UWB addresses both issues. In terms of the allocated spectrum, UWB uses the  same spectrum that is being used by the primary users. However, due to the strict  regulations on the effective isotropic-radiated power  EIRP  spectral density, for  example [Sipal et al. 2012d], the wideband radiation causes only negligible interfer- ence with the primary users. For the primary user, the UWB radiation appears to  be white noise, and due to its low power UWB does not significantly deteriorate  the performance of the primary user [Allen et al. 2006]. For the UWB user, the  primary user represents an interference source which, due to its narrowband nature,  corrupts only a small part of the UWB signal so that coexistence is possible [Allen  et al. 2006].  In terms of the second statement about bandwidth being the main force for  data-rate increase, we use the example of the IEEE802.11 systems and discuss the  main forces behind the increase in its capacity in the evolution of the system.  In the IEEE802.11a standard enacted in 1999, the single stream data rate was  54 Mbps and multiple users were accommodated by frequency division multiplex   IEEE802.11 .  With  the  IEEE802.11ac  standard  of  2013,  a  single  stream  data  rate in the IEEE802.11ac systems is now capable of offering up to 866.7 Mbps   IEEE802.11 . In other words, the data rate per single stream increased by a factor  of 16 over 14 years.  The contributors toward this development are: bandwidth and MIMO; reduc- tion of the guard interval; increase of the modulation level; and increase of the code  rate. The contribution of these to the overall factor of 16 is illustrated in Figure 7.1.  Bandwidth and MIMO  l a v r e t n  i    d r a u G  r e d r o   r e h g i H  n o i t a l u d o m  d e s a e r c n I  e t a r   e d o c  1  2  3  4  5  6  7  8  9 10 11 12 131415 16  Figure  7.1  Contributions  toward  the  single-user  data-rate  increase  between  IEEE802.11a and IEEE802.11ac.      344  ◾  MIMO Processing for 4G and Beyond  Note that bandwidth and MIMO are the main contributors to the increase in  capacity by a factor of 9.9. Multiuser MIMO-enabled users share the same frequency  band. As a result, the bandwidth of the orthogonal frequency-division multiplexing   OFDM  symbol is increased from 20 to 160 MHz. This alone gives an increase by  a factor of 8. Furthermore, the relative number of pilot and guard subcarriers has  been reduced. As a result, the number of data subcarriers in IEEE802.11ac is 476  compared to 48 in IEEE802.11a.  The reduction of the guard interval from 800 to 400 ns means that the symbol  repetition rate, and hence the data rate, has increased by a factor of 1.1. The increase  of modulation order from 64-QAM to 256-QAM represents a significant challenge  for analogue-to-digital conversion but contributes only by a factor of 4 3 = 1.33.  Finally, the increase of code rate from 3 4 to 5 6 has provided a data rate increase  by factor of 1.11.  The numbers in Figure 7.1 confirm the importance of bandwidth and MIMO.  Multiple-user MIMO enables the reuse of spectral resources by multiple users but  one still requires bandwidth to provide data rate in the single data link. In the  logarithmic sense, the bandwidth in IEEE802.11ac is closer to UWB  factor 3.125   than to its predecessor IEEE802.11a  factor of 8 . This underlines the importance  of studying UWB channels and UWB MIMO. On the one hand, the large band- width represents a challenge. On the other, the bandwidth offers a higher temporal  resolution which enables a better understanding of the underlying physical prin- ciples in a wireless channel.  7.1.2  History and Current UWB Standards The pioneering experiments of Hertz and Marconi employed electric sparks and  are often considered as the first UWB experiments [Allen et al. 2006]. Wireless  technology,  however,  soon  realized  the  advantage  of  heterodyne  narrowband  transmission and the art of wireless using extremely short pulses was forgotten  until the 1960s. In the 1960s, this interest was revived by a US military proj- ect mainly due to an interest in radar applications, as radar resolution increases  with bandwidth [Allen et al. 2006]. Commercial interest in UWB technology  for communications began in the 1990s. However, the real trigger for the inten- sive research efforts had been marked by the Part 15 ruling of the US FCC that  allowed unlicensed UWB radiation subject to strict EIRP requirements [Allen  et al. 2006].  Standardization efforts started in 2002, and are sometimes considered to be  one of the reasons for the premature commercial failure of the technology [Sipal  et al. 2012d]. The high data-rate UWB standard was deliberated upon by the IEEE  802.15.3a task group. However, two opposing industrial alliances, WiMedia alli- ance and UWB forum, were unable to find a compromise and as a consequence the  standardization efforts within the IEEE were stopped in early 2006 [Heidari 2008,  Sipal et al. 2012d].      Ultrawideband Systems and MIMO  ◾  345  The UWB forum was dismantled soon after Motorola left it in 2006 [Heidari  2008].  The  WiMedia  alliance  brought  their  proposal  forward  to  the  European  Association for Standardizing Information and Communication Systems  ECMA ,  and their multiband OFDM scheme was standardized by the ECMA-368 standard.  The ECMA-368 standard foresees data rates ranging from 53.3 to 480 Mbps using  OFDM symbols with 128 subcarriers and 528 MHz bandwidth. More details of  the WiMedia’s ECMA standard can be found in the standard itself  ECMA 368   or in [Heidari 2008].  The  dismantling  of  the  IEEE  802.15.3a  task  group  has,  however,  not  been  the end of UWB standardization within the IEEE. Two low-data-rate standards  have since been approved, namely, the IEEE802.15.4a for personal area networks   IEEE802.15.4  and IEEE802.15.6 for body area networks  IEEE802.15.6 .  These standards are attractive because they offer the possibility to implement  communication  systems  with  properties  desirable  for  wireless  sensor  networks.  The systems have low-power consumption, they are robust against the impact of  frequency selective fading, their inherently low range combined with time hop- ping  enables  dense  spatial  reuse  of  the  frequency  resources,  and  in  the  case  of  IEEE802.15.4  they  also  provide  ranging  capabilities  required  by  location-aware  wireless sensor networks.  The  IEEE802.15.4a  for  personal  area  networks  relies  on  the  combination  of  burst-position  modulation   BPM   and  binary-phase-shift-keying   BPSK    IEEE802.15.4 .  The  symbol  structure  is  presented  in  Figure  7.2.  Each  sym- bol transmits two information bits. The first bit is defined by the position of the  burst of pulses in the symbol—in the first or in the second half of the symbol as   Tsym  Tsym  Transmit: 0X  TGuard  Transmit: 1X  Tb  Tb  TGuard  Hopping for multiuser—activate one slot out of NHOP  Figure 7.2  The symbol structure in the 802.15.4a UWB standard. The light shade  of gray is used to show the PPM modulation. To enable spectrum sharing, time  hopping is used and transmitted only in one time slot Tb  dark gray  is used for bit  transmission.      346  ◾  MIMO Processing for 4G and Beyond  shown in Figure 7.2. The second data bit is coded by the polarity of the pulse burst.  Additionally, the pulse burst can be positioned in one of NHOP bins  NHOP is integer  representing the number of bins slots for time-hopping sequence  as the standard  foresees time hopping to enable spectrum sharing among multiple users. The num- ber of chips  pulses per burst  and the number of bins for hopping are defined by  the standard and vary between different data rates  IEEE802.15.4 . The manda- tory bandwidth of the pulses is 499.2 MHz, but optionally can also reach 1081.6,  1331.2, and 1354.97 MHz  IEEE802.15.4 .  The IEEE805.15.4a UWB standard foresees nonmandatory ranging capability  which relies on time-of-arrival estimation  IEEE802.15.4 . The range is determined  using the roundtrip duration of a signal between two nodes, and the known dura- tion of the processing at the distant transceiver  IEEE802.15.4 . The ranging preci- sion as defined by the standard can achieve resolution of up to 1 cm  IEEE802.15.4 . The IEEE802.15.6 system for body-area-networks is a low complexity low data- rate standard providing data rates from 0.3948 to 12.636 Mbps  IEEE802.15.6 .  The mandatory modulation is impulse radio  IR  using on–off-keying  OOK  and  low complexity energy detection. Optional IR with differential BPSK QPSK or  frequency modulation UWB can be implemented  IEEE802.15.6 .  In OOK IR UWB, the data bits are modulated on a symbol as presented in  Figure 7.3. For the transmission of “0,” the pulse is transmitted in the first half of  the symbol; for the transmission of “1,” the pulse is transmitted in the second half  of the symbol, as shown in Figure 7.3. Within each half of the symbol, there are 16  bins with duration TW, which are used for multiuser access by time hopping. The  duration of the pulse TW can be equal to 2, 4, 8, 16, 32, or 64 ns. The increase of the  pulse duration reduces the data rate by a factor of 2, but it improves the sensitivity   Tsym  Tsym  Transmit: 0  Tw  Transmit: 1  Tw  Hopping for multiuser—activate one slot out of 16  Figure 7.3  The symbol structure in IEEE802.15.6. The light gray color shows the  information carried in the first or the second half of the symbol. Each half consists  of 16 time slots for time-hopping is employed and only one time slot  dark gray   per symbol is actively used for communication.      Ultrawideband Systems and MIMO  ◾  347  of the receiver by 3 dB. The pulse bandwidth is 499.2 MHz  IEEE802.15.6 . The  standard does not define the pulse waveform, but chirp pulses or chaotic waveforms  to create pulses long in the time domain yet satisfying the UWB criteria in the  frequency domain are suggested  IEEE802.15.6 .  7.1.3  UWB Regulations Worldwide The  standards  described  in  Section  7.1.2  define  the  framework  for  communica- tions, but the transmitters are also required to comply with the local regulations  on the EIRP spectral density. The corresponding regulations in Europe, the United  States, Korea, and Japan are presented in Figure 7.4. As can be seen, the maximum  emission limit in all regions is the EIRP spectral density of −41.3 dBm MHz. More  details on the regulations can be found, for example, in [Sipal et al. 2012d].  These regulatory limits have significant impact on the design and operation of  MIMO in UWB systems because all UWB regulations are EIRP spectral density  bound. It means that UWB MIMO systems must ensure the maximum transmit- ted power spectral density in any direction does not exceed the limit. In contrast,  for the IEEE802.11, the radiation is power bound. Hence, as long as the total gain  of  transmission  does  not  exceed  6 dBi,  the  power  spectral  density  radiated  in  a  selected direction can be increased [Vithanage et al. 2009].  Europe  LDC DAA General limit  USA  Indoor Outdoor  0  2  4  6  8  10  12  14  0  2  4  12  14  Frequency  GHz   Japan  General limit DAA  8  6 10 Frequency  GHz   Korea  Outdoor limit Outdoor DAA  –40 –50 –60 –70 –80 –90       z H M m B d     P R I E n a e     M       z H M m B d     P R I E n a e     M  –40 –50 –60 –70 –80 –90       z H M m B d     P R I E n a e     M  –40 –50 –60 –70 –80 –90       z H M m B d     P R I E n a e     M  –40 –50 –60 –70 –80 –90  0  2  4  8  6 10 Frequency  GHz   12  14  0  2  4  6  8  10  12  14  Frequency  GHz   Figure  7.4  Spectral  emmission  masks  for  UWB  region  in  Europe,  the  United  States, Japan, and Korea. In bands denoted as DAA, radiation is permissible only  for transmitters equipped with detect-and-avoid capability. In bands denoted as  LDC, only low-duty-cycle operation is allowed.      348  ◾  MIMO Processing for 4G and Beyond  In summary, the understanding of the regulations for UWB systems is impor- tant  as  these  regulations  set  a  different  framework.  In  some  cases,  UWB  sys- tems,  therefore,  have  to  resort  to  different  MIMO  optimization  strategies  than  IEEE802.11,  making  UWB  system  design  and  implementation  rather  specific  [Vithanage et al. 2009].  7.2  UWB Wireless SISO Channel The  UWB  wireless  channel  differs  significantly  from  the  narrowband  channel  because its bandwidth enables the emergence of some unique and interesting chan- nel properties. These properties represent the main opportunity for the technology,  but at the same time they can also be seen as its main limitation. Hence, the UWB  wireless channel is introduced here.  In this section, the path gain, channel impulse response in SISO UWB wireless  channel, and the robustness of UWB wireless channel to fading are discussed. The  main objective of this section is to demystify the UWB wireless channels.  7.2.1  Path Gain in the UWB Wireless Channel Path gain is the most important component in the link budget. It enables designers  to perform initial range and feasibility estimates. Here, only the general concept  of path gain is introduced and readers interested in more details on path gain are  referred, for example, to [Molisch et al. 2004] and [de la Roche et al. 2013].  Path gain is the mean expected attenuation a signal experiences during propaga- tion over range r in a particular environment, and is defined as [de la Roche et al. 2013]  PG r      =  E  H f r df   ,   2      7.1        f  c  +  B     2  ∫  f  c  −  B     2          where  E{⋅}  is  the  expected  value  excluding  fading   see  Section  7.2.5 ;  H f,  r   is  the channel transfer function for range r; B is the bandwidth; and fc is the center  frequency.  The reader should note the inverse relationship between path gain and path loss.   As a result, path loss increases with range, whereas path gain is reduced.  Path gain is expressed in decibel  dB  scale as  PG r dB     =  PG  0  −  n 10  log 10     r r 0         7.2   where PG0 is the mean path gain for reference range r0  for UWB channels r0 is  typically selected as 1 m [de la Roche et al. 2013] ; n is the path-gain coefficient             Ultrawideband Systems and MIMO  ◾  349   in free space n = 2, for line-of-sight condition in an indoor environment its value  is lower since the path gain is increased by the energy carried by the multipaths  [de la Roche et al. 2013] .  In  contrast  with  narrowband  channels,  the  UWB  channel  occupies  a  wide  range of frequencies and H f, r  depends strongly on frequency. Thus, path gain  depends on the bandwidth and center frequency of the channel [Molisch et al.  2004].  Practical  systems  introduced  in  Section  7.1.2  have  typical  bandwidths  of  500 MHz  with exception of IEEE802.15.4 which considers bandwidths of 500– 1355 MHz . Therefore, only the impact of center frequency has to be considered  and variations within the symbol bandwidth can be neglected [de la Roche et al.  2013].  7.2.2   Channel Impulse Response of the SISO UWB   Wireless Channel  In principle, the impulse response of a UWB channel does not differ from that of  a narrowband channel and can be expressed as the sum of consecutive multipath  components  rays . For simulations that explore system performance, it is impor- tant to know what the typical statistical properties of the channel impulse response  are, that is, the typical delays of consecutive rays, the typical number of rays, and  so on [de la Roche et al. 2013].  It is important to have a model that describes the channel accurately but remains  understandable and simple. Unfortunately, most models reported in the literature,  including the IEEE802.15.4a channel model for UWB, are rather complex and  error prone. It can be shown that due to a systematic error in measurement process- ing, an error was embedded in the IEEE802.15.4a channel model and the number  of rays was overestimated by factor of 4 or 5 [Sipal et al. 2010].  7.2.3  Systematic Errors in Wireless Channel Measurements Owing to the vast bandwidth, UWB channel measurements are often performed  in the frequency domain by vector network analyzers  VNA . These measurements  provide the measured channel transfer function HM f  . The application of inverse  Fourier transform on HM f   to obtain the channel impulse response introduces  artifacts which we discuss next.  As noted above, the actual channel impulse response, hC t , without the impact  of the antennas, is a real function and can be described as a sum of N multipath  components:     h t     C  =  ∗  δ  t    −  τ  i     N  ∑α  i  = 1  i      7.3       350  ◾  MIMO Processing for 4G and Beyond  where τi is the delay of the ith multipath component; δ t  is the Dirac delta func- tion; αi t   is  the  real  amplitude  of  the  ith  multipath  component;  and  *  denotes  convolution.  Since  practical  communication  systems   including  practical  UWB  systems   are bandpass systems, the baseband descriptors are often preferred [Molisch et al.  2004]. In the baseband equivalent, the channel impulse response hCB t  is a com- plex function and the relationship between hC t  and hCB t  is known to be [Ohm  and Lueke 2006]:  h t     C  =  ℜ  { h CB  t     exp   ⋅  j  2π  f t C  }        7.4   where fC is the center frequency of the system and ℜ{⋅} takes the real component  of {⋅}.  Using Equation 7.3, it is possible to express the measured channel transfer func-  tion HM f  as  H f    M     =  ⋅  exp   −  j  π τ2 f     ⋅  i  i  H f    , A i  ⋅  rect   7.5          f     − B  f  C             N  ∑α  i  = 1  where  B  is  the  bandwidth  of  the  measurement  around  the  center  frequency  fC;   ; and HA,i f   is the combined channel transfer function   rect    x  =   1  0   0.5  <  for  x otherwise  of the transmit and receive antenna.  HA,i f   is specific to each multipath component to reflect the fact that the radia- tion  properties  of  antennas  are  dependent  on  the  angle-of-departure  and  angle- of-arrival  AoD and AoA , that is, the gain of the antenna is different in different  directions.  HA,i f    also  includes  the  variation  of  antenna  gain  as  a  function  of  frequency.  Equation 7.5 represents the data obtained from a measurement with a VNA.   The inverse Fourier transform of Equation 7.5 yields  h M  t      =  N  ∑α  i  = 1  i  { h  ⋅    t  , A i  −  τ  i     sinc   Bt     cos   π f t 2 C  ∗ [   7.6   } ]       where  sinc    x  = sin  π x  π     x  .  Let us compare Equation 7.3 with Equation 7.6. In Equation 7.3, each ray has  a simple form δ t − τi . In the measured impulse response in Equation 7.6, each  ray is represented by hA,i t − τi  * [sinc Bt  cos 2πfCt ] which includes the impact of  antenna impulse responses hA,i t  and the impact of the measurement with limited                Ultrawideband Systems and MIMO  ◾  351  bandwidth around the center frequency [sinc Bt  cos 2πfCt ]. This is a systematic  error which has an impact on the observation of the number of rays.  First, the [sinc Bt  cos 2πfCt ] term produces multiple peaks which are not inde- pendent multipath components. The impact of cos 2πfCt  can be removed by trans- formation into equivalent baseband, but even then the sinc Bt  term remains and  its artifacts can be erroneously interpreted as independent multipaths. The first two  sidelobes in sinc Bt  are spaced 1.5 B around the main lobe attenuated by 13.3 dB.  Further, sidelobes are then spaced by 1 B. It is possible to reduce the impact of the  sinc-function by applying different windowing functions, but at the cost of filtering  out some information about the channel.  Second, even if the impact of the sinc function is eliminated by advanced sig- nal processing, this is not always true about the impact of manifestation of the  antenna impulse responses hA,i t , which is a convolution of the impulse response  of the transmit antenna and the impulse response of the receiving antenna. Figure  7.5 shows a simulated antenna impulse response hA,i t  for transmission between  two example antennas in free space, that is, the impulse response corresponds to a  single ray. Thus, Figure 7.5 shows the difficulty of telling apart the manifestation of  antenna impulse response hA,i t  and independent rays.    –     R I    –     R I  1 0.5  0 –0.5 –1 –0.5  1 0.5 0 –0.5 –1 –0.5  0  0  0.5  Time  ns   0.5  Time  ns   1  1  Figure 7.5  Manifestation of antenna impulse responses for free-space transmis- sion between two discone antennas  top  and between two circular monopole  antennas facing broadside  bottom .      352  ◾  MIMO Processing for 4G and Beyond  The removal of hA,i t  from Equation 7.6 is possible, as shown in [Sipal et al.  2010] where the known antenna impulse response was deconvolved from a mea- sured channel to leave only the sinc function present. However, the deconvolution  requires perfect knowledge of hA,i t  for each ray, which is only possible when the  AoD and AoA for each ray are known. This is not the case for a general channel  measurement [Malik et al. 2008].  To conclude, this section shows that the traditional channel measurements are  subject to systematic error which can result in overestimation of the number of  independent rays in the channel. With this knowledge, it is possible to correct and  simplify many channel models as is shown in the subsequent section simplifying  the IEEE802.15.4a channel model.  7.2.4   Removal of Systematic Measurement Error   from Channel Models  The IEEE802.15.4 channel model is the most widely used channel model for UWB  system modeling. The channel impulse response, according to the IEEE802.15.4a,  is defined for the equivalent baseband channel, that is, it is a complex variable, and  it defines that the rays arrive in NK clusters, each of which consists of up to NL rays  [Molisch et al. 2004]:     h t     C  =  θe j  k l ,  δ  t T   k  −  k l ,  −  τ     k l ,   7.7   N  N  L  K  ∑∑ α  k  = 1  l  = 1     where Tk is the cluster delay; τk,l is the delay within the cluster; θk,l is the phase of  the ray.  The intercluster delays Tk − Tk−1 are a Poisson process [Molisch et al. 2004]. The  intracluster delays τk,l − τk,l−1 are the mixture of two Poisson processes. However,  when this mixture of Poisson processes is critically studied under the consideration  of the systematic error from the preceding section, it becomes apparent that only  one of the Poisson processes represents the actual ray, whereas the second one is  caused by the systematic error in evaluation of the measured results.  For instance, in the office environment, the two Poisson processes are reported  to have mean ray arrival times 0.337 and 5.26 ns [Molisch et al. 2004] and the pro- cess with mean ray arrival time of 0.337 ns dominates with relative occurrence of  98% [Molisch et al. 2004]. Based on the previous section, it is reasonable to argue  that the IEEE802.15.4a channel model overestimates the number of paths [Sipal  et al. 2010].  Thus, it is possible to conclude that the mean arrival time of a ray in a cluster  is a single Poisson process. In the office environment, the mean ray arrival time is  5.26 ns. For other environments, it is the Poisson process with the longer mean  ray arrival time from the two offered by the IEEE802.15.4a channel model. This       Ultrawideband Systems and MIMO  ◾  353  significantly simplifies the channel model as the number of independent rays is  significantly reduced [Sipal et al. 2010] and it enables us to reuse the results of the  IEEE802.15.4a channel model.  7.2.5  Multipath Fading in UWB Wireless Channels Fading in the wireless channels is caused by multipath superposition at the receiver.  The superposition of multiple signal copies can be either constructive or destruc- tive.  As  a  result,  the  received  signal  strength  can  vary  significantly  from  values  expected based on path gain. Similarly, even a small displacement of the transmit- ter or receiver can convert constructive superposition into destructive interference  and vice versa [de la Roche et al. 2013].  UWB systems are often quoted to be robust against multipath fading. This  statement is generally true but robustness to multipath fading also depends on the  architecture of the UWB system [de la Roche et al. 2013]. Thus, this section dis- cusses frequency-selective fading in more detail.  The  channel  transfer  function  H f    is  obtained  as  the  Fourier  transform  of   Equation 7.3:  H f       =  exp   −  j  π τ2 f     i  i   7.8   N  ∑α  i  = 1     The received channel energy for a channel with center frequency fc and band-  width B can be determined as follows:  f  c  +  B     2  ∫  f  c  −  B     2  f  +  B     2  NN  c ∑∫  k  = 1  f  c  −  B     2  N  ∑  i  = 1      H f     2  df  =  α α i  k  exp   −  j  π τ f 2   exp   i  j  π τ f 2     k  df   7.9   2     Some basic algebra results in  H f    2     df  N  f  c  +  B     2  ∑∫=  f  c  −  B     2  i  = 1  α  2 i  df  +  f  c  +  B     2  N  N  ∑∑∫  i  = 1  = 1 k ≠ k i  f  c  −  B     2  α α i  k  exp   −  j  ππ τ 2 f   exp   i  j  π τ f 2     df  k  H f        2  df  =  B  α  2 i  +  α α i  k  cos[  π τ   f 2  k  −  τ  i      ]     f  c  +  B     2  f  c  −  B     2  N  ∑  i  = 1  N  ∑  i  = 1  i  N  N  = 1  = k 1 ≠ k i    ∑∑     N ∑∑  N  i  = 1  = 1 k ≠ k i  H f        2  df  =  B  α  2 i  +  sin[  π τ B    k  k  −  τ   ]cos[  π τ f   2  c  k  i  −  τ   ]  i  1 π τ −− k     τ α α    i  i        f  c  +  B     2  f  c  −  B     2  ∫  ∫  ∫  f  c  +  B     2  f  c  −  B      2  f  c  +  B     2  f  c  −  B     2      354  ◾  MIMO Processing for 4G and Beyond  f  c  +  B     2  ∫  − f B c     2            N  ∑= B  i  = 1  α  2 i  +  N  N  ∑∑  i  = 1  = 1 k ≠ k i  where sinc   x  π x = sin  π x   .     ]             H f     2  df  α α i  k  [ sinc  B  τ    k  −  τ   ]cos[  π f 2  τ    cc  k  i  τ−  i   7.10   Equation 7.10 can be used to explain fading in narrowband and UWB chan- nels. The single-sum is the energy carried by the multipath and represents the mean  path gain. The double-sum represents the fading and the superposition of the mul- tipath  components  in  the  time  domain.  Depending  on  the  delay  between  mul- tipath components as well as the amplitudes of αi, the components in the double  sum either increase or reduce the channel energy.  Owing to the sinc term, the contribution of the second sum in Equation 7.10  is reduced with bandwidth. For narrowband channels, sinc[B τk − τi ] ≈ 1, and the  variation of path gain can be significant because even for a small displacement, the  terms cos[2πfc τk − τi ] can change the amplitude significantly. However, for a large  bandwidth B the second term is weighted by sinc[B τk − τi ] ≈ 0. As a result, the  channel energy from Equation 7.1 does not change for small displacements. This is  illustrated in Figures 7.6 and 7.7.  Center frequency 6 GHz, bandwidth 5 MHz  Center frequency 6 GHz, bandwidth 500 MHz  10  5  0  –5  –10  –15  –20    B d     y g r e n e   l e n n a h c   d e z i l a m r o N  10  0  –10  –20 1200    B d     y g r e n e   l e n n a h c   d e z i l a m r o N  10  0  –10  –20 1200  10  5  0  –5  –10  –15  –20    B d     y g r e n e   l e n n a h c   d e z i l a m r o N  10  0  –10  –20 1200    B d     y g r e n e   l e n n a h c   d e z i l a m r o N  10  0  –10  –20 1200  1100  1000 Tx–Rx X distance  mm   –400 –350 –300 –250 –200  Tx–Rx Y distance  mm   900 –450  1100  1000 Tx–Rx X distance  mm   –400 –350 –300 –250 –200  Tx–Rx Y distance  mm   900 –450  Center frequency 6 GHz, bandwidth 50 MHz  Center frequency 6 GHz, bandwidth 5 GHz  1100  1000 Tx–Rx X distance  mm   900 –450 –400 –350 –300 –250–200  Tx–Rx Y distance  mm   1100  1000 Tx–Rx X distance  mm   900 –450 –400 –350 –300 –250 –200  Tx–Rx Y distance  mm   Figure 7.6  Example of the spatial variation of the channel energy for various band- width B in Equation 7.10, measurements obtained for a laboratory environment as  described in Sipal  2012 .  Adapted from V. Sipal, Impact of the wireless channel on  the performance of ultrawideband communication systems, PhD thesis, University  of Oxford, Dec. 2012.   10  5  0  –5  –10  –15  –20  10  5  0  –5  –10  –15  –20      Ultrawideband Systems and MIMO  ◾  355  Measurement fc = 8 GHz Measurement fc = 6 GHz Measurement fc = 12 GHz    B d     h t p e d   e d a F  16 14 12 10 8 6 4 2 0 10–3  10–2  10–1  Bandwidth  GHz   100  101  Figure 7.7  Fade depth scaling for channel from Figure 7.6 for various center fre- quencies. Fade depth is defined as three times the standard deviation of the nor- malized channel energy in dB.  Figure 7.6 presents the measured channel energy  normalized to a local mean   evaluated according to Equation 7.10 for bandwidths 5, 50, 500, and 5000 MHz.  All measurements were performed for the same 1600 channels  grid 40 × 40  in a  laboratory environment. The details about the measurement can be found in [Sipal  et al. 2011]. In terms of fading, Figure 7.6 shows the variation of the channel energy  for a small spatial displacement and it also illustrates the increasing impact of the  sinc term as the bandwidth in Equation 7.10 is increased.  Figure 7.7 focuses in more detail on the impact of the scaling of the sinc term  with bandwidth. It analyzes the measurement from Figure 7.6 for bandwidths from  1 MHz to 6 GHz. For each bandwidth, the normalized energy for each data point  of the 40 × 40 grid is calculated. Then, the standard deviation of these energies is  determined and used to calculate the fade depth, which is defined as three times the  standard deviation of the spatial variation of the channel energy [Malik et al. 2007,  Allen et al. 2008, Sipal et al. 2011]. Figure 7.7 shows how this measure scales with  increasing bandwidth. It shows that for bandwidths beyond 1 GHz the channel  energy variation in an indoor channel is negligible.  On the basis of Figures 7.6 and 7.7, it is apparent that systems with larger  bandwidth are less prone to the impact of fading. However, this statement should  be used with caution as the impact of fading depends on the modulation and  other factors.  For IR systems such as those described by IEEE802.15.4 and IEEE802.15.6  standard, the impact of fading is negligible and fade margin does not need to be  considered  in  link  budget.  In  terms  of  MIMO,  the  fact  that  the  energy  of  the  received signal is independent of small spatial displacement means that IR UWB       356  ◾  MIMO Processing for 4G and Beyond  systems cannot benefit from spatial diversity systems, however, they still can benefit  from spatial filtering techniques.  For  OFDM  systems,  the  mean  energy  of  the  received  signal  is  independent  of the small spatial displacement, but this does not apply to individual subcarri- ers. In fact, the energy variation among individual subcarriers can be up to 20 dB  [Sipal et al. 2012b]. As a result, even though the mean received signal power is  10 dB above the receiver sensitivity, a significant number of weak subcarriers may  have negative SNR [Sipal et al. 2012b]. These subcarriers often cause a significant  increase of the overall BER and lead to failure of the communication for UWB  OFDM systems with fixed modulation [Sipal et al. 2013b].  This property, however, means that OFDM systems can benefit from both spa- tial filtering and spatial diversity schemes. Both spatial filtering and spatial diversity  in UWB OFDM systems are performed at the subcarrier level. Thus, there is little  conceptual difference between a UWB OFDM system and a narrowband OFDM  single-carrier system.  7.3  MIMO UWB Wireless Channel The preceding section introduced the channel impulse response model for a UWB  channel. In this section, it is shown how the model can be extended to describe  MIMO channels.  First, let us assume that the observations are performed in the far field of the  transmit  antenna.  Then,  the  rays  in  the  antenna  impulse  response  are  manifes- tations of plane waves and each ray manifests itself at all antenna elements of a  MIMO system.  This assumption that the channel impulse response in adjacent channels con- tains the same rays is confirmed by Figures 7.8 and 7.9. Data for Figures 7.8 and 7.9  were obtained in a rigorous channel measurement campaign reported in [Sipal et al.  2010, 2011]. The transmitter had a fixed position and the receiver was positioned  in a grid of 40 × 40 points spaced by 6 mm. The measurement was performed in a  laboratory environment across frequencies 3–20 GHz.  Figure 7.8 shows the channel impulse response of five adjacent channels. The  channel impulse response was determined for the real channel  i.e., no baseband  transformation  and therefore contains the artifacts discussed and described in  Section 7.2.2 in Equation 7.6. It is apparent that the same rays with the same  artifacts can be observed in all five channels. The gray dashed lines show that the  delay of the rays is changing linearly with linear displacement. Figure 7.9 presents  a time snapshot of the entire grid of 1600 channels to show the first two rays  from Figure 7.8. It is apparent that if the measurement artifacts were removed, a  single wave would be propagating across the plotted grid. It is also apparent that  the wave is spherical  due to range of 1.1 m  but for small displacements, that is,       Ultrawideband Systems and MIMO  ◾  357    –     R I    –     R I    –     R I    –     R I    –     R I  1 0 –1  1 0 –1  1 0 –1  1 0 –1  1 0 –1  3  3  3  3  3  4  4  4  4  4  Position x = 0 mm, y = 0 mm  5 8 Position x = 42 mm, y = 0 mm  6  7  5 8 Position x = 84 mm, y = 0 mm  7  6  5 8 Position x = 126 mm, y = 0 mm  6  7  5 8 Position x = 168 mm, y = 0 mm  6  7  5  6 7 Time  ns   8  9  9  9  9  9  10  10  10  10  10  Figure 7.8  Channel impulse response for five adjacent channels spaced by 42 mm  each, showing that the same rays, with a linear shift in delays, can be identified  in each channel.  Reprinted from V. Sipal, Impact of the wireless channel on the  performance of ultrawideband communication systems, PhD thesis, University of  Oxford, Dec. 2012.   smaller than 100 mm, the error due to plane wave approximation is acceptably  small.  To conclude, Figures 7.8 and 7.9 confirm the hypothesis that for a small dis- placement matching rays can be identified in the impulse responses of the wireless  channels and that it can be assumed that many of these rays are plane waves.  Thus,  the  channel  impulse  response  of  a  MIMO  channel  with  NR  receiver  antennas and NT transmitter antennas can be mathematically formulated as fol- lows [Malik et al. 2005]:     h C m n ,  ,  t      =  t    −  τ  i  −  τ     i m n , ,   7.11   N  ∑α δ  i  i  = 1         358  ◾  MIMO Processing for 4G and Beyond  t = 4 ns  t = 6.75 ns  0  50  100  150  200     m m      y   n o i t i s o P  0  50  100  150  200     m m      y   n o i t i s o P  –60  –65  –70  –75  –60  –65  –70  –75  0  100  50 150 Position x  mm   200  0  100  50 150 Position x  mm   200  Figure 7.9  Snapshots of 40 × 40 wireless channels showing the plane wave.   Reprinted from V. Sipal, Impact of the wireless channel on the performance  of ultrawideband communication systems, PhD thesis, University of Oxford,  Dec. 2012.   where hC,m,n t  is the channel impulse response between antennas m and n and τi,m,n  are the delays incurred due to the small displacement of the antennas.  Under  the  plane  wave  assumption, τi,m,n  can  be  expressed  using  simple  path  delay geometry as a function of antenna spacing and AoA AoD when the geometry  and orientation of the transmitter and receiver arrays are known.  As mentioned earlier, these equations are valid only for a small displacement.  In most cases for an indoor environment and range larger than 1 m, displacements  below 10 cm are usually sufficiently small so that the path gain of individual rays  does not change significantly, that is, change in αi due to change in path gain, shad- owing, or antenna gain  due to changed AoA AoD  can be neglected. For ranges  below 1 m, the limit of what counts as a small displacement is smaller because the  same absolute displacement results in larger relative change of path loss, that is, the  αi coefficient change faster with displacement.  The overall MIMO channel impulse response comprises the individual chan- nels from Equation 7.11. The specific results, however, depend on the MIMO oper- ation applied to the signals received by individual antenna elements.  7.4  UWB Antenna Arrays Antenna arrays are a fundamental component of most MIMO systems. Owing to  the available bandwidth, UWB antenna arrays possess some specific properties not  present in conventional antenna arrays [Kaiser et al. 2009]. For practical applica- tions, however, caution is required because as with fading in UWB channels, many  statements about UWB arrays are not general. They are applicable to certain array       Ultrawideband Systems and MIMO  ◾  359  geometry and certain signal types with specific bandwidth. These limitations will  be discussed in more detail here.  7.4.1   Difference between Narrowband and UWB Array,   Beam Patterns  There are two basic differences between a UWB and a narrowband antenna array  behavior—the duration of the signals processed by the array and the bandwidth of  the signal.  In  narrowband  systems,  signal  bandwidths  are  on  the  order  of  up  to  a  few  MHz. For instance, the IEEE802.11 standard specifies the subcarrier bandwidth of  0.3125 MHz  IEEE802.11 . The duration of such a signal multiplied by the speed  of propagation is significantly larger than the physical dimension of typical arrays.  Antenna arrays are thus described by array factors [Balanis 2005]. The array factor  description assumes a signal at a single frequency being radiated received by each  array element. To describe the array reception radiation in different directions, the  signals are summed in the complex domain considering the phase shifts caused by  geometric path differences [Balanis 2005].  For UWB arrays, the signal can be extremely short, that is, less than 1 ns. Hence,  it is possible that for some antenna geometries and azimuth angles, the received  transmitted signal is a pulse train. In other words, the signals do not superpose in  the time domain. Additionally, due to the large bandwidth, a single phase shift as  a descriptor for the geometrical path differences between rays received transmitted  by different antenna elements cannot be used.  As a result, time-domain descriptors for UWB antenna arrays, referred to as  beam patterns, have been introduced, for example, in [Kaiser et al. 2009]. Consider  Figure 7.10 showing a uniform linear array with N elements spaced by a distance d.   y t   ϕ  s t – τ1    N – 1 d  s t – τi   s t   τ1 ... τi ... τN  s t – τN   Figure 7.10  UWB antenna array transmitting signal s t  with limited duration.      360  ◾  MIMO Processing for 4G and Beyond  The transmitted signal s t  is delayed by delays τi which can be adjusted to control  the direction of the main beam.  The transmitted signal y t,φ  in direction φ in the far-field can then be described as  y t   ,  ϕ     =  −  i    −    1  sin  ϕ τ  −  i  N  ∑  i  = 1  s     t  d c         7.12   For far-field beam steering in direction φ0, that is, τ  τ possible to rewrite Equation 7.12 as follows [Malik et al. 2006]:  + = 1  i  i  +  d c   sin  ϕ  , it is   0  y t   ,  ϕ     =  −  i    −    1   sin  ϕ  −  sin  ϕ  0   7.13   N  ∑  i  = 1  s     t  d c          The beam patterns then characterize the properties y t,φ  as a function of  azimuth angle. These properties can be: the maximum power; the total radi- ated energy; or the peak signal amplitude [Kaiser et al. 2009]. Here, the total  radiated energy criterion is investigated in more detail to show the relationship  between  narrowband  and  UWB  arrays.  We  define  beam  pattern ε φ, φ0   as  follows:  ε ϕ ϕ  ,     0  ∞  ∫   , y t = −∞ ∞ ∫  −∞      s t  2  ϕ    dt  2  dt     Using Equation 7.13 and some basic algebra, it is possible to express ε φ, φ0  as  ε ϕ ϕ   ,     0  =  N  − 1  ∑ ∑i  =  0  N  − 1  j  = 0 R  ss  R i    ss     0  −  j  ∆ τ          τ ss     −∗ τ where R t   complex conjugation, and ∆τ  s t s      =  −∞  dt   d c   sin  ∞∫  ϕ  −  sin  ϕ   .  0   is the autocorrelation function with * denoting   Considering that autocorrelation is a Hermitian function    R  τ      ss  =  R  τ −∗   ss    ,   it   is possible to further simplify Equation 7.15 into  ε ϕ ϕ   ,     0  =  N  −∑N  +  = 1  i  1     − N i R  ss  ℜ       0  {   R i ss  τ ∆  }        7.14    7.15    7.16                      Ultrawideband Systems and MIMO  ◾  361  Assuming that s t  is a bandpass signal s t  = b t cos 2πfct  with pulse envelope  b t . This is a realistic assumption, because the IEEE802.15.4 and IEEE802.15.6  standards  indeed  use  bandpass  signals.  The  final  expression  for ε φ, φ0   can  be  obtained as  ε ϕ ϕ ,       0  =  1  N  −∑N  +  = 1  i     − N i  ℜ    { τ ∆ R i   bb R     0 bb  }   cos   π f 2  c  τ ∆      7.17         Equation 7.17 can be used to explain the behavior of narrowband and UWB  arrays. For narrowband antennas, the geometric path delay in the array is negligible  compared to the duration of the signal. Thus, it is possible to use the approximation  Rbb iΔτ  ≈ Rbb 0 . As a result, the beam pattern is defined only by the phase shifts in  the term cos 2πfcΔτ . Indeed, the result from Equation 7.17 for this case equals to  the square of the classical array factor.  For UWB signals, specifically for the impulse system, the properties of the array  also depend on the shape of the envelope signal b t . As bandwidth increases, the  impact of the cos term in Equation 7.17 is reduced. This dependency is typically  manifested as smoothing of nulls in the beam pattern as shown in Figure 7.11.  From  Equation  7.17,  it  is  apparent  that  for  large  bandwidth  and  azimuth  angles  far  from  the  main  beam,  the  beam  pattern  assumes  a  constant  level  10 log10N, which is due to the fact that for these angles it is possible to approxi- mate Rbb iΔτ  = 0 for all i ≥ 1. This is observed for the sparse array and bandwidth  of 4 GHz in Figure 7.11.   a     B d       0  ϕ    ,  ϕ   ε   0 1 g o  n r e t t a p m a e b   y g r e n E  l   0 1  15 10 5 0 –5 –10 –15 –20 –25   b     B d       0  ϕ    ,  ϕ   ε   0 1 g o  n r e t t a p m a e b   y g r e n E  l   0 1  15 10 5 0 –5 –10 –15 –20  B = 1 MHz B = 500 MHz B = 1 GHz B = 4 GHz  –50  0  50 Azimuth angle ϕ  deg   B = 1 MHz B = 1 GHz B = 4 GHz –50  0  50 Azimuth angle ϕ  deg   Figure 7.11  Beampatterns for six element UWB antenna array transmitting sig- nal Gaussian pulse b t  with various bandwidths modulated at center frequency  of 7.25 GHz. Elements spaced by  a  2 cm and  b  5 cm  enabling the existence  of grating lobes .  Reprinted from V. Sipal, Impact of the wireless channel on the  performance of ultrawideband communication systems, PhD thesis, University of  Oxford, Dec. 2012.       362  ◾  MIMO Processing for 4G and Beyond  7.4.2  Impact of Beam Patterns on Practical Systems From Equation 7.17, it is apparent that the radiation patterns of an array depend  strongly on the properties of the signal envelope Rbb iΔτ , however from previous  Section 7.4.1 it is apparent that the bandwidth of the signal plays a crucial role.  First, for OFDM systems, array factors can be used since the array actually  transmits  a  large  number  of  narrowband  signals  in  parallel,  rather  than  a  short  UWB impulse. However, the impact of the center frequency must be noted. In the  language of the classical array factors, the phase shift between antenna elements is  a variable of frequency. Thus, the array has different radiation properties for each  subcarrier of the OFDM symbols. The practical implication is that MIMO beam- forming has to be performed on a subcarrier basis.  In terms of IRs, it is noticed in Figure 7.11 that even for bandwidths of 500 MHz  and 1 GHz, there is a little difference between the narrowband and UWB beam  patterns. Consequently, [Sipal et al. 2012a] explored the upper bandwidth limit of  array factor as a descriptor for IR. The work concluded that for impulse signals with  bandwidth below BUL, array factors can be used without a significant error. The  bandwidth BUL was empirically found to be [Sipal et al. 2012a]     UL = B  0 16 . − d N     [ 1  ]GHz      7.18   As observed in Equation 7.18, the upper limit in bandwidth is inversely pro- portional to the physical dimensions of the array. Thus, it can be shown that for  practical arrays and bandwidths below 1 GHz, the classical array factors, evaluated  at the signal’s center frequency, can be used.  Grating lobe suppression is another interesting feature of sparse UWB arrays.  Grating lobes appear in antenna arrays with element spacing larger than a half- wavelength.  For  spacing  larger  than  a  wavelength,  the  energy  radiated  in  the  direction  of  the  grating  lobes  equals  the  energy  radiated  in  the  main  lobe.  The  beamforming ability of the array is compromised because the grating lobes cannot  be controlled independently of the main lobe. However, [Kaiser et al. 2009] reports  that UWB arrays do not manifest grating lobes.  [Sipal et al. 2012c] studied this property in more detail and found that the  transmitted pulse requires a relative bandwidth of more than 100% to effectively  suppress grating lobes. Such a bandwidth is often used in theoretical works, but  in current practical systems such as IEEE802.15.4 and IEEE802.15.6, the relative  bandwidths are below 30% for the lowest center frequency in the US band. In fact,  relative bandwidth of 100% is not currently allowed by the EIRP limits in Europe,  Japan, and Korea.  To conclude the section on UWB arrays, it is noted that the case of UWB  antenna arrays is different from the narrowband case. The UWB arrays therefore  exhibit many interesting properties, but it is equally important to understand that       Ultrawideband Systems and MIMO  ◾  363  these  properties  cannot  be  found  in  all  UWB  systems  with  bandwidths  greater  than 500 MHz. In other words, one should be aware of the limitations of state- ments relating to UWB arrays.  7.5  UWB MIMO MIMO-based UWB OFDM can be considered similar to narrowband systems.  This is the case especially for the high-speed UWB OFDM where multiple slower  data streams are transmitted in parallel. In principle, the algorithms are the same as  in narrowband OFDM systems because they are performed on the subcarrier basis,  that is, the performance is optimized for multiple narrowband channels in paral- lel. In other words, many algorithms discussed in other chapters of this book can  be directly applied to UWB OFDM systems. Rather than repeating information  contained elsewhere in the book, some of the distinctive specifics associated with  UWB MIMO systems are discussed here.  7.5.1  EIRP-Constrained Radiation The first and foremost difference between UWB MIMO and IEEE802.11 MIMO  is the fact that the transmitter for UWB is EIRP constrained, whereas in IEEE802.11  the  transmitter  is  power  constrained.  Power-constrained  systems  cannot  exceed  the total radiated power but they may choose the spatial distribution of the radia- tion, that is, they can increase the radiation in a certain direction and reduce it in  another  within certain limits . EIRP-constrained systems, however, can reduce the  radiation in undesired direction but they cannot allocate more power to the desired  direction [Vithanage et al. 2009].  This difference means that while UWB can benefit from transmit beamform- ing such that individual paths are summed constructively at the receiver, the algo- rithms for power-constrained MIMO systems cannot be used directly [Vithanage  et al. 2009]. The optimum solution to the EIRP-constrained problem is a complex  convex  optimization  not  suitable  for  practical  implementation  [Vithanage  et  al.  2009].  UWB receivers are not limited by EIRP. Thus, a UWB SIMO system can use  algorithms different from a UWB MISO system. Due to the limitations on the  EIRP, a SIMO system can be expected to provide better performance enhancement  than a MISO system.  7.5.2  Grating Lobes, Element Spacing, and Antenna Selection Another challenge for UWB systems is antenna spacing for systems operating in  the entire UWB band. The UWB band in the United States spans from 3.1 to  10.6 GHz. With spacing that optimizes performance at the lower end of the band,       364  ◾  MIMO Processing for 4G and Beyond  grating lobes appear at the upper end of the band which compromises the benefits  of beamforming. With spacing that prevents grating lobes at the upper end of the  spectrum, the antenna elements are too close at the lower end of the spectrum so  that beamforming is effectively nonexistent and channel correlation is strong.  One approach to UWB MIMO not affected by grating lobes is antenna selec- tion. This is a diversity scheme in which each subcarrier is transmitted by exactly  one antenna. Through channel sounding, the system determines which antenna  is more suitable for transmission of each subcarrier and the subcarriers are then  assigned as required [Vithanage et al. 2009].  This approach has multiple advantages. First, it is inherently EIRP constrained  [Vithanage et al. 2009]. Second, there are no issues with grating lobes [Vithanage  et al. 2009]. Third, it is a spatial diversity scheme which improves performance by  mitigating the impact of fading. Fading, as described in Section 7.2.5, is the main  limiting factor for UWB OFDM systems. Due to fading, a nonnegligible number  of subcarriers have very low or even negative SNR, even for mean signal energy  well above the noise floor. These subcarriers contribute mostly to the overall BER  [Sipal et al. 2012b]. Antenna selection can, despite its simplicity, address this issue  and  significantly  improve  the  performance  of  an  OFDM  UWB  system.  This  is  illustrated in Figure 7.12.  Figure 7.12 shows the BER improvement a WiMedia OFDM system operating  at 200 Mbps would achieve in a measured channel with a 4 × 1 antenna selection.   10–1  10–2    –     R E B  10–3  10–4  SISO 4 × 1 Antenna sel.  1  2  3  4  5  6  7  8  9  10  Distance  m   Figure 7.12  Gross BER performance of a WiMedia OFDM system at 200 Mbps  for four SISO channels and a 4 × 1 antenna selection. The figure uses measured  wireless channel in an office environment. The dashed line represents strength of  the forward error correction in the WiMedia standard.  Reprinted from V. Sipal,  Impact of the wireless channel on the performance of ultrawideband communi- cation systems, PhD thesis, University of Oxford, Dec. 2012.       Ultrawideband Systems and MIMO  ◾  365  Considering the highlighted strength of forward error correction, Figure 7.12 shows  that increasing the number of antennas by a factor of 4 approximately doubles the  range of the system from 3 m for a SISO system to 6 m with 4 × 1 antenna selec- tion system.  Antenna selection is not suitable for IR systems because, due to the ability to  resolve individual multipath components in the time domain, the energy received  by all antennas is the same and spatial diversity typically cannot provide any sig- nificant performance boost.  7.5.3  Complexity of MIMO for OFDM Systems Another challenging issue for OFDM-based UWB MIMO is implementation com- plexity. The optimum MIMO solution for UWB OFDM system  as well as other  OFDM system  is performed in the frequency domain, that is, on the subcarrier  basis. This means that a system with N antenna elements requires N OFDM chips. The number of OFDM chips as well as the per-subcarrier optimization can  be  associated  with  a  significant  complexity cost  increase  of  the  UWB  OFDM  system. Therefore, a cost–benefit analysis needs to be performed. The question  of feasibility is not specific to UWB MIMO. However, the complexity cost of an  OFDM communication system is proportional to bandwidth [Sipal et al. 2012d].  As a result, a UWB OFDM chip is already more than 25-times more complex  costlier than the IEEE802.11a chip, and 65-times more complex than DVB-T  chips. Thus, many MIMO techniques increase the cost of narrowband systems  by a few cents, but they may not be feasible for UWB because they increase the  cost on the order of a few dollars, which may be prohibitive for many consumer  electronics applications.  7.6  UWB Localization It has been suggested that we are about to enter an era of technological revolu- tion triggered by the advent of machine-to-machine communications [Evans et al.  2012]. With the decrease of cost of wireless communication, billions of devices are  expected to be equipped with the capability to communicate and share information  and to be controlled wirelessly [Evans et al. 2012]. It is conceivable that for many  of these applications, the localization of individual devices will play an important  role. Therefore, much research effort has recently focused on localization in wire- less sensor networks. UWB and UWB MIMO play a pivotal role in these activities  because the properties of UWB signals and UWB wireless channels are suitable for  these applications.  In this section, the main concepts of localization in wireless sensor networks  will be introduced and it will be shown how localization can benefit from the prop- erties of UWB and UWB MIMO systems.      366  ◾  MIMO Processing for 4G and Beyond  There are three main localization principles considered in the literature which  can all benefit from the properties of UWB systems. These are [Gezici et al. 2005]   ◾ Received signal strength  RSS  methods  ◾ Time-of-arrival  TOA  and time-different-of-arrival  TDOA   ◾ Angle-of-arrival  AOA  methods  7.6.1  RSS Ranging The objective of ranging is to determine the unknown distance between an anchor  and a node. The position of the node can be uniquely determined by triangulation  if the range to three anchors with known positions [Gezici et al. 2005]: Such sys- tems based on RSS exploit the fact that the path gain, introduced in Section 7.2.1,  depends on the range between the transmitter and the receiver  7.2 . The range can  be calculated from the RSS. The main systematic errors limiting the precision of  the RSS method are fading, shadowing, and unknown path-gain properties  exact  PG0 and n in Equation 7.2 are unknown for a specific channel . As a result, RSS is  typically used in conjunction with complex RSS fingerprinting [Malik and Allen  2006]. In other words, the RSS is measured for the entire area of interest. Later,  measurements are compared to this database to determine the location.  UWB is typically not considered as a candidate technology for RSS ranging,  but UWB and UWB MIMO can help to improve its precision. The first advan- tage of UWB systems compared to narrowband systems is the fact that wideband  signals are robust to fading  see Section 7.2.5 . In an indoor environment, the use  of wideband signals with bandwidths exceeding 500 MHz effectively eliminates  fading, removing one of the most significant sources of systematic errors in RSS  systems.  If the RSS ranging system is employed in connection with MIMO, the preci- sion further increases because beamforming can enable simplification of the com- plex multipath channel into a single-path directional channel [Malik and Molisch  2006].  This  has  two  benefits.  First,  a  single  path  channel  does  not  suffer  from  fading. Second, the path gain in a single-path channel corresponds to free-space  propagation, that is, PG0 and n are known.  Despite the performance improvements UWB can provide to RSS systems, it is  typically not considered because the precision of the other two localization meth- ods is superior.  7.6.2  TOA Ranging The principle of TOA-based ranging is the measurement of the propagation delay  between the anchor and the node [Tarique et al. 2006a,b]. As with RSS methods,  localization is performed when the range of the node to three anchors is known. It  is immediately apparent that TOA methods are suitable only for LOS conditions as       Ultrawideband Systems and MIMO  ◾  367  the delay in NLOS condition does not correspond to range. Complex algorithms  have therefore been developed to identify NLOS conditions in order to reduce sys- tematic error in localization [Gezici et al. 2005].  UWB  systems  are  highly  suitable  for  this  type  of  localization,  because  the  extremely short duration of UWB impulses enables very high precision in measure- ment of delay. The precision limit of TOA-based ranging arrival is given by the  Cramer–Rao-lower-bound  CRLB , which is derived from the Fisher information  matrix. Here, we present the CRLB for TOA ranging in free space. The minimum  ranging error  var    d  given by CRLB is given as follows [Gezici et al. 2005]:  var    d  ≥  c  2 2π  SNR  β     7.19   is  the  speed  of   light;  SNR   is  the  signal-to-noise  ratio;  and   2  f  S f       2  df  ∞  −∞  ∫  S f       2  df   is the effective signal bandwidth of the sig-     β =  where  c  ∞ ∫ nal S f  .  −∞  Free-space ranging represents only a very simple case and practical UWB local- ization systems achieve precision above the CRLB. However, Equation 7.19 pro- vides  a  good  intuitive  understanding  of  the  main  issues  of  ranging  in  practical  systems.  Assuming that the ranging signal S f   is a bandpass signal, the first observation  is that the precision of ranging increases with center frequency and bandwidth of  S f  . The second observation is that range d is not present in Equation 7.19.  Although both observations are correct, the impact of SNR in Equation 7.19 has  to be considered. First, SNR decreases with range with an adverse effect on ranging  precision. Second, the path-gain, that is, SNR, decreases with frequency. Third, due  to the higher attenuation of higher frequency components, adding extra bandwidth  increases β but also reduces SNR.  Since additional bandwidth also typically has adverse effect on noise figure of  amplifiers [Sipal et al. 2012d], it is concluded here that while bandwidth enables  precise ranging, for practical systems, a compromise between β  bandwidth and  center frequency  and SNR must be considered. Also, even though CRLB offers  high theoretical precision even for negative SNR  in dB , the establishment of com- munication for such a situation is highly challenging and for practical systems often  require pulse bursts with hundreds of chips.  In practical systems, the ranging precision of TOA is further impaired by other  factors. The first and most important factor is the multipath. Only the direct path  carries  the  relevant  information  about  range.  Thus,  not  only  do  later  multipath  components in the channel act as noise and have adverse effect on the SNR, in some  cases they may be stronger than the direct path making the detection of the direct       368  ◾  MIMO Processing for 4G and Beyond  path more challenging. These issues can, to some extent, be alleviated by the use  of MIMO systems which employ spatial filtering to attenuate the later multipath  components and enable improved detection of the direct path.  Another issue of TOA systems is clock synchronization between the transmit- ter and the receiver. Therefore, the practical ranging system in IEEE802.15.4a uses  measurement of roundtrip delay. In principle, the transmitter initiates ranging and  sends a message. This message is received by the node, which sends back confirma- tion of receipt followed by information about the delay incurred at the receiver due  to processing of the ranging request. The initiator can then determine the round  trip delay with high precision. For details about the scheme, the reader is referred  to the IEEE802.15.4 standard  IEEE802.15.4 .  An alternative solution to the synchronization problem is the use of the TDOA  scheme [Gezici et al. 2005], where the node compares relative delays between sig- nals received by the anchors. This scheme is used, for example, in the global posi- tioning system.  7.6.3  AOA Localization AOA localization aims to detect the direction of the incoming wave. If the direction  of the node with respect to three anchors is known, the location can be determined.  At  first,  it  would  appear  that  the  precision  of  this  localization  scheme  depends  mainly on the physical dimensions of the array as these define the beam-width.  However,  the  advantage  of  UWB  is  the  fact  that  the  wide  bandwidth  enables  extremely short delays between the pulses received by adjacent antenna elements to  be determined [Mallat et al. 2006].  In other words, the large bandwidth enables more precise detection of the AOA  because the AOA problem is transformed into TDOA. As a result, the same chal- lenges as in the case of the TOA TDOA methods are faced by the AOA systems.  In fact, the situation is more challenging as the AOA system must not match pulses  originating  from  the  direct  path  and  indirect  paths.  Otherwise,  fundamentally  incorrect results are obtained.  7.6.4  UWB Localization: Summary This section has introduced the fundamental concepts used in wireless localization,  and explained the principles as well as their drawbacks and limitations of the meth- ods. It is noted that despite the drawbacks the precision offered by UWB for node  localization  is  significantly  superior  to  the  precision  of  any  narrowband  system.  Thus, UWB localization remains one of the most interesting wireless technologies  that can be seen as an enabler for many wireless sensor networks.  It is also noted that this section has barely scratched the surface of the topic  of UWB localization. For instance, improvement in the precision of localization  is achieved when cooperative localization is used, that is, the nodes also use and       Ultrawideband Systems and MIMO  ◾  369  share the information about the relative position with other nodes to reduce the  uncertainty of localization. Readers interested in the topic are referred to review the  works of [Gezici et al. 2005] and [Zekavat et al. 2012].  7.7  Microwave Imaging The use of UWB MIMO systems in microwave imaging is as exciting as its ability  of precise localization. Microwave imaging for breast cancer detection has attracted  significant  attention  from  the  research  community  for  almost  two  decades  and  the research has moved from theoretical simulations to clinical trials with patients  [Fear et al. 2003, Nikolova 2011].  The conventional techniques for breast cancer detection are mammography and  MRI [Fear et al. 2003, Nikolova 2011]. The main issues of mammography are the  use of ionizing radiation and patient discomfort due to breast compression. The dis- advantage of MRI is the cost of the scan. Microwave imaging is of interest due to its  potential to deliver a low-cost nonionizing method for breast cancer detection, but  numerous obstacles have to be overcome before the potential of microwave imaging  is fully achieved. In this section, we discuss some microwave imaging techniques  and their limitations as well as the limitation of microwave imaging in general.  7.7.1  Techniques of Microwave Imaging Most microwave imaging techniques rely on the contrast between the electromag- netic properties of malignant and healthy tissues. While the level of contrast is still  subject to research especially due to differences found between in vivo and ex vivo  samples [Nikolova 2011], there is a general agreement that malignant tissue has  higher permittivity and conductivity than healthy tissue, for example, [Fear et al.  2003] and [Nikolova 2011]. Most microwave-imaging techniques aim to detect this  contrast. The objective of most techniques is to achieve imaging with resolution  below the diffraction limit of half-wavelength [Nikolova 2011].  The  most  promising  microwave  techniques  that  are  capable  of  beating  the  diffraction  limit  and  that  have  reached  the  stage  of  clinical  trials  are  micro- wave tomography and UWB-pulsed radar [Fear et al. 2003, Klemm et al. 2009,  Nikolova 2011].  The principle of microwave tomography is the following. A MIMO measure- ment is performed by antennas in the proximity of the breast, for instance one  of the first practical setups from Dartmouth College consists of 32-channels and  records  data  at  multiple  frequencies  [Fear  et  al.  2003].  The  measured  channel  matrix is then compared to a simulated channel matrix that is obtained using a  breast model. The comparison is used in an iterative process to match the model  parameters with the measured signals in order to obtain an accurate image of the  breast [Fear et al. 2003]. This process is computationally challenging but it enables       370  ◾  MIMO Processing for 4G and Beyond  achieving precision on the order of a tenth of the wavelength [Fear et al. 2003,  Nikolova 2011].  Pulsed radar is a time-domain technique using synthetic focusing. The tech- nique relies on the assumption that reflections from significant scatterers will be  present in all measured impulse responses [Klemm et al. 2009, Nikolova 2011].  In its simplest form, the technique can be explained using Figures 7.8 and 7.9. In  Figures  7.8  and  7.9,  the  reflections  in  the  channel  impulse  response  originating  from the same reflector can be matched. From the knowledge of the geometrical  position of the antennas and the delays of the reflection footprints received by the  antennas, the 3D angle of arrival of each ray can be determined. In microwave  imaging, the same principle is applied considering more complex wave propagation  in the heterogeneous medium of a breast.  Despite conceptually being a time-domain technique, the measurements are  typically performed in the frequency domain using a VNA similar to the channel  measurements described in Section 7.2.3. The precision of the method is given by  the measurement bandwidth and the number of antennas. However, as will be dis- cussed in Section 7.7.2, there are limits beyond which it is not feasible to increase  the bandwidth or the number of antennas.  It is noted that, apart from the techniques mentioned above, there is a pleth- ora  of  other  microwave-imaging  techniques  that  are  being  investigated,  such  as  hybrid techniques. An example of a hybrid method is the thermoacoustic method  [Nikolova 2011], which is based on the observation that various tissue types heat  up differently  malignant tissue heats more rapidly due to higher conductivity . As  a result of heating and cooling, the expansion and contraction of the tissue induces  acoustic waves analyzed by ultrasound sensors.  7.7.2  Limitations of Microwave Imaging The  main  limitations  of  microwave  imaging  are  the  impact  of  lossy  tissue  and  antenna design [Fear et al. 2003, Nikolova 2011]. The first and perhaps the main  challenge for microwave imaging is the fact that the tissues in human body are lossy  as shown in Figure 7.13 presenting the electromagnetic properties of human tissue  according to the Gabriel model [Gabriel 1996]. The wave coupled into the conduc- tive medium is attenuated and has limited penetration depth. The skin depth for  human tissue as a function of frequency is presented in Figure 7.14. For muscle and  dry skin, the skin depth is less than 10 mm for frequencies above 2 GHz. Thus, the  detection of signals reflected from small scatterers is challenging even for systems  with a link budget as high as 120 dB [Fear et al. 2003].  This has a direct impact on the resolution and the application of these imaging  systems. Practical systems typically do not use frequencies above 3 GHz [Klemm  et al. 2009]. In the case of the pulsed radar, adding additional bandwidth above  3 GHz would actually reduce the SNR of the processed signal, in other words  the  resolution  would  not  increase  for  increased  signal  bandwidth.  In  terms  of       Ultrawideband Systems and MIMO  ◾  371  Relative permittivity of human tissue  –  Fat  Muscle  Dry skin  108  Frequency  Hz   109  1010  Conductivity of human tissue  S m  Fat  Muscle  Dry skin  108  109  Frequency  Hz   1010  Figure 7.13  Electromagnetic properties of muscle, fat, and dry skin using tissue  parameters according to [Gabriel 1996].  Muscle Fat Dry skin  108  Frequency  Hz   109  1010  Figure 7.14  Skin depth as a function of frequency for muscle, fat, and dry skin.  102  101    –     y t i v i t t i  m r e p   e v i t a l e R  100  107  101  100  10–1     m   S     y t i v i t c u d n o C  10–2  107  103  102  101     m m      h t p e d n i k S     100  107      372  ◾  MIMO Processing for 4G and Beyond  applications, the losses in tissue mean that microwaves are not suitable for imag- ing of deep tissues and the applications are limited only to breast cancer imaging  because  breasts  mainly  consist  of  fatty  tissue  with  relatively  low  conductivity   compared to other tissues in the human body  [Fear et al. 2003, Nikolova 2011]. In terms of antennas, there are two main challenges. As shown above, the elec- tromagnetic properties of human tissue differ significantly from those of free space.  Therefore, the antenna designs have to be matched in order for the signal to be radi- ated into the human body [Sipal et al. 2013a]. To increase the efficiency of radiation,  a matching liquid is typically used. For breast placed directly on the antenna, the  contact area between the antenna and the tissue depends on the patient, impacting  the antenna efficiency. With the breast immersed in a matching liquid, this issue is  resolved [Ruvio et al. 2010].  The second challenge is the physical size of the antennas and the coupling of  adjacent antenna elements. It is noted that antennas designed to radiate into high  permittivity  tissue  are  significantly  smaller  than  their  free-space  counterparts.  However, the precision of the imaging depends strongly on the number of antennas  employed. In typical proof of concept systems, two antennas are moved around the  phantom by a positioner. For practical systems, the duration of these scans is not  acceptable as the image would be distorted due to the movement of the patient.  Thus, antenna arrays are typically used, but there is only a limited space around  the breast and arrays with a large number of elements will be impacted by mutual  coupling between antenna elements, which reduces the resolution capabilities.  There  are  numerous  other  challenges  relating  to  microwave  imaging.  For  instance, it is desirable to reduce the duration of the measurement to mitigate the  impact of the patient’s movement. This requires fast multichannel VNA. Another  challenge is the design of low-loss fast-switching matrices so that a 4-channel VNA  can service a 32-antenna imaging system [Fear et al. 2003]. Despite these chal- lenges, microwave imaging remains a highly interesting research avenue. In the last  20 years, we have witnessed an enormous progress from theoretical simulations to  clinical trials and it appears only a matter of time until microwave tomographic  imaging based on UWB technology will find its way to the clinic.  7.8  Future Perspectives The relevance of UWB technology for communications, localization, and medi- cal imaging, among other applications, should not be underestimated. The main  opportunity offered by UWB technology is the vast bandwidth. UWB bandwidth  enables the emergence of many unique and interesting properties of the wireless  channel and antenna arrays, including unprecedented resolution for localization  and imaging systems.  The second opportunity is the possibility to reuse the system front-ends  ampli- fiers and antennas  that are already present in the handsets and base stations. In       Ultrawideband Systems and MIMO  ◾  373  other words, from the system perspective, the integration of UWB in an existing  system is easier than integration of a second front-end for mm-waves.  It  has  been  11  years  since  the  U.S.  Federal  Communications  Commission  granted permission for unlicensed UWB radiation. During this time the under- standing of the theoretical, practical, and economic challenges associated with the  deployment of the technology has matured considerably.  Indeed, we are beginning to see the deployment of UWB-based technology in  large-scale consumer applications. Not only can the IEEE802.11ac with 160 MHz  bandwidth  be  considered  almost  a  UWB  system,  but  practical  UWB  chips  for  wireless communication and localization are entering the phase of mass production  [DecaWave 2013].  With  the  massive  performance  boost  offered  by  the  synergy  of  UWB  and  MIMO technologies, it is reasonable to expect that UWB MIMO systems will  enable advanced future wireless systems with wide-ranging applications.  References Allen, B., M. Dohler, E. Okon, W.Q. Malik, A. Brown, and D.J. Edwards, Ultra wideband  antennas  and  propagation  for  communications,  Radar  and  Imaging,  John Wiley  &  Sons, Chichester, UK, 2006.  Balanis, C. Antenna Theory: Analysis and Design, 3rd ed. Wiley-Blackwell, New Jersey, USA,   May 2005.  de la Roche, G., A. A. Glazunov, and B. Allen, LTE-Advanced and Next Generation Wireless  Networks  Channel  Modelling  and  Propagation,  John  Wiley  &  Sons,  1st  edition,  Chichester, UK, 2013.  Evans, P.C. and M. Annunziata, Industrial Internet: Pushing the boundaries of minds and   machines, GE Imagination at Work, 26 November 2012.  Falciasecca, G. and B. Valotti, Guglielmo Marconi: The pioneer of wireless communications,  in Proceedings of the European Microwave Conference, Rome, Italy, 2009, 544–546, Oct.  2009.  Fear,  E.C.,  P.M.  Meaney,  and  M.A.  Stuchly,  Microwaves  for  breast  cancer  detection?   Potentials, IEEE, 22 1 , 12,18, Feb Mar 2003.  Gabriel, C. Compilation of the dielectric properties of body tissues at RF and microwave   frequencies, 1996. Online: niremf.ifac.cnr.it docs dielectric report.html  Gezici,  S.,  Z.  Tian,  G.B.  Giannakis,  H.  Kobayashi,  A.F.  Molisch,  H.V.  Poor,  and  Z.  Sahinoglu, Localization via ultra-wideband radios: A look at positioning aspects for  future sensor networks, Signal Processing Magazine, IEEE, 22 4 , 70–84, July 2005.  Goldsmith, A., S. Jafar, I. Maric, and S. Srinivasa, Breaking spectrum gridlock with cogni- tive radios: An information theoretic perspective, in Proceedings of the IEEE, 97 5 ,  894–914, May 2009.  Heidari, G. WiMedia UWB—Technology Choice for Wireless USB and Bluetooth, John Wiley   & Sons, Chichester, UK, 2008.  IEEE 802.11: Wireless LAN Medium Access Control  MAC  and Physical Layer  PHY    Specifications, 2012 revision, IEEE-SA. 5 April 2012.  IEEE 802.15.4: Low-rate wireless personal area networks  LR-WPANs  IEEE-SA, 16 June 2011.      374  ◾  MIMO Processing for 4G and Beyond  IEEE 802.15.6: Wireless body area networks, IEEE-SA, 29 Feb. 2012. Kaiser, T., F. Zheng, and E. Dimitrov, An overview of ultra-wide-band systems with MIMO,   Proceedings of the IEEE, 97 2 , 285–312, Feb. 2009.  Klemm,  M.,  J.A.  Leendertz,  D.  Gibbins,  I.J.  Craddock,  A.  Preece,  and  R.  Benjamin,  Microwave  radar-based  breast  cancer  detection:  Imaging  in  inhomogeneous  breast  phantoms, Antennas and Wireless Propagation Letters, IEEE, 8, 1349–1352, 2009.  Malik, W.Q. and B. Allen, Wireless sensor positioning with ultrawideband fingerprinting,  European Conference on Antennas and Propagation  EuCAP  2006, Nice, France, pp.1– 5, 6–10 Nov. 2006.  Malik, W.Q.  and  A.F.  Molisch,  Ultrawideband  antenna  arrays  and  directional  propagation  channels,  European  Conference  on  Antennas  and  Propagation   EuCAP   2006,  Nice,  France, Nov. 2006.  Malik, W.Q., B. Allen, and D.J. Edwards, A simple adaptive beamformer for ultrawideband  wireless systems, in Proceedings of the 2006 IEEE International Conference on Ultra- Wideband, Waltham, USA, 453–457, 24–27 Sept. 2006.  Malik, W.Q., B. Allen, and D.J. Edwards, Impact of bandwidth on small-scale fade depth,   GLOBECOM 2007, IEEE, 3837–3841, 26–30 Nov. 2007.  Malik, W.Q., B. Allen, and D.J. Edwards, Bandwidth-dependent modelling of smallscale  fade depth in wireless channels, Microwaves, Antennas & Propagation, IET, 2 6 , 519– 528, Sept. 2008.  Malik, W.Q., C.J. Stevens, and D.J. Edwards, Synthetic aperture analysis of multipath prop- agation in the ultra-wideband communications channel, Signal Processing Advances in  Wireless Communications, 2005 IEEE, 375–379, 5–8 June 2005.  Malik, W.Q., C.J. Stevens, and D.J., Edwards, Ultrawideband antenna distortion compensa- tion, Transactions on Antennas and Propagation, IEEE, 56 7 , 1900–1907, July 2008.  Mallat,  A.  J.,  Louveaux,  and  L.  Vandendorpe,  UWB  based  positioning:  Cramer  Rao  bound for angle of arrival and comparison with time of arrival, in Proceedings of 2006  Symposium on Communications and Vehicular Technology, 65–68, 23–23 Nov. 2006.  Mass production tape-out keeps Scensor on course for 2013 release, DecaWave Newsletter,   Molisch, A.F. et al. IEEE 802.15.4a channel model—Final report, IEEE, Technical Report,   Nikolova, N.K. Microwave imaging for breast cancer, Microwave Magazine, IEEE, 12 7 ,   Issue 9, Summer 2013.  2004.  78,94, Dec. 2011.  Ohm,  J.R.  and  H.D.  Lueke,  Signalubertragung:  Grundlagen  der  digitalen  und  analogen   Nachrichtenubertragung, 10th ed. Springer, Berlin, 2006.  Ruvio, G., R. Solimene, and M.J. Ammann, Evaluation of antenna types for RF breast can- cer imaging using 2-layer planar tissue model, in Proceedings of Microwave Conference   EuMC , 2010 European, Paris, France, 212–215, 28–30 Sept. 2010.  Standard ECMA-368 High rate ultra wideband PHY and MAC standard, ECMA, 3rd ed.    December 2008   Sipal, V. Impact of the wireless channel on the performance of ultrawideband communica-  tion systems, PhD thesis, University of Oxford, Dec. 2012.  Sipal, V., B. Allen, and D. Edwards, Effects of antenna impulse response on wideband wireless  channel, in Proc. of the Antennas and Propagation Conf.  LAPC , 2010 Loughborough,  129 132 , 8–9 Nov. 2010.      Ultrawideband Systems and MIMO  ◾  375  Sipal, V., B. Allen, and B.D. Edwards, Descriptor choice for UWB antenna arrays, in Proc.  of the European Conference on Antennas and Propagation. EUCAP 2012, Prague, Czech  Republic, 603–606, 26–30 Mar. 2012a.  Sipal, V., D. Edwards, and B. Allen, On the range of Wimedia OFDM UWB wireless, Ultra- Wideband   ICUWB ,  2012  IEEE  Conference,  Syracuse,  USA,  421–425,  17–20  Sep.  2012b.  Sipal, V., D. Edwards, and B. Allen, Bandwidth requirement for suppression of grating lobes in  ultrawideband antenna arrays, in Proceedings of the 2012 IEEE International Conference  on Ultra-Wideband  ICUWB , Syracuse, USA, 421–425, 17–20 Sept. 2012c.  Sipal, V., B. Allen, D. Edwards, and B. Honary, 20 Years of ultrawideband: Opportunities   and challenges, IET Communications, 6 10 , 1147–1162, July 3, 2012d.  Sipal, V., J.E. Browne, P. McEvoy, and M.J. Ammann, Evaluation of antenna suitability for  the use in radiomyography, in Proceedings of the Loughborough Antennas and Propagation  Conference  LAPC , Loughborough, UK, 2013, Nov. 2013a.  Sipal, V., J. Gelabert, C. Stevens, B. Allen, and D. Edwards, Frequency-selective fading of  ultrawideband wireless channels in confined environments, Microwaves, Antennas &  Propagation, IET, 5 11 , 1328–1335, August 19 2011.  Sipal, V., J. Gelabert, C. Stevens, B. Allen, and D. Edwards, Adaptive OFDM for wireless inter- connect in confined enclosures, Wireless Communications Letters, IEEE, 2 5 , 507–510,  2013b.  Tarique, Z., W.Q. Malik, and D.J. Edwards, Bandwidth requirements for accurate detection  of direct path in multipath environment, Electronics Letters, 42 2 , 100–102, Jan. 19,  2006a.  Tarique, Z., W.Q. Malik, and D.J. Edwards, Effect of bandwidth and antenna directivity  on the range estimation accuracy in a multipath environment, in Proc. of the Vehicular  Technology Conf.  VTC  2006-Spring. IEEE 63rd, 6, 2887–2890, May 7–10, 2006b.  Vithanage, C., M. Sandell, J. Coon, and Y. Wang, Precoding in OFDM-based multi-antenna   ultra-wideband systems, Communications Magazine, IEEE, 47 1 , 41–47, Jan. 2009.  Zekavat, R. and R. Buehrer, Wireless localization using ultra-wideband signals, in Handbook  of Position Location: Theory, Practice and Advances, Wiley-IEEE Press, New Jersey, USA,  1st edition, 2012.       Chapter 8 Frequency-Domain  Packet Combining  Techniques for UWB  Paulo Montezuma, Mário Marques da Silva,  and Rui Dinis  Contents 8.1  Introduction .............................................................................................378 8.2  Single Carrier with Frequency-Domain Equalization ...............................381 8.3   Iterative Frequency-Domain Packet Combining Techniques  Optimized for UWB ................................................................................383 8.4  Conventional Soft Packet Combining ARQ .............................................384 8.4.1  Packet Combining with Strong Interference Levels.......................386 8.5  Packet Combining with Diversity ............................................................386 8.5.1  Dealing with Fixed Channels .......................................................394 8.6  Performance Analysis ...............................................................................395 8.6.1  Performance Results .....................................................................396 Acknowledgment ..............................................................................................403 References .........................................................................................................403  377   378  ◾  MIMO Processing for 4G and Beyond  8.1  Introduction Currently, there is a big effort to standardize ultra wideband  UWB -based com- munication  systems  for  both  military  and  civil  applications   see  [Siwiaik  2002]  and the references therein . The reduced power spectral density  PSD  levels of the  transmitted signals allow the coexistence of UWB signals with other narrowband  systems without significant interference of the narrowband systems. Such reduced  PSD results from the low transmit power and from the high bandwidth [Siwiak  2002]  UWB signal bandwidths may exceed 25% of the central frequency .  Initially,  UWB  systems  were  spread-spectrum  based,  with  extremely  high  bandwidths and very high processing gains. This results in a system very effective  against multipath propagation impairments, namely, fading and time-dispersion  effects  [Win  and  Scholtz  1998].  Spread-spectrum  UWB-based  systems  can  be  implemented either in baseband or using a continuous wave. In the latter case, the  carrier frequency should be of the order of the signal bandwidth.  Afterwards, impulse radio technique was widely adopted in UWB signals. This  employs short pulses  typically with a duration below 1 ns , with zero mean and  a  small  number  of  zero  crossings,  combined  with  time-hopping  multiple  access   TH-MA . These pulses are sent directly to the transmit antenna  i.e., a “baseband”  transmission  is  employed ,  which  results  in  a  low  implementation  complexity.  Nevertheless,  since  the  achievable  spectral  efficiencies  with  impulse  radio  tech- niques  are  typically  low,  UWB  systems  employing  continuous-wave  techniques  have received much attention [Ishiyama and Ohtsuki 2004]. Since these pulses are  sent directly to the transmit antenna  i.e., a “baseband” transmission is employed ,  the  implementation  complexity  at  both  the  transmitter  and  the  receiver  can  be  relatively low.  Moreover, the despreading operations are usually simpler than for contin- uous-wave  UWB  options.  However,  since  the  achievable  spectral  efficiencies  with impulse radio techniques are typically low, there is an increased interest on  UWB systems employing continuous-wave techniques [Ishiyama and Ohtsuki  2004,  Popescu  et  al.  2005].  Owing  to  the  high  signaling  rates,  the  time-dis- persion  effects  associated  with  multipath  propagation  can  be  severe  in  UWB  systems. For this reason, continuous-wave UWB systems should employ block  transmission  techniques,  with  appropriate  cyclic  extensions  and  be  combined  with  FDE  techniques   frequency-domain  equalization   [Gusmão  et  al.  2000,  Falconer et al. 2002].  Orthogonal  frequency  division  multiplexing   OFDM   schemes  are  the  most  popular modulations based on this concept, but the transmitted signals have high  envelope fluctuations and a high peak-to-mean envelope power ratio  PMEPR ,  leading to amplification difficulties. For this reason, single-carrier with frequency- domain equalization  SC-FDE  schemes are particularly interesting for low-cost  UWB terminals, especially when iterative receivers are employed [Benvenuto and  Tomasin 2002, Dinis et al. 2003].      Frequency-Domain Packet Combining Techniques for UWB  ◾  379  Block transmission techniques, with appropriate cyclic prefixes and employing  FDE techniques, have been shown to be suitable for high data rate transmission  over severely time-dispersive channels [Gusmão et al. 2000, Falconer et al. 2002].  Two possible alternatives based on this principle are OFDM and single carrier  SC   modulation using FDE  or SC-FDE . Owing to the lower envelope fluctuations of  the transmitted signals  and, implicitly a lower PMEPR , SC-FDE schemes are espe- cially interesting for the uplink transmission  i.e., the transmission from the mobile  terminal to the base station  [Gusmão et al. 2000, Falconer et al. 2002], being con- sidered for use in the upcoming LTE  long-term evolution  cellular system.  A promising iterative block–decision feedback equalization technique  IB-DFE   for  SC-FDE  was  proposed  in  [Benvenuto  and  Tomasin  2002]  and  extended  to  other diversity [Marques da Silva and Dinis 2011] and spatial multiplexing scenar- ios [Vutecic and Yuan 2002, Gusmão et al. 2003]. These IB-DFE receivers can be  regarded as iterative DFE receivers with the feedforward and the feedback operations  implemented in the frequency domain. Since the feedback loop takes into account  not just the hard decisions for each block but also the overall block reliability, error  propagation is reduced. Consequently, IB-DFE techniques offer much better per- formance than noniterative methods [Benvenuto and Tomasin 2002, Dinis et al.  2003]. Within these IB-DFE receivers, the equalization and channel decoding pro- cedures are performed separately  i.e., the feedback loop uses the equalizer outputs  instead of the channel decoder outputs . However, it is known that higher perfor- mance gains can be achieved if these procedures are performed jointly. This can be  done by employing turbo equalization schemes, where the equalization and decod- ing procedures are repeated in an iterative way [Marques da Silva and Dinis 2011],  being essential in multiple-input multiple-output  MIMO  schemes with high-order  modulations. For these reasons, SC-FDE schemes are particularly interesting for  low-cost UWB terminals, especially when iterative receivers are employed.  It is well known that channel noise can lead to packet errors. This problem is  particularly serious in wireless systems since fading and shadowing effects can lead  to significant decrease in the received power and, consequently, significant packet  error rates. The traditional approach to cope with an erroneous packet is to dis- card it and ask for their retransmission, which corresponds to employ conventional  automatic repeat request  ARQ  techniques. The major problem with conventional  ARQ schemes is that they can have very poor performance when the errors are  due to unfavorable propagation conditions that remain for some time, since packet  errors are likely to occur for several transmission attempts.  To  cope  with  this  type  of  scenarios,  hybrid  ARQ forward  error  correction   FEC  strategies have been proposed [Hagenauer et al. 1988, Gusmão et al. 1999].  The basic idea behind these techniques is to retain the signal associated with an  erroneous packet and to ask for additional redundancy. This is usually done by  employing a basic error correction code that is very powerful and has low rate.  This code is punctured, leading to a code with higher rate, but smaller error correc- tion capabilities that is used in the first transmission attempt of the packet. If we       380  ◾  MIMO Processing for 4G and Beyond  have an error in the packet detection, the additional bits that were punctured are   transmitted, instead of a conventional packet retransmission, increasing the error  correction capabilities of the code. The major problem with these techniques is that  we are limited by the performance of the basic code that was adopted. If we want a  very powerful basic code, we need codes that are too complex and or require very  long blocks  e.g., turbo codes [Vucetic 2002] . The basic code needs to be designed  for a worst-case scenario that is seldom used.  An alternative is to take advantage of the last received packets  regardless of the  reason of the packet loss  and combine them until we end up receiving a packet suc- cessfully. In terms of the implementation complexity, the simplest way is to employ  soft packet combining techniques that can be regarded as Hybrid-ARQ type II  techniques based on repetition codes. They allow improved performance with the  number of retransmission attempts. Hybrid-ARQ techniques are currently used in  3GPP’s high-speed downlink packet access  HSDPA , high-speed uplink packet  access  HSUPA , and LTE. In diversity combining techniques  DC , the usage of  repetition codes with soft decision can be regarded as a low-complexity version of  the conventional Hybrid-ARQ.  Moreover,  soft  packet  combining  techniques  proposed  in  [Hagenauer  et  al.  1988]  can  be  an  alternative  to  conventional  ARQ  schemes.  Within  these  tech- niques, packets associated with different transmission attempts are combined in  a soft way, allowing improved performances [Hagenauer et al. 1988]. These tech- niques can be regarded as hybrid ARQ FEC schemes based on repetition codes  with soft decision, with low encoding decoding complexity. Moreover, their per- formance  is  not  bounded  by  the  performance  of  the  basic  code,  since  it  is  not  a conventional punctured code. A promising soft combining ARQ technique for  SC-FDE was proposed in [Dinis et al. 2008], which was shown to be very effective  to cope with fading effects.  However, when very severe fading conditions affect the transmission of several  packets, the number of retransmissions can be very high, which compromises both  spectral and energy efficiencies of the system. In the majority of dispersive environ- ments, the antenna diversity is widely used to reduce the multipath fading and  increase reliability. In addition, by using diversity, having multiple transmit receive  antennas should increase data throughput.  Diversity schemes can be applied either to the transmitter or to the receiver, the  most common scheme being the use of several antennas in the receiver together with  one combining method to enhance the quality of the received signal [Proakis and  Salehi 2007]. However, in wireless mobile systems, constraints on size and power  consumption of mobile devices can impose limitations to the implementation of  this technique. However, from the base station’s side, these limitations are less wor- rying because one of them can give service to hundreds of mobile subscribers.  Using multiple antennas can result in a smaller probability of error for the same  throughput because of the diversity gain. A particularly elegant scheme for MIMO  coding was developed by Alamouti [Alamouti 1998]. The MIMO Alamouti scheme       Frequency-Domain Packet Combining Techniques for UWB  ◾  381  is a transmit diversity scheme for two transmit antennas that does not require trans- mit channel knowledge. The main objective of space–time codes is to achieve the  maximum possible diversity. Space–time codes provide a diversity gain equal to  the product of the number of transmit and receive antennas. Also, the maximum  throughput of the space–time codes is one symbol per channel use for any number  of transmit antennas. The use of multiple antennas results in increasing the capac- ity of MIMO channels. Therefore, one may transmit at a higher throughput, com- pared to single-input single-output  SISO  channels, for a given probability of error. The idea behind using a transmit diversity scheme is that maybe some of the  redundant-sent signals can arrive in a better state to the receiver than others, and by  exploiting them all together, the result should be better. The Alamouti scheme can  also be easily generalized to two transmit antennas and Nr receive antennas, in a  MIMO system. One of the biggest advantages is that the scheme requires no band- width increase because redundancy is applied in space and time across multiple  antennas. It does not require higher transmit power either. These restrictions are  the most important for wireless communication systems. The new scheme is able  to improve error performance, data rate, or capacity of wireless systems without  increasing bandwidth or transmit power. The smaller sensitivity to fading permits  the system to use a higher-level modulation  a modulation that transmits more bits  per symbol  to increase the bit rate or a smaller reuse factor to increase the capacity.  8.2   Single Carrier with Frequency-Domain   Equalization  To explain the SC-FDE schemes, we start with a brief introduction where we con- sider an SC-based block {an; n = 0,1, . . ., N − 1} transmission with N useful symbols  per block resulting directly from a mapping operation of the original data into a  selected signal constellation plus a suitable cyclic prefix  CP  longer than the overall  delay spread of the channel. Let us consider block transmission schemes where the  lth transmitted block has the form  s  l  t      =  a h t   n l T ,  −  nT s   ,   8.1   N  −∑1  =− n N  G     with Ts denoting the symbol duration, NG denoting the number of samples in the  cyclic prefix, and hT t  representing the adopted pulse-shaping filter. The signal sl t   is transmitted over a time-dispersive channel. At the receiver, the received signal is  sampled and after removing the samples associated with the CP results the follow- ing block in the time domain  {  ,y n l  ;  n  =  , , 0 1  …  ,  N  −  } 1      8.2             382  ◾  MIMO Processing for 4G and Beyond  The samples of the block are passed to the frequency domain by an N-point  discrete Fourier transform  DFT , leading to the corresponding frequency-domain  block samples {Yk,l;k = 0,1,. . .,N − 1}, where Yk,l = Hk,lAk,l + Nk,l. To minimize the  effects  of  ISI   intersymbol  interference   and  channel  noise,  the  equalized  sam- } ples of the signal  1  are obtained based on the coefficients  {Fk;k = 0,1, . . ., N − 1} that are optimized under the minimum mean square error   MMSE , which leads to the set of FDE coefficients   cid:31  A k k l, ;  , , 0 1  …  {  N  =  −  ,  F k  =  H +  * k H  k  ,  2  α  k  =  , 1 2  ,...,  N  −  1   8.3      where α is the inverse of the signal-to-noise ratio  SNR  given by  α  =  σ σ  2 N 2 s      8.4      2      E S   2     k  2  =  E N k  with α =  denoting the variances of the real  and  imaginary  parts of  the  channel  noise  {Nk,l;k = 0,1,  . . .,  N − 1}  and  the  data  samples {Ak,l; k = 0,1, . . ., N − 1}, respectively.  2 and σ s 2  In SC modulations, the data contents of a given block are transmitted in the  } { − 1  are con- time domain. Therefore, the equalized samples  verted  again  into  time  domain  by  an  inverse  DFT   IDFT   operation  leading  to  } { the block of time-domain-equalized samples   cid:31  a 1 . Then, these  n l, ; equalized samples are used in the decision process about the transmitted symbols or  block.   cid:31  A k k l, ;  In IB-DFE scheme  iterative block DFE , both the feedforward and feedback  parts are implemented in the frequency domain. Thus, for a given itth iteration, the  output samples are given by  , , 0 1  , , 0 1  …  …  N  N  =  −  =  n  ,  ,   cid:31 A   k   cid:30      B A k k  −1              it  it  it  it  it  ,          k  k   ;  =  −  …  , , 0 1  =     F Y k } { } { it  it  where  F 1   denote  the  feed-   and  B 1 k k forward and feedback coefficients, respectively, and {Ak,l;k  = 0,1, . . ., N − 1} is the  } { DFT of the hard decision of the lth block  ˘ −   it  a  for the ith itera- 1 , n l tion, associated with the transmitted time domain of the lth block {an,l; n = 0,1, . . .,  N − 1}. The feedforward and feedback coefficients are still chosen to maximize the  signal-to-interference plus noise ratio  SINR , with the optimum coefficients given by   8.5   , , 0 1  , , 0 1  …  …  N  N  N  =  −  =  −   ;  n  k  ,  ,  ;  it       F k  =   α   k  +    1     Κ it   F − ρ    H * k −     1 2     it  H  k  ,  2         8.6                Frequency-Domain Packet Combining Techniques for UWB  ◾  383  and     it       B k  =  it  −ρ 1         it    F H k  k  −       1  ,      8.7   ∑   N    is selected to assure that 1   and ρ it  is  respectively, where ΚF it  a measure of the reliability of the decisions used in the feedback loop. Since block  estimates are used by the “feedback” filter  weighed by the log-likelihoods , the  IB-DFE coefficients take into account the overall block reliability on the feedback  loop, which leads to a small error propagation effect. In fact, IB-DFE has a turbo- like behavior and can be regarded as a low-complexity turbo equalizer [Tüchler and  Hanenauer 2001].    F H k  − N 1 = 0 it  =  1  it  k     8.3   Iterative Frequency-Domain Packet Combining   Techniques Optimized for UWB  A promising soft combining ARQ technique for SC-FDE was proposed in [Dinis  et al. 2008], which was shown to be very effective to cope with fading effects. We  consider the uplink transmission in UWB wireless systems employing SC-FDE  schemes. The basic receiver structure is depicted in Figure 8.1, where the DFT  and IDFT blocks refer to implementations of discrete Fourier transform and its  inverse. The time-domain block is associated with a given user  i.e., the corre- sponding packet  is {an; n = 0,1,. . ., N − 1} where an is selected from a given con- stellation and N is the fast Fourier transform  FFT  size. As usual, for SC-FDE  block transmission techniques, a suitable cyclic prefix longer than the overall delay  spread of the channel is added to each time-domain block. For the sake of sim- plicity, we assume a one-to-one correspondence between time-domain blocks and  user packets.  If errors are detected in a received packet, we ask for its retransmission, but we  store the signal associated with each transmission attempt. Although we could keep  trying to transmit the packet until there were no errors, in practice, there is a maxi- mum number of transmission attempts NR. If we fail after NR attempts, we need  to change the transmission parameters  transmit power, carrier frequency, base sta- tion, etc.  since the channel is too bad. The packet associated with the rth trans- } { mission attempt of {an; n = 0,1,. . .,N − 1} is  a 1 . The received  r   ; n signal associated with the rth transmission attempt is sampled and the cyclic prefix  { } is removed, leading to the time-domain block  y 1 . If the cyclic  prefix is longer than the overall channel impulse response, then the corresponding  { frequency-domain block is  Y N  n r   ; n } 1  where  , ,..., 0 1  , ,..., 0 1  , ,..., 0 1  r   ; k  N  N  −  =  −  =  =  −  n  k  ,     Y  r     k  =  r     A H k  r     k  +  N  r    , k      8.8       384  ◾  MIMO Processing for 4G and Beyond  {Bk  i }  x  Σ  x   i } {Bk   a    1 } { yn   b   DFT  …  DFT  DFT  …  DFT  X  X  X  X   1,i }  {Fk  1 }  {yk   i–1  {Ak            }   i–1  {an             }  DFT  Delay  {Fk   R,i }  Σ   R } { yn  {yk   R }  ~ {Ak   } i   IDFT  –  +   i–1  {Ak            }   i–1  {an             }  DFT  Delay  {Hk   1 *}  { yn  1 }  {yk   1 }   R *}  Σ  {Hk  R }  {yk   R } { yn  {Ck  i }  –  Σ  x  +  {Ak   } i ~  IDFT  {an   } i   Dec.  {an   } i ~  {an   } i   Dec.  {an   } i ~  Figure  8.1  Receiver  structure  r i   ,   F k  i    ,  k  ,...,  , 1 2  r     k  H  C  =  =  R   .  ∗  r   a   and  alternative   format    b ,  since   { = r   ; r     denoting  the  channel  noise.  A k with  N k k { = a n r   ; , ,..., N 0 1 n quency response for the rth transmission attempt.  } 1  and  H k r   ; k  0 1 , ,...,  N  {  −  =  N  } , ,..., 0 1 1   is  the  DFT  of  } − 1  is the overall channel fre-  −  8.4  Conventional Soft Packet Combining ARQ Let us assume that we have R versions of the packet  i.e., there were R transmission  attempts . Our receiver, depicted in Figure 8.1, consists of an iterative frequency- domain receiver where, for a given iteration i, the frequency-domain samples at the  output are given by      cid:31 A i     k  =  r i   ,   F Y k  r     k  −  i       B A k k  i  − 1  ,     R  ∑  r  = 1   8.9       Frequency-Domain Packet Combining Techniques for UWB  ◾  385  ,  r  k  =  −  =  R  N  }  1  , 1 2  ,...,  r i   ,  F k     and {  , ,..., 0 1  = −    B k i 1  are the feed- , ,..., } , N where { 0 1 k i− =    A 1 forward and the feedback coefficients, respectively. { } 1  denotes  , ,..., 0 1 k N , k = − = − the  DFT  of  the  average  data  estimates  { } , ,..., a 1 DFT{ N k , 0 1   1   n k 1 }, where  an denotes the average symbol values conditioned to the  FDE output. For quadrature phase shift keying  QPSK  constellations, these average  values are given by [Marques da Silva et al. 2010]  0 1 , ,...,    A k  N  −  =  −  −   1  ,  i  i  a     i n  =  tanh     L I i     n 2    +  j  tanh     L Q i     n 2     ,      without loss of generality, we assume that  an  2  2= , i.e.,  a  n = ± ±1  j   , with  L I i     n  =  2 2σ eq  Re  {  cid:31  a     i n  }  L Q i     n  =  2 2σ eq  Im  {  cid:31  a     i n  }        denoting the log-likelihood ratios  LLRs  of the “in-phase bit” and the “quadrature   cid:31  i      cid:31  bit,”  associated  with  an,  respectively,  and  { IDFT { A a ;   i     n k k 2  is given by  }. The variance σ eq 1  , ,..., 0 1  0 1 , ,...,  } 1  N  N  =  =  =  −  −  n  ;  σ eq 2  =  a n  −   cid:31  a i     n  1 2  E     2    ≈  1 N 2  1  N  −∑  n  =  0   cid:30  a i     n  −   cid:31  a i     n  2  ,     j   are the hard decisions associated with   cid:31 an  i    = ± ±1  cid:22  where  a i   . The simplest way  n to design the receiver is to consider only the channel noise, which corresponds to  ignore the interference in its design. Under these conditions, the optimum feedfor- ward coefficients, for a given iteration, can be written as  r i   ,   F k  =   cid:15  r i   ,   F k γ  i      ,     with γ  i  and  back coefficients Bk   cid:15    ,   as defined in [Dinis et al. 2008]. Moreover, the optimum feed- r i Fk  i    are also defined in [Dinis et al. 2008].   8.10    8.11    8.12    8.13    8.14   and                     386  ◾  MIMO Processing for 4G and Beyond  8.4.1  Packet Combining with Strong Interference Levels The receiver can be designed taking into account the characteristics of the inter- ference, which is added to the thermal channel noise.* This means that the FDE  output is still given by Equation 8.9, with the feedforward coefficients given by  Equation 8.14, but with   cid:15  r 1   ,   F k  =  H  r    * k   α     eq r     k  +    1  −     i  ρ     R  ∑ −     1 2    r  = 1  ’  H  r   ’  k  2       ,  rr  = 1 2,  ,...,  R  ,   8.15          eq r  α k  =  E N      r k         r k  2     2    +  E A  k   E I   2   ,     r     denoting  the  interference  at  kth  subcarrier  and  the  rth  retransmission  eq r    can be regarded as the inverse of the equivalent SINR . The cor-  with  Ik attempt  i.e., α k relation coefficient ρ i  is given by −∑1  ρ    i  =  N  1  2  N     n  =  0  Re  { a     i n  } +  Im  { a     i n  }    .     The optimum feedback coefficients are the same as defined in [Gusmão et al.    8.16    8.17   where           2003].  8.5  Packet Combining with Diversity The MIMO Alamouti code is a simple space–time block code  STBC , where the  different replicas sent for exploiting diversity are generated by a space–time encoder,  which encodes a single stream through space using all the transmit antennas and  through time by sending each symbol at different times.  The Alamouti STBC scheme uses two transmit antennas and Nr receive anten- nas  and  can  accomplish  a  maximum  diversity  order  of  2Nr  [Alamouti  1998].  Moreover, the Alamouti scheme has full rate  i.e., a rate of 1  since it transmits  two symbols every two time intervals. Next, a description of the Alamouti scheme   *  For the sake of simplicity, we will assume that the interference is Gaussian with zero mean and   uncorrelated from subcarrier to subcarrier. The extension to other cases is straightforward.      Frequency-Domain Packet Combining Techniques for UWB  ◾  387  is provided for both one and two receive antennas, followed by a generalization  for Nr receive antennas. For an Alamouti STBC with two transmit antennas, the  time-domain block to be transmitted by the mth antenna are sn,i and the encoding  operation can be described in time domain as  see also Chapter 1, for a description  of the STBC scheme   Time − l 1 2 l 2  1  Antenna } { s n l 2 1 , - − s { } * n l 2 ,  2  Antenna } },  s { s { * n l 2 ,  n l 2 ,  − 11      8.18      where we assume that the rows of each coding scheme represent a different time  instant, while the columns represent the transmitted symbol through each different  antenna, as shown in Figure 8.2. In this case, the first and second rows represent  the transmission at the first and second time instant, respectively.  S1  * –S2  S2  * S1  Tx antenna 1  Δ  h1 = h1,1  Δ  h2 = h2,1  Tx antenna 2  Rx antenna 1  n1, n2  +  Channel estimator  h1  h2  h1  h2  ∧ S1  Maximum likelihood detector  ∧ S2  Combiner  C1  C2  Figure 8.2  STBC with two transmit and one receive antenna.      388  ◾  MIMO Processing for 4G and Beyond  Let us define s  .  Considering the matrix–vector representa- tion, the Alamouti scheme encoding operation becomes [Marques da Silva et al. 2012]  1 cid:24   and s  +  cid:24  2 1  n i,2  n i,  s  s  2  G  2  s s   2 1 = −   s s * *   2 1  cid:31   cid:30  cid:29   cid:28  cid:29  space       time      8.19   At a time t =  2i − 1 T, symbols s1 and s2 are transmitted from antenna 1 and  antenna 2, respectively. Assuming a symbol duration of T, at time t = 2iT are trans- mitted the symbols −s2  * from antenna 1 and antenna 2, respectively.  * and s1  For one receive antenna, the received signals are  y 1 y  2  = =  = h r t     + rr t T      1 1   ,    s n i 2 , = − h  + 1 1   ,    h s * n i ,  2 1   ,    s  + 2 1  + n i 2 1 , + h  + 2 1   ,    1     n 1 s * n i 2 ,  = +  h s 1     1 n 2  + n i 2 , = −  h s 2 2 h s * 1 2  + n 1 + h s * 2 1   8.20   +  2,,   n  ,      cid:24       denotes the received signal at antenna l  for one receive antenna, we have  l where yn i , l = 1  at time iT, and hn i   m l ,   denotes the channel response for the path between the  , mth transmit antenna and lth receive antenna. For the sake of simplicity, we assume    Ntr Nr , where Ntr and Nr are the number of transmit and receive anten- h n i , nas, respectively. The subscript and superscript associated with the receive antenna  are omitted when we have only one antenna at the receiver, so in this case, we may     1 2 cid:24  assume h . Before being sent to the equalizer, the received sig- h n i, nals are combined as follows:     2  and h n i,  h Ntr Nr  1 cid:24  h  ,  c 1 cc  2  = =  h y * 1 1 h y * 2 1  + −  h y * 2 2 h y * 1 2  = =  h h s * 1 1 1 h h s * 2 1 1  + +  h h s * 1 2 2 h h s * 2 2 2  + +  h n * 1 1 h n * 2 1  − +  h h s * 2 1 2 h h s * 1 1 2  + −  h h s * 2 2 1 h h s * 2 1 1  + h n * 2 2 − **,   h n 1 2   8.21   with the corresponding representation in frequency domain given by   C  C   k i , 2  k i ,  + 2 1    =   H H     * 1 k i ,   2 k i ,   *            2 H k i , −     1 H k i ,        YY k i , 2  * Y  k i ,  2 1+      ,     =  −  =  m       k  {  N  1 }  DFT  0 1 , ,...,  H k ;    represents  the  where  channel frequency response for the kth subcarrier and the mth transmit antenna,  = DFT = n N , ,..., 0 1   }   is  the  noise  term  and  { { i k i , N − 0 1 1 }. , ,...,  Assuming for now a linear FDE for SC schemes, the Alamouti post- processing becomes  0 1 , ,...,  , ,..., 0 1  ; Y k , k i  DFT  h   m n  1 }  } 1  N  N  =  −  =  n  n  , n i  y  {  {  ;  ;     =  −  N  −  1   cid:31 A + 2 1 , k i  =      * 1 Y H k i , 2 k i , α +  + Y rr∑ Nt  m  = 1  * + 2 1 , k i H    2 H k i , 2   m   k i ,   *    ,      8.22    8.23                      Frequency-Domain Packet Combining Techniques for UWB  ◾  389      cid:31 A , k i 2  =   Y     * 1 , k i  H + , 2 1 k i ∑α +  + Ntr  m  = 1    2 * Y H , k i 2 , k i 2   H    m , k i       ,      8.24   where  A k ; ; n regarded as the inverse of the equivalent SNR.  , ,..., 0 1  DFT  a n i ,  N  =  −  k i ,  } = 1  {  {  =  , ,..., 0 1  N  −  }   and  α  can  be  1  Let us consider now the case of two receive antennas, as depicted in Figure 8.3,   in which the received signals are given by  S2 *  S1  Tx antenna 2  Rx antenna 2  n3, n4  +  S1  *  –S2  Tx antenna 1  Rx antenna 1  n1, n2  +  Δ  h1 = h1,1  Δ  h3 = h2,1  Δ  h2 = h1,2  Δ  h4 = h2,2  h1 h2  Channel estimator  h1  h2  Combiner  h3 h4  Channel estimator  C1  C2  h3  h4  Maximum likelihood detector  Figure 8.3  STBC for two transmit and two receive antennas.      390  ◾  MIMO Processing for 4G and Beyond  1     y 1 1     y 2   2 y 1 2   y 2        = = − == = −  + + 1     h s h s n 2 1 2 1 1 1 1 , , + +     1 h s h s n * * 2 1 1 1 1 2 2 , , + + 2     h s h s n 1 2 2 2 1 2 1 , , + +   2 h s h s n * * 2 2 2 1 1 2 2 , ,   ,        denote the received signal by the lth antenna at time 2iT and  where  y l     and  y l 2 1  2i + 1 T, respectively  the same notation applies to the noise terms n l     .      and n l 1 1 1      cid:24   cid:24  Assuming  y h h , h ,  3 2 1 and h h , we may write 4  ,  cid:24  2 2  h h 1  ,  h 1 1 ,  1     2    y 1  y 1  2   2   cid:24    cid:24    cid:24    cid:24    cid:24   1 2 ,  2 1 ,  y  y  y  y  y  ,  ,  ,  ,  2  2  4  3                2  y 1 y y y  3  4          =  s s 2 1 − s s * * 2 1 0 0 0 0          0 0 0 0 s s 2 1 − s s * 1  * 2          h 1 h 2 h 3 h 4                  +  n 1 n 2 n 3 n 4                     with the resulting signals after the combiner  c 1  c  2  h y * 1 1 2 h 1 h y * 2 1 2 h 1       + + − +  h y * 2 2 2 h 2 h y * 1 2 2 h 2  + + + +  h y * 3 3 2 h 3 h r * 4 3 2 h 3  + + − +  h y * 4 4 2  h 4 h y * 3 4 2 h 4  s 1    +    s  22  −  h n * 1 1  +  h n 2 2  * ++  h n * 3 3  +  h n * 4 4  h n * 1 2  +  h n * 2 1  −  h n * 3 4  +  h n * 4 3  ,   8.27      and in the matrix–vector representation results  c 1 c  2        =   ∑  4  l   = 1 0  h l   2  0        ∑  4  l   = 1  h l  2   ⋅  s 1 s  2        +       *nn h 1 1 − h n * 1 2  + h n * 2 2 + h n * 2 1  + h n * 3 3 − h n * 2 4  + h n * 4 4 + h n * 4 3  .      = = = =        Now, for the conventional SC-FDE decoding, the postprocessing STBC for  two transmit antennas and two receive antennas becomes  for the lth branch of  receiver    cid:31 A l     k i , 2  =  ∑  2  Y = l 1 + α  l     + k i 2 1 , 2  H  l    ,  * 1 k i ,  +  = ∑∑  m  1  2  l  = 1  l l   ,   2    * Y H k i k i , , 2 2  H    k  m l ,   ,, i      8.25    8.26    8.28    8.29                        Frequency-Domain Packet Combining Techniques for UWB  ◾  391  Table 8.1  Channel Definition  Tx1  Tx2  Rx1    ,   11 Hk i , 2     ,   2 1 Hk i , 2  Rx2    ,   1 2 Hk i , 2     ,   2 2 Hk i , 2  . . .  . . .  Rx Nr  Nr   , 1 Hk i , 2        Nr , 2 Hk i , 2     and      cid:31 A     l + 2 1 , k i  =  2  ∑  l  2   ,  * , k i  −     l Y H 2 , k i = 1 l = ∑∑ 2 2 α ++  m  1  l  = 1  Y  l     * l + 2 1 , k i  1   ,  * H , k i ,   2 m l   Hk i ,      8.30   with   cid:31  A + k i 2 1 ,  ∑=  Ntr = l 1   cid:31      l A + 2 1 , k i   and   cid:31  A k i , 2  =∑ = Ntr l 1   cid:31  l     . A k i 2 ,  As mentioned earlier, the Alamouti STBC can be used with two transmit  antennas and one receive antenna accomplishing the full diversity of 2, and for  two transmit and receive antennas the full diversity of 4. This is an important  characteristic of Alamouti STBC as it reduces the effect of fading at mobile sta- tions while only requiring extra antenna elements at the base station, where it  is more economical than having multiple antennas at the receivers [Alamouti  1998].  However, if having more antennas at the receivers is not a problem, this scheme  can be used with two transmit antennas and Nr receive antennas, while accom- plishing a 2Nr full diversity.  The definition of the channels between transmit  Tx  and receive antennas  Rx   and the notation for the received signals in the antennas along symbol periods are  those presented in Tables 8.1 and 8.2, respectively.  The transmission sequence is the same as in both cases explained earlier. Analyzing  the received signals for the case of two transmit antennas and two receive antennas,  it is possible to generalize for the case of M receive antennas. Therefore, similar to   Table 8.2  Received Signals Time Definition  t + 2iT  t +  2i + 1 T  Rx1  y1,2i  y1,2i+1  Rx2  y2,2i  y2,2i+1  Rx Nr  yNr,2i  yNr,2i+1  . . .  . . .      392  ◾  MIMO Processing for 4G and Beyond  the previous case, the received signals by each receiver are described by the set of  equations:   8.31    8.32    8.33    8.34   which results in matrix–vector notation  y = Hs + w         1     y 1 1     y 2 2    y 1 2   y 2  cid:20    y Nr 1   Nr y 2  = = − = = −  + + 1     n h s h s 1 1 1 1 2 1 2 , , + +     1 n h s h s * * + i 2 1 1 1 2 , 2 1 1 , + + 2     n h s h s 2 1 2 1 2 2 2 , , + +   2 n h s h s * * 2 2 2 1 1 2 2 , ,            = h , Nr 1 = − h , 1  s 1  Nr  + * 2  s  h , 2 Nr + h 2  ,  s  2  Nr  + s * 1       Nr n 2 +   Nr n 2   ,     s  =     s 1 s  2  − s * 2 s * 1    =   s 1 [ ]  s 2 [ ]  ,       H  =  h 11 , h 1 2 ,  cid:20           h 2 1 , h 2 2 ,  cid:20           h 1 ,  Nr  h 2  ,  Nr  =   h h 1 [ ]  2 [ ]  ,          with  and                 w  =  w , 11 w , 1 2  cid:20        w   , 1  Nr  , 2 1  w w , 2 2  cid:20   w  2  ,  Nr          =   w w [ ] 1  [ ] 2  .     8.35   It should be mentioned that the combined symbol still is a linear combination  of the received signals and the channel coefficients. That fact makes very simple the  receiver’s design of the Alamouti scheme, independently of how many antennas are  deployed in the receiver since we have      Frequency-Domain Packet Combining Techniques for UWB  ◾  393  c 1 c  2  = =  h y * 1 [ ] 1 [ ] h y * 2 [ ]  1 [ ]  + y h * 2 2 [ ] [ ] − [ ] y h * 1 [ ] 2  ,        that is   c 1  c   2    =   2  Nr  ∑∑  m  = 1  l  = 1  0            h m l ,   2  0          ⋅      y 1 [ ] y 2 [ ]    +           Nr  ∑ ∑  = 1 l Nr  l  = 1  h n * 1 1 , , l  l  +  h n * 2 2 l  ,  ,  l  −  h n * , 1 l  2 ++ * , l  h nl * 1 2 , ,  l  .             2  Nr  ∑∑  m  = 1  l  = 1    h m l ,   2  This scheme can be applied to the structure of the receiver previously defined  in Figure 8.1. The resulting structure, the IB-DFE for an Alamouti scheme 2XNr,  is presented in Figure 8.4. The postprocessing to be adopted in the SC-FDE in  the receiver at each retransmission for the branch associated with the lth receive  antenna will be  Nr  ∑  l   cid:31 A   ,   r l k i , 2  =  l  1  r   , ,  * k i ,    ,   r l + k i , 2 1  H Ntr  Y = 1 ∑∑+ α  = 1  m  + Nr  l  = 1  Y  r l   ,  * k i , 2  l ,        , r 2 H k i , 2  H  ,   r m l   , , k i         1,1 * {Hk,l      }  1,1  {Yk,l     }  X  { yn   1.1 }  DFT   1,Nr  {Yn           }  …  DFT   1,Nr * {Hk,l         }  1,Nr  {Yk          } X  Σ  …   R,1 * {Hk,l       }  R,1  {Yk,l       }  X   R.1  {Yn       }  DFT  Σ  …  DFT   R,Nr * {Hk,l         }  R,Nr  {Yk           }  X   R,Nr  {Yn           }   i–1  {Ak            }   i–1  {an            }  DFT  Delay  {Bk    } i   x  Σ  {Ck   } i   Σ  x  ~ {Ak   } i   IDFT   8.36    8.37    8.38   {an   } i   Dec.  ~ {an   } i   Figure 8.4   IB-DFE structure with Nr diversity order for R retransmissions.      394  ◾  MIMO Processing for 4G and Beyond  and              where  Nr  ∑  l   cid:31 A   ,   r l + k i , 2 1  =  l ,  *    , r r l   ,   2 Y H k i k i , , 2 = 1 ∑∑+ Nr α  = 1  m  − Ntr  l  = 1  Y    ,  * r l + k i , 2 1  1   , r ,,  * l H k i , 2  .  H  ,   r m l   , , k i      8.39   Therefore,  after  R  retransmissions,  we  will  have  =∑ =  cid:31   cid:31  R A A 1 r k k defined by   For each retransmission, the equivalent diversity coefficient Ck    ,  .  =  r l i , 2  ∑ = R r 1   cid:31  A   ,   r l + k i , 2   cid:31  A k  +  2  2  1  1  i  i  ,  ,    and  r    is   1  C  r     k  =   α     eq r     k  +  1    −  ρ        i  R  Ntr  Nr  ∑∑∑ −     1 2    r  ′  = 1  m  = 1  l  = 1  ′ ,   r m l ,  2  H    k       ,  r  =  , 1 2  ,...,  R  .   8.40   The FDE output is still given by Equation 8.9, with the feedforward coefficients   for each retransmission given by  r l   ,   F k  =  r l   ,  * H C k  r    , k  r  =  , 1 2  ,...,  R  ;  l  =  , 1 2  ,..,  Nr  ,   8.41             eq r  α k  =  E N      r k         r k  2     2    +  E A  k   E I   2   ,      8.42   with N  r     k  Nr = ∑ =1 l  N  r l   ,   k   and I  r     k  Nr = ∑ =1 l  I    ,   r l . k  8.5.1  Dealing with Fixed Channels When  strong  interference  remains  over  the  several  retransmission  attempts,  the  performance can be rather poor unless we change our working band, as with fre- quency-hopping systems. Since changing the frequency leads to additional difficul- ties and delays, this is not practical in most UWB systems. In this case, we could  assume that the frequency-domain block associated with the rth retransmission of  } 1  is an interleaved version of {Ak; k = 0,1,. . .,  r   ; a given packet  A k k } N − 1}. Since this is formally equivalent to assume that  H k r   ; 1  is  k an interleaved version of {Hk; k = 0,1,. . .,N − 1}, the interference correlations for  each frequency can be very small.  , ,..., 0 1  , ,..., 0 1  {  {  N  N  −  =  −  =      Frequency-Domain Packet Combining Techniques for UWB  ◾  395  r  ,  ;  j  +ζ  k  =  −  =  =  N  a n  A k  A k  …     a r n  0 1 , ,  r    A k  exp   πζ   2   and Hk  However, to avoid transmitting signals with very large envelope fluctuations, it  is better to assume that { , that is, corresponds to a  1 } cyclic-shifted version of {Ak; k = 0,1,…, N − 1}, with shift ζr. This means that the  corresponding time-domain block is { }, ,  1 with a suitable ζr. It should be noted that this technique is formally equivalent to     1 , with shift −ζr. Moreover,      = r having A k we also have a cyclic shift in the interference, which means that when the interfer- ence characteristics remain constant, the mostly affected subcarriers will, in general,  be different.* In general, the larger the ζr, the smaller the correlation between Hk r     eq   1 , provided that  and  Hk ζr < N 2  since we consider cyclic shifts, ζr = N is equivalent to having ζr = 0 . In  this chapter, we assume that the different ζr are the odd multiples of N 2, N 4, N 4,  and so on, that is     1  and the smaller the correlation between α k  r    a cyclic-shifted version of Hk  eq r    and α k   ; n N n  , , 0 1  …  N  =  −  ,  r  ζ ζ  2  6  = =  N   N 3  ; 2   ; 8  ζ 3 ζ  ζ  = N = 5  ;   4   ; N 8  =  8  4 ζ  7  3 =  N 7  ;   2   N 8  ζ ...  5  =  N    ; 8   8.43      eq r   , for each fre- This allows small correlation between different  Hk quency  naturally, as r increases the correlations are higher . Moreover, envelope  } { fluctuations  associated  with  a 1   are  not  too  different  from  r   ; n the ones associated with {an; n = 0,1,…, N − 1}. One advantage of this approach  relies on the fact that, for QPSK constellations, the constellation associated with  { r   ; a n  }  is also a QPSK constellation for r = 2, 3, and 4. 1  r    and α k  , , 0 1  , , 0 1  …  …  N  N  −  =  =  −  n  n  ,  ,  8.6  Performance Analysis This section derives the analytical expression for the performance of ARQ schemes.  It  is  assumed  that  the  maximum  number  of  transmission  attempts  for  a  given  packet is NR. This means that a packet is lost when it is not successfully decoded  after NR transmissions. We will assume that the probability of error detection  erro- neous packet  after combining R packets is PF R . For conventional ARQ schemes  and a fixed channel, we may write  P R F        =  [  P F     ] . 1 R      8.44   The probability of detecting a packet successfully after NR transmission attempts         is  * Naturally, we are assuming that the interference only affects part of the spectrum. Otherwise,   the “cyclic shift” would not have any impact on the performance.      396  ◾  MIMO Processing for 4G and Beyond        P S  = −1  P N F     R   ,     8.45   with the average number of transmitted packets given by  E N [  R  ]  =    n 1  −  P n F        P m F        +  N  R  P m F      .   8.46   − 1  N  R  ∑  n  = 1  n  − 1  ∏  m  = 1  − 1  N  R  ∏  m  = 1     The first term accounts for the packets that might require an additional trans- mission. The second term accounts for the packets that cannot have more retrans- missions  regardless of being successfully detected or not . The average number in  Equation 8.46 is closely related with the average packet delay.  8.6.1  Performance Results In  this  section,  a  set  of  performance  results  are  presented  concerning  the  pro- posed ARQ techniques. The uplink of a continuous-wave UWB system employing  SC-FDE schemes is considered using the proposed IB-DFE receiver. Each packet  has N = 256 data QPSK symbols, corresponding to blocks with length 4 ms.  It is assumed to be a severely time-dispersive channel with rich multipath prop-  agation and uncorrelated Rayleigh fading on the different paths.  Coded  transmissions  are  considered,  using  the  well-known  64-state,  rate-1 2  convolutional  code  with  generators  1 + D2 + D3 + D5 + D6  and  1 + D + D2 + D3 + D6. The coded bits associated with a given FFT block are inter- leaved before being mapped into the QPSK constellation symbols and a suitable  deinterleaver is employed before the channel decoder. Moreover, strong interference  levels are considered, occupying 1 8 of the transmission band  i.e., we have very  high  interference  levels .  Also  assumed  are  perfect  synchronization  and  channel  estimation conditions at the receiver.  As described previously, the proposed iterative receiver presents three different   basic forms:  feedback  receiving chain   ◾ Turbo receivers, corresponding to using the channel decoder output in the    ◾ IB-DFE receivers, corresponding to using uncoded data only in the iterative    ◾ Linear FDE, corresponding to the IB-DFE with a single iteration  With regard to the ability to mitigate the interferences, the proposed receiver pres- ents two different configurations:   ◾ Without  knowledge  of  the  interference  characteristics   denoted  “conven-  tional FDE”    ◾ With perfect knowledge of interference characteristics  denoted “ideal FDE”       Frequency-Domain Packet Combining Techniques for UWB  ◾  397  With respect to the retransmissions, we have two different scenarios:   ◾ Equal channels  EC : same channels for each packet retransmission  ◾ Shifted channels  SC : same channels for each packet retransmission but dif-  ferent packet shifts for each retransmission  Figure  8.5  shows  the  average  BER   bit  error  ratio   for  a  single  transmission  attempt, with or without interference. As can be seen, when the receiver does not  know the interference characteristics, the performance can be far from the ones  without interference. Notwithstanding, this difference is significantly reduced if  the FDE receiver has knowledge about the interference characteristics, especially  after four iterations.  Figures 8.6 and 8.7 show the packet error rate  PER  performance of the turbo  FDE with four iterations for EC and SC cases, with strong interference levels. For  the  sake  of  comparison,  we  also  include  the  PER  for  the  linear  FDE.  In  Figure  8.6, it is assumed that the receiver does not have knowledge about the PSD of the  0=  in the computation of the feedfor- interference  i.e., we assume that  E Ik ward coefficients , while in Figure 8.7 we assume that we use this knowledge in the   r     2   [   ]  100  10–1  10–3  10–4  0  R E B  10–2   * : Linear FDE  Δ : Iter. 2  0 : Iter. 4  : No interference : Conventional FDE : Ideal FDE  5  10  15  Eb N0  dB   Figure 8.5  BER performance for a single packet transmission.      398  ◾  MIMO Processing for 4G and Beyond  100  R E P  10–1  R = 2  R = 4   o : Linear FDE  * : Turbo FDE  Iter. 4   : EC : SC  R = 1  10–2 –6  –4  –2  0  2  Eb N0  dB   4  6  8  10  Figure 8.6  PER results for “conventional FDE” receiver.  computation of the feedforward coefficients  to avoid crowding these figures, we  did not include the results with R = 3 . Comparing both figures, the performance  improvement achieved by the turbo FDE relating to the linear FDE becomes evi- dent. Moreover, it is clear that a better performance tends to be achieved with the  SC, relating to EC. Additionally, the PER performance is improved when the PSD  of interference is taken into account by FDE coefficients  ideal receiver . In both  cases, using the proposed ARQ technique, the performance improves significantly  with R  transmissions attempts . From Figure 8.7, it is seen that, for two transmis- sion attempts  R = 2  and EC, the performance tends to be worse than for R = 1.  This results from the fact that combining packets using the same channel  EC  does  not bring any added value  it even degrades, as we are combining multiple corrupted  packets . Contrarily, when SC is employed, since the shift applied to the packets  places the corrupted bits in different relative positions within the combined packets,  the increase of the number of transmission attempts tends to achieve a performance  improvement. Note that when an error is detected in the packet  using the punc- tured code , the additional bits that were punctured are requested for transmission. The best overall performance is achieved with the turbo FDE associated with  SC, for R = 4, using the “ideal receiver” receiver. Clearly, even when the turbo FDE       Frequency-Domain Packet Combining Techniques for UWB  ◾  399   o : Linear FDE  * : Turbo FDE  Iter. 4   : EC : EC  R = 2  R = 1  100  R E P  10–1  R = 4  10–2 –6  –4  –2  0  2  Eb N0  dB   4  6  8  10  Figure 8.7  PER results for “ideal FDE” receiver.  is employed, the knowledge of the PSD of the interference is critical for the pro- posed receiver to achieve a good performance.  The performance results show that this technique is able to cope with strong  interference levels as well as deep fadings, even for fixed channels. Moreover, the  improvement of performance is obtained at the cost of very low complexity from  both the transmitter and receiver.  Next, a set of figures are presented regarding a MIMO 2X2, that is, an Alamouti  coding scheme at the transmitter and at the receiver with diversity of order 2. Only  uncoded transmissions are considered, with the same conditions adopted for simu- lation proposed on previous cases. However, here we have a slight difference with  respect to the retransmissions, since the studied scenarios are   ◾ Uncorrelated  channels   UC :  uncorrelated  channels  for  each  packet   retransmission   ◾ Shifted channels  SC : same channels for each packet retransmission but dif-  ferent packet shifts for each retransmission      400  ◾  MIMO Processing for 4G and Beyond  Figures  8.8  and  8.9  show  the  average  BER  behavior  with  transmission  attempts in the presence of strong interference. It can be seen for each retransmis- sion, the improvement associated with the successive iterations on the IB-DFE  receiver, with a power gain of approximately 5 dB for four iterations in the first  transmission  attempt.  Notwithstanding,  when  the  number  of  combined  pack- ets increases with the number of retransmissions, the improvement due to itera- tions decreases for both channel types  as can be seen from Figures 8.8 and 8.9,  for more than two retransmissions, there is no obvious advantage increasing the  number of iterations from three to four . Again, for both cases, using the pro- posed ARQ technique, the performance improves significantly with R  transmis- sions attempts . As expected, the results for UC are better than those for SC, but  the assumption of uncorrelated channels can be unrealistic in real conditions.  From the comparison of these results with those from Figure 8.5, it is possible  to  conclude  that  the  adopted  MIMO  technique  assures  a  power  gain  near  to  2.2 dB, even without the convolutional code adopted in the simulation scenario    *  Linear  Δ  2 iterations  ο  4 iterations  100  10–1  R E B  10–2  10–3  10–4 –5  0  5  Eb N0  dB   10  15  Figure  8.8  BER  performance  retransmissions.  for  an  uncorrelated  channel  between       Frequency-Domain Packet Combining Techniques for UWB  ◾  401   *  Linear  Δ  2 iterations  ο  4 iterations  100  10–1  R E B  10–2  10–3  10–4 –5  0  5  Eb N0  dB   10  15  Figure 8.9  BER performance for a fixed channel between retransmissions.  of Figure 8.5. Obviously, if a coded transmission is adopted, we can expect higher  power efficiency improvements.  Figures 8.10 and 8.11 show the PER performance behavior of the IB-DFE with  different iterations for UC and SC cases, with strong interference levels. In both  figures, it is assumed that the receiver has knowledge about the PSD of the interfer- ence, and uses this knowledge in the computation of the feedforward coefficients.  Comparing  both  figures,  it  becomes  clear  about  the  performance  improvement  achieved by the IB-DFE relating to the linear FDE. Again, a better performance  tends to be achieved with the UC relating to SC. Contrary to the EC case previ- ously analyzed in Figures 8.6 and 8.7, the increase of the number of transmission  attempts tends to achieve a performance improvement since, for both cases depicted  in Figures 8.10 and 8.11, the proposed ARQ technique improves the performance  significantly with R  transmissions attempts .  As expected, the best overall performance is achieved with UC, for R = 4.  Clearly,  when  the  IB-DFE  is  employed,  the  knowledge  of  the  PSD  of  the  interference  is  still  critical  for  the  receiver  with  diversity  to  achieve  a  good  performance.      402  ◾  MIMO Processing for 4G and Beyond   *  Linear  Δ  2 iterations  ο  4 iterations   *  Linear  Δ  2 iterations  ο  4 iterations  100  R10–1  E P  10–2 –5  100  R10–1  E P  10–2 –5  0  5  Eb N0  dB   10  15  Figure 8.10  PER results for an uncorrelated channel between retransmissions.  0  5  Eb N0  dB   10  15  Figure 8.11  PER results for a fixed channel between retransmissions.      Frequency-Domain Packet Combining Techniques for UWB  ◾  403  Acknowledgment This work was supported by the FCT  Fundação para a Ciência e Tecnologia  via  project PEst-OE EEI LA0008 2013.  References Alamouti,  S.  A  simple  transmit  diversity  technique  for  wireless  communications,  IEEE   Journal on Selected Areas in Communications, 16 8 , 1451–1458, October 1998.  Benvenuto,  N.  and  S. Tomasin,  Block  iterative  DFE  for  single  carrier  modulation,  IEE   Electronics Letters, 39 19 , 1144–1145, September 2002.  Dinis, R., P. Carvalho, and J. Martins, Soft combining ARQ techniques for wireless systems  employing SC-FDE schemes, IEEE ICCCN’08, St. Thomas, US Virgin Islands, August  2008.  Dinis,  R.,  A.  Gusmão,  and  N.  Esteves,  On  broadband  block  transmission  over  strongly   frequency-selective fading channels, Proc. Wireless 2003, Calgary, Canada, July 2003.  Falconer,  D.,  S.  Ariyavisitakul,  A.  Benyamin-Seeyar,  and  B.  Eidson,  Frequency  domain  equalization  for  single-carrier  broadband  wireless  systems,  IEEE  Communications  Magazine, 4 4 , 58–66, April 2002.  Gusmão,  A.,  R.  Dinis,  and  N.  Esteves,  Adaptive  HARQ  schemes  using  punctured  RR  codes for ATM-compatible broadband wireless communications, IEEE VTC’99  Fall ,  Amsterdam, Netherlands, September 1999.  Gusmão, A., R. Dinis, and N. Esteves, On frequency-domain equalization and diversity com- bining for broadband wireless communications, IEEE Transactions on Communications,  51 7 , 1029–1033, July 2003.  Gusmão, A., R. Dinis, J. Conceicao, and N. Esteves, Comparison of two modulation choices for   broadband wireless communications, IEEE VTC’00  Spring , Tokyo, Japan, May 2000.  Hagenauer,  J.  et  al.,  Rate-compatible  punctured  convolutional  codes   RCPC  codes   and  their application, IEEE Transactions on Communications, 36 4 , 389–400, April 1988. Ishiyama,  Y.  and  T.  Ohtsuki,  Performance  evaluation  of  UWBIR  and  DS-UWB  with  MMSE-frequency  domain  equalization   FDE ,  IEEE  GLOBECOM’04,  Dallas, TX,  USA, November–December 2004.  Marques  da  Silva,  M.  and  R.  Dinis,  Iterative  frequency-domain  detection  and  channel  estimation for space-time block codes, European Transactions on Telecommunications,  22 7 , 339–351, 2011.  Marques da Silva, M., A. Correia, R. Dinis, N. Souto, and J.C. Silva, Transmission Techniques  for  Emergent  Multicast  and  Broadcast  Systems,  1st  edition,  CRC  Press  Auerbach  Publications, Boca Raton, USA, May 2010, ISBN: 9781439815939.  Marques da Silva, M., A. Correia, R. Dinis, N. Souto, and J. Silva, Transmission Techniques  for  4G  Systems,  1st  edition,  CRC  Press  Auerbach  Publications,  Boca  Raton,  USA,  November 2012, ISBN: 9781466512337.  Popescu, D., P. Yaddanapudi, and R. Kondadasu, OFDM versus time-hopping in multiuser  ultra wideband communication systems, IEEE VTC’05  Spring , Stockholm, Sweden,  May 2005.  Proakis, J. and M. Salehi, Digital Communications, 5th edition, McGraw-Hill Science,   New York, USA, 2007, ISBN-10: 0072957166.      404  ◾  MIMO Processing for 4G and Beyond  Siwiak, K. Ultra-wide band radio: A new PAN and positioning technology, IEEE Vehicular   Technology Society News, February 2002.  Tüchler, M. and J. Hanenauer, Linear time and frequency domain turbo equalization, IEEE   VTC’01  Fall , pp. 2773–2777, Atlantic City, New Jersey, 2001.  Vutecic, B. and J. Yuan, Turbo Codes: Principles and Applications, Kluwer, Dordrecht, 2002. Win, M. and R. Scholtz, On the robustness of ultra-wide bandwidth signals in dense mul-  tipath environments, IEEE Communications Letters, 2 2 , 51–53, February 1998.      Chapter 9 Link and System Level  Simulation for MIMO  Américo Correia and Mário Marques da Silva  Contents 9.1  Requirements and Scenarios .................................................................... 406 9.1.1  Intercell Interference Coordination Schemes ................................410 9.1.2  Soft and Hybrid Reuse ..................................................................411 9.1.3  Coordinated Multipoint Transmission ..........................................414 9.2  Evaluation Methodology ..........................................................................417 9.2.1  Link-Level Simulations .................................................................419 9.2.2  System-Level Simulations .............................................................421 9.3  Simulation Results ...................................................................................425 9.3.1  Results for PMP Scenarios ........................................................... 426 9.3.2  Results for PtP Scenarios ............................................................. 430 9.3.2.1  Results for PtP with SU-MIMO .....................................431 9.3.2.2  Results for MU-MIMO ..................................................437 9.3.3  Results for CoMP with MU-MIMO ............................................441 9.4  Conclusions ..............................................................................................445 Acknowledgments .............................................................................................445 References ........................................................................................................ 446  405   406  ◾  MIMO Processing for 4G and Beyond  9.1  Requirements and Scenarios In this section, some important aspects related to long-term evolution  LTE , LTE- Advanced,  and  multiple-input  and  multiple-output   MIMO   requirements  and  scenarios are described. The baseline LTE radio access network  RAN  and evolved  packet core  EPC  network were defined in 3GPP Release 8. This provided the  world with a comprehensive and highly capable new cellular communications stan- dard that, in November 2012, has been successfully launched in 113 commercial  networks and in 51 countries. The main attributes that differentiate this new stan- dard from previous standards are   ◾ Single-channel  peak  data  rates  of  up  to  300 Mbps  in  the  downlink  and    ◾ Full integration of frequency division duplexing  FDD  and time division    ◾ Packet-based EPC network to eliminate cost and complexity associated with   75 Mbps in the uplink.  duplexing  TDD  access modes.  legacy circuit-switched networks.  Other key technologies introduced in Chapter 1 that enable the new capabili-  ties include   ◾ Adoption of orthogonal frequency-division multiple access  OFDMA  and  single-carrier frequency-division multiple access  SC-FDMA  for the down- link and uplink air interfaces, respectively, to enable narrowband scheduling  and efficient support of spatial multiplexing.   ◾ Support for six channel bandwidths from 1.4 to 20 MHz to enable high data    ◾ Baseline support for spatial multiplexing  MIMO  of up to four layers on the   rates.  downlink.   ◾ Faster physical layer control mechanisms leading to lower latency.  Despite the substantial capabilities of LTE in Release 8, the 3GPP standard has   continued to evolve through Releases 9, 10, 11, and 12.  Most LTE radio network designs prefer complying with the continuous net- working principle. Continuous networking can improve cell edge user experience,  reduce inter-radio access technologies  RAT  handover requirement, and facilitate  evolution from 3G to LTE [3GPP 2010a]. LTE continuous networking needs con- sidering continuous coverage of the reference signal received power  RSRP . This  consists of the average of the power of all resource elements which carry cell-specific  reference signals over the entire bandwidth. The reference signal received quality   RSRQ  measurement provides additional information when RSRP is not sufficient  to make a reliable handover or cell reselection decision. RSRQ is the ratio between  the RSRP and the received signal strength indicator  RSSI  and, depending on the       Link and System Level Simulation for MIMO  ◾  407  measurement bandwidth, represents the number of resource blocks. RSSI is the  total received wideband power including all interference and thermal noise. Best  service cells, traffic channel for uplink and downlink, physical uplink shared chan- nel  PUSCH , and physical downlink shared channel  PDSCH  are also required. Special  scenarios  like  femtocells  may  need  LTE  discontinuous  coverage.  Discontinuous coverage may dig out the advantages of high-order modulation and  coding in good radio environment. Therefore, it improves cell throughput and cell  center user experience.  The femtocell concept is not unique to LTE or LTE-Advanced [3GPP 2012a],  but there was an opportunity for LTE to incorporate this technology from the start.  From a radio deployment perspective, the femtocell operates over a small area within  a larger cell. The radio channel can be the same as that of the macrocell  known as  co-channel deployment  or on a dedicated channel. The femtocell concept is funda- mentally different from relaying since the femtocell connection back into the core  network is provided locally by an existing wired Internet connection rather than  over the air back to the macrocell. Most femtocell deployments cover indoor areas,  which helps provide isolation between the femtocell and the macrocell radio chan- nels. There is also femtocell outside the coverage area of macrocell. This could be,  for example, a way to provide local cellular coverage in rural areas where digital  subscriber line exists but there is no cellular coverage provided by any operator.  It must be decided whether the femtocells are operated for closed subscriber  group  CSG , user equipment  UE , or for open access. Other practical consid- erations such as pricing can be considered commercial issues, although in the co- channel CSG case, the probability that areas of dense femtocell deployment will  block macrocells becomes an issue.  Several 3GPP studies have shown that increases in average data rates and 100  times greater capacity are possible with femtocells over what can be achieved from  the macronetwork. However, femtocells do not provide the mobility of macrocel- lular systems, and differences exist in the use models of these systems.  The evolved multimedia broadcast and multicast service  E-MBMS  television  service was specified at the physical layer in Release 8 but was not functionally com- plete until Release 9. The features in Release 9 provide a basic MBMS service car- ried over an MBMS single frequency network  MBSFN . One limitation of Release  9 definition was the lack of a feedback mechanism from the UEs that would inform  the network if sufficient UEs were present in the target area to justify turning on  the MBSFN locally. In Release 11, further MBMS enhancements for service con- tinuity were specified including support on multiple frequencies, reception during  radio resource control  RRC  idle and RRC connected states, and support to take  UE positioning into account for further optimization of the received service.  E-MBMS is performed either in single cell or multicell mode. In single cell trans- missions, E-MBMS traffic is mapped to the downlink shared channel  DL-SCH .  In multicell mode, transmissions from cells are carefully synchronized to form an  MBSFN [3GPP 2010b, Marques da Silva et al. 2010, 2012].      408  ◾  MIMO Processing for 4G and Beyond  MBSFN is an elegant application of OFDM for cellular broadcast. The prin- ciple of operation is quite simple. Identical transmissions are broadcast from closely  coordinated cells simultaneously on a common frequency [Marques da Silva et al.  2012]. Signals from adjacent cells arrive at the receiver and are dealt with in the  same manner as multipath delayed signals. In this manner, UE can combine the  energy from multiple transmitters with no additional receiver complexity.  If the UE is at a cell boundary, the relative delay between the two signals is quite  small. However, if the UE is close to one base station and relatively distant from  a second base station, the amount of delay between the two signals can be quite  large. For this reason, MBSFN transmissions might be supported using 7.5 kHz  subcarrier spacing  instead of 15 kHz  and a longer CP [3GPP 2010b], as depicted  in Figure 9.1. MBSFN networks also use a common reference signal from all trans- mitters within the network to facilitate channel estimation. As a consequence of  the MBSFN transmission scheme, UE can roam between cells with no handover  procedure required. Signals from various cells will vary in strength and in relative  delay, but in aggregate the received signal is still dealt with in the same manner as  a conventional single channel OFDM transmission.  Synchronized eNodeBs transmitting MBMS data  Signals from different eNodeBs arrive within cyclic prefix at UE  OFDM symbol duration  ISI-free window  Cyclic prefix  Figure  9.1  MBSFN  transmission  with  long  cyclic  prefix  to  avoid  intersymbol  interference.       a    b   Link and System Level Simulation for MIMO  ◾  409  E-MBMS transmitting cell  Cells not transmitting E-MBMS UEs receiving E-MBMS data  UEs not receiving E-MBMS data  MBSFN area Cells not transmitting E-MBMS UEs receiving E-MBMS data UEs not receiving E-MBMS data  Figure 9.2    a  SC-PMP transmission and  b  MBSFN transmission.  Figure 9.2 illustrates MBSFN transmission scheme including also an illustra- tion of the single-cell point-to-multipoint  SC-PMP  transmission. The other sce- nario will be evaluated later in this chapter.  According  to  3GPP  specifications  [3GPP  2007,  2009a,b,c],  the  deployment  scenario where a dedicated carrier is used for broadcast only  MBSFN  has the  following properties:   ◾ E-UTRA MBMS is envisaged to achieve a cell edge spectrum efficiency of  1 bit s Hz, equivalent to the support of, at least, 16 mobile TV channels, at  around 300 kbps per 5 MHz channel  in an urban or suburban environment .      410  ◾  MIMO Processing for 4G and Beyond   ◾ In the deployment scenario, where a carrier is shared between broadcast and  unicast traffic, the target performance at cell edge for broadcast traffic should  be in line with the existing target performance for the unicast traffic.  9.1.1  Intercell Interference Coordination Schemes Since the LTE system employs OFDMA in the downlink and SC-FDMA in the  uplink, intracell interference is mitigated due to orthogonality between subcarriers  [Marques da Silva 2012]. However, intercell interference remains as the main source  of interference, especially at cell edges. Intercell interference occurs when multiple  eNBs* are transmitting using the same frequency. Under these circumstances, the  transmitted signals interfere with each other, collisions occur, and the UEs might not  receive the packets correctly. Figure 9.3 depicts a situation where S1.1 is the signal  sent from eNB1 to UE1, S2.1 is the signal sent from eNB2 to UE1, and S2.2 is the  signal sent from eNB2 to UE2. Since UE1 is at the cell border, the signal S1.1 might  suffer  interference  from  S2.1.  This  occurs  when  there  is  no  intercell  interference  coordination, such as in SC-PMP scenario. However, in MBSFN scenario, signals  S1.1 and S2.1 are soft combined and therefore UE1 receives S1.1 + S2.1 correctly.  The  ability  of  cells  to  coordinate  their  narrowband  scheduling  offers  some  potential  for  interference  avoidance.  Support  for  coordination  of  resource  block   S1.1  eNB 1  UE1  S 2.2  eNB 2  S   2 . 1  UE2  Signal received at UE1  .  1 1 S  +  .  1 2 S  =  .        1 2 S + 1 1 S     .  Time  Time  Time  Signal received  at UE2  .  2 2 S  Time  Figure 9.3  Example of potential intercell interference.  *  Evolved Node-B  eNode-B  refers to the base station of LTE and 4G systems. This corresponds   to the evolution of the node-B, considered by UMTS.      Link and System Level Simulation for MIMO  ◾  411   RB  allocation between cells in the downlink was introduced in Release 8 with  the inclusion of the relative narrowband transmit power  RNTP  indicator. This  support feature is a bitmap that can be shared between base stations over the X2  interface. It represents those RB for which the base station intends to limit its out- put power to a configurable upper limit for some period of agreed-upon time. This  allows schedulers to agree on how cell-edge RB will be used so that, for instance,  cell-edge users who cause the most interference can be restricted to certain parts of  the channel. This coordination could be implemented using a semistatic agreement  for partial frequency reuse at the cell edge or might involve more dynamic schedul- ing based on real-time network loading. The next section covers partial frequency  reuse schemes and hybrid reuse  HR , also referred to as soft reuse schemes.  9.1.2  Soft and Hybrid Reuse To solve the limitations in terms of spectral efficiency of traditional frequency reuse  schemes, HR, or soft fractional frequency reuse  SFFR , as it is sometimes mentioned  in the literature, was proposed by several authors [Simonsson 2007, Sarperi et al. 2008,  Zhou and Zein 2008, Fodor et al. 2009]. This consists of defining different zones  within each cell where different reuse factors are applied. Figure 9.4 shows an example  of HR 1 + 1 3  reuse 1 + reuse 1 3 , in which there is an area where all frequency   r e w o P  Frequency  f 1  r e w o P  Frequency  f 1 + f 2 + f 3  f 3  f 2  r e w o P  Frequency  Figure 9.4  Example of HR with reuse 1 + reuse 1 3.      412  ◾  MIMO Processing for 4G and Beyond  spectrums are used and another area at the border of the cells where only a fraction  of the frequency is used. This way we can achieve maximum spectral efficiency in the  center of each cell, and reduced intercell interference levels at the border of cells.  This technique is implemented using the same methodology used for normal  fractional frequency reuse, but this time different levels of power P are applied to  different frequencies, for each sector of every cell, as defined in the following.     P max P max       f f  t ,   t ,    = =  ,  P p tx  f <  ∈ P ,  f  n f  ∉   f  n   9.1   The assignment of different power levels to different frequencies fn is related to  the characteristics of radio signals, more precisely the average path losses  Lpath  that  radio signals suffer over the air. This has direct impact on the total power received  at the UE  PRxUE . This way, at the center of the cell, all frequencies transmitted with  power P < ptx will be received and, at the edge of cells, only frequencies transmitted  with power P > ptx will be received and will interfere with each other.  To determine the power levels that each frequency should use, we first need to  determine the location of the different reuse zones. This can be somewhat tricky,  because it is hard for the UE to determine with precision its position, therefore  making it hard to know when it should be using one or another reuse. To solve this,  we can define certain levels or targets for carrier-to-interference ratio  C I , and  based on those target values the UE knows that it should apply for one type of reuse   e.g., if UE C I is higher than the target C I  or another  e.g., if UE C I is below  target C I . However, the level of C I received at UE is associated with a certain  distance to the center of the cell  i.e., eNB site . This allows us to define distances  of reuse  DR  that are directly related to a certain level of C I and, in turn, these  levels of C I can be determined from the received power of pilot subcarriers at UEs. Let  us  analyze  the  example  depicted  in  Figure  9.5,  in  which  HR  1 + 1 3  is  considered, meaning that reuse 1 is used within a certain area  the small inner  hexagons  and reuse 1 3 is used outside that area  outer region  for each cell sector.  R is the cell radius and D is the distance between the center of cells using the same  frequencies, and R1 is the radius of the reuse 1 zone inside each cell, being D1 the  distance between reuse 1 zones inside each cell.  The carrier–interference ratio  C I  in hexagonal cellular topologies is expressed as  =  α  1 i 0     D R     =  10  log 10  c i C I     c i     dB   9.2     where i0 is the number of interfering cells interfering at distance D, and α is the  average exponent of propagation path loss that can take values between 2 and 5          R R1  R R1  R R1  R R1  c i  C I  Link and System Level Simulation for MIMO  ◾  413  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  R R1  D1  R R1  R R1  R R1  R R1  D  D1 and R1 for reuse1   D1 and R1 for reuse1 3   Figure 9.5  Hexagonal cellular topology, using HR 1 + 1 3 scheme.   based on 3GPP specifications we use α = 2.2 . According to Figure 9.5, both reuse  1 and reuse 1 3 have i0 = 6 interfering cells at distance D. If we want the DR to be  1 3 of R, for reuse 1 we have R1 = DR = R 3 and D1 = 2R. The C I for users at DR is  =  1 6  2 2 .              2 R R 3  =  8 58 .  =  10  log   .  8 58    10  =  9 34 .  dB           We know that for a UE located at DR = R 3, the C I target should be 9.34 dB,  meaning that UEs with C I equal or higher than this value will be using reuse 1,  and UEs with C I lower than that will be using reuse 1 3.  Next, we must find out what is the power that should be allocated to frequen- cies  meant  to  be  received  within  reuse  1,  and  the  power  that  must  be  used  by  frequencies meant to be received on the entire cell  especially in the border of the  cell . To do so, we need to first know the C I level received at the edge of the cell; in  our example the edge of the cell at the distance R from the center of cell. We have  c i C I  2 2 .  =  1 6     3 R R     =  1 87 .  =  10  log   .  1 87  10     =  2 71 .  dB     The C I for frequencies supposed to be received by UEs at the edge of the cell will  be 2.71 dB. If we consider that for that C I level the power is Pmax 46 dBm = 40 W,    9.3    9.4       414  ◾  MIMO Processing for 4G and Beyond  the frequencies that are not supposed to be received must be transmitted with infe- rior power Ptx. This way we have  tx = p  40 3 R R  W 2 2 .       =  W 40 11 21 .  =  3 57 .  W      9.5      Looking at Equation 9.5, we conclude that, at the center of the cells, frequencies  will be transmitted with Pmax = 3.57 W and, at the border of the cells, frequencies  will be transmitted using Pmax = 40 W. The example described can be applied to  other configurations such as HR 1 + 1 2 or HR 1 2 + 1 3. Furthermore, more than  just two reuse zones can exist.  The  following  section  describes  another  technique  to  improve  the  cell-edge   spectral efficiency.  9.1.3  Coordinated Multipoint Transmission The concept of cooperative MIMO was briefly introduced in Chapter 1, also named  as network MIMO or CoMP [3GPP 2011]. The goal of CoMP is to improve the  coverage of high data rates and cell-edge throughput, and also to increase system  throughput.  The primary difference between standard MIMO and CoMP is that for the  latter, the transmitters are not physically colocated. In the case of downlink CoMP,  however, there is the possibility of linking the transmitters at baseband to enable  sharing of payload data for the purposes of coordinated precoding. This sharing is  not physically possible for the uplink, which limits the options for uplink CoMP.  For the standard network topology in which the eNBs are physically distributed,  the provision of a high capacity and low latency baseband link is challenging and  would probably require augmentation of the X2 inter-eNB interface using fiber.  However, a cost-effective solution for inter-eNB connectivity is offered by a net- work architecture in which the baseband and RF transceivers are located at a cen- tral site with distribution of the RF to the remote radio heads  RRHs  via fiber.  Four downlink deployment scenarios were defined for the feasibility study in   Release 11 [3GPP 2011]:   ◾ CoMP scenario 1 is a homogeneous macronetwork  all cells have the same  coverage area  with intrasite CoMP. This is the least complex form of CoMP  and is limited to eNBs sharing the same site  see Figure 9.6 .   ◾ CoMP scenario 2 is also a homogeneous network but with high Tx-power  RRHs. This is an extension of scenario 1 in which the six sites adjacent to the  central site are connected via fiber optic links to enable baseband cooperation  across a wider area than is possible with scenario 1  see Figure 9.7 .      Link and System Level Simulation for MIMO  ◾  415  Scenario 1  Figure 9.6  CoMP scenario 1  considered in LTE Release 11 .  Scenario 2  Figure 9.7  CoMP scenario 2  considered in LTE Release 11 .      416  ◾  MIMO Processing for 4G and Beyond  Scenario 3  Figure 9.8  CoMP scenario 3  considered in LTE Release 11 .   ◾ CoMP scenario 3 is a heterogeneous network in which low power RRHs with  limited coverage are located within the macrocell coverage area  see Figure  9.8 .   ◾ CoMP scenario 4 is a heterogeneous network in which low power RRHs with  limited coverage are located within the macrocell coverage area. The trans- mission reception points created by the RRHs have the same cell identity as  the macrocell  see Figure 9.9 .  Scenario 4  Figure 9.9  CoMP scenario 4  considered in LTE Release 11 .      Link and System Level Simulation for MIMO  ◾  417  Scenarios 3 and 4 are expected to be used in metropolitan areas where network   deployment is dense and RRHs of different transmission power levels coexist.  The introduction of CoMP enables several new categories of network opera- tion, which are defined for the downlink as follows [Lee et al. 2012, Rumney 2013,  3GPP 2011]:   ◾ Joint processing  JP : Data for a UE is available at more than one point in the   CoMP cooperating set for the same time–frequency resource.   ◾ Joint  transmission   JT :  This  is  a  form  of  spatial  multiplexing  that  takes  advantage of decorrelated transmissions from more than one point within the  cooperating set. Data to a UE is simultaneously transmitted from multiple  points to coherently improve the received signal quality or data throughput.  ◾ Dynamic point selection  DPS : The UE data is available at all points in the  cooperating set but is only transmitted from one point based on dynamic  selection  in  time  and  frequency.  The  DPS  includes  dynamic  cell  selection   DCS . DPS may be combined with JT, in which case multiple points can be  selected for data transmission in the time–frequency resource.   ◾ Coordinated scheduling and beamforming  CS CB : Data for a UE is only  available at and transmitted from one point in the CoMP cooperating set but  user scheduling and beamforming  BF  decisions are made across all points  in the cooperating set. Semistatic point selection  SSPS  is used to make the  transmission  decisions.  Dynamic  or  semistatic  muting  may  be  applied  to  both JP and CS CB.  9.2  Evaluation Methodology Radio networks resources are obviously finite and scarce  i.e., limited bandwidth  for  transmission .  As  the  number  of  services  that  use  the  available  bandwidth  increases, it is essential to have techniques that optimize the usage and allocation of  such limited resources. Scheduling consists precisely in performing the allocation  of resources taking into consideration different factors. This allocation is typically  performed  in  the  time  domain,  meaning  that  scheduling  algorithms  divide  the  time domain in small pieces  time slots [TS] , and then allocate every one of those  TS to different users.  With the introduction of LTE and OFDMA, the paradigm of scheduling has  slightly  changed  since  resources  can  be  allocated  not  only  in  time  domain  but  also in the frequency domain. This flexibility of allocation both in time and fre- quency will, in theory, enable OFDMA-based schedulers to allocate resources more  efficiently, for example, allocating more time and bandwidth to users with more  demanding needs.  With  multiuser  MIMO   MU-MIMO   specified  for  LTE-Advanced,  the  downlink of a MIMO broadcast channel requires both scheduling and BF. The       418  ◾  MIMO Processing for 4G and Beyond  well-known orthogonal random beamforming  ORBF  exploits properly the avail- able MIMO spatial channel dimensions of the system.  A single simulation that takes into consideration both the link-level simulation   LLS  and system-level simulation  SLS  would be preferable. Nevertheless, that  implies a significant increased degree of complexity, and huge simulation times.  Therefore, two separate but interconnected approaches are the best solution.  The LLS objective is to model a radio link between a UE and an eNB, includ- ing  channel  estimation,  interleaving,  decoding,  and  so  on,  operating  at  symbol  level frequency or time resolution. The output that is expected consists of one or  more figures which show the relation between the minimum required signal-to- noise ratio  SNR  that the link should experience to achieve a given block error rate   BLER .  For the SLS, a 19-cell network topology with wrap-around will be used as the  baseline network topology for all SLSs, with the following features [ITU-R 2008]:     1. The system is modeled as a network of 7 clusters. Each cluster has 19 hex- agonal cells with 6 cells in the first tier and 12 cells in the second tier sur- rounding the central cell of each cluster. Each cell has 3 sectors. Frequency  reuse is modeled by planning frequency allocations in different sectors in the  network.    2. Users are dropped independently with uniform distribution throughout the  system. Each mobile corresponds to an active user session that runs for the  duration of the drop.    3. Mobiles are randomly assigned channel models. Depending on the simula- tion, these may be in support of a desired channel model mix, or separate  statistical realizations of a single type of channel model.   4. Users are dropped according to the specified traffic mix.   5. For sectors belonging to the center cluster, sector assignment to a user is based  on the received power at a user from all potential serving sectors. The sector  with best path to the user, taking into account slow fading characteristics   path loss, shadowing, and antenna gains  is chosen as the serving sector.    6. Mobile  stations  are  randomly  dropped  over  the  57  sectors  such  that  each  sector has the required numbers of users. Although users may be in regions  supporting  handover,  each  user  is  assigned  to  only  one  sector  for  count- ing purposes. All sectors of the system shall continue accepting users until  the desired fixed number of users per sector is achieved everywhere. Users  dropped within 35 m of a sector antenna shall be redropped. User locations  for six wrapping clusters are the same as the center cluster.  7. For simulations that do not involve handover performance evaluation, the loca- tion of each user remains unchanged during a drop, and the speed of a user is  only used to determine the Doppler effect of fast fading. Additionally, the user  is assumed to remain attached to the same eNB for the duration of the drop.         Link and System Level Simulation for MIMO  ◾  419       8. Fading signal and fading interference are computed from each mobile sta- tion into each sector and from each sector to each mobile for each simulation  interval.  9. Packets are not blocked when they arrive into the system  i.e., queue depths  are infinite . Users with a required traffic class shall be modeled according to  the traffic models defined in this document. Start times for each traffic type  for each user should be randomized, as specified in the traffic model being  simulated.    10. Packets  are  scheduled  with  a  packet  scheduler  using  the  required  fairness  metric. Channel quality feedback delay and protocol data unit  PDU  errors  are  modeled  and  packets  are  retransmitted  as  necessary.  The  hybrid  auto- matic repeat request  HARQ  process is modeled by explicitly rescheduling  a packet as part of the current packet call after a specified HARQ feedback  delay period.    11. Simulation time is chosen to ensure convergence in user performance met- rics. For a given drop, the simulation is run for this duration, and then the  process is repeated with the users dropped at new random locations. A suf- ficient number of drops are simulated to ensure convergence in the system  performance metrics.    12. Performance statistics are collected for users in all cells according to the out-  put matrix requirements.    13. All 57 sectors in the system shall be dynamically simulated.  The system level simulators used in this chapter were based on the above 13  requirements  for this study only the downlink is considered . Another general  description of an SLS is presented in Chapter 5 of [Marques da Silva et al. 2012].  9.2.1  Link-Level Simulations For the LLSs, the urban macropropagation channel was used to simulate the  point-to-point   PtP   and  the  point-to-multipoint   PMP   scenarios  radio  link.  Since the number of subcarriers allocated to each user vary along the simulation,  an extensive study had to be performed, testing all the possible number of sub- carriers. Starting with one physical resource block, each one with 12 subcarriers,  every time  12, 24, 36, 48 subcarriers, and so on  until reaching the maximum  subcarrier value of 600  corresponding to the total usage of the subcarriers avail- able with a 10 MHz transmitting bandwidth .  The size of the transmitted block depends on the number of subcarriers used   and the number of OFDM symbols per subframe, being expressed by     L TBcod  =  N  symb  ×  N  sc      9.6       420  ◾  MIMO Processing for 4G and Beyond           where LTBcod denotes the total size of the block transmitted in a single subframe  including coding and cyclic redundancy check  CRC  bits, Nsymb is the number of  OFDM symbols per subframe and per subcarrier, and Nsc is the number of occu- pied subcarriers during one subframe.  The size of the effective data transmitted block LTB  i.e., without the coding and   correction bits  is inferior to LTBcod, being expressed by  L TB  =  L TBcod  R c      9.7   where Rc is the respective coding rate.  For the different combinations of environment  hierarchical modulation, cod- ing rate, etc. , the LLS produced figures with the evolution of the BLER as a func- tion of the link ES N0. ES N0 represents the ratio of the energy of each symbol  ES   over the spectral noise density  N0 . For the PMP modes  SC-PMP and MBSFN  scenarios , the target BLER to be achieved is 1%  BLER = 0.01 . For PtP scenario,  the target BLER is 10%  BLER = 0.1 , that is, in every 10 transmitted packets only  one of those is not correctly decoded at the receiver and needs to be retransmitted.  The SNR values used in SLS are obtained using  SNR  =  +  10 log 10  E S N  0     R b log   M B 2 w            9.8   where ES N0 is obtained from the figures produced by LLS, Rb is the specific bit-rate  considered in the simulation run, M is the index of the hierarchical modulation  used  e.g., for 16QAM, we have the modulation order M = 16 , and Bw is the total  bandwidth available for transmission  i.e., 10 MHz for all the cases . As defined in  Equation 9.9, the Rb value is obtained by dividing the size of the block of bits being  transmitted  before coding  over the duration in seconds that is needed to transmit  the entire block of bits  typically this is the subframe duration or time transmission  interval equal to 0.5 ms .  R b  =  L TB TTI      9.9   Some results from LLSs are presented in Figure 9.10 for one of the environ- ments under consideration. The presented ES N0  and SNR values obtained from  them  are required to receive the totality of the bits for each modulation and coding  scheme  MCS . The target SNR values required to receive only a part of those bits   i.e., only the strong bits, or strong and average bits  are obviously lower than those. Figure 9.10 plots the BLER performance of single-user MIMO  SU-MIMO   2 × 2  with  frequency  diversity,  as  a  function  of  ES N0  values,  for  different  fre- quency  reuse  R,  two  different  streams  transmitted  by  antennas  A1  and  A2   in       Link and System Level Simulation for MIMO  ◾  421  100  10–1  R E L B  10–2  10–3  10–4  0  A1, Cod. 1 2, R 1 3 A2, Cod. 1 2, R 1 3 A1, Cod. 1 2, R 1 2 A2, Cod. 1 2, R 1 2 A1, Cod. 1 2, R 1 A2, Cod. 1 2, R 1 A1, Cod. 3 4, R 1 3 A2, Cod. 3 4, R 1 3 A1, Cod. 3 4, R 1 2 A2, Cod. 3 4, R 1 2 A1, Cod. 3 4, R 1 A2, Cod. 3 4, R 1  2  4  8  10  12  6  ES N0  dB   Figure 9.10  BLER versus Es No MIMO  2 × 2 , QPSK, urban macrochannel.  case  of  multiresolution,  the  BER  of  each  spatial  multiplexing*  stream  might  be  different  and coding rate Cod. The receiver is an iterative minimum mean square  error  MMSE , as described in Chapter 2. Taking as reference the BLER = 0.01  or  BLER = 0.1 for PtP communications  then the corresponding ES N0 values would  provide the SNR values to correctly receive a block of N bits, being used as an input  to run the system level simulator.  9.2.2  System-Level Simulations The ITU-R IMT-Advanced MIMO channel model for SLS is a geometry-based  stochastic model. It can also be called double-directional channel model. It does  not explicitly specify the locations of the scatters, but rather the directions of the  rays, like the well-known spatial channel model  SCM  [3GPP 2009a]. Geometry- based modeling of the radio channel enables separation of propagation parameters  and antennas.  The channel parameters for individual snapshots are determined stochastically  based on statistical distributions extracted from channel measurements. Antenna  geometries and radiation patterns can be defined properly by the user of the model.  Channel realizations are generated through the application of the geometrical prin- ciple by summing contributions of rays  plane waves  with specific small-scale  SS   parameters  such  as  delay,  power,  angle-of-arrival   AoA   and  angle-of-departure   AoD . Superposition results to correlation between antenna elements and tempo- ral fading with geometry-dependent Doppler spectrum.  *  A multilayer MIMO transmission is assumed  spatial multiplexing , as described in Chapter 1.      422  ◾  MIMO Processing for 4G and Beyond  A number of rays constitute a cluster. In the terminology of this document, we  equate the cluster with a propagation path diffused in space, either or both in delay and  angle domains. Elements of the MIMO channel, for example, antenna arrays at both  link ends and propagation paths, are illustrated in Figure 9.11. The generic MIMO  channel model is applicable to all scenarios, for example, indoor, urban, and rural.  The time-variant impulse response matrix of the U × S MIMO channel is given by     h  τ   ;   t  =  h  τ   ;   tn  N  ∑  n  = 1      9.10   where t is time, τ is delay, N is the number of paths, and n is path index.  The IMT-Advanced channel model for the evaluation of IMT-Advanced candi- date technologies consists of a primary module and an extension module. Only the  primary module is described, which is mandatory for IMT-Advanced evaluation.  The generic channel model is a stochastic model with two  or three  levels of  randomness. First, large-scale  LS  parameters such as shadow fading, delay, and  angular spreads are drawn randomly from tabulated distribution functions. Next,  SS parameters such as delays, powers, and directions of arrival and departure are  drawn  randomly  according  to  tabulated  distribution  functions  and  random  LS  parameters. At this stage, the geometric setup is fixed and the only free variables  are the random initial phases of the scatters. By picking  randomly  different initial  phases, an infinite number of different realizations of the model can be generated.  When the initial phases are also fixed, there is no further randomness left.  Figure 9.12 shows the overview of the channel model creation. The first stage  consists of two steps. First, the propagation scenario is selected. Then, the network   Array 2   U  Rx elements    rrx,1  rrx,U  Array 1   S  Tx elements    Path 1   rtx,1  rtx,S  Path N  Figure 9.11  MIMO channel.      Link and System Level Simulation for MIMO  ◾  423  Propagation parameter  generation  Large-scale parameters -DS, AS, K -XPR -shadowing -path loss  Multipath parameters  -power,  delay, AoA,  AoD, etc.  ChIR  generation  Channel coefficient generation  ChIR  User defined parameters  Scenario selection  -urban macro -urban micro -indoor -out2in -etc.  Network Layout  -BS and MS   locations -velocities  Antennas  -elements -orientations -field patterns  Figure 9.12  Channel model creation process.  layout and the antenna configuration are determined. In the second stage, LS and  SS parameters are defined. In the third stage, channel impulse responses  ChIRs   are calculated.  The generic model is based on the drop concept. When using the generic model,  the simulation of the system behavior is carried out as a sequence of drops, where a  drop is defined as one simulation run over a certain time period. A drop  or snap- shot or channel segment  is a simulation entity where the random properties of the  channel remain constant except for the fast fading caused by the changing phases  of the rays. The constant properties during a single drop are, for example, the pow- ers, delays, and directions of the rays. In a simulation, the number and the length of  drops have to be selected properly by the evaluation requirements and the deployed  scenario. The generic model allows the user to simulate over several drops to get  statistically representative results. Consecutive drops are independent.  Several different scenarios will be evaluated, some considering E-MBMS ser- vices in PtP mode and PMP modes. The scenario where PtP mode is evaluated will  serve as reference result when comparing the results in PMP, which are expected to  outperform the results of PtP mode.  The SU-MIMO, MU-MIMO, and finally CoMP scenarios will also be evalu-  ated in the next section.  The most important parameters used for the different scenarios based on 3GPP   recommendations [3GPP 2010c, 3GPP 2010d] can be observed from Table 9.1.  The average propagation loss with distance is dependent on the probability of  line-of-sight  LOS . This is presented in Equation 9.11, where mobile users must be  distant from the eNB antennas more than 18 m.     Pr   LOS     =  −  d     63  −  e     +  e  −  d     63  d  >  18  m   9.11      18 1   d      424  ◾  MIMO Processing for 4G and Beyond  Table 9.1  Parameterization for SLS Simulations  Parameter  Cell radius  Schedulers  Traffic model  Simulation time  Subframe duration  TTI   Carrier frequency  Propagation model  Distance attenuation  d = distance  in meters   Values  500, 750, 1000, 2250 m  RR, Max C I, FT, PF  CBR  500  seg   0.5 ms  2 GHz  3GPP urban macro  PNLOS = −40.45 + 39.09 log d   dB  PLOS = 34.04 + 22 log d  if d < 360 m  dB  PLOS = −11.02 + 40 log d  if d > 360 m  dB  L = Pr LOS PLOS +  1–Pr LOS  PNLOS  dB   Channel model  Urban macro  Number of base station sites  19  Number sectors per base station  site  3 sectors site  User mobility  UE antenna height  eNB antenna height  % of transmitted power by other  cells  1.5 m  25 m  90  Random walk inside sector  Modulations  Coding rate  Frequency reuse  Sites layout  QPSK, H-16QAM, H-64QAM  1 2, 3 4  1,1 3, HR: 1 + 1 3  19 eNBs  eNB base station power sector  46 dBm or 40 W  RRH power sector  34 dBm or 2.5 W  Number UEs per sector  Variable      Link and System Level Simulation for MIMO  ◾  425  9.3  Simulation Results The problem of intercell interference is illustrated in Figure 9.13, which shows a  cumulative distribution function plot of the geometry factor within a typical mac- rourban cell.  The geometry factor was the term used in universal mobile telecommunication  system  UMTS  to indicate the ratio of the wanted signal relating to the inter- ference plus noise. This corresponds to the signal-to-interference-plus-noise ratio   SINR . From the figure, it is viewed that 10% of the users experience better than  10.5 dB geometry factor but 50% of users experience worse than 1.5 dB. The exact  shape of the curve varies significantly depending primarily on the frequency reuse  factor followed by the cell size and cell loading. An isolated cell would exhibit a  shift to the right, indicating that most users are experiencing very good signal con- ditions. A cell in an urban area with significant cochannel inter-cell interference  would shift to the left. Penetration loss through buildings, as experienced when  indoor coverage is provided from an external cell, would also cause a shift to the  left. When the deployment in a particular area has resulted in a certain geometry  factor  distribution,  the  challenge  becomes  how  to  deal  with  the  interference  to  improve cell-average and cell-edge performance.  100  90  80  70  60  50  40  30  20  10     %         a s s i c s A <   y r t e m o e g h t i     w   s n o i t a c o  l   r e s U  0 –10 –8 –6 –4 –2  0  6  4  2 8 Geometry  dB   Urban macrocell  10  12  14  16  18  20  Figure 9.13  Geometry factor distribution in a typical macrourban cell with fre- quency reuse 1.      426  ◾  MIMO Processing for 4G and Beyond  9.3.1  Results for PMP Scenarios In 3G systems, the frequency reuse was optimized at one, and methods such as  scrambling and spreading were used to minimize the impact of interference with  resulting gains in average spectral efficiency. Later systems employed receive diver- sity, equalizer, transmit diversity, and limited spatial multiplexing  MIMO . For  LTE-Advanced, the planned performance enhancement techniques will take fur- ther steps by using more advanced MIMO and BF, interference cancellation, frac- tional frequency reuse, and other advanced methods.  It is worth explaining how the cell-edge performance targets used by ITU-R and  3GPP were developed based on simulated geometry-factor distributions for the tar- get deployment environments. Ten users were randomly distributed within each cell  and the resulting geometry factor was calculated for each UE. This information was  converted into a data throughput rate that was in turn used to plot a distribution of  throughput. The process was repeated many times in a multidrop simulation to cre- ate a smooth throughput distribution. The cell-edge performance was then defined  as the fifth percentile of the throughput distribution. It is not straightforward to take  the cell-edge figure per user and multiply by 10 to predict the cell-edge average since  the distribution is complicated by the type of scheduler used. The scheduler may  have allocated more resources to the cell-edge users in a proportionally fair system. The following six figures present several geometry distributions  SINR , illus- trating several intercell interference cancellation  ICIC  schemes. The system simu- lated has 19 sites  eNBs , where each cell has 3 sectors, 57 sectors in total, and  mobile users are distributed within the inner 7 cells but suffer intercell interference  from all the eNBs. The cell radius is 2250 m.  In Figure 9.14, the spatial geometry distribution of the SC-PMP scenario with  full frequency reuse of 1 is presented. As reuse 1 is considered, no ICIC is employed  and as a result the SNR is low almost everywhere. The higher values of SNR occur  closer  to  the  sites  aligned  with  the  directions  of  the  three  sector  antennas.  The  places with SNR≤ −2 dB correspond to about 10% of the total area. There are no  places with SNR≥ 22 dB.  The simple form of reducing intercell interference is employing fractional fre- quency  reuse.  In  Figure  9.15,  the  spatial  geometry  distribution  of  the  SC-PMP  scenario with fractional frequency reuse of 1 3 is presented. As a result, the SNR  increases everywhere. As expected, the higher values of SNR continue to occur  closer to the sites aligned with the directions of the three sector antennas. The places  with SNR≤ −2 dB have disappeared and were replaced by 0 dB ≤ SNR ≤ 2 dB cor- responding to about 10% of the total area. The places with SNR ≥ 22 dB corre- spond to about 10% of the total area. Due to the significant co-channel intercell  interference reduction, there is a shift to the right in terms of geometry curve pre- sented in Figure 9.13.  In Figure 9.16, the spatial geometry distribution of the SC-PMP scenario with  soft frequency reuse of 1 + 1 3 is presented. When compared with the case of simple       Link and System Level Simulation for MIMO  ◾  427  Figure 9.14  Spatial signal-to-interference-noise ratio of SC-PMP scenario with  frequency reuse 1.  Figure 9.15  Spatial signal-to-interference-noise ratio of SC-PMP scenario with  frequency reuse 1 3.      428  ◾  MIMO Processing for 4G and Beyond  Figure 9.16  Spatial signal-to-interference-noise ratio of SC-PMP scenario with  soft frequency reuse 1 + 1 3.  reuse 1, the SNR increases everywhere. The higher values of SNR continue to occur  closer to the sites aligned with the directions of the three sector antennas. However,  despite the higher available spectrum, when compared with the case of reuse 1 3,  there is a decrease in SNR values close to eNBs due to the use of reuse 1 in those  areas. The places with 0 dB ≤ SNR ≤ 2 dB correspond to about 10% of the total  area, which is identical to simple reuse 1 3. However, the places with SNR ≥ 22 dB  have decreased and correspond to about 3% of the total area.  In  Figure  9.17,  the  spatial  geometry  distribution  of  the  MBSFN  scenario  with full frequency reuse of 1 is presented. In spite of employing reuse 1, there  is ICIC due to the considered MBSFN scenario. For reuse 1, MBSFN compared  with SC-PMP presents spatial SNR higher due to coordination of the synchro- nized transmissions. The higher values of SNR continue to occur closer to the sites  aligned with the directions of the three sector antennas. The places with values  −2 dB ≤ SNR ≤ 0 dB correspond to about 5% of the total area. The places with  values SNR ≥ 22 dB correspond also to about 5% of the total area.  To  further  reduce  the  intercell  interference,  we  consider  the  fractional  fre- quency  reuse.  In  Figure  9.18,  the  spatial  geometry  distribution  of  the  MBSFN  scenario with fractional frequency reuse of 1 3 is presented. As a result, the SNR  increases substantially everywhere. As expected, the higher values of SNR continue       Link and System Level Simulation for MIMO  ◾  429  Figure  9.17  Spatial  signal-to-interference-noise  ratio  of  MBSFN  scenario  with  frequency reuse 1.  Figure  9.18  Spatial  signal-to-interference-noise  ratio  of  MBSFN  scenario  with  frequency reuse 1 3.      430  ◾  MIMO Processing for 4G and Beyond  Figure  9.19  Spatial  signal-to-interference-noise  ratio  of  MBSFN  scenario  with  soft frequency reuse 1 + 1 3.  to occur closer to the sites aligned with the directions of the three sector anten- nas. The places with −2 dB ≤ SNR ≤ 0 dB have disappeared and were replaced by  6 dB ≤ SNR ≤ 8 dB, corresponding to about 10% of the total area. The places with  values SNR ≥ 22 dB have increased and correspond to about 20% of the total area. In Figure 9.19, the spatial geometry distribution of the MBSFN scenario with  soft frequency reuse of 1 + 1 3 is presented. When compared with the case of simple  reuse 1, the SNR increases everywhere. The higher values of SNR continue to occur  closer to the sites aligned with the directions of the three sector antennas. However,  when compared with the case of reuse 1 3, there is a decrease in SNR values close to  eNBs due to the use of reuse 1 in those areas. The places with 6 dB ≤ SNR ≤ 8 dB  correspond to about 10% of the total area, which is identical to simple reuse 1 3.  However, the places with values SNR ≥ 22 dB have decreased and correspond to  about 15% of the total area.  9.3.2  Results for PtP Scenarios In PtP scenario, every UE is served individually, and the link established by any  given UE. If a user does not receive a packet properly, there is the option to retrans- mit the lost packet. Therefore, coverage in this type of system is assured. In this       Link and System Level Simulation for MIMO  ◾  431  scenario, service delay or outage can be experienced  e.g., due to large waiting times  when scheduling , outage being one of the aspects analyzed here. Another impor- tant aspect is the overall system capacity  i.e., how many users per cell can the  system serve .  Since  every  UE  is  individually  allocated  with  resources,  and  once  these  are  finite, some sort of scheduling mechanism is necessary. Different scheduling mech- anisms are tested, using different numbers of UEs in the system to better under- stand how every scheduling algorithm performs [Gomes 2010].  The following results only cover the traffic model, with constant bit-rate  CBR *  at  37,800  kbps.  The  CBR  traffic  model,  as  the  name  says,  always  generates  the  same amount of data, with exactly the same time intervals between consecutive  data. This is the traffic model that comes closer to type of traffic generated in PMP  transmissions. The CBR traffic model generates a packet of 37,800 bits every 1 ms   millisecond . This represents a traffic generator offering a load of 37,800 kbps per  UE and a maximum spectral efficiency per user of 3.7 bps Hz in a 10 MHz band  with MIMO 4 × 4 [3GPP 2012b]. As we previously described, the exact shape of  the geometry curve varies significantly depending on the frequency reuse factor fol- lowed by the cell size and cell loading. The influence of the type of employed sched- uler, the cell size, and the cell loading will all be analyzed in the following sections.  9.3.2.1  Results for PtP with SU-MIMO Figure 9.20 shows the cumulative distribution function of throughput  CDF x   as  a function of the throughput, for SU-MIMO 4 × 4, with 10 channel quality indi- cators  CQIs  QPSK modulated, and five CQIs 16QAM modulated. The CDF x   is the probability of the random variable% of UEs with throughput value less than  or equal to x. Three different schedulers are analyzed, where the number of users  per sector is 10, as recommended by ITU-R [ITU-R 2008] and by 3GPP [3GPP  2012a]. The CDF of throughput was chosen as the basis of comparison of differ- ent schemes in ITU-R and 3GPP. In this figure, the cell radius R is 750 m, the  coding rate is 1 2 and the frequency reuse is one  high levels of intercell interfer- ence at cell borders . As can be seen, the results vary significantly depending on  the scheduler. There are two “fair” schedulers, the simple round robin  RR  and  the fair throughput  FT . In RR, users form a circular queue and the scheduler  allocates equal timeslots for each and every user in the queue. The FT algorithm  consists of serving users equally accordingly to the average throughput. Therefore,  the FT scheduling aims at fairness in terms of user throughput  all users, no mat- ter what their receiving conditions or position are inside cell will have the same  average throughput . This is done by scheduling first users who have lowest average  throughputs. The scheduler maximum carrier-interference  MCI , also referred to  in the literature as “maximum SINR,” or simply as “Max C I,” is a channel aware   *  CBR stands for constant bit rate.      432  ◾  MIMO Processing for 4G and Beyond     RR MCI FT    t u p h g u o r     Th = <   s E U %     1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0    0  1000  2000  3000  4000  5000  6000  7000  8000  9000  Throughput  kbps   Figure 9.20  CDF of throughput versus throughput, SU-MIMO  4 × 4 , different  schedulers, Nu = 10.  scheduling algorithm where it is given more priority to users with good channel   users  located  closer  to  the  base-station .  The  scheduler  chooses  the  user  k  with  maximum SINR at instant t. The measurement of SINR is performed via constant  periodic CQI feedback done by every single user. The MCI is not fair.  Only RR and FT are able to transmit successfully to users located at cell bor- ders. Remind that the cell-edge performance is defined as the fifth percentile of the  CDF of the throughput. In this case, the cell-edge performance of RR and FT is  125 kbps. The average throughput  50% CDF  is 650 kbps for MCI, 2150 kbps for  FT and 2650 kbps for RR. However, it can be viewed that 10% of users experience  a better than 7600 kbps for MCI, 3700 kbps for FT, and 5000 kbps for RR.  The throughput distribution versus the geometry of SU-MIMO 4 × 4 is illus- trated in Figure 9.21, for different schedulers, and corresponds to previous Figure  9.20. The geometry factor is the term used in UMTS to indicate the ratio of the  wanted signal relating to the interference plus noise, and corresponds to the SINR.  As expected the results depend on the scheduler. The curves corresponding to the  two “fair” schedulers, RR and FT are less dependent of the parameter geometry.  Indeed the FT algorithm aims at achieving a straight line along the geometry axe.  Independent of the mobile position within the cell, each one gets the same average  throughput. Due to the way it works, the RR scheduler presents the expected varia- tion of the throughput with the geometry. Users located close to the base station,       Link and System Level Simulation for MIMO  ◾  433  6000  5000  4000  3000  2000  1000    s p b k     t u p h g u o r h t   e g a r e v A  RR MCI FT  10  0 –10  –5  0 Geometry  dB   5  15  Figure 9.21  Throughput distribution versus geometry, SU-MIMO  4 × 4 , differ- ent schedulers.  with high values of geometry  expressed in dB , achieve higher throughput than  users at the border of the cell. The unfair scheduler MCI, giving more priority to  users with good channel conditions, amplifies the difference of throughput versus  the geometry. It has very small throughput for users at the cell edge and very high  throughput for users located close to the base station.  The throughput distribution versus the geometry of SU-MIMO 4 × 4 is illus- trated in Figure 9.22, for the RR scheduler, where the parameter cell radius is vari- able. As can be seen from Table 9.1 and Equation 9.11, the average propagation loss  with the distance depends on the existence of LOS  or non-LOS [NLOS] . The prob- ability of LOS decreases with the distance, and the probability of NLOS increases  with the distance. In the model used for LOS at d < 320 m, there is an exponential  power decay with 3.4 and for LOS at d ≥ 320 m the power decay increases to 4.  When we consider the cell with radius equal to R = 500 m, there is a predominance  of places that are in LOS. In this case, there is a strong intercell interference, even  for mobiles close to the base station. Increasing the cell radius to R = 750 m and to  R = 1000 m decreases the probability of LOS and reduces the intercell interferences  for users close to the base station increasing the throughput. This can be seen from  Figure 9.22. However, for users located at the cell edge increasing the cell radius  reduces the throughput due to decreasing levels of received power, while keeping  the same geometry  the same signal to interference plus noise ratio .      434  ◾  MIMO Processing for 4G and Beyond  4500  4000  3500  3000  2500  2000    s p b k     t u p h g u o r h t   e g a r e v A  R = 500 m R = 750 m R = 1000 m  1500  –10  –5  0  5 Geometry  dB   10  15  Figure 9.22  Throughput distribution versus geometry, SU-MIMO  4 × 4 , differ- ent cell radius, Nu = 10.  The CDF of throughput results for SU-MIMO 4 × 4, the RR scheduler, for dif- ferent cell radius, Nu = 10, is illustrated in Figure 9.23, and corresponds to Figure  9.22. As expected, the case R = 750 m is the intermediate one. For R = 1000, there  is a reduction of the maximum throughput, and less than 10% of the users have  throughput higher than 4500 kbps. For R = 500 m, there are 10% of the users with  throughput higher than 5350 kbps. However, there is an average throughput  50%  of users  of 2650 kbps for R = 1000 m, while for R = 500 m the average value is  2500 kbps. For cell edge users, the throughput is also higher for R = 1000 m com- pared to R = 500 m  or R = 750 m .  The throughput distribution versus the geometry of SU-MIMO 4 × 4, where the  number of users per cell is Nu = 50, is illustrated in Figure 9.24, for different schedul- ers. As expected, there is a substantial throughput reduction per user when we increase  the number of users from 10  Figure 9.22  to 50. For MCI, only 30% of the users  are served but 10% of these users get more than 2000 kbps. For RR and FT, 50% of  the users get 525 kbps which is around 10 50 of the throughput achieved when there  were 10 users. For FT, 10% of the users get more than 600 kbps and for RR there are  10% of users with more than 1000 kbps. In conclusion, there is a linearly proportional  decrease of the throughput for a linear increase of the number of users.      Link and System Level Simulation for MIMO  ◾  435  R = 500 m R = 750 m R = 1000 m    t u p h g u o r     Th = <   s E U %     1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  1000  2000  3000  4000  5000  6000  7000  8000  9000  Throughput  kbps   Figure 9.23  CDF of throughput versus throughput, SU-MIMO  4 × 4 , different  cell radius, Nu = 10.  The  CDF  of  throughput  results  for  SU-MIMO  2 × 2  with  10  CQIs  QPSK  modulated and five CQIs 16QAM modulated are illustrated in Figure 9.25. The  same schedulers are analyzed, namely, RR, MCI, and FT. The number of users per  sector is 10 and the cell radius R is 750 m, the coding rate is 1 2 for QPSK and 3 4  for 16QAM, the frequency reuse is one. This figure should be compared to Figure  9.22 with MIMO 4 × 4.  RR and FT are able to transmit successfully to users located at cell borders and  MCI continues to not serve 30% of the users. The cell-edge performance  5% CDF   of RR and FT is 125 kbps. The average throughput  50% CDF  is 450 kbps for  MCI, 1200 kbps for FT, and 1400 kbps for RR. However, 10% of users experience  a throughput better than 7500 kbps for MCI, 1900 kbps for FT, and 3800 kbps for  RR. When we compare the MIMO 2 × 2 results with MIMO 4 × 4, the cell edge  throughput has not changed, but the average throughput is about half, independent  of the scheduler. For the 90% CDF, the throughput results depend on the schedul- ers. For FT, this throughput is halved, for the RR scheduler is 76%, and for MCI  is 96%. It should be noticed that the highest bit rate of the CQIs for MIMO 2 × 2  is almost the same as the CQIs for MIMO 4 × 4 because both employ 16QAM but  the coding rates are different 3 4 and 1 2, respectively.      436  ◾  MIMO Processing for 4G and Beyond  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  t u p h g u o r     Th = <    s E U %     t u p h g u o r  Th = <   s E U %     RR MCI FT  RR MCI FT  0  0  1000  2000  3000  4000  5000 Throughput  kbps   6000  7000  8000  9000  Figure 9.24  CDF of throughput versus throughput, SU-MIMO  4 × 4 , Nu = 50.  0  0  1000  2000  3000  5000  4000 6000 Throughput  kbps   7000  8000  9000  10000  Figure 9.25  CDF of throughput versus throughput, SU-MIMO  2 × 2 , Nu = 10.      Link and System Level Simulation for MIMO  ◾  437  9.3.2.2  Results for MU-MIMO BF  is  a  suboptimal  strategy  that  can  serve  multiple  users  at  a  time,  but  with  reduced complexity. In BF, each user stream is coded independently and multi- plied by a BF weight vector for transmission through multiple antennas. Careful  selection of weight vectors can reduce  or eliminate  mutual interference among  different  streams  by  taking  advantage  of  spatial  separation  between  users  and  thereby supporting multiple users simultaneously. This multiuser communication  scheme is called space-division multiple access  SDMA .* In [Sharif and Hassibi  2005], the authors propose an orthogonal random beamforming  RBF  scheme.  Another suboptimal BF strategy is zero-forcing beamforming  ZFBF  [Yoo and  Goldsmith  2006],  where  the  weight  vectors  are  chosen  to  avoid  interference  among  user  streams.  Both  scheduling  strategies  essentially  combine  TDMA  OFDMA with SDMA.  In industry, SDMA with orthogonal BF, under the name “per user unitary  and rate control”  PU2RC  [Samsung 2006], was proposed to the 3GPP-LTE  standard. The main feature of PU2RC is limited feedback, where multiuser pre- coders or beamformers are selected from a codebook of multiple orthonormal  bases.  Based  on  limited  feedback,  PU2RC  supports  SDMA,  scheduling,  and  adaptive  modulation  and  coding.  Because  of  its  versatility  and  advanced  fea- tures, PU2RC is one of the most promising solutions for high-speed downlink  in 3GPP-LTE.  The cumulative distribution function of throughput results for MU-MIMO  with M = 4 transmitting antennas, with the same adaptive MCSs of SU-MIMO  are illustrated in Figure 9.26. Four different schedulers are analyzed, where the  number of users per sector is 10. In current and next figures, the cell radius R is  750 m and perfect channel state information is assumed. All schedulers include  beamformers selected from multiple orthonormal bases. There is a new scheduling  algorithm named proportional fair  PF . Similar to Max C I, PF is channel aware.  In fact, we can look at PF as a less aggressive version of Max C I scheduling algo- rithm. PF uses CQI feedback sent by users to determine the instantaneous possible  data rate a user k can achieve at a given instant t, and also the average throughput  a user k had until instant t. This way, users that have instantaneous throughputs  higher than their average throughput are scheduled first. The unfairness of Max  C I scheduler, where only users with good SNR have resources allocated, is avoided  [Ishizaki and Hwang 2009]. As expected, the results are varying depending on the  scheduler type. The comparison with Figure 9.20 indicates that MCI increases the  highest throughput achieved by 10% of users, better than 8000 kbps. However,  there is a reduction of the highest throughput for FT  and RR , which was com- pensated by the increase of average throughput, specially the throughput for users  at cell edge. The throughput performance curve of PF is following the MCI curve   *  See Chapter 1.      438  ◾  MIMO Processing for 4G and Beyond  RR MCI FT PF  t u p h g u o r  Th = <    s E U %     1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  1000  2000  3000  4000  5000  6000  7000  8000  9000  Throughput  kbps   Figure 9.26  CDF of throughput versus throughput, MU-MIMO  M = 4 , different  schedulers, Nu = 10.  but with much more fairness. As a result, the average throughput of PF is more than  the double of the MCI.  The throughput distribution versus the geometry of MU-MIMO, for M = 4  transmitting antennas, is illustrated in Figure 9.27, for different schedulers, and  corresponds to Figure 9.26. As expected, the results depend on the scheduler and  should be compared with Figure 9.21. An increase of throughput is observed for  MCI and users with highest geometry. There is a reduction of throughput for RR  and  users  with  higher  geometry.  The  performance  of  PF  is  between  these  two  schedulers for all geometry values. The throughput of FT is the less dependent of  the geometry parameter and presents an increase for the smaller geometry.  The throughput distribution versus the distance of MU-MIMO, M = 4 trans- mitting antennas, is illustrated in Figure 9.28, for different schedulers, and cor- responds to previous Figure 9.27. As expected there is a strong correlation with  the results presented in Figure 9.27. The correlation is due to the strong relation  between geometry and location inside the cell of the users. Users at smaller dis- tance of the base station are those with higher geometry. Inversely, users at the  border of the cell  R = 750 m  are the ones with the smallest geometry. For MCI  and users at R = 50 m, the throughput is higher than 8000 kbps, which should  correspond to less than 10% of the users. For PF, RR, and FT algorithms, the       Link and System Level Simulation for MIMO  ◾  439  7000  6000  5000  4000  3000  2000  1000    s p b k     t u p h g u o r h t   e g a r e v A      s p b k     t u p h g u o r h t   e g   a r e v A  9000  8000  7000  6000  5000  4000  3000  2000  1000  0  0  0 –10  –5  0 Geometry  dB   5  15  Figure 9.27  Throughput distribution versus geometry, MU-MIMO  M = 4 , dif- ferent schedulers, Nu = 10.  RR MCI FT PF  10  RR MCI FT PF  100  200  300  400  500  600  700  800  Distance  m   Figure 9.28  Throughput versus distance, MU-MIMO  M = 4 , different schedul- ers, Nu = 10.      440  ◾  MIMO Processing for 4G and Beyond  highest throughput is 6200 kbps, 4350 kbps, and 2900 kbps, respectively. At cell  edge, there is an inversion and for MCI, PF, RR, and FT the throughput achieved  is 90 kbps, 350 kbps, 650 kbps, and 1600 kbps, respectively.  The  CDF  of  throughput  results  for  MU-MIMO  with  M = 4  transmitting  antennas and the same MCSs of SU-MIMO are illustrated in Figure 9.29, where  the number of users per sector is 50. The same four different schedulers are ana- lyzed. The comparison with Figure 9.24 indicates that MCI increases the highest  throughput achieved by 10% of users, better than 2300 kbps. However, there is a  reduction of the highest throughput for RR  and FT  which was compensated by  the increase of the average throughput, specially the throughput of FT for users at  cell edge. Again, the performance curve of PF is following the MCI curve but with  much higher percentage of users served, in spite of small throughput. As a result,  more than 55% of the users are scheduled by PF, while for MCI, only 28% are  scheduled.  The throughput distribution versus the geometry of MU-MIMO, M = 4 trans- mitting antennas, for Nu = 50 users per sector is illustrated in Figure 9.30, and cor- responds to CDF results of previous Figure 9.29. These results should be compared  with Figure 9.27 for Nu = 10. For the FT algorithm with Nu = 50, there is an aver- age throughput of 500 kbps that multiplied by 50 10 = 5 gives 2500 kbps which   RR MCI FT PF  t u p h g u o r  Th = <    s E U %     1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  1000  2000  3000  4000  5000  6000  7000  8000  9000  Throughput  kbps   Figure 9.29  CDF of throughput versus throughput, MU-MIMO  M = 4 , different  schedulers, Nu = 50.      Link and System Level Simulation for MIMO  ◾  441  RR MCI FT PF  4000  3500  3000  2500  2000  1500  1000  500    s p b k     t u p h g u o r h t   e g a r e v A  0 –10  –5  0 Geometry  dB   5  10  15  Figure 9.30  Throughput distribution versus geometry, MU-MIMO  M = 4 , dif- ferent schedulers, Nu = 50.  is  the  average  throughput  when  Nu = 10.  There  is  no  throughput  gain   unitary  gain  with this scheduler. For MCI with Nu = 50, in the region of higher geom- etry  interference-limited region , there is an average throughput of 3600 kbps that  multiplied by 5 gives 1800 kbps which is three times the average throughput of  6000 kbps when Nu = 10. So there is a throughput gain of 3 for this scheduler.  In the region of smaller geometry  interference plus noise-limited region , there is  no throughput gain. In fact, a loss of throughput is observed. For PF in the inter- ference-limited region, the throughput gain is 1.5. In the interference plus noise- limited region, the gain is unitary. With RR, there is a unitary gain in both regions.  This is similar to FT.  To increase the spectral efficiency on average and or at the cell borders, or when  the number of users is increasing, the MU-MIMO with PF scheduling should be  employed.  9.3.3  Results for CoMP with MU-MIMO To allow a comparison with previous results, only CoMP scenario 2 is analyzed  in this section. Data to a UE is simultaneously transmitted  joint transmission   from  multiple  points  to  coherently  improve  the  received  signal  quality  or  data  throughput. A combination of MU-MIMO with CoMP is employed. We take the       442  ◾  MIMO Processing for 4G and Beyond  simplification  of  assuming  that  the  quality  of  channel  state  information  is  very  good  perfect estimation .  The  cumulative  distribution  function  of  throughput  results  for  CoMP  with  MU-MIMO  with  M = 4  transmitting  antennas  per  site,  with  the  same  adap- tive MCSs of SU-MIMO are illustrated in Figure 9.31. The same four different  schedulers are analyzed, where the number of users per sector is 10 and the cell  radius R is 750 m. As expected, the results are varying depending on the scheduler.  The comparison with Figure 9.26 indicates overall improvements independently  of the schedulers. For MCI, the highest throughput achieved by 10% of users is  around 8500 kbps. For PF, RR, and FT the corresponding values are 7750 kbps,  5900 kbps, and 4100 kbps, respectively. The average throughput has also increased  for all the schedulers. There is an obvious increase of throughput of cell edge users  for schedulers MCI and PF. There are also throughput increments at cell edge users  for the FT and RR due to improvement of the received signal-to-noise ratio.  The throughput distribution versus the geometry of CoMP with MU-MIMO,  M = 4 per site, for Nu = 10 users per sector is illustrated in Figure 9.32, and cor- responds to CDF results of previous Figure 9.31. These results should be compared  with Figure 9.27. There is an overall performance improvement independently of  the schedulers. For the FT algorithm, there is an obvious increase of throughput of   t u p h g u o r  Th = <   s E U %     1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  0  RR MCI FT PF  1000  2000  3000  4000  5000  6000  7000  8000  9000  Throughput  kbps   Figure 9.31  CDF of throughput versus throughput, CoMP with MU-MIMO, dif- ferent schedulers, Nu = 10.      Link and System Level Simulation for MIMO  ◾  443  7000  6000  5000  4000  3000  2000  1000    s p b k     t u p h g u o r h t   e g a r e v A  RR MC FT PF  0 –10  –5  0  5  Geometry  dB   10  15  Figure 9.32  Throughput distribution versus geometry, CoMP with MU-MIMO,  different schedulers, Nu = 10.  3000 2500 kbps = 1.2. For the other algorithms, it is not easy to compute the gain  because we need to consider the performance improvement in all geometry values,  but the same 20% increase seems to apply.  The CDF of throughput results for CoMP with MU-MIMO, and with M = 4  transmitting antennas per site, is illustrated in Figure 9.33, where the number of  users per sector is 50. The comparison with Figure 9.29 indicates overall improve- ments  independently  of  the  schedulers.  For  MCI,  PF,  RR,  and  FT  the  highest  throughput achieved by 10% of users is 3300 kbps, 2050 kbps, 1200 kbps, and  800 kbps, respectively. The performance curve of PF is following the MCI curve,  but there is no improvement for users served with small throughput. In all, 55%  of the users  the same percentage as without CoMP  are scheduled by PF while for  MCI, 33% are now scheduled  5% increase .  The throughput distribution versus the geometry of CoMP with MU-MIMO,  for Nu = 50 users per sector, is illustrated in Figure 9.34, and corresponds to CDF  results of previous Figure 9.33. These results should be compared with Figure 9.32  for Nu = 10. For the FT algorithm, with Nu = 50, there is an average through- put of 700 kbps that multiplied by 50 10 = 5 gives 3500 kbps which is 500 kbps  above the average throughput when Nu = 10. There is a throughput gain of 1.17  with  this  scheduler.  For  MCI  with  Nu = 50,  in  the  region  of  higher  geometry       444  ◾  MIMO Processing for 4G and Beyond  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  t u p h g u o r  Th = <    s E U %     4500  4000  3500  3000  2500  2000  1500  1000  500    s p b k     t u p h g u o r h t   e g a r e v A  RR MCI FT PF  RR MCI FT PF  0  0  1000  2000  3000  4000  5000  Throughput  kbps   6000  7000  8000  9000  Figure 9.33  CDF of throughput versus throughput, CoMP with MU-MIMO, dif- ferent schedulers, Nu = 50.  0 –10  –5  0 Geometry  dB   5  10  15  Figure 9.34  Throughput distribution versus geometry, CoMP with MU-MIMO,  different schedulers, Nu = 50.      Link and System Level Simulation for MIMO  ◾  445   interference-limited  region ,  there  is  an  average  throughput  of  4300 kbps  that,  multiplied by 5, gives 21,500 kbps, which is 3.3 times the average throughput of  6500 kbps when Nu = 10. The throughput gain is 3.3 for this scheduler. In the  region  of  smaller  geometry   interference  plus  noise-limited  region ,  there  is  no  throughput gain, but there is a loss. For PF in the interference-limited region, the  throughput gain is 1.67. In the interference plus noise-limited region, the gain is  unitary. With RR, there is a unitary gain in all regions. When these results are  compared with Figure 9.30, for Nu = 50 but without CoMP, we get the follow- ing conclusions: for FT, the throughput gain is around 1.4 within both interfer- ence regions; for RR the gain is 1.25 within both interference regions; for MCI, in  the interference-limited region, the gain is 1.15 and is unitary in the interference  plus noise-limited region; for PF, in the interference-limited region, the gain is 1.4,  being 1.10 in the interference plus noise-limited region. Due to the use of joint  coordinated multipoint transmission, independently of the schedulers employed,  throughput gains are observed. However, the gains achieved depend on the sched- ulers. The performance results indicate also that the criterion of proportional fair- ness is important when the number of users is increasing.  9.4  Conclusions The  main  goal  of  this  chapter  was  to  describe  a  set  of  techniques  that  may  be  implemented in future LTE-Advanced networks, using PMP and PtP scenarios.  These techniques use spatial multiplexing and introduce the concept of coordinated  multipoint transmission.  The use of fractional reuse schemes helps to reduce intercell interference suf- fered by users, especially those at cell border. The disadvantage of this technique  is that by partitioning the existing frequencies available, every cell will only have  access to a part of the total available bandwidth, and this is unfair to UEs closer  to the center of the cell  with good channel conditions  that could achieve higher  throughputs if using the total bandwidth.  To increase the spectral efficiency on average and or at the cell borders, or when  the  number  of  users  is  increasing,  the  MU-MIMO  with  fair  scheduling  should  be employed. The use of joint coordinated multipoint transmission achieves addi- tional throughput gains. However, the gains obtained depend on the schedulers  employed. The performance results also indicate that the criterion of proportional  fairness is important when the number of users is increasing.  Acknowledgments This work was supported by Fundação para a Ciência e Tecnologia  FCT  via proj- ect PEst-OE EEI LA0008 2013.      446  ◾  MIMO Processing for 4G and Beyond  References 3GPP, Improvements of the Multimedia Broadcast Multicast Service  MBMS  in UTRAN,   3GPP, Requirements for Evolved UTRA  E-UTRA  and Evolved UTRAN  E-UTRAN , TR   TR 25.905 v7.2.0, December 2007.  25.913 v9.0.0, December 2009a.  3GPP, Feasibility study for evolved Universal Terrestrial Radio Access  UTRA  and Universal   Terrestrial Radio Access Network  UTRAN , TR 25.912 V9.0.0, 2009b.  3GPP, Technical Specification Group Radio Access Network; MBMS synchronization proto-  col  SYNC , TS 25.446 v9.0.0, December 2009c.  3GPP, Further advancements for E-UTRA physical layer aspects TS 36.814, V9.0.0, 2010a. 3GPP,  General  aspects  and  principles  for  interfaces  supporting  Multimedia  Broadcast   Multicast Service  MBMS  within E-UTRAN, TS 36.440 v9.1.0, March 2010b  3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA ; Radio Frequency  RF  system   scenarios, Technical Report TR 36.942 v9.0.1, April 2010c.  3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA ; User Equipment  UE  radio   transmission and reception, TS 36.101 v9.3.0, 2010d.  3GPP,  Coordinated  multi-point  operation  for  LTE  physical  layer  aspects,  TS  36.819,   V11.1.0, 2011.  V11.0.0, 2012b.  3GPP, Evolved Universal Terrestrial Radio Access  E-UTRA  and Evolved Universal Terrestrial  Radio Access Network  E-UTRAN ; Overall description, TS 36.300, V11.3.0, 2012a. 3GPP, Requirements for Further Advancements of E-UTRA  LTE-Advanced , TR 36.913   Fodor, G., Koutsimanis, C., Rácz, A., Reider, N., Simonsson, A., and Muller, W., Intercell  interference coordination in OFDMA networks and in the 3GPP long term evolution  system. Journal of Communications, 4, 445–453, August 2009.  Gomes, P. S., Scheduling techniques to transmit multi-resolution in E-MBMS services of   LTE-advanced, PhD thesis, ISCTE-IUL, September 2010.  Ishizaki, F., and Hwang, G., Throughput performance of quantized proportional fair schedul- ing with adaptive modulation and coding. In Wireless Telecommunications Symposium,  Prague, April 2009, pp. 1–6.  ITU-R,  Guidelines  for  evaluation  of  radio  interface  technologies  for  IMT-Advanced,   M.2135, 2008.  Lee, J., Ng, B., and Mazzarese, D., Coordinated multipoint transmission and reception in   LTE-advanced systems. IEEE Communications Magazine, 44–50, November 2012.  Marques da Silva, M., Multimedia Communications and Networking. CRC Press Auerbach   Publications, 1st edition, ISBN: 9781439874844, Boca Raton, FL, March 2012.  Marques da Silva, M., Correia, A., Dinis, R., Souto, N., and Silva, J.C., Transmission Techniques  for Emergent Multicast and Broadcast Systems. CRC Press Auerbach Publications, 1st  edition, ISBN: 9781439815939, Boca Raton, FL, May 2010.  Marques  da  Silva,  M.,  Correia,  A.,  Dinis,  R.,  Souto,  N.,  and  Silva,  J.C.,  Transmission  Techniques  for  4G  Systems.  CRC  Press  Auerbach  Publications,  1st  edition,  ISBN:  9781466512337, Boca Raton, FL, November 2012.  Rumney,  M.,  LTE  and  the  Evolution  to  4G Wireless:  Design  and  Measurement  Challenges.  Copyright Agilent Technologies, Inc. 2013, John Wiley & Sons, Ltd, United Kingdom. Samsung  Electronics,  Downlink  MIMO  for  EUTRA,  in  3GPP TSG  RAN  WG1    44   R1-060335, Feb. 2006.      Link and System Level Simulation for MIMO  ◾  447  Sarperi, L., Hunukumbure, M., and Vadgama, S., Simulation study of Frequency Reuse in  WiMAX Networks. FUJITSU Scientific & Technical Journal  FSTJ , 44, 318–324, July  2008.  Sharif, M., and Hassibi, B., On the capacity of MIMO broadcast channels with partial side   information. IEEE Transactions on Information Theory, 51, 506–522, Feb. 2005.  Simonsson,  A.,  Frequency  reuse  and  intercell  interference  co-ordination  in  E-UTRA.  In   IEEE 65th Vehicular Technology Conference, Dublin, April 2007, pp. 3091–3095.  Yoo, T. and Goldsmith, A., On the optimality of multiantenna broadcast scheduling using  zero-forcing beamforming. IEEE Journal on Selected Areas in Communications, 24 3 ,  528–541, March 2006.  Zhou, Y., and Zein, N. Simulation study of fractional frequency reuse for mobile WiMAX.   In IEEE Vehicular Technology Conference, Singapore, May 2008, pp. 2592–2595.       Chapter 10 Massive MIMO and  Its Detection  Xiaoli Ma and Qi Zhou  Contents 10.1  Introduction and Motivation ...................................................................450 10.2  System Model ...........................................................................................451 10.2.1 Different Types of Massive MIMO ...............................................452 10.2.1.1 Single-User MIMO ........................................................452 10.2.1.2 Multiuser MIMO ...........................................................453 10.2.1.3 Distributed Massive MIMO ...........................................454 10.2.2 Mutual Information for Massive MIMO Uplink ..........................455 10.2.3 Precoding Designs for Massive MIMO Downlink .......................456 10.3  Detection of MIMO Systems with Large Arrays ......................................457 10.3.1 Linear Detectors ...........................................................................457 10.3.2 Successive Interference Cancelation and K-Best Detectors ............458 10.3.3 Iterative Soft Interference Cancelation ..........................................459 10.3.4 Lattice-Reduction-Aided Linear Detectors .................................. 460 10.3.5 Lattice-Reduction-Aided K-Best Algorithms.................................462 10.3.6 Local Neighborhood Search Methods ..........................................462 10.3.7 Performance and Complexity Comparisons ..................................463 10.3.8 Detection for Other Channels ......................................................467 10.4  Hardware Implementation of Massive MIMO Detectors .........................467 10.5  Other Issues of Massive MIMO Systems ................................................. 468 10.5.1 Channel State Information .......................................................... 468  449   450  ◾  MIMO Processing for 4G and Beyond  10.5.2 Synchronization ........................................................................... 468 10.5.3 Hardware Issues ........................................................................... 468 References .........................................................................................................469  10.1   Introduction and Motivation MIMO techniques have gained considerable attention in modern wireless communi- cations because of their high spectrum efficiencies and extended coverage. By trans- mitting data streams via multiple antennas and exploiting diversity gains offered by  distinct channel propagations, MIMO techniques boost the data rate and enhance  the  data  reception.  Thanks  to  these  benefits,  MIMO  systems  have  been  widely  adopted by modern wireless systems. For example, current long-term evolution  LTE   standard allows up to eight antennas equipped at the base station to transmit four  streams simultaneously. To further harvest the benefits of MIMO systems, massive  MIMO techniques have been proposed by installing a large number of antennas at  base stations, possibly in the order of tens or hundreds. With the large number of  antennas, massive MIMO offers several unique benefits for wireless communications:   ◾ Massive  MIMO  provides  high  orders  of  degrees  of  freedom  of  channels,  and thus allows the base station to serve more terminals at the same time–  frequency resources.   ◾ Massive MIMO can reap the benefits of rich propagation paths such that  the  fading  effects  can  be  averaged  out,  that  is,  diversity  order  goes  to  infinity.   ◾ When  the  number  of  antennas  at  the  base  station  is  much  larger  than  at  the terminals, massive MIMO enables simple precoding detection with near- optimal performance.  To efficiently operate the communication systems with a large number of anten- nas, massive MIMO also imposes a number of challenges in hardware and signal  processing, including   ◾ Fast and efficient detection algorithms given the massive channel matrices.  ◾ Stringent channel estimation issue, where the channel parameters grow lin-  early in terms of the number of antennas and the number of terminals.   ◾ Pilot contamination caused by the interference from the adjacent cells, which   is becoming a bottleneck of multicell massive MIMO systems.   ◾ Low-cost energy-efficient RF frontend.  This chapter introduces detection algorithms for Massive MIMO. We provide a  brief introduction to massive MIMO and discuss its mutual information and pre- coding designs in Section 10.2. Then, the detection designs for massive MIMO are  provided in Section 10.3. Hardware implementation concerns of massive MIMO       Massive MIMO and Its Detection  ◾  451  detectors are stated in Section 10.4, and other issues of massive MIMO such as  channel estimation and synchronization will be mentioned in Section 10.5.  10.2   System Model Consider an uplink MIMO transmission model     u  y  =  u  Hs  +  u  w  ,     10.1   where yu is an M × 1 received signal vector at the base station with M being the  number of antennas at base station, su is an N × 1 transmit signal vector with N  being the number of antennas at the terminals, h is an M × N channel matrix,  and wu is the additive white Gaussian noise vector with zero mean and covariance  matrix N0IM.  For the downlink MIMO transmission, we assume time-division duplex  TDD   transmission so that the downlink channel is the reciprocal of that of the uplink  one [Rusek et al. 2013]. The corresponding downlink transmission model is   10.2   d  y  =  T d H s  +  d  w  ,      where superscript T denotes the matrix transpose, yd is an N × 1 received signal vec- tor at the terminals, sd is an M × 1 transmitted signal at the base station, and wd is  the additive white Gaussian noise vector with zero mean and covariance matrix N0IN.  The reason for using TDD here is to allow the base station to perform precoding  which can obtain channel state information  CSI  with reciprocity. The CSI can also  be acquired using the feedback from terminals, but it is expensive due to the large  number of channel parameters of massive MIMO.  For massive MIMO, the number of antennas at both ends can be up to hun- dreds  or  even  thousands.  Since  each  terminal  typically  employs  antennas  less  than  10  due  to  limited  space,  massive  MIMO  generally  applies  a  large  number  of antennas at the base station, that is, M ≫ 0. However, for multiuser MIMO   MU-MIMO , it is also possible that a group of synchronized terminals transmit  simultaneously, which forms a large number of antennas at the mobile side such  that N ≫ 0. For example, for the LTE-A systems, each user may have four anten- nas. With more than 10 users, the total number of antennas becomes large if the  base station needs to decode them simultaneously. Therefore, based on the number  of antennas employed at the base station and the terminals, we categorize the fol- lowing two general cases of massive MIMO.   ◾ Case 1: M ≫ N, which accounts for SU-MIMO or MU-MIMO when the   number of serving terminal antennas is small.   ◾ Case 2: M ≈ N, which accounts for MU-MIMO when the total number of  serving terminal antennas is close to the number of antennas at the base station.      452  ◾  MIMO Processing for 4G and Beyond  These  two  setups  have  different  impacts  on  MIMO  transceiver  designs.  In  general, the complexity of optimal symbol detection for MIMO grows exponen- tially in terms of the number of independent data streams for diversity and spatial  multiplexing gains. However, when M ≫ N, under the favorable channel propaga- tion condition, the channel orthogonalization or channel hardening takes effect such  that the columns of h become asymptotically orthogonal as in [Rusek et al. 2013]        H H H M     ≈  , D     M N   cid:14    10.3   where the small-scale fading effect is averaged out and d is an N × N diagonal matrix  with Di,i accounting for path loss and large-scale fading effects from the ith antenna  to the base station  the superscript H in the expression is the Hermitian operator .  The main benefit of channel orthogonality is that it allows efficient simple precoding  and detection  e.g., zero-forcing detector  without losing “too much” performance   see [Ma and Zhang 2008a] . Another reason is that the diversity orders collected by  optimal detector and linear detectors are M and M − N + 1, respectively. When M  ≫ N, M − N + 1 approaches M with negligible difference if M is large.  When M ≈ N, the transceiver designs of massive MIMO systems are quite dif- ferent because the linear detectors do not perform well and Equation 10.3 does not  hold. Optimal detection such as sphere decoding algorithms  SDAs  is clearly unaf- fordable due to its high complexity  e.g., the search space for a 50 × 50 MIMO with  256-QAM  quadrature amplitude modulation  is 25650 ≈ 2.5 × 10120 . Note that  even for the first case, when N is 10 or 20, sphere decoding or maximum likelihood  detector  MLD  does not have affordable complexity. Detection becomes one of  the major obstacles to prevent applying massive MIMO in real systems. In Section  10.3, the recent development of low-complexity high-performance large MIMO  detectors will be introduced.  10.2.1   Different Types of Massive MIMO 10.2.1.1   Single-User MIMO An illustration of SU-MIMO systems is depicted in Figure 10.1. Owing to the  physical limitation of terminals, the number of antennas N at the terminal is gener- ally much less than M. Therefore, SU-MIMO systems fall into case 1 when a large  number of antennas are equipped at the base station, and thus reap the benefits  of  channel  orthogonalization  if  favorable  channel  propagation  condition  holds.  However, the SU-MIMO channels could be highly correlated because of the com- pact distance of antennas at the terminal side and possible line-of-sight environ- ment. From the power efficiency point of view, using a large antenna array to serve  a single or a small number of users may not be wise. Hence, in this case, the gain of  massive MIMO for SU-MIMO may be limited.      Massive MIMO and Its Detection  ◾  453  Base station  Terminal 1  Figure 10.1  An illustration of SU-MIMO systems.  10.2.1.2  Multiuser MIMO An illustration of MU-MIMO systems is depicted in Figure 10.2. When multiple  terminals are allowed to access the same time–frequency resource, MU-MIMO  provides  higher  system  efficiency  compared  to  SU-MIMO.  Here,  we  consider   single-cell MU-MIMO systems, where a base station is serving T terminals with  each terminal being equipped with Q antennas  i.e., N = TQ . The transmission  model of an uplink MU-MIMO system is      10.4   u  y  H s t  u t  +  u  w  T  ∑ = 1 t Hs  =  =  u  +  u  w  ,     Base station  Terminal 1  Terminal 2  Terminal 3  Figure 10.2  An illustration of MU-MIMO.      454  ◾  MIMO Processing for 4G and Beyond  u  where ht is an M × Q channel matrix from terminal t to the base station, st transmitted signal from terminal t, h = [h1, . . ., ht], and s   , u T s 1  cid:30   = [   u is a Q × 1  ,     ] . u T T s T  When T = 1, the MU-MIMO reduces to SU-MIMO. When K ≥ 2, the received  signal of each terminal is interfered with those of the other terminals, and thus  we could expect that the mutual information of each terminal for MU-MIMO is  smaller than that for SU-MIMO given the same transmitted power at each termi- nal. However, when M ≫ N, the channel orthogonalization kicks in such that the  received signal of each terminal is almost orthogonal, that is, interference-free in  the desired signal space under favorable channel propagation condition. In addi- tion, since the terminals are autonomous, the favorable channel propagation condi- tion is usually satisfied since the antennas at the terminals are almost uncorrelated  and uncoupled [Gao et al. 2011, 2012]. This again shows that the massive MIMO  is in favor of the MU-MIMO setup.  10.2.1.3   Distributed Massive MIMO Distributed  massive  MIMO   Figure  10.3   can  be  treated  as  a  special  case  of  MU-MIMO to further provide higher system capacity by employing distributed- deployed antennas to transmit and receive signals. One form of distributed mas- sive MIMO is to enable cooperation between the base stations in different cells  that reduces the intercell interference. However, synchronization becomes a critical  issue even for distributed antennas at the same base station. In some cases, the large   BS  BS  BS  Figure 10.3  An illustration of distributed massive MIMO systems.      Massive MIMO and Its Detection  ◾  455  number of antennas at the base station can also be placed in different places  e.g.,  on tops of buildings  [Rusek et al. 2013]. In this case, synchronization is one issue,  and the low-cost RF frontend may introduce more issues.  10.2.2   Mutual Information for Massive MIMO Uplink Since SU-MIMO is a special case of MU-MIMO when T = 1, in this section, we  focus on the mutual information of MU-MIMO systems. Unless stated otherwise,  we  assume  that  CSI  is  known  at  the  receiver   CSIR ,  that  is,  the  terminals  for  downlink  transmissions,  and  the  base  station  for  uplink  transmissions,  and  we  impose power constraint at each terminal as  and at the base station as  E  {  s  u t   } 2  =  u  E  ∀ =  cid:30    t T ,  , 1  E  {  d  s  2 =  }  d  E  .      10.5    10.6   The signal-to-noise ratios  SNRs  for uplink and downlink are defined as Eu   N0 = ρ u and Ed N0 = ρ d, respectively.  To  quantify  the  benefit  of  massive  MIMO  in  information  theory,  we  adopt  achievable sum rate from [Rusek et al. 2013]. Achievable sum rate is defined as the  mutual information between the received signal and transmitted signals. For the  uplink MU-MIMO systems by assuming Gaussian-independent input su, the sum  rate is given as  C  =  I     ; u y s  u     =  log det  2  I  M  +     E  H  u HH QN 0     .      10.7   When M ≫ N, that is, uplink transmission with massive antennas at the base  station and relatively small total number of antennas of all terminals, the asymp- totic sum rate becomes  C   cid:14  = u M N  I     u ; y s  u     =  log det  2  +  u  ρ  H H H Q     N  I    M u D Q ρ u     td M Q     ,  ≈  =  I  2  log det    ∑∑ log  Q  T  t  = 1  q  = 1  ρ  +  N  + 1   2   10.8                      456  ◾  MIMO Processing for 4G and Beyond  where we employ channel orthogonalization in Equation 10.8, dt is the path loss  and  large-scale  fading  effect  from  the  tth  terminal  to  the  base  station,  and  we  assume that all antennas at the same terminal experience the same path loss and  large-scale fading effect dt, that is, D t−1 Q+q, t−1 Q+q = dt, ∀q = 1,. . .,Q.  From Equation 10.8, the gains of massive MIMO for uplink transmission are  twofold:  i  the effective SNR at the receiver  ρu dtM Q  is linearly boosted as M  increases and  ii  by rewriting Equation 10.8 as  Q  T  ∑∑  t  = 1  q  = 1  log  2  + 1   u  ρ  d M t Q    =    T  ∑  t  = 1    C  u t    M N   cid:14   ,      10.9   ,  we  could  observe  that  the  sum  rate  equals  the  rate  summation  of  each  terminal  M N cid:14   which is the rate of the terminal for SU-MIMO. Thus, with channel orthog-     Ct u onalization approximation, all terminals can simultaneously transmit the signals using  the same time frequency resource without interfering with each other, and as a result,  the sum rate of massive MIMO for uplink MU-MIMO can be significantly increased.  10.2.3  Precoding Designs for Massive MIMO Downlink For massive MIMO downlink transmissions, since each terminal cannot collectively  process  its  received  signal   because  the  system  is  underdetermined ,  MU-MIMO  downlink usually precodes the transmit signals so that each terminal can decode their  own signal separately  c.f. Chapter 3 . The optimal precoding is the so-called dirty  paper coding  DPC  [Caire and Shamai 2003, Vishwanath et al. 2003, Weingarten  et al. 2006], which requires high complexity. To alleviate the complexity, some practi- cal precoding schemes such as zero-forcing  ZF  precoding and matched filter  MF   precoding are found to be more efficient for massive MIMO systems.  The ZF precoding basically inverts the channel effects at the transmitter, where   the transmitted signal is obtained as  sd =  hT † dd,    10.10   where  superscript  T  denotes  the  matrix  transpose,   hT † = h* hT  h* −1  is  the  Moore–Penrose pseudo inverse of hT with superscript * being the complex conju- gate, and dd are the downlink data symbols. When M ≈ N, the performance gap of  ZF precoding to the optimal one is significant. However, as the number of antennas  at the base station grows, the performance of ZF precoding approaches the optimal  and is almost the same if M is sufficiently greater than N [Rusek et al. 2013].  One observation of the pseudo inverse in Equation 10.10 is that h* hT h* −1 ≈  h*  d−1  under  favorable  channel  propagation  condition,  and  therefore,  we  can  obtain an approximated ZF precoding, namely, MF precoding as  d  s  =  * H  − 1 dD  d     ,   10.11                Massive MIMO and Its Detection  ◾  457  which does not require the computation of the inversion of matrix hT h* and d−1  can be treated as a power normalization matrix. One drawback of MF precoding is  that when M is not large enough, the approximation by favorable channel propaga- tion condition may not be accurate, that is, hT h* cannot be approximated as a  diagonal matrix. As a consequence, the MF may experience error floor at high SNR  regime if symbolwise detector is adopted at the receiver side.  10.3  Detection of MIMO Systems with Large Arrays In this section, we introduce and compare the massive MIMO detection methods  for uplink transmissions with QAM constellations. To simplify the notation, we  drop the superscript of the received signal yu, transmitted signal su, and noise wu in  this section. Given the model in Equation 10.1, the MLD is   cid:31 s  =  arg min S N ∈   cid:30  s   cid:30  y Hs  −  2  ,      10.12   where  S  is  the  set  of  QAM  constellation.  In  general,  finding  the  solution  of  Equation  10.12  is  a  nondeterministic  polynomial  hard   NP-hard   problem   as  described in Chapter 2 , which suggests that no algorithm can guarantee to find  the optimal solution efficiently, especially when N and or the constellation size S  is large. Since S is a finite set, one could resort to the exhaustive search to solve  Equation 10.12, which suffers from exponential complexity with respect to prob- lem size N. SDAs have been proposed to reduce the searching complexity, but the  variance of the complexity is still high and the performance is degraded by fixing  the complexity for large MIMO systems [Jaldén and Ottersten 2005, Rusek et al.  2013].  10.3.1   Linear Detectors As seen in Chapter 2, linear detectors  LDs  are adopted in practical systems for  their polynomial complexity. When M ≥ N, the zero-forcing linear detector  ZF- LD  for the model in Equation 10.1 is given as   cid:22 sZF =    Q  H x †     =      Q  H  H H H y  −   H1   ,      10.13   where h† =  hH h −1 hH is the Moore–Penrose pseudo inverse of channel matrix  h and Q ⋅  is the symbolwise quantizer to the constellation set S. ZF-LD is the  most straightforward detector. However, it has inferior performance and does not  exist when M < N.            458  ◾  MIMO Processing for 4G and Beyond        The  other  widely  used  LD  is  minimum-mean-square-error  linear  detector    MMSE-LD , which aims at minimizing E{  cid:13   x Hs  −   cid:13   2  as }   cid:22 s  MMSE =  Q  H  H H  +        QN E u  0  I  N  − 1     H  H y  ,         10.14   where  E  {  ss  H  }  =  u  E Q     I  N  .  By  exploiting  some  prior  information  of  symbols,  the  MMSE-LD  generally  offers better error performance than ZF-LD. In addition, the MMSE-LD can have  the same formula as in an extended model as  H  =       H QN E u  0  I  N       ,  y  =  y  0  N  × 1      .          10.15   Regarding  the  performance  and  complexity  of  LDs  for  MIMO  systems,  although  LDs   ZF-LD  and  MMSE-LD   have  lower  complexity  than  the  MLD  and SDAs, their error performance degrades for MIMO systems by only collecting  diversity order M − N + 1 [Winters et al. 1994, Gore et al. 2002, Ma and Zhang  2008b]. However, in the case of massive MIMO systems with M ≫ N, we could  expect LDs to exhibit close error performance  similar diversity order  to MLD,  since M − N + 1 is approaching M and the diversity order M − N + 1 looks the  same as M in the error performance plot.  10.3.2   Successive Interference Cancelation   and K-Best Detectors  Another class of polynomial-complexity detectors is hard-output decision feedback  detectors, including successive interference cancelation  SIC  and K-best detectors.  Since SIC can be treated as a special case of K-best, this section will mainly focus  on K-best detectors.  A K-best detector first performs QR decomposition on the channel matrix as  h = qr, where q is an M × N orthonormal matrix and r is an N × N upper tri- angular matrix. Then, the problem in Equation 10.12 is reformulated as   cid:31 s =  argmin S N ∈   cid:30  s   cid:29   cid:30  y Rs  −  2  ,      10.16     where   cid:15 y Q y H .  =  Thanks to the upper triangular structure of r, the K-best detector performs a  layered search from the Nth layer to the first layer to find suboptimal solutions to       Massive MIMO and Its Detection  ◾  459  Equation 10.16. To better illustrate layered search, we introduce some common  terms used in the K-best detector:  n   ◾ Partial candidate of the nth layer, si   , which is defined as  n       si  =       n s , i n  … ,  ,      n s , i N  T    ,  ∀  n s ,      n , i n  ∈  S     n   ◾ Cost associated with the partial candidate si  n   , costi   , which is  n       costi  =   cid:31  y R  −  0        − ×   1 N n     n s i  2   =   NN∑   cid:30   =  n   cid:31  y  cid:30   −  N  ∑  =   cid:30   k  2  R s  cid:30  k  ,      n , i k  .            10.17    10.18   n   ◾ Child  of  a  partial  candidate  si   ,−1   which  is  a  partial  candidate  of  the  n   ,  s j −  n − 1 th layer and has the form s =     1 n j    n T T   ] ,  −   1 n , j n  −   1 n , j n  S.  ∈  ,     s i  [  s  s                       ,  ,  ,  ,  + 1  + 1  ],    n s 2    n s 2    n s 1    n… , s K  +…   1 n , s K  The complexity of the K-best detector is O  Then, the K-best detector performs a breadth-first search from the Nth layer  to the first layer. For each layer  e.g., the nth layer , the algorithm computes the  K-best partial candidates [  that is, the K partial candidates with  the minimum costs among all the possible children of the  K partial candidates   in the previous  n + 1 th layer. The search procedure termi-     n ] [ s 1 nates once the first layer is reached, and the candidate with minimum cost in the  first layer is denoted as the hard output of the K-best detector. N K NK   and it is fixed  when  the  number  of  candidates  K  and  the  constellation  size  S  are  constant,  which is in favor of hardware complexity [Guo and Nilsson 2006]. In addition,  when K = 1, the K-best detector reduces to the SIC detector. The performance of  general K-best detector is hard to quantify. When K = 1, the SIC detector collects  the same diversity as LDs  Ma and Zhang 2008a,b . One major issue of hard- output decision-feedback detectors is that the erroneous detected symbol could  propagate to the successive layers and thus degrade the search performance. To  combat this error propagation issue, one method is to apply sorted QR decom- position so that the detection starts from the stronger layers. Another way is to  perform soft interference cancelation, which will be introduced in the following  section.   S   ,  +     2  10.3.3  Iterative Soft Interference Cancelation To enhance the error performance, the iterative soft interference cancelation  ISIC   [Wang and Poor 1999, Liang et al. 2008] detectors incorporate soft information  from the previous iteration to mitigate the interference.      460  ◾  MIMO Processing for 4G and Beyond  Given  the  soft  estimates  of  su    in  the  previous   ℓ − 1 th  iteration, the ISIC detector reformulates the system model in Equation 10.1 to  detect symbol sk as   cid:31  …  cid:31  s , s , 1 N  ] T  =  − 1  − 1  [  ,   cid:31    cid:31   ,  y  k  ,   cid:31   =  y  −  ,   cid:31   − 1  ∑ ≠ i k +  i   cid:30  s h i ∑  ≠ i k  =  h  s k k  h  i     s i  −   cid:30  s i  ,   cid:31   − 1     +  w  .   10.19               Then, the ISIC detector obtains an M × 1 optimal MMSE filter vector  wk,ℓ   and the information   that minimizes the MSE between the filter output  w yk H  cid:12  , symbol sk as  k   cid:12   ,  w  k   cid:12  ,  =  h h k  H k  +  d  h h i  H i  k   cid:12  ,  h  k  ,   10.20      ∑  ≠ i k  − 1     where dk,ℓ is the variance of the difference s 1 normalized by the variance of  − sk  see [Wang and Poor 1999 and Liang et al. 2008] for details . The performance  gain comes from the soft information, but there still exists a performance gap with  the optimal detector, especially for high-order modulations.  k  k−  cid:31   cid:30 , s  10.3.4   Lattice-Reduction-Aided Linear Detectors The performance gap between the MLD and LDs is mainly due to the nonorthogo- nality of the channel matrix h when M ≈ N  Ma and Zhang 2008a,b . As seen in  Chapter 2, the motivation of lattice-reduction-aided  LRA  LDs is based on the  fact that if channel matrix h is “close” to orthogonal, the decision region of LDs  is also “close” to that of the MLD [Ma and Zhang 2008a,b, Ling 2011]. Hence, to  improve the error performance of LDs, LR finds another “more orthogonal” basis   cid:31 H statistically that defines the same lattice as h. As a result, LRA LDs yield error  performance close to the MLD and have the same error performance as the MLD  if the lattice-reduced basis is orthogonal. That is, the so-called reducing basis h  is equivalent to finding a “more orthogonal” basis   cid:31 H HT=  [Agrell et al. 2002],  where T is a unimodular matrix, such that all entries of T and T−1 are Gaussian  integers, and the determinant of T is ±1 or ±j  c.f. Chapter 2 . Thus, the key of LRA  detectors is to find the unimodular matrix T with low complexity while enabling  better performance.  To  find  the  unimodular  matrix  T,  there  are  several  existing  LR  algorithms,  including  Minkowski  reduction,  Korkin–Zolotarev   KZ   reduction  [Agrell  et  al.  2002],  the  LLL  algorithm  and  its  complex  valued  counterparts  [Lenstra  et  al.  1982,  Ma  and  Zhang  2008b,  and  Gan  and  Mow  2009],  the  Seysen’s  algorithm       Massive MIMO and Its Detection  ◾  461   SA  [Seysen 1993, Zhang et al. 2010], and element-based lattice-reduction  ELR   algorithms [Zhou and Ma 2013a,b]. Among these algorithms, the LLL algorithms  are well adopted because they allow worst-case polynomial complexity and yield a  basis with certain orthogonality guaranteed, that is, the orthogonality deficiency is  bounded. However, as shown in [Zhou and Ma 2013a], the LLL algorithms do not  aim at minimizing the asymptotic error performance of LRA LDs and thus may  exhibit unsatisfactory performance when N is large. To achieve better performance,  ELR algorithms are proposed to minimize the asymptotic error performance and  show considerable performance gain over LLL algorithms when N is large. In the  following text, we provide the general framework for LRA detectors and the details  of the LR algorithms can be referred to in the aforementioned papers.  The application of LRA to massive MIMO does not differ from the concept  presented in Chapter 2: given the unimodular matrix T based on h, the model in  Equation 10.1 can be rewritten as              y HTT s w +  2 HTz  − 1 +  + 1   = =  j    H1 N  × 1  +  w  .     The equivalent model becomes   cid:31  y Hz w  =  +   cid:31   ,    2  +  =   cid:31  Tz  ,   cid:31  s  HT  = 2  11N   1 ×  where   cid:31 H −1   contains  the  information   ,  z T s − symbols in the lattice-reduced domain, and   cid:31 y  Since T is  unimodular and the entries of s are drawn from QAM constellations, the entries  of z are Gaussian integers in  cid:27 [ ].j  Note that matrix T is obtained at the receiver  and does not perform as a precoder.    H1 N    21   ×  = =    1  +  +  y     j  j  .  Given the model in Equation 10.21, the LRA ZF-LD is given as   cid:31 z =     Q   cid:30   cid:30  H H H y   cid:30  −   H1   cid:30   H     =    Q   cid:30   cid:30  H y †   .     Then, the estimate of s is obtained by   cid:22  s  =  Q   2  T   cid:22  z  +    1  +    1j N   .  × 1     Similar to the LRA ZF-LD, LRA MMSE-LD can be derived by applying  LR algorithms on the MMSE-extended model in Equation 10.15 to offer bet- ter performance than LRA ZF-LD. LR can also be applied to SIC, which fur- ther boosts the performance. For certain LR techniques  e.g., LLL , it has been  proved  that  LRA  detectors  collect  the  same  diversity  as  MLD  does  [Ma  and  Zhang 2008a].   10.21    10.22    10.23    10.24       462  ◾  MIMO Processing for 4G and Beyond  10.3.5  Lattice-Reduction-Aided K-Best Algorithms As the number of antennas grows, LR algorithms should also be combined with  K-best detectors to boost the performance. Since the LRA detection assumes infi- nite  lattice,  LRA  K-best  detector  relaxes  the  boundary  constraints  in  Equation  10.12 to infinite lattice as           s cid:31  =  argmin U N ∈   cid:30  s   cid:30  y Hs  −  2  ,      10.25         where U is the unconstrained constellation set with the form    j   . 1 By applying an LR algorithm to obtain a more “orthogonal” matrix   cid:31 H HT= ,    cid:27  2    1   cid:27   2     +  +  +  Equation 10.25 can be rewritten as  s cid:31  =  2  T  arg min ∈  cid:30   cid:29  z  N   cid:30   cid:30   cid:30  y Hz  −  2  +  1    +    j N 1  . × 1   10.26   Similar to the K-best detector described in Section 10.3.2, by performing QR  , where   cid:31 Q  is an M × N orthonormal matrix and   cid:31 R is  decomposition on   cid:31  an N × N upper triangular matrix, the problem in Equation 10.26 can be reformu- lated as   cid:31   cid:31  H QR=  s cid:31  =  2  T  arg min ∈  cid:30   cid:29  z  N   cid:28   cid:30   cid:30   cid:30  y Rz  −  2  +  1    +    j N 1  ,  × 1   10.27    cid:31   =   cid:30   cid:31  where   cid:31  H . Therefore, LRA K-best detector performs a breadth-first search  y Q y from the Nth layer to the first layer, and for each layer, only K-best candidates sur- vive and are served as the parents of the next layer.  Compared to the conventional K-best detector, the main difference of the LRA  K-best is that the information symbol in the LR domain z is unbounded while  s is constrained in a finite QAM constellation set. This results in a challenging  problem to the LRA K-best algorithm, that is, how to efficiently find K-best candi- dates among all infinite children of K parents for each layer. This problem can be  addressed by using the Schnorr–Euchner  SE  strategy [Shabany and Gulak 2008]  and priority queue [Zhou and Ma 2012, Wen et al. 2013] such that the overall com- plexity of LRA K-best detector  not including the LR algorithm  is on the order of   This method has great potential on hardware realization  O  with controllable performance and complexity trade-offs.  N K NK  log   2    .  K  +  2  10.3.6   Local Neighborhood Search Methods Local neighborhood search methods [Datta et al. 2010, Srinidhi et al. 2011] start  with an initial symbol vector, and iteratively improve the current symbol vector by  moving to the best symbol vector in the neighborhood of the current vector. The       Massive MIMO and Its Detection  ◾  463  best symbol vector means the symbol vector with the minimum cost in the neigh- borhood N      cid:31 sk  of current symbol vector  cid:31 sk      cid:31  s  k  + = 1  arg min    ∈  N   cid:30  s   cid:31  s k      cid:30  y Hs  −  2  .      10.28   i  =  ≠   cid:29  s  cid:31   ,  cid:31  i s i   cid:31   cid:30  s ,  cid:31   To allow simple enumeration of all neighbors with low complexity, a vector  cid:15 s   is defined as a neighbor of the symbol vector  cid:31 s if the vector  cid:15 s  has only one sym-  cid:30   and  bol that is different from the corresponding symbol of   cid:31 s, that is,  ∃ s i  while the different one  cid:15 si is the neighbor of   cid:31 si in the constellation  ∀ ≠ set S  see [Datta et al. 2010, Srinidhi et al. 2011] for details . After the search is  terminated, the symbol vector with the minimum cost among the vectors visited  during the search becomes the estimate of s.  One issue of local neighborhood search methods is that the search process can  be easily trapped in a local minimum. To address this issue, tabu search [Datta et al.  2010] is proposed to allow a worse move  i.e., the best symbol vector in the neigh- borhood has higher cost than the current one  to jump out of the local minima.  However, to prevent cycle search paths, tabu search maintains a tabu table of past  moves  and  prohibits  some  duplicated  visits  by  looking  up  the  table.  To  further  improve the performance of tabu search methods, layered tabu search algorithm is  proposed in [Srinidhi et al. 2011].  One drawback of local neighborhood search methods is that their complexity  has a large variance with respect to channel, noise, and or symbol realizations, and  thus may pose great challenges in hardware implementation.  10.3.7  Performance and Complexity Comparisons In this section, we show the performance and complexity of various detectors for  massive MIMO via Monte-Carlo simulations. We consider an uplink MU-MIMO  transmission with one base station equipped with M = 32 antennas and serving  T = M  terminals  such  that  Q = 1  and  N = M.  The  entries  of  channel  matrix  h  are modeled as independent and identically distributed  i.i.d.  complex Gaussian  variables with zero mean and unit variance. We consider the following detectors for  comparisons:  i  MMMSE-LD;  ii  dual ELR-shortest-longest-basis-aided MMSE  sorted-variance SIC  D-ELR-SLB-aided MMSE SV-SIC  detector;  iii  LTS detec- tor;  iv  MMSE-ISIC detector with five iterations;  v  K-best detector with sorted  QR decomposition  SQRD  preprocessing [Wübben et al. 2003]; and  vi  LLL- aided MMSE K-best detector. The performance of interference-free  IF , that is,  K = 1, is also considered as a benchmark.  Figures 10.4 and 10.5 demonstrate the error performance of various detectors  with  different  SNR ρus.  From  the  figures,  we  have  the  following  observations:   i  MMSE-LD shows inferior performance compared to the rest of the detectors  and  IF  case,  and  its  diversity  order  is  just  1.   ii   D-ELR-aided  MMSE-SV-SIC       464  ◾  MIMO Processing for 4G and Beyond  MMSE-LD D-ELR-SLB-aided MMSE-SV-SIC LTS MMSE-ISIC K-best with K = 25 and SQRD LLL-aided MMSE K-best with K = 25 Interference-free  100  10–1  10–2  R E B  10–3  10–4  10–5  2  R E B  100  10–1  10–2  10–3  10–4  10–5  5  4  6  8  12  14  16  18  20  10 ρu  dB   Figure 10.4  Performance comparisons of various detectors for MIMO systems  M = N = T = 32, Q = 1, 16-QAM, and different ρus.  MMSE-LD D-ELR-SLB-aided MMSE-SV-SIC LTS MMSE-ISIC K-best with K = 25 and SQRD LLL-aided MMSE K-best with K = 25 Interference-free  10  15  ρu  dB   20  25  Figure 10.5  Performance comparisons of various detectors for MIMO systems  M = N = I = 32, Q = 1, 64-QAM, and different ρus.      Massive MIMO and Its Detection  ◾  465  improves  the  performance  of  MMSE-LD,  especially  for  high  SNR  and  outper- forms MMSE-ISIC and LTS when ρu is large  e.g., ρu > 19 dB for 64-QAM .  iii   LTS and MMSE-ISIC exhibit almost the same performance for 16-QAM, while  for 64-QAM, LTS shows superior performance to MMSE-ISIC. However, both  of  them  lose  some  diversity  orders  as  SNR  increases.   iv   K-best  detector  with  K = 25  and  SQRD  preprocessing  generally  yields  better  performance  than  LTS  and MMSE-ISIC for medium-to-high SNR, and its gain over LTS at BER = 10−4 is  about 4 dB for 16-QAM. However, it still cannot achieve the same diversity order  as MLD at high SNR, as demonstrated by the case with 64-QAM.  v  By exploit- ing the LR algorithm, the LLL-aided MMSE K-best detector with K = 25 achieves  the best performance among all detectors for medium-to-high SNR  e.g., ρu ≥ 11  for 64-QAM . The performance gains of the LLL-aided MMSE K-best detector  over K-best at BER = 10−4 are about 2 dB and 4 dB for 16-QAM and 64-QAM,  respectively. In addition, the gaps of the LLL-aided MMSE K-best to IF case are  about 2 dB and 4 dB at BER = 10−5, respectively.  Figure 10.6 illustrates the number of arithmetic operations of various detectors.  Several remarks about the complexity of the detectors can be drawn:  i  Although  the  instantaneous  complexity  of  the  D-ELR-SLB  and  LLL  algorithms  depends  on the channel realizations, the worst-case complexity  99.9% upper percentile   of the D-ELR-SLB-aided MMSE-SV-SIC and LLL-aided MMSE K-best detectors  is the closest to their average complexity, respectively.  ii  The complexity of the   LTS, average LTS, 99.9% upper percentile D-ELR-SLB-aided MMSE-SV-SIC, average D-ELR-SLB-aided MMSE-SV-SIC, 99.9% upper percentile MMSE-ISIC MMSE-LD LRA MMSE K-best, K = 25, average LRA MMSE K-best, K = 25, 99.9% upper percentile  1011  1010  109  108  107  106  s n o i t a r e p o   c i t e m h t i r a   f o   r e b m u N  105  5  10  15  ρ u  dB   20  25  Figure 10.6  Number of arithmetic operations of various MIMO detectors with  M = N = T = 32, Q = 1, 64-QAM, and different ρus for MU-MIMO systems.      466  ◾  MIMO Processing for 4G and Beyond  D-ELR-SLB-aided  MMSE-SV-SIC  detector  is  only  slightly  higher  than  that  of  the low-complexity MMSE-LD. The reason for similar levels of complexity of the  D-ELR-SLB-aided MMSE-SV-SIC detector is that, while the complexity of the  D-ELR-SLB detector constitutes only a small portion of the overall detection com- plexity, the main computational complexity consists of the preprocessing opera- tions  i.e., matrix inversion of the Gram matrix and QR decomposition , which  requires the same polynomial order complexity of the MMSE-LD.  iii  The number  of arithmetic operations of LLL-aided MMSE K-best detector is about twice higher  than  that  of  the  D-ELR-SLB-aided  MMSE-SV-SIC  detector.  The  price  for  the  extra complexity mainly comes from the K-best algorithm. For illustration pur- pose, we do not plot the complexity of the K-best algorithm without LR, which is  almost the same as that of LLL-aided MMSE K-best detector.  iv  The MMSE-ISIC  detector requires higher complexity than the LLL-aided MMSE K-best detector.  LTS requires highest average complexity when ρu is small  ρu ≤ 15 , but its aver- age complexity decreases as ρu increases. However, when ρu is large, the worst-case  complexity of LTS, which makes a critical contribution to the error performance of  the LTS [Zhou and Ma 2013a], becomes much higher than the average one because  of the neighborhood search nature of the algorithm.  Figure  10.7  illustrates  the  performance  of  various  detectors  for  MIMO  sys- tems with M = 48, N = 32, Q = 1, and 64-QAM. Compared to the results with  M = N = 32 in Figure 10.5, all detectors obtain considerable performance gain by  equipping additional antennas at the base station. For example, the MMSE-LD   MMSE-LD D-ELR-SLB-aided MMSE-SV-SIC LTS MMSE-ISIC K-best with K = 25 and SQRD LLL-aided MMSE K-best with K Interference-free  R E B  100  10–1  10–2  10–3  10–4  10–5  5  10  15  20  25  Figure  10.7  Performance  comparisons  of  various  detectors  for  MIMO  systems  with M = 48, N = 32, Q = 1, 64-QAM, and different ρus.      Massive MIMO and Its Detection  ◾  467  exhibits about 4 dB loss compared to IF case at BER = 10−2  in contrast, the loss is  20 dB for M = N = 32 . The D-ELR-SLB-aided MMSE-SV-SIC detector has about  2.5 dB gain over the MMSE-LD at BER = 10−5. The LTS, MMSE-ISIC, K-best,  and LLL-aided MMSE K-best detectors have almost the same performance and  reach the performance of IF at BER = 10−5. In addition, K = 5 candidates are suf- ficient for both K-best and LLL-aided to have near-optimal performance.  10.3.8  Detection for Other Channels In the previous sections, we focussed on detector designs for uncoded systems with  i.i.d. channels. However, for massive MIMO systems, the antennas may not be  spaced  enough  and  thus  the  channels  may  be  correlated.  At  the  same  time,  in  practical systems, error control codes have to be considered. As one may observe  from the previous sections, the LRA detectors have great potential on hardware  realization for massive MIMO. In the literature, LRA detectors have been extended  to other channel conditions. In [Zhang and Ma 2010], LRA detectors with soft  output are proposed, which show low complexity and high performance for coded  systems. In [Gestner et al. 2012], correlated channels are considered and again LRA  detectors show great performance. In [Zhang and Ma 2009] and [Zhou and Ma  2013c], LRA precoders are developed when the CSI is available at the transmitter.  Although these results have shown that LRA detectors are strong candidates for  MIMO systems, there are still many open issues for massive MIMO. For example,  when the channels are correlated, how are the performance and complexity of the  detectors going to change?  10.4    Hardware Implementation of Massive   MIMO Detectors  To  realize  the  detectors  in  hardware,  one  faces  several  fundamental  challenges  [Zhang  et  al.  2009].  One  of  these  challenges  is  that  hardware  realizations  nec- essarily have only finite numerical resolution. Furthermore, in practical systems,   floating-point representations are abandoned for the improved efficiency afforded  by  fixed-point  operations.  Fixed-point  signal-processing  solutions  have  generally  been chosen due to advantages in speed, power consumption, cost, and suitabil- ity  for  portable  applications.  However,  so  far,  the  existing  theoretical  analysis  of detectors is derived within the real or complex field. There are only a limited  number of tractable equalizer algorithms that have been adequately characterized,  implemented, and measured as to the performance for fixed-point applications  see  [Zhang and Ma 2008, Gestner et al. 2011] .  In the literature, people have prototyped different types of detectors. However,  the major discrepancy here is that those who developed the algorithms do not have  enough  knowledge  of  hardware  on  VLSI-integrated  circuits,  and  those  who  try       468  ◾  MIMO Processing for 4G and Beyond  to prototype the detection algorithms do not know much about the math behind  it. The applicable and practical detectors should be implemented with low com- plexity in hardware while keeping the performance as high as possible. Note that  blindly reducing the complexity of an algorithm without considering the effects on  numerical precision, parallelism, and memory requirements can result in a poor  hardware  realization  and  similarly,  blind  application  of  hardware  optimizations  can result in an unexpected increase in algorithm complexity and a reduction in  system performance. By carefully considering both perspectives, one will realize  reduced-complexity LR algorithms that take into consideration the finite hardware  resources and processing constraints of real-time communication systems.  10.5  Other Issues of Massive MIMO Systems Massive MIMO has shown great potential benefit for future wireless communica- tions. It also reveals “massive” challenges that deserve further research.  10.5.1   Channel State Information The benefit of massive MIMO highly relies on the perfect CSI at the receiver and or  transmitter. Channel models have to capture the new behavior phenomenon of the  radio channel so that the performance assessment can be more realistic. For exam- ple, due to the large number of antennas, the channels may be correlated. How to  quantify the correlation deserves more efforts on measurements and analysis. At  the same time, owing to the large number of antennas and possible time variation  and frequency selectivity of the channels, channel estimation  either training based  or semiblind  becomes challenging—large number of parameters in three dimen- sions. Furthermore, how the channel estimation error affects the detection and also  the precoder design is an interesting topic for research.  10.5.2  Synchronization Massive MIMO requires hundreds of RF chains, ADC DAC, and power amplifiers  connecting to the antennas. Synchronization is critical in this case to guarantee the  performance of massive MIMO systems. For example, if the antennas are distrib- uted at different places, the timing offsets due to propagation delays and processing  delays of RF chains will degrade the performance of the detectors since the aggre- gated streams are not aligned. Together with the phase noise, frequency offsets, and  DC offset, the performance is severely affected by the synchronization errors.  10.5.3   Hardware Issues In practice, RF chains introduce DC offset, phase noise, I Q imbalance, power  amplifier   PA   nonlinearity,  and  other  nonideal  issues.  Since  massive  MIMO       Massive MIMO and Its Detection  ◾  469  systems require large numbers of components, to enable economic designs, usually  low-cost devices are adopted. In this case, the PA nonlinearity may redirect the  beams and introduce the interference to other cells. The nonideal characteristics of  the hardware will also reduce the efficiency of massive MIMO. To support the high  data rate transmissions, the connection from the RF frontend to baseband  e.g., in  the common public radio interface  is also important. Massive MIMO makes it  more challenging and has higher demand on the RF designs.  References Agrell, E., T. Eriksson, A. Vardy, and K. Zeger, Closest point search in lattices, IEEE Trans.   Inf. Theory, 48 8 , 2201–2214, August 2002.  Caire, G. and S. Shamai, On the achievable throughput of a multiantenna Gaussian broad-  cast channel, IEEE Trans. Inf. Theory, 49 7 , 1691–1706, July 2003.  Datta, T.,  N.  Srinidhi,  A.  Chockalingam,  and  B.S.  Rajan,  Random-restart  reactive  tabu  search algorithm for detection in large-MIMO systems, IEEE Commun. Lett., 14 12 ,  1107–1109, December 2010.  Gan, Y.H., C. Ling, and W.H. Mow, Complex lattice reduction algorithm for low-complex- ity full-diversity MIMO detection, IEEE Trans. Signal Process., 57 7 , 2701–2710, July  2009.  Gao, X., O. Edfors, F. Rusek, and F. Tufvesson, Linear pre-coding performance in measured  very-large MIMO channels, in Proc. IEEE Veh. Tech. Conf.  VTC Fall , San Francisco,  September 5–8, 2011, pp. 1–5.  Gao, X., F. Tufvesson, O. Edfors, and F. Rusek, Measured propagation characteristics for  very-large MIMO at 2.6 GHz, in Proc. IEEE 46th Annual Asiomar Conf. Signals Systems  Computers  ASILOMAR , California, November 4–7, 2012, pp. 295–299.  Gestner,  B.,  X.  Ma,  and  D.V.  Anderson,  Incremental  lattice  reduction:  Motivation,  the- ory, and practical implementation, IEEE Trans. Wireless Commun., 11 1 , 188–198,  January 2012.  Gestner, B., W. Zhang, X. Ma, and D. V. Anderson, Lattice reduction for MIMO detection:  From theoretical analysis to hardware realization, IEEE Trans. Circuits Systems I Regular  Papers, 58 4 , 813–826, April 2011.  Gore, D.A., R. Heath Jr, and A.J. Paulraj, On performance of the zero forcing receiver in  presence  of  transmit  correlation,  in  Proc.  IEEE  Int.  Symp.  Info.  Theory,  Lausanne,  Switzerland, June 30–July 5, 2002, p. 159.  Guo, Z. and P. Nilsson, Algorithm and implementation of the K-best sphere decoding for   MIMO detection, IEEE J. Sel. Areas Commun., 24 3 , 491–503, March 2006.  Jaldén, J. and B. Ottersten, On the complexity of sphere decoding in digital communica-  tions, IEEE Trans. Signal Process., 53 4 , 1474–1484, April 2005.  Lenstra, A.K., H.W. Lenstra, and L. Lovász, Factoring polynomials with rational coefficients,   Math. Annalen, 261 4 , 515–534, 1982.  Liang, Y.-C., E.Y. Cheu, L. Bai, and G. Pan, On the relationship between MMSE-SIC and  bi-GDFE  receivers  for  large  multiple-input  multiple-output  channels,  IEEE Trans.  Signal Process., 56 8 , 3627–3637, August 2008.  Ling, C. On the proximity factors of lattice reduction-aided decoding, IEEE Trans. Signal   Process., 59 6 , 2795–2808, June 2011.      470  ◾  MIMO Processing for 4G and Beyond  Ma, X. and W. Zhang, Fundamental limits of linear equalizers: Diversity, capacity and com-  plexity, IEEE Trans. Inf. Theory, 54 8 , 3442–3456, August 2008a.  Ma, X. and W. Zhang, Performance analysis for MIMO systems with lattice-reduction aided   linear equalization, IEEE Trans. Commun., 56 2 , 309–318, February 2008b.  Rusek, F., D. Persson, B. Lau, E. Larsson, T. Marzetta, O. Edfors, and F. Tufvesson, Scaling  up MIMO: Opportunities and challenges with very large arrays, IEEE Signal Process.  Mag., 30 1 , 40–60, January 2013.  Seysen, M. Simultaneous reduction of a lattice basis and its reciprocal basis, Combinatorica,   13 3 , 363–376, September 1993.  Shabany, M. and P. Glenn Gulak, The application of lattice-reduction to the K-best algo- rithm for near-optimal MIMO detection, in Proc. IEEE Int. Symp. Circuits Systems   ISCAS , Washington, USA, May 18–21, 2008, pp. 316–319.  Srinidhi, N., T. Datta, A. Chockalingam, and B.S. Rajan, Layered tabu search algorithm  for  large-MIMO  detection  and  a  lower  bound  on  ML  performance,  IEEE  Trans.  Commun., 59 11 , 2955–2963, July 2011  Vishwanath, S., N. Jindal, and A. Goldsmith, Duality, achievable rates, and sum-rate capac- ity of Gaussian MIMO broadcast channels, IEEE Trans. Inf. Theory, 49 10 , 2658– 2668, October 2003.  Wang, X. and H.V. Poor, Iterative  turbo  soft interference cancellation and decoding for   coded CDMA, IEEE Trans. Commun., 47 7 , 1046–1061, July 1999.  Wen, Q., Q. Zhou, C. Zhao, and X. Ma, Fixed-point realization of lattice-reduction aided  MIMO receivers with complex K-best algorithm, in Proc. Int. Conf. Acoustic Speech  Signal Proc.  ICASSP , Vancouver, Canada, May 26–29, 2013.  Weingarten, H., Y. Steinberg, and S. Shamai, The capacity region of the Gaussian multiple- input multiple-output broadcast channel, IEEE Trans. Inf. Theory, 52 9 , 3936–3964,  September 2006.  Winters, J.H., J. Salz, and R.D. Gitlin, The impact of antenna diversity on the capacity  of  wireless  communication  systems,  IEEE  Trans.  Commun.,  42 234 ,  1740–1751,  February March April 1994.  Wübben, D., R. Böhnke, V. Kühn, and K.D. Kammeyer, MMSE extension of V-BLAST  based on sorted QR decomposition, in Proc. Veh. Tech. Conf.  VTC , Orlando, FL,  October 6–9, 2003, pp. 508–512.  Zhang, W. and X. Ma, Quantifying diversity for wireless systems with finite-bit representa- tion, in Proc. IEEE Int. Conf. Acoustics Speech Signal Process., Las Vegas, NV, March  30–April 4, 2008, pp. 2841–2844.  Zhang, W. and X. Ma, A novel lattice reduction aided linear precoding scheme, in Proc. 43rd  Conf. Information Sci. Syst., Johns Hopkins University, Baltimore, MD, March 18–20,  2009, pp. 518–523.  Zhang, W. and X. Ma, Low-complexity soft-output decoding with lattice-reduction-aided   detectors, IEEE Trans. Commun., 58 9 , 2621–2629, September 2010.  Zhang, W., X. Ma, B. Gestner, and D.V. Anderson, Designing low-complexity equalizers for   wireless systems, IEEE Commun. Mag., 47 1 , 56–64, January 2009.  Zhang, W., X. Ma, and A. Swami, Designing low-complexity detectors based on Seysen’s   algorithm, IEEE Trans. Wireless Commun., 9 10 , 3301–3311, October 2010.  Zhou, Q. and X. Ma, An improved LR-aided K-best algorithm for MIMO detection, in  Proc. IEEE Int. Conf. Wireless Commun. Signal Process.  WCSP , Huangshan, China,  September 2012, pp. 1–5.      Massive MIMO and Its Detection  ◾  471  Zhou, Q. and X. Ma, Element-based lattice reduction algorithms for large MIMO detection,   IEEE J. Sel. Areas Commun., 31 2 , 274–286, February 2013a.  Zhou, Q. and X. Ma, Improved element-based lattice reduction algorithms for wireless com-  munications, IEEE Trans. Wireless Commun., 2013, 12 6 , 2806–2816, June 2013b.  Zhou, Q. and X. Ma, Joint transceiver designs using lattice reduction algorithms, in Proc.  China Summit Int. Conf. Signal Info. Process.  ChinaSIP , Beijing, China, July 6–10,  2013c.       Chapter 11 MIMO Two-Way Relay  Channel with  Superposition Coding  Ioannis Krikidis and John S. Thompson  Contents 11.1  Two-Way Relay Channels.........................................................................473 11.2  Communication Model ............................................................................475 11.3  SPC and Power Split ................................................................................478 11.3.1 Conventional SPC without CSI at the Users .................................478 11.3.2 SPC with CSI at the Users ............................................................479 11.3.3 Fairness and SC Power Split......................................................... 480 11.3.4 Optimization ................................................................................481 11.4  Numerical Results ....................................................................................482 11.5  Chapter Summary ....................................................................................488 References .........................................................................................................488  11.1  Two-Way Relay Channels The two-way relay channel is an important information theoretic network structure  [Shannon 1961], and it is becoming a central concept in the design of the physical  layer of future communication systems. It consists of two users who are unable  to communicate directly, hence they establish communication via a shared relay  node. This scenario characterizes networks with central controllers as well as ad   473   474  ◾  MIMO Processing for 4G and Beyond  hoc networks with limited relaying resources. In two-way relay channels, the two  terminals exchange messages with each other via the relay, and the objective of a  two-way  relay  protocol  design  is  to  maximize  the  spectral  efficiency  of  the  two  communication links that are formed between the two links.  Recently, there is a lot of interest in the design of efficient cooperative protocols  for two-way relay channels. The proposed schemes can be divided into two main  categories based on the number of the required time phases:  a  in the two-phase  protocol,  called  multiple  access  broadcast   MABC   protocol  [Kim  et  al.  2008],  both users simultaneously transmit their data to the relay during the first phase  and then the relay transmits during the second phase, while  b  in the three-phase  protocol the two users sequentially transmit to the relay followed by a transmis- sion from the relay [Saleh et al. 2009]. Furthermore, each protocol category can be  combined with any relaying strategy resulting in numerous two-way protocols with  different complexities and performance. In [Kim et al. 2011], the authors highlight  the most significant two-way relaying protocols and characterize their achievable  rate region from an information theoretic point of view. An interesting MABC  two-way scheme that employs superposition coding  SPC  at the relay node has  been proposed in [Hammerstrom et al. 2007], where the authors analyze its capac- ity  performance  for  a  general  multiple-input  multiple-output   MIMO   two-way  relay channel with different channel side information  CSI  requirements. The use  of SPC as a broad cast approach for two-way relay configurations has been reported  in several studies for different contexts [e.g., Chen and Yener 2010; Chen et al.  2010; Oechtering and Boche 2008]; in addition a combination of SPC with net- work coding appropriate for asymmetric two-way relay topologies is discussed in  [Park and Oh 2009].  Although there is a lot of work on the design of efficient two-way relay proto- cols, the majority of them assume perfect channel estimation, which is not always  a realistic assumption. The impact of imperfect channel estimation on the achiev- able system performance is a classical problem in the literature. In [Medard 2000],  the  authors  characterized  the  Shannon  capacity  of  a  conventional  single-input   single-output  SISO  network under imperfect channel estimation. A related power  allocation strategy that maximizes the achieved capacity of SISO with imperfect  channel estimation has been proposed in [Klein and Gallager 2001]. The impact  of an imperfect channel estimation on the capacity performance of a MIMO net- work as well as a related waterfilling power allocation  WF-PA  strategy have been  proposed in [Yoo and Goldsmith 2006]. However, the effects of channel estima- tion error on the reception reliability of a decode-and-forward two-way relay chan- nel with physical layer network coding have been reported in [Ding and Leung  2011] in terms of error probability. In addition, different channel-estimation tech- niques for a two-way relay channel are discussed in [Jiang et al. 2010 and references  therein], while the achieved sum rate for a two-way relay channel with AF and  imperfect channel estimation is investigated in [Panah and Heath 2010] and [Jia  and Vosoughi 2011]. However, the impact of imperfect channel estimation on the       MIMO Two-Way Relay Channel with Superposition Coding  ◾  475  achievable performance  rate  of a MIMO two-way relay protocol with SPC from  an information theoretic standpoint is still an open problem in the literature.  This chapter analyses the effects of imperfect channel estimation on the achievable  rate region of a MIMO MABC-SPC two-way relay protocol. By extending the work  presented in [Hammerstrom et al. 2007] and [Yoo and Goldsmith 2006], we char- acterize the information theoretic performance of the MIMO MABC-SPC protocol  under imperfect channel estimation for two main CSI assumptions:  a  without CSI  at the users where a symmetric power allocation between the two data flows is used  and  b  with an imperfect CSI at both users where a WF-PA is employed. Another  issue that is discussed through this chapter is the impact of the SPC power split on  the achievable system performance. We show that an appropriate power split between  the two data flows can maximize the achievable performance by simultaneously sup- porting user fairness. In addition, a power split that maximizes the achievable sum  rate is presented, and a theoretical framework that calculates the optimal SPC power  split between the two data flows for both optimization targets  fairness, sum rate   is proposed. It is shown that the optimal SPC allocation is common for both CSI  assumptions and independent of the instantaneous channels; a result that makes the  proposed scheme suitable for applications with critical complexity constraints.  The remaining part of the chapter is organized as follows. In Section 11.2, we  present  the  system  model  and  we  describe  the  considered  MIMO  MABC-SPC  protocol as well as its related achievable rate region. In Section 11.3, we present the  two CSI assumptions and we introduce an SPC power split under a user fairness  constraint as well as for sum-rate maximization. Numerical results are shown and  discussed in Section 11.4, followed by concluding remarks in Section 11.5.  Note that in this chapter log ⋅  denotes the logarithm of base 2.  11.2  Communication Model We assume a three-node MIMO two-way relay channel consisting of two users A  and B and a shared relay node R. All nodes are equipped with M > 1 antennas and  both users can establish communication using an MABC-SPC cooperative pro- tocol. Figure 11.1 depicts the system model and the two phases of the cooperative  protocol.  We  consider  flat  fading  spatially  uncorrelated  Rayleigh  MIMO  chan-  with i ∈ {A, B} denotes the channel matrix for the i → R  nels where hRi link.  The  entries  of  the  channel  matrices  hRi  are  independently  and  identically  distributed  i.i.d.  zero-mean circularly symmetric complex Gaussian  ZMCSCG   random variables with unit variance  i.e., rank hRi  = M . In addition, the chan- nel matrices remain constant for the whole transmission  during the two phases  of the adopted cooperative protocol  and change to an independent realization for  the next transmission. We assume that the channel matrices are subject to a chan- nel estimation error and therefore are imperfectly known at the receivers with an   for the i → R link, where the entries of  MMSE estimation error E  ×C M M  −  cid:30  H  H  ∈   cid:31   Ri  Ri  i      476  ◾  MIMO Processing for 4G and Beyond  xB  HRB  xA  HRA   a    b   . . . A  . . . A  . . . R  . . . R  GAuB  HRA  GBuA  HRB  . . . B  . . . B  Figure 11.1  The system model:  a  the first phase of the protocol,  b  the second  phase  of  the  protocol.   Adapted  from  Krikidis  I.  and  J.  S.  Thompson,  J.  Netw.  Comput. Appl., 35 1 , 510–516, January 2012.   Ei are ZMCSCG with variance σ εi with variance 1 SPC cooperative protocol are described as follows:  2 and the entries of   cid:22 hRi  are also i.i.d. ZMCSCG  2− σ ei [Yoo and Goldsmith 2006]. The two phases of the MABC-  Phase 1: In the first phase of the protocol, both users transmit their messages to  the common relay by forming a conventional MIMO multiple-access channel. At  the relay node the received signal can be expressed as +  1 denotes the transmitted message for the ith user, n    where xi ~     R represents a noise vector having ZMCSCG entries of variances σ n 2 and both users   cid:24  E[ transmit subject to a power constraint trace  ] denotes  the input covariance matrix. Due to the considered channel estimation error at the  relay node, the instantaneous rate region is the closure of the convex hull of the set  points     satisfying [Tse 2005, Section 10.1.2]:   where  P i  H x RA A  H x RB B  M∈ ×C    , CN 0   11.1   P≤  I n M  x x i   Pi  2σ  ,    r R  +  =  H i  n     ,  R  R RA B 1  1  RA  1  ≤  I  A 1   cid:31  log det  I  M  +  RB  1  ≤  I  B 1   cid:31  log det  I  M  +         cid:30   cid:30  H h h RA RA + σ σ   2 ε  A  2 ε  B  P    σ  2 n  +   cid:30   cid:30  H h h RB RB + σ σ   2 ε A  2 ε B  P    σ  2 n  +     ,     ,        R  +  RA B 1  1  ≤  I  sum  cid:31  log det  I  M  +      cid:30   cid:30  H h h RA RA + σ σ   2 n  + 2 ε A   cid:30   cid:30  H h h RB + P   2 ε B  RB σ    ,       11.2    11.3    11.4            where the above expressions consist of a generalization of the analysis presented in  [Yoo and Goldsmith 2006, Eq.  7 ].      MIMO Two-Way Relay Channel with Superposition Coding  ◾  477  Phase 2: In the second phase of the protocol, the relay node re-encodes the users’  messages using the same or a different codebook with the first phase of the protocol  and broadcasts them to both users via an SPC scheme [Tse 2005, Section 6.2.2;  Cover and Thomas 2006, Section 15.6]. With SPC, the relay node superposes the  sources’ messages in the modulation domain [Larsson and Vojcic 2005]  e.g., linear  combination of the two signals  with an appropriate power split and broadcasts the  resulting signal without further processing. It is worth noting that SPC is an effi- cient approach in order to boost the broadcast performance and achieve capacity.  Given that each user knows its own transmitted message  self-interference , it  suppresses its contribution from the received signal subject to the imperfect channel  estimate and decodes the message of the opposite user. More specifically, the SPC  scheme is defined as  u  R  =  G u  B  A  +  G u A B  ,    M∈ ×C  1 and gi  where ui  denote respectively the re-encoded message and  a  precoding  matrix   unitary  matrix ,  respectively,  for  the  ith  user.  The  received  signals are expressed as  ×C M M  ∈  r A  =  RA  H G u  cid:31   cid:30  cid:29   cid:28  cid:29  A self-interference  B  +  H G u A B  RA  +  v  ,  A  r B  =  H G u  RB  B  A  +  RB  H G u  cid:31   cid:30  cid:29   cid:28  cid:29  A B self-interference  +  v  B  ,         11.5    11.6    11.7   ′  ′  2σ  M∈ ×C        H A  H B  ~  P  ≤    1    P  I v M  CN 0   ,  G P GA B  G P GB A  ≤ α  where   − α  and trace       1 represents the receiver signal at ith user and  v where  ri i represents a noise vector having ZMCSCG entries of variances σ v 2. The relay node  transmits  with  a  total  power  P  which  is  split  between  the  two  data  flows  with  ] and  trace   α ∈ [0 1] denote the power split factor. Due to imperfect channel estimation, the  self-interference terms cannot be perfectly removed from the received signals and  affect the rate region computation related to the second phase of the protocol. By  using the analysis presented in [Yoo and Goldsmith 2006, Eq.  7 ] and taking into  account the power split that characterizes the SPC design  for user A the imperfect  = σ αε self-interference suppression corresponds to  E[ A P ]  which is added  2 A to the channel estimation error of the main-link σ  − α P  [Yoo and Goldsmith  2006] resulting in a total degradation of σ εA P2  , we can prove that the rates of the  second phase of the protocol satisfy the constraints:  E G u B A 2 1  εA   cid:24  E[  u u i  ′P i  H i  ,  ,  RA  2  ≤  I  A 2  α        cid:31   log det  I  M  +     H G P G H cid:30   cid:30  ′ H A A B σ ε + PA 2  RA σ  2 v  H RA     ,      11.8                   478  ◾  MIMO Processing for 4G and Beyond  RB  2  ≤  I  B 2  α        cid:31   log det  I  M  +     H G P G H cid:30   cid:30  ′ H B B A σ ε + PB 2  RB σ  2 v  H RB     .      11.9   By intersecting the above instantaneous rate regions related to the two phases  of the protocol and by averaging over many independent fades of the channels [Tse  2005], we define the overall achievable  average  rate region of the system as  RA  ≤ 1 2  E[ min  [  I  , A 1  I  B 2  α    ]] ,       RB  ≤ 1 2  E[ min  [  I   ,α    I  B 1  A 2  ]]     R RA B  +  2 E[ ≤ 1  I  sum  ],      11.10    11.11    11.12   where the factor 1 2 represents the rate loss caused by the two phases of the coop- erative protocol.  11.3  SPC and Power Split In this section, we deal with the impact of the CSI on the SPC design and investi- gate a power-split technique that  a  maximizes the achievable rate region under a  user-fairness constraint and  b  maximizes the achievable sum rate.  11.3.1   Conventional SPC without CSI at the Users The conventional SPC  C-SPC  design does not apply a precoding processing to the  bidirectional data at the relay node and therefore corresponds to gi = IM for i ∈ {A,  B}. In this case, the power allocated to each data flow is symmetrically distributed  among  the  spatial  direction  of  the  MIMO  channels.  If  we  use  the  single-value  decomposition  SVD  of the channel matrices HRA  the  instantaneous   maximum user rates during the second phase of the protocol can be written as   and HRB ,   cid:22    cid:22   I  C-SPC α      A 2      cid:24   log  1  +  M  ∑  m  = 1     α P M  σ  2 v  λ 2 m + σ ε 2 A  P     ,     I  C-SPC α      B 2      cid:24   log  1  +  M  ∑  m  = 1     1    P    α − M  σ  2 v  µ 2 m + σ ε 2 B  P     ,      11.13    11.14                         MIMO Two-Way Relay Channel with Superposition Coding  ◾  479  where λm and mm  with m = 1,. . .,M  denote the mth singular values for the channel  matrices HRA   respectively.   and hRB ,   cid:22    cid:22    cid:22    cid:22     and  HRB cid:22   11.3.2  SPC with CSI at the Users This SPC technique  called WF-SPC  assumes that imperfect channel knowl- edge  is  available  to  all  the  nodes  of  the  network  and  elaborates  a  WF-PA  in  each  bidirectional  link.  More  specifically,  we  assume  that  the  relay  node  has  a  global  knowledge  of  the  estimated  channels  HRA    this  estimation  is performed during the first phase of the protocol  while each user has a local  channel knowledge  HRi  is available at ith user . This CSI assumption enables a  power allocation  PA  optimization for each bidirectional link and therefore the  power assigned to the ith data flow is distributed among the spatial directions   eigenmodes   of  the  HRi   channel  according  to  the  principles  of  the  WF-PA.  We note that in the WF-SPC scheme the precoding matrix gi is given by the   while its left-hand matrix defines the  right-hand matrix of the SVD of the HRi postprocessing matrix applied at the ith user [Hammerstrom et al. 2007; Tse  2005]. By using a similar analysis with the C-SPC scheme, the instantaneous  user  rates  achieved  during  the  second  phase  of  the  cooperative  protocol  with  WF-SPC are given as   cid:22    cid:22      A  where P   m and R → B links, respectively, which are equal to  P   m  ,  B  , denote the WF power allocated to mth eigenmode of the R → A      I  WF-SPC α     A 2         cid:24   log  1  +  M  ∑  m  = 1  M  ∑  m  = 1        P A     m + σ  2 ε A  P  λ 2 m     ,  σ  2 v  P B     m + σ  2 ε B  P  µ 2 m     ,  σ  2 v        I  WF-SPC α     B 2         cid:24   log  1  +  A     P   m  =  ν  A  −  σ  2 v  2 ε A  P  σ + λ 2 m  B     P   m  =  ν  B  −  σ  2 v  2 ε B  P  σ + µ 2 m        +  +        ,  ,         11.15    11.16    11.17    11.18               +  cid:24   where [ ] x total power constraints ∑  max[ , ] x  0   and the constant parameters νA, νB are chosen to satisfy the   M =m  0     AP   m  =  α  and ∑ P  M =m  0     BP   m  =  1    −    ,α P   respectively.      480  ◾  MIMO Processing for 4G and Beyond  11.3.3   Fairness and SC Power Split As it can be seen from the instantaneous user rates for both the C-SPC and the  WF-SPC schemes, the power split between the two data flows is a critical parameter  for the overall performance of the system. In this subsection, we wish to identify an  SPC power-split technique that jointly maximizes the achievable rate region of the  system and supports data-rate fairness between the two users. To focus our analysis  on the second phase of the protocol, which refers to the SPC power split, we assume   α  for all the channel realizations which indicates  that I   that the single-user rate constraints in Equations 11.10 and 11.11 are dominated by  the second-phase user rates. In this case, a power split factor α* that maximizes the  minimum instantaneous single-user rate jointly achieves a maximization of the rate  region and ensures data-rate fairness between the two users. More specifically, the  power split factor that ensures user fairness is defined as   α  and I    >  >  B 2  A 2  B 1  A 1  I  I  *  α  =  arg max  α  ∈ 01 ] [  min  α     ,  I  α    B 2  A 2  [  I  ]   ,      11.19   where the solution of the above optimization problem requires that both single-user  instantaneous rates become equal. Therefore, the optimal power split can be found  by solving the following equation in respect to the parameter α*  I  A 2  α    *     =  I  B 2  α    *   .      11.20   It is obvious that the above solution requires Equation 11.20 to be solved for  the optimal power split for each channel realization, which will increase complexity  and is undesirable for real-time applications.  However,  as  the  adopted  performance  metric  is  the  average  achievable  data  rate, we can approximate the solution of the optimization problem by replacing the  instantaneous rates with their average values. More specifically, the SPC power split  based on the average rates can be found by equating the average single-user rates  and solving the resulting equation in respect to the parameter α *  [ E  I  *  α    A 2  ]    =  [ E  I  *  α    B 2  ]    .      11.21   For the C-SPC policy, we can solve Equation 11.21 as follows:  E  log det  I  M  +               α  P * M      cid:22   cid:22    diag   H H H RA RA   σ σ + PA     2 2   v ε − diag P     H H RB σ σ + PB     2 2 v ε  α * M  1       H RB             =  E  lo  gg det  I  M  +                  MIMO Two-Way Relay Channel with Superposition Coding  ◾  481  α     1        cid:22  diag H H RB +   2 P v   cid:22   cid:22  P diag H *   H H RA RA σ σ + M PA 2 2     v ε  cid:22  − α     * P σ σ   2 M ε B M     H RB  ⇒  E  det  I  M  +  =  E  det  +  M             I    α M  ⇒ +  1     ⇒ =  α  *  * P σ    −   1 + 2 v  σ    2 ε  = AA σ P   2 ε A σ − 1   σ + 2 2 v ε B  σ       1  −  σ  2 ε A          α − −  P 1   1     *  σ σ + M   2 2 v ε B σ σ + P      2 2 2 v ε ε B A σ σ + − P     1    2 ε B  +  1  2 v  M  σ P  2 ε B           ,  ++ σ εA P2         11.22            *  *  ]  α = E [  where α *  denotes  the  optimal  power  split  which  can  be  shown  to  be  equal  to  α  and the operator diag X  gives Xi,j = 0 if i ≠ j  matrix diagonalization .  This proposed power split does not require an instantaneous adjustment of the allo- cated power and requires less complexity than adjusting the power for each channel  realization. The simulation results to be presented in Section 11.4 will show that  this simplification does not significantly affect the  average  achievable rate region. Although the above optimal power split given by Equation 11.22 refers to the  C-SPC scheme, it is a good approximation for the WF-SPC scheme. The simula- tions in Section 11.4 show that the above optimal value can be applied to both  C-SPC and WF-SPC schemes in order to identify the optimal power split from  a user-fairness standpoint. This main observation reveals that the optimal power  split can be calculated for the C-SPC technique, whose corresponding equation is  simpler than the WF-SPC scheme, and can be used for both SPC schemes.  11.3.4  Optimization The question now is to find the SPC power split that maximizes the achievable   average  sum rate. Based on the rate region of the SPC scheme given in Equations  11.10 through 11.12, the achievable sum rate is written as [Hammerstrom et al.  2007]  R RA B  +  ≤  E[ min min[  [  1 2  I  ,  I  A 1  B 2  α     ] min[  +  I  α     ,  I  ],  I  B 1  A 2  sum   11.23   ]] ,     Following the approach of Section 11.3.3, by assuming that I >   ,α  Equation 11.23 can be simplified to    I  A 1  I  B 1  A 2  >  I  B 2   α  and     R RA B  +  ≤  E[ min  [  I  1 2  α       +  I  α sum     ,  I  A 2  B 2  ]] ,      11.24       482  ◾  MIMO Processing for 4G and Beyond  where the parameter α  power split  affects only the term I  ;  given  that the optimization criterion is the average sum rate, the optimal power split for  the second phase of the SPC protocols is given by  α    α    +  B 2  A 2  I        *  α  =  arg max  α  ∈ 01 [ ]  [[ E I  α       +  I  α    A 2  B 2  ]]   .      11.25   The  above  optimization  problem  can  be  solved  numerically  and  the  simula- tions presented in the next section show that the optimal solution is common for  both the C-SPC and WF-SPC schemes. It is worth noting that for scenarios where  sum  the achievable sum rate is independent on the  E [ power split; Isum dominates the sum rate.  E [  E [  α    α     ]   ]  +  >  ],  B 2  A 2  I  I  I  *  *  11.4  Numerical Results Monte Carlo simulations were carried out in order to validate the performance of  the proposed schemes. The simulation system follows the system model described  in Section 11.2, and the performance metric considered is the achievable average  user rate; the simulation parameters are defined in the following discussion for  each simulation example and summarized in Table 11.1. It is worth noting that  the main contribution of this chapter is to characterize the achievable rate of a  MIMO MABC-SPC protocol with imperfect channel estimation for different CSI  assumptions  and  study  the  optimal  power  allocation  for  different  optimization  targets. The simulation results are in line with this main purpose of the chapter   Table 11.1  Simulation Examples and Corresponding Parameters  Simulation example 1  Simulation example 2  Simulation example 3  Simulation example 4  σ P  2 n  = = 5  σ 0 01 . , M , dB  = 1 , 2 2 ε v A = 2 4 6 8 , ,  σ ,  =  0 01 . ,  σ  2 ε B  =  0 1 . ,  σ P  2 n  σ = 0 01 . , 2 v = dB M 30 ,  = =  σ = 1 , 2 4 6 8 , ,  2 ε A ,  0 01 . ,  σ  2 ε B  =  0 1 . ,  σ 2 n M  = =  0 01 . , 2 4 ,  σ  2 v  =  1 ,  σ ε 2 B  =  0 1 . ,  P  =  5 30 ,  , dB  σ P  2 n  σ = . 0 01 , 2 v = 0 5 10 30 , , ,  = σ 1 , M dB ,  2 ε A  =  = 0 01 . , 2 4 ,  σ  2 ε B  =  0 1 . ,      MIMO Two-Way Relay Channel with Superposition Coding  ◾  483  0 1  , σ v 2  0 01  = .  1= , σ εA 2  and therefore a comparison of the considered protocol  MIMO MABC-SPC  with  other MIMO–MABC approaches is beyond the scope of this work.  0 1= . , σ εB 2  Simulation 1: In Figures 11.2 and 11.3, we plot the max−min achievable  average   single-user rate, which is half the sum-rate expression for both users shown in Equation  11.24. This is plotted versus the SPC power split factor for a simulation setup with  σ n = . , P = 5 dB and M = 2, 4, 6, 8 antennas. We  2 note that these simulation parameters correspond to a low SNR scenario and ensure  that the second phase of the cooperative protocol determines the maximum single- >⇒ user rates  e.g., σ σ 2  . This simulation scenario is not  2 v a symmetric one since σ > 2 , which means that selecting α = 0.5 to split the relay  transmit power equally between the links is not optimal in this case. More specifically,  Figure 11.2 deals with the C-SPC scheme and plots the max−min achievable user rate  for different values of α while the maximum average achievable rate for both A and B  users as well as the max−min achievable user rate corresponding to an instantaneous  power split adjustment α* are used as reference curves.   and I > IA    As can be seen the power split that maximizes the max−min user performance is  equal to α = 0.42; a power split value that corresponds to equal maximum average   I A 1 σ  >  B 2  2 n  B1  ε B  I  A  ε  3.5  Optimal PA  α*      U C P B     e t a r   e g a r e v A  4.5  5  4  3  2  1  2.5  1.5  0.5  0  0  Min  RAR, RBR  RAR RBR  M = 8  M = 6  M = 4  M = 2  0.1  0.2  0.3  0.4  0.6  0.7  0.8  0.9  1  E α*  ≈ 0.42  0.5 α     2 n  2 v  =  =  σ  0 01 . ,  for  C-SPC;  Figure  11.2  Achievable  σ   M = 2,4,6,8  antennas  and  P = 5 dB;  the  0 01 . , dotted line denotes the achievable user rates for an instantaneous SPC power split   α* .  Adapted from Krikidis I. and J. S. Thompson, J. Netw. Comput. Appl., 35 1 ,  510–516, January 2012.    average   user  σ  rates  versus  α   0 1 . ,  2 ε A  1 ,  σ  2 ε B  =  =      484  ◾  MIMO Processing for 4G and Beyond  Optimal PA  α*      U C P B     e t a r   e g a r e v A  6  5  4  3  2  1  0  Min  RAR, RBR  RAR RBR  M = 8  M = 6  M = 2  0  0.1  0.2  0.3  0.4  0.6  0.7  0.8  0.9  1  E[α*] ≈ 0.42  0.5 α  2 v  2 n  =  =  σ  1 ,  0 01 . ,  Figure  11.3  Achievable  for  WF-SPC;  σ   M = 2,4,6,8  antennas  and  P = 5 dB;  the  0 01 , . dotted  line  denotes  the  achievable  user  rates  for  an  instantaneous  SPC  power  split  α* .  Adapted from Krikidis I. and J. S. Thompson, J. Netw. Comput. Appl.,  35 1 , 510–516, January 2012.    average   user  rates  versus  α  σ 2 ε B  0 1, .  2 ε A  σ  =  =  rates for both users. Therefore, by equating the maximum average user rates, we  can calculate the optimal power split value; an observation that validates the effi- ciency of the proposed power-split technique, given in Equation 11.21. Furthermore,  the performance of the instantaneous power-split technique  corresponding to α*   validates the fact that the fixed α value, obtained from the solution of Equation  ].*α  In addition, we can see that the proposed fixed power-split  11.21, is equal to E[ technique efficiently approximates the optimal max−min performance with a per- formance loss almost equal to 0.2 bits per channel use  BPCU . However, Figure  11.3 deals with the WF-SPC scheme and shows the impact of the power split on  the max–min achievable single-user rate. The first important observation is that the  WF-SPC scheme outperforms the C-SPC scheme for the considered low SNR sce- nario. This observation is in line with conventional MIMO configurations where the  WF is beneficial for low SNRs [Tse 2005]. As for the performance of the proposed  SPC power-split techniques, we can see that the main observations follow the previ- ously reported conclusions.      MIMO Two-Way Relay Channel with Superposition Coding  ◾  485  Min  RAR,RBR  RAR RBR Min  RAR,RBR  with WF RAR with WF RBR with WF  M = 8  M = 6  M = 4  M = 2     U C P B     e t a r   e g a r e v A  12  10  8  6  4  2  0  E α*  ≈ 0.1  0  0.1  0.2  0.3  0.4  0.6  0.7  0.8  0.9  1  0.5 α  Figure  11.4  Achievable   average   user  rates  versus  α  for  both  the  C-SPC  and    M = 2,4,6,8  antennas  and  WF-SPC;  σ P = 30 dB.  Adapted from Krikidis I. and J. S. Thompson, J. Netw. Comput. Appl.,    35 1 , 510–516, January 2012.   0 01 . ,  0 01 . ,  0 1 . ,  2 ε A  σ  σ  σ  1 ,  2 ε B  =  =  =  =  2 v  2 n  Another significant observation is that the optimal fixed power split value  for  the  WF-SPC  scheme  is  equal  with  this  one  used  for  the  C-SPC  scheme   α ≈ 0.42 . This result motivates the use of the C-SPC scheme for the computa- tion of the optimal α in order to further reduce the computational complexity.  Furthermore, it is worth noting that due to the asymmetric channel estimation  error for the R → A, R → B links, the optimal SPC power split is not symmetric   α = 0.5  and assigns more power to the link with the higher channel estimation  error  R → B .  Simulation 2: Figure 11.4 follows the parameter settings used in Figures 11.2  and 11.3 but with a fundamental change; P = 30 dB which refers to a high SNR  scenario.  As  can  be  seen  from  the  curves  corresponding  to  the  C-SPC  and  the  WF-SPC schemes, both SPC schemes achieve a similar performance. This observa- tion is in line with conventional point-to-point MIMO systems where WF is useful  only for the low SNR regime while it converges to a symmetric PA for high SNRs.  As for the power-split techniques, we can see that both the instantaneous and aver- age power allocations yield virtually the same data-rate performance.      486  ◾  MIMO Processing for 4G and Beyond  Simulation 3: In addition, it can be seen that for P = 30 dB the optimal fixed  power split corresponds to α ≈ 0.1 and therefore the 90% of the available power is  allocated to the R → B link that suffers from the higher channel estimation error.  It  is  worth  noting  that  for  the  low  SNR  regime  the  optimal  power  split  factor  is closer to the symmetric power allocation as the Gaussian noise dominates the  system  performance  degradation.  In  addition,  in  Figure  11.5,  we  plot  the  opti- ] *E α  for both the C-SPC and the WF-SPC schemes  mal fixed SPC power split   [ versus  different  channel  estimation  errors  of  the  R → A  link  for  P = 5,  30 dB,  σ . The curves show that both  2 n SPC schemes correspond to the same optimal power split allocation while more  power is allocated to the link with the higher channel estimation error. We note  that the optimal SPC power split is more sensitive to high SNR regime and there- ]*α  are higher for high SNRs  fore the interval value as well as the variability of E[ than low SNRs. Furthermore, Figure 11.5 validates the analytical derivation of the  optimal power split given by Equation 11.22; as can be seen in the curves corre- sponding to Equation 11.22 that match the simulation results.   antennas and σ εB 2  = . 0 1  0 01 . ,  M  1 ,  σ  =  =  =  4  2 v  1  0.9  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1    * α   E  Symmetric SPC power split  C−SPC  30 dB  WF−SPC  30 dB  C−SPC  5 dB  WF−SPC  5 dB  Eq. 11.22 for 5 dB Eq. 11.22 for 30 dB 0.8 1  0.9  0  0  0.1  0.2  0.3  0.4  0.6  0.7  0.5 σe 2 A  Figure 11.5  The optimal fixed SPC power split versus the channel estimation error  of the R → A link for both the C-SPC and the WF-SPC; σ 0.1,   M = 4 antennas and P = 5, 30 dB.  Adapted from Krikidis I. and J. S. Thompson,  J. Netw. Comput. Appl., 35 1 , 510–516, January 2012.   0.01,  =ε 2 B  1,  σ  σ  =  =  2 v  2 n      MIMO Two-Way Relay Channel with Superposition Coding  ◾  487  ]  I  2 n  2 v  =  =  =  σ  σ  σ  2 ε A  1 ,  0 01 . ,  0 01 . ,  sumE[  Simulation  4:  Figure  11.6  shows  the  impact  of  the  SPC  power  split  on  the  achievable  average  sum rate for both the C-SPC and the WF-SPC schemes. More  specifically, Figure 11.6 plots the achievable sum rate versus α  power split  for a  simulation setup with σ  M = 2, 4 anten- nas and  a  P = 0 dB,  b  P = 5 dB,  c  P = 10 dB, and  d  P = 30 dB; the sum rate  1 2   in Equation 11.12 is also depicted as a reference curve. As can be seen,  for  the  low  and  intermediate  SNR   P = 0,  5,  10 dB   the 1 2  ]   dominates  the  achievable  sum  rate  for  all α  and  therefore  the  SPC  power  split  becomes a critical issue. We can see that the power split that maximizes the achiev- able sum rate is equal to α * .= 0 55  for P = 0 dB; these values are common for both the C-SPC and WF-SPC schemes.  On the other hand, for high SNRs  P = 30 dB , although 1 2  sumE[ ] I  dominates the  α + achievable sum rate, the maximization of the 1 2   I  ]  guarantees the  B 2  .= 0 56 for P = 5 dB, α *  .= 0 6  for P = 0 dB, α *    E[    E[  0 1 . ,  α    α    α    2 ε B  +  =  B 2  A 2  A 2  I  I  I        0  0.2  0.4  0.6  α  0.8  1  0.2  0.4  0.6  0.8  1  Optimal power split  Optimal power split  1 2Isum for M = 2 RAR+RBR, C−SPC for M = 2 RAR+RBR, WF−SPC for M = 2 1 2Isum for M = 4 RAR+RBR, C−SPC for M = 4 RAR+RBR, WF−SPC for M = 4  8 7 6 5 4 3 2 1 0   d      U C P B     e t a r   e g a r e v A  8 7 6 5 4 3 2  Optimal power split  α  b   Optimal power split   a      U C P B     e t a r   e g a r e v A   c      U C P B     e t a r   e g a r e v A  8  6  4  2  0  8 7 6 5 4 3 2 1  0  0.2  0.4  0.6  α  0.8  1  0  0.2  0.4  0.6  α  0.8  1  Figure 11.6  Achievable  average  sum rate versus α for both the C-SPC and the WF-SPC  0.5Isum and   0 5 0 1 , .   . M = 2,4  antennas  and   a   P = −0 dB,   b   P = −5 dB,   c   P = −10 dB,  and   d   P = 30 dB.  Adapted from Krikidis I. and J. S. Thompson, J. Netw. Comput. Appl.,  35 1 , 510–516, January 2012.   0 01 . ,  0 01 , .    σ  α    σ      ;  I B  2 ε A  1 ,  σ  σ  σ  2 ε B  =  =  =  =  +  2 v  2 n  I     A  2  2      488  ◾  MIMO Processing for 4G and Beyond  maximization of the achievable sum rate  i.e., α * .= 0 9 results in a significant loss  on the achievable sum-rate performance . As for the C-SPC and WF-SPC schemes,  we can see that the WF-SPC scheme outperforms C-SPC at low SNRs, an observa- tion that is in line with our previous remarks.  11.5  Chapter Summary This chapter investigated the achievable rate region as well as the power-split process  for a MIMO bidirectional network with superposition coding relaying and imper- fect channel estimation. A power-allocation technique that incorporates the average  channel statistics and maximizes the achievable rates under a user-fairness constraint  has  been  described,  and  it  was  shown  that  an  optimal  power  allocation  strategy  allocates more power to the link with the higher channel estimation error while it is  more sensitive at high SNRs. A power split that maximizes the achievable sum rate  has also been investigated. It was seen that, in contrast to the fairness target, the  power allocation becomes less sensitive to estimation errors and thus the optimal  power allocation is close to the symmetric power allocation. Additionally, it was  demonstrated that the SPC power allocation is independent of the CSI and therefore  both C-SPC and WF-SPC schemes are optimized with the same power split.  References Chen, M. and A. Yener, Power allocation for F TDMA multiuser two- way relay networks,   IEEE Trans. Wireless Commun., 9, 546–551, February 2010.  Chen, L., L. Cao, X. Zhang, and D. Yang, Integrating network coding and superposition  coding in extended two-way relay networks, in Proc. of the IEEE Glob. Commun. Conf.,  Miami, USA, December 2010, pp. 1481–1486.  Cover,  T.  M.  and  J.  A.  Thomas,  Elements  of  Information  Theory,  John  Wiley  &  Sons,   Chischester, UK, 2006.  Ding, Z. and K. K. Leung, Impact of imperfect channel state information on bi-directional  communications with relay selection, IEEE Trans. Sign. Proc., 59, 5657–5662, Nov. 2011. Hammerstrom, I., M. Kuhn, C. Esli, J. Zhao, A. Wittneben, and G. Bauch, MIMO two-way  relaying with transmit CSI at the relay, in Proc. of the IEEE Workshop on Sign. Proc. Adv.  Wireless Commun., Helsinki, Finland, June 2007, pp. 1–5.  Jia,  Y.  and  A.  Vosoughi,  Sum-rate  maximization  of  two-way  amplify-and-forward  relay  networks with imperfect channel state information, in Proc. of the IEEE Inter. Conf.  Acoustics Speech Sign. Proc., Prague, Czech Republic, May 2011, pp. 2808–2811.  Jiang,  B.,  F.  Gao,  X.  Gao,  and  A.  Nallanathan,  Channel  estimation  and  training  design  for two-way relay networks with power allocation, IEEE Trans. Wireless Commun., 9,  2022–2032, June 2010.  Kim, S., J. P. Mitran, and V. Tarokh, Performance bounds for bidirectional coded coopera-  tion protocols, IEEE Trans. Inform. Theory, 54, 5235–5241, November 2008.      MIMO Two-Way Relay Channel with Superposition Coding  ◾  489  Kim, S., J. N. Devroye, P. Mitran, and V. Tarokh, Achievable rate regions and performance  comparison of half duplex bi-directional relaying protocols, IEEE Trans. Inf. Theory,  57, 6405–6418, Oct. 2011.  Klein, T. E. and R. G. Gallager, Power control for the additive white Gaussian noise chan- nel under channel estimation errors, in Proc. of the IEEE Inter. Symp. Inf. Theory, June  2001, p. 304.  Krikidis, I. and J. S. Thompson, MIMO two-way relay channel with superposition coding  and imperfect channel estimation, J. Netw. Comput. Appl., 35 1 , 510–516, January  2012.  Larsson, E. and B. Vojcic, Cooperative transmit diversity based on superposition modula-  tion, IEEE Commun. Lett., 9, 778–780, September 2005.  Medard, M. The effect upon channel capacity in wireless communications of perfect and  imperfect knowledge of the channel, IEEE Trans. Inf. Theory, 46 3 , 933–946, May  2000.  Oechtering, T. J. and H. Boche, Bidirectional regenerative half-duplex relaying using relay   selection, IEEE Trans. Wireless Commun., 7, 1879–1888, May 2008.  Park, M. and S. K. Oh, A hybrid network-superposition coding for asymmetrical two-way  relay channels, in Proc. of the IEEE Vehicular Tech. Conf., Anchorage, Alaska, September  2009, pp. 1–5.  Panah, A. and R. W. Heath, Sum-rate of MIMO two-way relaying with imperfect CSI, in  Proc. of the IEEE Inter. Conf. Acoustics Speech Sign. Proc., Dallas, TX, March 2010, pp.  3418–3421.  Shannon, C. E. Two-way communications channels, in 4th Berkeley Symp. Math. Stat. Prob.,   Chicago, IL, June 1961, pp. 611–644.  Saleh, A. B., C. Hausl, and R. Kotter, Outage behavior of bidirectional half-duplex relaying  schemes, in Proc. of the IEEE Inform. Theory Workshop, Taormina, Italy, October 2009,  pp. 50–54.  Tse, D. Fundamentals of Wireless Communication, Cambridge University Press, Cambridge,   UK, 2005.  Yoo, T. and A. Goldsmith, Capacity and power allocation for fading MIMO channels with   channel estimation error, IEEE Trans. Inf. Theory, 52, 2203–2214, May 2006.       Chapter 12 Physical-Layer Network  Coding with Multiple- Antenna Relays  Dirk Wübben, Meng Wu, and Armin Dekorsy  Contents 12.1  Introduction to Bidirectional Communication PLNC .............................492 12.2  APP-Based Detection Schemes .................................................................495 12.2.1 Calculation of APPs ......................................................................495 12.2.2 Separated Channel Decoding .......................................................499 12.2.3 Joint Channel Decoding and Physical-Layer    12.2.4 Generalized Joint Channel Decoding and Physical-Layer   Network Coding ...........................................................................501  Network Coding ...........................................................................505 12.3  MIMO Detection Techniques ..................................................................507 12.3.1 Linear Equalization ......................................................................507 12.3.2 Successive Interference Cancellation .............................................508 12.4  Performance Analysis ...............................................................................509 12.4.1 Single-Antenna Relay ....................................................................510 12.4.2 Multiple-Antenna Relay ................................................................510 Acknowledgment ..............................................................................................512 References .........................................................................................................512  491   492  ◾  MIMO Processing for 4G and Beyond  12.1   Introduction to Bidirectional Communication   PLNC  In wireless communication, the concept of cooperation is a very promising aspect  in realizing enhanced system performance, reliability, and coverage extension. For  example, relaying nodes have been introduced to support communication between  terminals such that the source transmits its message to the relay, which then for- wards a processed message to the destination. As full-duplex relays, that is, relays  transmitting and receiving at the same time and frequency, are difficult to imple- ment, it is common to restrict to the application of half-duplex transceivers causing  a substantial loss in spectral efficiency. This drawback has to be compensated by the  performance improvements achieved by cooperative communication techniques.  In  order  to  compensate  this  drawback,  such  a  one-way  relaying  system  can  be expanded in a bidirectional manner based on the concept of network coding  by allowing the intermediate node to perform operations on the incoming data  [Ahlswede et al. 2000]. In this two-way relaying system setup, both terminals  also  denoted as sources  intend to exchange information with each other with the help  of  a  relay.  The  direct  approach  is  to  let  the  sources  send  their  messages  succes- sively to the relay, and the relay transmits a network-coded signal containing, for  example, the bit-level exclusive-or  XOR  of both received messages back to the  sources in a third time slot by exploiting the broadcast nature of wireless channels  [Fragouli et al. 2006, Katti et al. 2006]. Since both sources are aware of what they  have transmitted previously, they can use this a priori information to estimate the  message of the other source without ambiguity. As a result, doubled amount of data  can be maximally transmitted in three time slots compared to one-way relaying  requiring two time slots. Furthermore, the number of required time slots can be  reduced to two by allowing both sources to transmit simultaneously to the relay. As  the information of the sources are then combined during the transmission to the  relay, such a scheme is termed physical-layer network coding  PLNC  [Zhang et al.  2006], which maps the receive signal at the relay directly to the network-coded  signal. Additionally, an essentially identical concept termed denoise-and-forward   DNF  was proposed in [Popovski and Yomo 2006] and [Koike et al. 2009]. In  these  literatures,  the  impact  of  channel  coding  is  not  considered.  Extensions  to  joint consideration of channel decoding and PLNC are referred to [Zhan and He  2008]. More generalized approaches herein requiring modified decoders are intro- duced in [Zhang and Liew 2009] for repeat accumulate codes and in [Wübben and  Lang 2010, Wübben 2010, and Pfletschinger 2011] for low-density parity-check   LDPC  codes with a modified sum-product algorithm  SPA . For convolutional  codes jointly considered with PLNC, an extended Trellis diagram is applied [To  and Choi 2010]. Furthermore, precoding strategies are investigated in [Schmidt  et al. 2013a,b] to combat multipath fading for PLNC.  The  above-mentioned  literatures  are  focused  on  single-antenna  relay  nodes.  When multiple antennas are available at the relay, the increased spatial degrees of       Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  493  freedom basically lead to a multiuser MIMO configuration for the two-way relay- ing system using PLNC. Therefore, common MIMO processing techniques can  be adopted in this context and thus provide a variety of design flexibility. In [Xu  et al. 2010], the uplink transmissions from both sources to the relay are treated as a  conventional multiuser MIMO channel, where different multilayer MIMO detec- tion techniques are applied. After this separate detection of the source messages,  a network-coded signal is generated for broadcasting. The joint consideration of  MIMO detection and PLNC is investigated in [Zhang and Liew 2010] and [Chung  et al. 2012] for linear detection and in [Zhang et al. 2012] for nonlinear detection.  However, the impact of channel coding is ignored in these works. In this chapter,  the  existing  schemes  for  PLNC  in  bidirectional  communications  as  well  as  the  MIMO-related extensions are studied and compared in detail with the emphasis  on multiple-antenna relays and channel coding.  In bidirectional relaying systems, two source nodes A and B intend to exchange  information with each other supported by a relaying node R. The communication  consists of two phases as shown in Figure 12.1. In the multiple-access  MA  phase,  both sources transmit their packets of the same length to the relay simultaneously,  resulting in a superimposed receive signal yR at relay R. Upon reception, R estimates  a network-coded message xR from the receive signal and broadcasts it back to the  sources in the broadcast  BC  phase. Here, both sources A and B are assumed to be  equipped with a single antenna, whereas the relay is equipped with J ≥ 1 antennas. It  is noted that the direct link between A and B is not available due to the half-duplex  constraint.  The binary information words of the same length K for source A and B are  denoted as bA and bB, respectively. These two information words are encoded by the  same linear channel code Γ with code rate RC = K N into binary source codewords  cA = Γ bA  and cB = Γ bB  of length N at the sources. Applying a mapper M with  an  M-ary modulation alphabet, the  source  codewords are mapped to the symbol  } of length L = N m with m = log2 M. Both  vectors x A symbol vectors are transmitted to the relay simultaneously in the MA phase. The  symbol vector x A  of source A consists of L symbols   2  cid:30       = M{  = M{   and x  x L A     ]  }c A  = [      1  x  x  c  A  A  B  B   a  Multiple-access  MA  phase   b   Broadcast  BC  phase  yR  ℓ   R  xA  ℓ   A  xB  ℓ   B  yA  ℓ   A  xR  ℓ   R  yB  ℓ   B  Figure 12.1  A two-way relaying network where two sources A and B exchange  information with each other via the relay R. The communication consists of an  MA phase and a BC phase.      494  ◾  MIMO Processing for 4G and Beyond  xA  ℓ , ℓ = 1, 2, . . ., L, where the symbol  x  depends on m code  bits that are collected to the code bit tuple c    ].    cid:31  , A Here, m denotes the number of bits contained in one modulated symbol xA    cid:12   with  index υ = 1, . . ., m.  = M c { A =      cid:31  , A 1     }  cid:31  c  The ℓth receive signal yR,j ℓ  on the jth antenna at relay R, j = 1,2, . . ., J, is        cid:31       cid:31   c m , A       cid:31    cid:30   c  [  A  A  2  given by  y  R  ,  j       cid:31   =  h A  ,  j       cid:31   x  A       cid:31   +  h B  ,  j       cid:31   x  B       cid:31   +  n R  ,  j     .  cid:31    12.1      When flat fading channels are considered, hA,j ℓ  and hB,j ℓ  represent the chan- nel coefficients in time domain. In case of frequency selective fading channels using  orthogonal frequency division multiplexing  OFDM , the channel coefficients are  defined in frequency domain for the ℓth subcarrier. The additive white Gaussian  noise  AWGN  nR,j ℓ  is circularly symmetric complex, which has zero mean and  variance σ n 2.  With the definition of the 2 × 1 transmit symbol vector x     cid:31  y R  the corresponding J × 1 receive signal vector y R at relay R is given by  = y [       cid:31        cid:31   , 1  R  = x [      cid:31  A 2  cid:30       cid:31  ,     ] , x B    T  cid:31  y    ]   T  cid:31  J , R  y R       cid:31   =  H x           cid:31   cid:31   +  n  R     ,  cid:31       12.2   ,  ,  j  j  2  R  [  [  y  y  y  h  =  h B  h 1       cid:31        cid:31        cid:31        cid:31        cid:31   = [     ]  cid:31    cid:30  J h  T   denotes  the  J × 2  MIMO  channel  where  H matrix and nR ℓ  denotes the noise vector at R. Note that h j    ]   T  cid:31  holds. In order to represent the complete receive signals at the relay for ℓ = 1,2, . . ., L,  we additionally define the receive signal matrix Y     1    ] L   R R of dimension J × L that collects the L receive signal vectors.  2  cid:30       = A h  = M{  Upon  receiving  the  superimposed  signal,  the  relay  performs  an  estimation  with  respect  to  the  XOR  of  the  source  codewords  cA⊕B = cA ⊕ cB  based  on  yR.  This  estimated  relay  codeword  cR   is  further  mapped  to  the  symbol  vec- tor  x }, which is broadcasted toward both sources in the BC phase. In  case of multiple antennas at the relay, diversity-exploiting schemes can be applied,  for example, orthogonal space-time block code  OSTBC  [Alamouti 1998, Tarokh  et al. 1999], space-time trellis code  STTC  [Tarokh et al. 1998], linear dispersion  code  LDC  [Hassibi and Hochwald 2002], and so on. For example, assuming that  OSTBC is applied in the BC phase while ignoring the data rate loss due to orthogo- nal code designs for J > 2, the equivalent system equation on the ℓth element from  relay R to source A is given by [Tarokh et al. 1999]  ⊕ cid:22 c A B  =  c  R  R  R  y  A       cid:31   =  2  ′ h A  ,  j       cid:31   x  R       cid:31   +  n  A     ,  cid:31    12.3   J  ∑1 J  j  = 1                  Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  495  B  B  A  A  y  y  y  y      1      1  = [     ]  y L B  y L A  2  cid:30       2  cid:30       ′h jA,     cid:12    where  yA   ℓ   represents  the  receive  signal  after  OSTBC  detection.  Here,  denotes  the  channel  coefficient  for  the  link  from  the  jth  antenna  at  relay  R  to  source A. As can be observed in Equation 12.3, a diversity gain of order J can be  achieved.  After  reception  and  OSTBC  detection  in  the  BC  phase,  both  source    and   cid:22 cR B,   from  the  receive  sig- nodes  A  and  B  estimate  the  relay  codeword   cid:22 cR A, = [ nals  y A   and  y B    ],   respectively. Based on the fact that each source knows what it has transmitted in  the MA phase as a priori information, the information from the counterpart can  be obtained by simply performing XOR operation again at the sources between the  estimated relay codeword and this a priori knowledge. Specifically, the estimated  codeword from source B at source A is achieved by  cid:22  . The estimate  c  cid:22  c A  = The above decode-forward  DF -based approach for PLNC requires decod- ing at relay R to estimate the relay codeword. However, when decoding errors  occur at R, that is,  cid:22 c , these errors will then propagate to the sources  in the BC phase, which severely degrades the end-to-end performance of the  bidirectional  communication.  Therefore,  the  overall  system  performance  is  highly dependent on the decoding results at the relay. To this end, we focus  on the crucial MA phase in the sequel, where different detection and decod- ing schemes at the single-antenna or multiple-antenna relay are presented and  compared  with  respect  to  the  error  rate  performance  of  the  estimated  relay  codeword.   is obtained similarly at source B.  ⊕, R A  ⊕, R B  ⊕ A B  ⊕ A B  ≠  =   cid:22  c   cid:22  c  c  c  c  A  B  B  12.2  APP-Based Detection Schemes 12.2.1  Calculation of APPs In this section, several a posteriori probability  APP -based detection and decoding  schemes are presented to estimate the relay codeword cR from the receive signal  yR at the relay. We may either estimate the source messages explicitly or directly  estimate the relay message. In order to simplify the description, we will first intro- duce some basic relations between the occurring signals and their corresponding  probabilities. Note that the element index ℓ is omitted in the sequel for the sake of  simplicity unless otherwise stated.  Since source A and B transmit simultaneously to relay R in the MA phase, each  receive signal yR,j at the jth antenna defined in Equation 12.1 is determined by both  = M  This leads to M2 different noise- source messages x free receive signals at R  } and x  = M{ c  c B{  }.  B  A  A     sAB  ,  j  =  h A  ,  j  x  A  +  h x B j  ,  B  ,      12.4       496  ◾  MIMO Processing for 4G and Beyond        where each of these hypothesis is defined by the bit tuples c = [ and c c bit tuple c AB nate D as  ]    As a short-hand notation, we define the combined  ] and introduce the polynomial description with indetermi-  2  cid:30  B  c B 1 , = [ c  2  cid:30   c m , A  c m , B  ].  c  c  c  , 1  A  A  A  A  B  B  ,  ,  = [  c  AB  = =  c [ c  A  , 1  +  A  , 1  c A , 2 +  cid:30    cid:30  c m A , − c D m 1 A  m ,  +  , 1  c B c D B  , 1  c m  , B 2 +  B  c  ] m ,  cid:30  cc Dm 2   cid:30  +  B,   12.5   m  1−  .     Thus, cAB belongs to a Galois field CAB = FM 2  and c  = C     represents the  jth event in FM 2 , 0 1 . Based on the instantaneous channel knowledge  hA,j and hB,j, the relations between these notations are shown in Tables 12.1 and  12.2 for BPSK and QPSK modulation as examples, respectively. For the later deri- vations, we also include the element-wise XOR combination of cA and cB given by  i M  ≤ ≤  −  AB  AB  i  2  c  ⊕ = ⊕ = A B  c  c  A  B  [  c  A  , 1  ⊕  c  B  , 1  c  A  , 2  ⊕  c  2  cid:30  ,  B  c  A  m ,  ⊕  c  ].  B  m ,   12.6      It is noted that  = −1 in the tables denotes the imaginary unit. Additionally,  graphical examples are presented in Figure 12.2 to illustrate the complex constel- lation set for the noise-free receive signal s jAB,  on the jth antenna at the relay for  one fading channel realization. As can be observed, BPSK and QPSK lead to 4 and  16 hypotheses, which correspond to Tables 12.1 and 12.2, respectively. Note that  some hypotheses can be completely superimposed in certain channel conditions,    a   BPSK Im  0  1  3  Re  2   b   6  10  2  14  7  3  15  11  QPSK Im  0  4  5  8  9  12  Re  1  13  Figure  12.2  Graphical  example  for  the  noise-free  receive  signal  constellation  set on the jth antenna at the relay for one fading channel realization,  a  for BPSK   =    with  h jA, , = − h jB,  +   i = 0,. . .,3 and  b  for QPSK with  h jA,   =  0.2  0.5 ,  0.8  0.6 , +     i = 0,. . .,15.     h jB,  0.3   +   =   ,      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  497  Table 12.1  Mapping Rules of Code Bit Tuple  cA,cB , Transmit  Signals  xA,xB , and Noise-Free Receive Signal sAB,j on the jth  Antenna at Relay R for BPSK Modulation  i  0  1  2  3  cA  cB  cA⊕B  cAB  0  1  0  1  0  0  1  1  0  1  1  0  0  1  D  1 + D  xA   −1  1  1   −1  xB  1  1   −1   −1  sAB,j  hA,j + hB,j  −hA,j + hB,j hA,j − hB,j  −hA,j − hB,j  for example, only three hypotheses for BPSK and nine hypotheses for QPSK are  present in AWGN channels, as shown in Figure 12.9.  Since all transmitted code symbols are assumed to be equally likely, the a priori   probabilities for cAB  = C    i  are given by  AB  Pr{ c  AB  =  C AB     } i  =  1 M  . 2     12.7   Furthermore, the probability density for yR conditioned on the code bit com- AB∈ C  with deterministic channel gains can be deduced from AWGN   bination cAB channels as  p  {  y  R    c  AB  =  C AB  i    }    y  R  −  H  X  i      2   12.8   1 =   πσ 2 n  K     exp  −      1 σ 2 n      .     =  =  }  AB      i  c { Here, X M  c } { M A tuple from the sources given that cAB the a posteriori probability Pi that cAB receive signal vector yR, is  [  c { M AB  B  denotes the ith modulated symbol  }] = C    i  is transmitted. Applying Bayes’ rule,  = C    i  was transmitted, given the current   AB  i = P  c Pr{  AB  =  C AB  i       =  =  p  {  y  R  pp  {  y R      c  c  AB  AB  =  C AB  = C  AB  R  }  y    } Pr{ c i α    } . i  i    }  = AB Pr{ y  C AB }  R      12.9   The constant α = =  ness condition  ∑  iP  i     } i  = C AB AB } Pr{ y R  Pr{ c 1  to normalize the probabilities Pi.  1 Pr{  =  M  R  y  2  }   can be calculated using the complete-               498  ◾  MIMO Processing for 4G and Beyond  Table 12.2  Mapping Rules of Code Bit Tuple  cA,cB , Transmit Signals   xA,xB , and Noise-Free Receive Signal sAB,j on the jth Antenna at Relay  R for QPSK Modulation  cA⊕B  cAB  i  0  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  cA  00  10  01  11  00  10  01  11  00  10  01  11  00  10  01  11  cB  00  00  00  00  10  10  10  10  01  01  01  01  11  11  11  11  00  10  01  11  10  00  11  01  01  11  00  10  11  01  10  00  1 + D + D2  −    h A  ,  j  +    h B  ,  j  0  1  D  1 + D  D2  1 + D2  D + D2  D3  1 + D3  D + D3  1 + D + D3  D2 + D3  1 + D2 + D3  D + D2 + D3  xA  1     −1  −   −1   −    −1 −  1    1    1     −1  −  xB  1  1  1  1           −1   −1   −1   −1  −  −  −  −  sAB,j hA,j + hB,j  h A  ,  j  +  h B  ,  j   − h_A,j + hB,j  −  h A  ,  j  +  h B  ,  j  h A  ,  j  +   h B  ,  j    h A  ,  j  +    h B  ,  j  −  h A  ,  j  +    h B  ,  j  hA,j − hB,j  h A  ,  j  −  h B  ,  j   − hA,j − hB,j  −  h A  ,  j  −  h B  ,  j  h A  ,  j  −   h B  ,  j    h A  ,  j  −    h B  ,  j  −  h A  ,  j  −    h B  ,  j  1 + D + D2 + D3  −    h A  ,  j  −    h B  ,  j  The APPs determine the probabilities of different transmit code bit combina- tions cAB based on the receive signal yR. These APPs can be used to calculate log- likelihood ratios  LLRs  for the individual code bits cA and cB, or the XORed code  bit cA⊕B. In the sequel, the LLRs are obtained from the APPs that facilitate different  detection and decoding schemes, which are termed APP-based schemes.      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  499  12.2.2  Separated Channel Decoding The estimation of the source information at the relay can be interpreted as a tra- ditional MA problem, which targets at estimating the individual messages cA and  cB explicitly by separated channel decoding  SCD . Based on the APPs defined in  Equation 12.9, the probability for cA, ,υ  υ = 1, . . ., m, given the receive signal vector  yR, can be calculated as  ξ where ΩA,υ  denotes the set of indices with code bit cA,υ equal to ξ ∈ { , }0 1  accord- ing to Tables 12.1 and 12.2. For example, ΩA,  collects all events i with  0 1 cA,1 = 0 for BPSK. Correspondingly, the LLR LA,υ for the code bit cA,υ can be for- mulated as  { , } 0 2  =  Pr{ c  υ =  A  ,  ξ    y  R  }  =  ∑  ξ ∈ Ω A  i  υ ,  Pi  ,     L A  υ ,  =  ln     c Pr{ A c Pr{  A  υ ,  υ ,  = =  0 1     y y  R  R  } }     ,     which is fed to a soft-input channel decoder for each code bit of the codeword.  In this way, the estimated   cid:22 c A for the source codeword transmitted by source  A  is  achieved.  In  a  similar  manner,  LLR  calculation  and  channel  decoding  are performed with respect to the codeword from source B, resulting in the  estimate  cid:22 cB.  Graphical Illustration ξ ξ In Figure 12.3, graphical examples are given that illustrate the set ΩA,υ  and ΩB,υ   used to calculate LLRs in Equation 12.11 for BPSK. Here, the event sets are defined  as ΩA, 0 1   for the calculation of LA,1 by   and ΩA, 1 1  { , } 0 2  { , } 1 3  =  =  which  correspond  to  the  solid  lines  and  dashed  lines  in  the  figure,  respectively.  Similarly, ΩB, 0 1   hold for calculating LB,1 leading to   and ΩB, 1 1  { , } 2 3  { , } 0 1  =  =   12.10    12.11    12.12    12.13   L A, 1  =  ln     P 0 P 1  + +  P 2 P 3     ,  L B, 1  =  ln     P 0 P 2  + +  P 1 P 3     .                        500  ◾  MIMO Processing for 4G and Beyond   a    b   cA,1 Im  yR,j x  0  2  1  3  Re  Re  cB,1 Im  yR,j x  0  2  1  3  Figure 12.3  Graphical example of the LLR calculation for SCD with BPSK. The  receive signal yR,j on the jth antenna at R is represented by “x.” Solid lines and  dashed lines correspond to entries sAB,j with code bit equal to 0 and 1, respec- tively,  a  for code bit cA,1 and  b  for code bit cB,1, i = 0, . . . ,3.  It  is  noted  that  for  QPSK,  the  graphical  illustration  for  LLR  calculations  is  focused  on  the  first  code  bit  in  one  modulated  symbol,  that  is,  cA,1  and  cB,1,  as  visualized  in  Figure  12.4.  Specifically,  ΩA,   and  0 1 ΩA,  are used to calculate the LLR LA,1, whereas LB,1 is cal- } , , { , 1 3 5 7 9 11 13 15 , , 1 1 culated using ΩB, { , , } 0 1 2 3 8 9 10 11 , , , 0 1  { , }. 4 5 6 7 12 13 14 15  { , 0 2 4 6 8 10 12 14   and ΩB, 1 1  Furthermore, it can be observed in Figure 12.4 for QPSK that SCD will lead to   are spatially separated for this   relatively larger LLR for cA,1 as the sets ΩA,1  0  and ΩA,1 1  =  =  =  =  }  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,   a   6  7  3  10  11  2  14  15  cA,1 Im 4 x  yR,j 8  12  Re  0  1  13  5  9   b   6  10  cB,1 Im 4 x  2  14  7  3  15  11  5  9  yR,j 8  12  Re  0  1  13  Figure 12.4  Graphical example of the LLR calculation for SCD with QPSK. The  receive signal yR,j on the jth antenna at R is represented by “x.” Solid lines and  dashed lines correspond to entries sAB,j with code bit equal to 0 and 1, respec- tively,  a  for code bit cA,1 and  b  for code bit cB,1, i = 0, . . . ,15.      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  501  YR  APP  ∑  ∑  LA  LB  D  D  cA ˆ  cBˆ  cR =  cAˆ ⊕  cBˆ  ⊕  Figure  12.5  Block  diagram  for  parallel  separated  channel  decoding   P-SCD ,  which estimates cA and cB individually and subsequently applies network coding  c R   cid:22 ⊕  =  cid:22  c  c . B  A  channel realization. In contrast, ΩB,1 1  are not well distinguished and thus  result in smaller LLRs. A closer look on the LLR distributions taking into account  the fading channel characteristic is presented in the upcoming section.  0  and ΩB,1  Finally, XOR-based network coding is applied to combine the decoding output   cid:22 ⊕ , which is then modu-  vectors and generate the relay codeword as  c c B lated and broadcasted back to the sources in the BC phase.  Note that in the above approach, the source codewords cA and cB are decoded  in parallel. Therefore, such a separated decoding scheme is termed P-SCD with  the  block  diagram  shown  in  Figure  12.5.  Alternatively,  the  decoding  result  of  the channel with larger signal-to-noise ratio  SNR  can be subtracted from the  receive signal and a common decoding for the second codeword with respect to  this interference-reduced signal is performed. Such a successive decoding scheme  is termed S-SCD.  =  cid:22  c  R  A  12.2.3   Joint Channel Decoding and Physical-Layer   Network Coding  For PLNC, the functionality of the relay node is to generate a network-coded mes- sage cR from the receive signal yR. In order to build such a relay codeword, it is not  necessary that the relay has to estimate the source codewords cA and cB explicitly as  performed by SCD presented in the previous section. Alternatively, the relay code- word cR = cA⊕B can be directly estimated from yR without knowing the individual  messages  cA  and  cB,  which  is  termed  joint  channel  decoding  and  physical-layer  network coding  JCNC  [Zhan and He 2008, Zhang and Liew 2009].  Based  on  the  assumption  that  both  sources  apply  the  same  linear  channel  code, the modulo-2 sum cA⊕B = cA ⊕ cB is also a valid codeword of the code Γ.  In  this  case,  the  APPs  for  each  XOR  code  bit  cA⊕B,υ = 0  and  cA⊕B,υ = 1  can  be  determined as     Pr{ c  ⊕ A B  υ ,  =  ξ    y  R  }  = ∑  ξ ∈ Ψ υ  i  Pi  ,      12.14       502  ◾  MIMO Processing for 4G and Beyond  using  the  APPs  Pi  in  Equation  12.9.  Here,  Ψυ ξ  defines  the  set  of  indices  with  the  XOR  code  bit  cA⊕B,υ = cA,υ ⊕ cB,υ  equal  to  ξ ∈ { , }0 1   For  example,  the  set  Ψ1 } indicates all events  i with cA⊕B,υ = 0 for BPSK. Thereafter, the cor- 0 responding LLR  = { , 0 3  L ⊕ A B  υ ,  =  ln     c Pr{ ⊕ A B c Pr{  ⊕ A B  υ  ,  υ ,  = =  0 1     y y  R  R  } }         12.15   is  fed  to  the  channel  decoder,  which  produces  the  relay  codeword  c directly.  R  =  cid:22  ⊕   A B  c  Graphical Illustration ξ is illustrated graphically in Figure 12.6  The LLR calculation based on the set Ψυ for both BPSK and QPSK modulation according to the occurrence of the XOR  code bit cA⊕B in Tables 12.1 and 12.2. The event sets Ψ1 0 }  1 2 are used to calculate the LLR LA⊕B,1 for BPSK by  } and Ψ1 1  = { , 0 3  = { ,  L A B⊕  , 1  =  ln     P 0 P 1  + +  P 3 P 2     ,      12.16          a   cA⊕B,1 Im  yR,j x  0  2  1  3  Re   b   6  10  cA⊕B,1 Im  4 x  2  14  7  3  15  11  5  9  yR,j 8  12  Re  0  1  13  Figure  12.6  Graphical  example  of  the  LLR  calculation  for  JCNC.  The  receive  signal yR,j on the jth antenna at R is represented by “x.” Solid lines and dashed  lines correspond to entries sAB,j with the first bit in the XOR code bit tuple cA⊕B,1  equal to 0 and 1, respectively,  a  for BPSK with i = 0, . . . ,3 and  b  for QPSK with  i = 0, . . . ,15.      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  503  ,  ,  ,  ,  ,  ,  = { ,  which is only different from the LLR calculations  Equations 12.12 and 12.13  for  SCD in summation of the APPs. Contrarily, for QPSK, the LLR of the first bit  in  the  XOR  code  bit  tuple  is  calculated  using  Ψ1 }  and  0 Ψ1 }. Note that for this channel realization, JCNC will pro- 1 duce relatively smaller LLRs for cA⊕B since the sets Ψ1 1 are not well separated  in space. This will also be elaborated and compared to SCD subsequently by con- sidering the distribution of the LLRs.  0 2 5 7 8 10 13 15  1 3 4 6 9 11 12 14  0 and Ψ1  = { ,  Finally, the estimated relay codeword cR is modulated and broadcasted to both  sources in the BC phase. Compared to SCD with two decoding chains, JCNC  requires channel decoding only once per MA channel use and, thus, computational  efforts are reduced. The block diagram for JCNC is depicted in Figure 12.7.  ,  ,  ,  ,  ,  ,  LLR Distributions The LLRs  Equations 12.11 and 12.15  calculated using the APPs are fed to a chan- nel  decoder  for  SCD  and  JCNC,  respectively.  It  is  noted  that  larger  amplitude  of LLRs provides more reliability and thus is able to benefit more from channel  decoding.  Therefore,  the  distributions  of  the  LLR  amplitudes  of  the  individual  code bit cA for P-SCD and XOR code bit cA⊕B for JCNC are investigated as follows.  As an example, the cumulative distribution function  CDF  of the absolute LLRs   denoted as LLR  at the relay is shown in Figure 12.8 for both AWGN channels  and fading channels. QPSK modulation is adopted at both source nodes A and B. As can be observed in the figure, approximately half of the LLRs for P-SCD  are extremely small  close to 0  in AWGN channels. This is because some constel- lation points in the noise-free receive signal plain are completely superimposed and  therefore cannot be distinguished by SCD at all due to this ambiguity. These super- imposed points can be observed in Figure 12.9 for BPSK and QPSK modulation.  When BPSK is applied at the sources, the transmit symbol tuple  xA,xB  =  1, − 1   and   xA,  xB  =  −1,1   lead  to  the  same  hypothesis  sAB,j = 0  at  each  antenna.  For  QPSK, 16 different transmit symbol tuples  xA, xB  lead to only 9 points in the  complex  plain.  For  example,  the  events  i = 3,6,9,12  all  result  in  sAB,j = 0,  which  degrades the performance of SCD significantly. However, these hypotheses cor- respond to the same XOR code bit tuple cA B⊕ = [ 1 1  all of which belong to the  set Ψ1 1 . Therefore, JCNC is immune to this ambiguity and produces larger  LLRs compared to SCD as shown Figure 12.8a.  1 or Ψ2  ],  YR  APP  LA⊕B  ∑  D  cR = cA⊕B  ˆ  Figure 12.7  Block diagram for joint channel decoding and physical-layer network  coding  JCNC , which estimates c   directly from the receive signal YR.  ⊕ cid:22  c A B  =  R      504  ◾  MIMO Processing for 4G and Beyond   a   AWGN   b   One flat fading realization   c   Multipath fading with OFDM  F D C  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0  F D C  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0  F D C  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0  P-SCD J = 1  JCNC J = 2  P-SCD J = 1  JCNC J = 2   10 LLR  0  5  15  20  0  5  15  20  0  5  15  20  10 LLR  10 LLR  Figure 12.8  LLR distributions  CDF  of code bits before decoding for P-SCD and  JCNC in  a  AWGN channels,  b  fading channels with one channel realization  h jA,  =   and  h jB,   and   c   multipath  fading  channels  using  OFDM  averaged over different channel realizations, SNR = 5 dB and QPSK modulation.  0.2  0.5 ,   = −  +   When fading channels are considered, we investigate the LLR distribution with  respect to one flat fading realization used in Figure 12.2, where the channel coef- ficients lead to distributed noise-free constellation points sAB,j at the relay. In this  case, SCD benefits from this spatial separation and thus produces larger LLRs com- pared to JCNC, as visualized in Figure 12.8b. For practical concerns, frequency- selective fading channels in combination with OFDM are considered, resulting in  different constellation maps over the subcarriers. It can be observed in Figure 12.8c  that SCD still achieves larger LLR amplitudes compared to JCNC by averaging    a   BPSK Im   b   3  2  1  0  Re  Re  QPSK Im  2  8  6 3  12 9  7  13  0  4 1  5  10  14 11  15  Figure 12.9  Graphical example for the noise-free receive signal constellation set  on each antenna at the relay in AWGN channels,  a  for BPSK with i = 0, . . . ,3 and   b  for QPSK with i = 0, . . . ,15.      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  505  over different channel realizations. This scenario will also be considered later on in  Section 12.4 for performance evaluations. Furthermore, multiple antennas at the  relay lead to improved CDF curves while the comparison between SCD and JCNC  remains unchanged.  12.2.4   Generalized Joint Channel Decoding and Physical-  Layer Network Coding  The separated decoding of both source codewords cAand cB as well as the joint decod- ing of the XOR codeword cA⊕B from the receive signal yR are operated in binary bit  level. Alternatively, the decoding at the relay can be performed with respect to the  nonbinary field FM 2  such that the M2-ary code combination cAB is estimated from  yR. Subsequently, PLNC is executed that maps the estimated  cid:22 c AB to the relay code- word cR. This approach is able to fully exploit the coding gain of both channel codes  at the sources and is termed generalized joint channel decoding and physical-layer  network coding  G-JCNC   Wübben and Lang 2010, Wübben 2010].  In order to examine the validity of the G-JCNC scheme operated in nonbi- nary field, the code structure for cAB applied to the MA phase is observed. Here,  the encoding process is assumed to be slightly different compared to the system  defined in Section 12.1, where m identical encoders are applied to the information  bit streams bA,1 to bA,m, that is, the encoding process, for example, at source A reads   In this way, the code bits cA,υ ℓ    . c A with υ = 1, . . ., m contained in one modulated symbol xA ℓ  have similar connec- tions in the code structure of the applied channel code Γ. The encoding at source B  is performed likewise. Basically, each code bit of a linear channel code consists of  the modulo-2 sum of some information bits, for example, the code bit cA,υ ℓ  in the  codeword is achieved by the sum of the uth and the wth information bits, that is  2  cid:30          ] L      1  Γ    =  =  b  c  c  c  [  υ ,  υ ,  υ ,  υ ,  υ ,  A  A  A  A  c  A  υ ,   cid:31  =      b A  υ ,  u      ⊕  b A  υ ,  w     .      12.17   Since both sources employ the same channel code, the ℓth element in the code   bit polynomial can be written as  c  AB       cid:31   = =  =  =  A  , 1  , 1  c [ b [ A b B b A ⊕ b AB   cid:30      c  cid:31  , 1 m A , ⊕ u     b w     A ⊕     u w b   B , m , m + +  cid:30  bb     u A , m , 1 + +  cid:30  b b w     A A , 1 ⊕     b w   .   u AB   ] u D     w D    − 1     m  m ,  c      cid:31  B , 1  cid:30  AA b       cid:31      u  , m   cid:30  ⊕  c  B     ]  cid:31  m ,     w b B  b A  , m      u  , 1  ⊕  b w B     , 1      cid:30   + − m 11  m  +  cid:30  u D b     B , 1 + +   b w D m B     1 ,  2  m  − 1  + u D b     B , m +  cid:30  w D   b B  m ,     2  m  − 1   12.18               506  ◾  MIMO Processing for 4G and Beyond  , 1  , 1        m ,  AB  =  b B  b A   cid:30   u      u      u      u      b A ].    u     , B 1  b w [ A  b [ A , 1  cid:30     It can be observed that the code bit polynomial cAB  ℓ  is given by the modulo-2   cid:30   sum of the information bit polynomials b AB m , b umB,    ] and b  Similarly, a code    bit  equal  to  the  modulo-2  sum  of  more  than  2  information  bits  can  be  calcu- lated  by  nesting  the  operation  in  Equation  12.18,  which  still  belongs  to  FM 2 .   Correspondingly, channel decoding is performed at the relay with respect to the  codeword cAB.  =   w b w     cid:30    b w m B ,  In [Wübben and Lang 2010] and [Wübben 2010], a modified SPA at the  relay is applied considering LDPC codes at the sources for the G-JCNC scheme.  The modified SPA is based on the investigations in [Kschischang et al. 2001]  and [Davey and Mackay 1998]. As shown in Figure 12.10 for the block diagram,  instead of the LLRs, the APPs are directly fed to the channel decoder in FM 2   and updated iteratively within the modified SPA. As a result, the APP vector  p =  is generated from the  decoding algorithm. Finally, PLNC is performed that maps the updated APPs  p to the binary code bit cR ℓ  in the relay codeword. Exemplarily, the mapping  rules are given by  ]  with  p  Pr{ c       i  i =  C AB  pM   cid:30   p 0  p 1  12 −  =  AB  y  }  [  R  c  R       cid:31   =  ⊕ cid:22  c A B       cid:31   =  if  arg max  p i  =  1 2 { , }   1   0   i  else      12.19   c  R       cid:31   =  ⊕ cid:22  c A B       cid:31   =   12.20   10   00          11  01  if  arg max  if  arg max  0 5 10 15 { , }  ,  ,  1 4,, { ,  11 14  ,  }  if  arg max  { , } 2 7 8 13  ,  ,  if  arg max  p i  { , 3 6 9 12  ,  ,  }  p i  p i  p i  =  =  =  =  i  i  i  i     for BPSK and for QPSK, respectively.  YR  APP  cAB ˆ  D  cR  PLNC  Figure  12.10  Block  diagram  for  generalized  joint  channel  decoding  and  physi- cal-layer network coding  G-JCNC . The estimation   cid:22 cAB  is mapped to the cor- responding network-coded signal after a channel decoding in  FM 2 .  and            Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  507  Compared  to  SCD  and  JCNC,  G-JCNC  takes  into  account  both  channel  codes from the sources and therefore is able to fully exploit the available informa- tion about the superimposed receive signal yR at the relay. This leads to improved  system performance, as can be observed in Section 12.4 later on. Since the decod- ing process is performed in FM 2  instead of in binary field for SCD and JCNC,  higher computational complexity is required for G-JCNC.  12.3  MIMO Detection Techniques The  APP-based  detection  and  decoding  schemes  presented  in  the  previous  sec- tion can be applied to systems with an arbitrary number of antennas J at the relay.  Specifically, introducing multiple antennas at relay R only influences the APP calcu- lations defined in Equation 12.9, whereas the decoding schemes based on the APPs  remain unchanged. However, when equipping J > 1 antennas at R, the MA phase  corresponds  to  a  2 × J  MIMO  channel,  which  allows  the  application  of  MIMO  processing techniques. In the sequel, several common multilayer MIMO detection  techniques are applied to two-way relaying networks with two time slots, which esti- mate cA and cB explicitly from the received signal yR. Network coding is then applied   cid:22  to generate the relay codeword cR c  for broadcasting. Although common  B MIMO detection techniques also fall into the category “separated channel decod- ing” presented in Section 12.2.2, since cA and cB are individually estimated, the  term “SCD” still indicates the APP-based scheme exclusively. Note that the MIMO  detection techniques are applied independently to PLNC in this chapter. Alternative  schemes with joint consideration of MIMO detection and PLNC are referred to  [Zhang and Liew 2010, Chung et al. 2012, and Zhang et al. 2012].  ⊕ cid:22  c A  =  12.3.1  Linear Equalization For linear equalization  LE  schemes, the receive signal vector yR is filtered by a  2 × J matrix g, resulting in the filtered signal vector   cid:31   The  x filter matrix g for linear detectors employing the zero-forcing  ZF  or minimum  mean squared error  MMSE  criteria are given as   cid:31  ] x T B  Gy  =  =   cid:31  x  [  .  R  R  A  G =  +  +  h h       = =       H  h h h h h h  −   1 −   1  H  H  H  ZF MMSE  .     Here, the operator  ⋅ + denotes the pseudo-inverse of a matrix. Note that MMSE  corresponds to ZF for the extended system, which has an extended channel matrix  h of dimension   J + 2  ×2   12.21    12.22   H  =   H  σ n 2 I       .               508  ◾  MIMO Processing for 4G and Beyond  Furthermore, the receive signal vector also has to be extended for MMSE to fit   the dimension as  The corresponding estimation errors of different layers are determined by the   diagonal elements of the error covariance matrix Φ, which is given by  y  R  =  y 0      R  ×2 1  .         Φ =  σ    σ   2 n 2 n       H  −   1 h h −   1 h h  H  ZF MMSE  .      12.23    12.24         R  R  R  R  =  =  + H y  + H y   for ZF or   cid:31 x  Applying the filtering matrix to the receive signal vector, the filtered signal vec-  for MMSE of dimension 2 × 1 contains  tor   cid:31 x the estimated messages for xA and xB in each layer, respectively. When ZF is per- formed, the cross-layer interference is removed completely with greater noise ampli- fication. For MMSE, a compromise between the interference and the amplified  noise is achieved. Subsequently, the filtered signal   cid:31 xR is demodulated and decoded  for both layers to estimate the source codewords  cid:22 c A  and  cid:22 cB, separately. This further  leads to the relay codeword c   cid:22   for broadcasting. c B  ⊕ cid:22  c A  =  R  12.3.2  Successive Interference Cancellation The linear estimation schemes detect different layers in parallel. Alternatively, the  layers can be detected successively, where the cross-layer interference resulting from  the layer already detected in the layer to be detected is reconstructed and elimi- nated. Such a nonlinear detection technique is termed successive interference can- cellation  SIC . In this section, we emphasize on SIC based on QR decomposition   QRD  of the channel matrix [Wübben et al. 2003].  Employing QR matrix decomposition, the 2 × J channel matrix h in the MA  phase can be decomposed into h = qr, where q denotes a J × 2 matrix with ortho- normal columns and r denotes a 2 × 2 upper triangular matrix. The matrix qH is  used  as  the  filter  matrix,  yielding   cid:31 x .  Owing  to  the  upper  triangular  structure of r, the second layer of the filtered signal vector  cid:31 xR is free of interference.  This estimated symbol is decoded and then used to reconstruct the interference  contributing to the first layer. After subtracting this cross-layer interference, com- mon decoding is performed to the first layer. In this way, the source codewords cA  and cB are estimated successively, which are further network coded to generate the  relay codeword cR broadcasted in the BC phase. Note that the above SIC approach  with QRD is based on the ZF criterion as the interference is completely removed   Q y  =  H  R  R      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  509  in the second layer. When the MMSE criterion is considered, QRD is applied to  the extended channel matrix as H QR=  while the subsequent operations are per- formed according to Q  and R instead.  Since erroneous decisions of the layer detected first will propagate to the second  detection step, the performance of SIC can be improved by first detecting the layer  with higher reliability. Note that for OFDM systems with channel coding applied  to each OFDM symbol, the same detection order is required on all subcarriers.  For such an ordered SIC  OSIC  detection scheme, we take the ordering criteria  based  on  SINR  optimization  from  [Wübben  and  Kammeyer  2006]  for  perfor- mance evaluations later on. With this concern, the layer with the smaller averaged  estimation error φκ over all subcarriers of one OFDM symbol is detected first. Here,  φκ is defined as     φκ  =  [  ΦΦ    cid:31  ] κ κ ,  ,  L  ∑1 1L  =   cid:31       12.25   with Φ ℓ  denoting the error covariance matrix on the ℓth subcarrier defined in  Equation 12.24. The operator [⋅]κ,κ indicates the κth diagonal term of a squared  matrix with κ = 1,2.  12.4  Performance Analysis For performance evaluations, a two-phase two-way relaying system is considered  where the relay is located in the middle of the two sources and the three nodes  are on a line. In the link-level simulations, all links are assumed to be multipath  Rayleigh block fading with NH = 5 normalized equal power taps in time domain.  In  order  to  ease  the  equalization  efforts  for  such  frequency  selective  channels,  OFDM is applied for all transmissions, where each OFDM symbol is individu- ally encoded by an optimized LDPC code and contains L = 1024 subcarriers with  QPSK  modulation.  The  optimized  degree  distributions  of  the  LDPC  code  are  achieved from [Urbanke 2010] and the progressive edge growth  PEG  algorithm  [Hu  et  al.  2005]  is  performed  to  construct  the  parity-check  matrix.  This  code  with both a medium code rate  RC = 0.5  and a high code rate  RC = 0.875  is  considered. Additionally, a maximum number of 100 iterations are employed for  both binary and nonbinary channel decoding. The iterative decoding process is  terminated when the parity-check condition is fulfilled or the maximum num- ber of iterations is reached. For performance evaluations, the dependency of the  2σ n  assuming normal- frame error rate  FER  for the relay codeword on SNR ized transmit power at both sources is presented for the detection and decoding  schemes investigated in Sections 12.2 and 12.3.   = 1      510  ◾  MIMO Processing for 4G and Beyond  12.4.1  Single-Antenna Relay For the single-antenna relay scenario, the FER performance of the relay codeword  for the APP-based detection and decoding schemes presented in Section 12.2 is  shown in Figure 12.11. It can be observed that G-JCNC achieves the best perfor- mance due to full exploitation of both channel codes from the sources. When an  LDPC code of medium rate RC = 0.5 is applied, P-SCD performs approximately  1 dB better than JCNC. This is because P-SCD produces for the individual code  bits LLRs with larger amplitude compared to JCNC for the XOR code bits, as  demonstrated by the LLR distributions in Figure 12.8c. Therefore, P-SCD is more  capable of exploiting the coding gain from the frequency selective fading channel  environment compared to JCNC. Furthermore, S-SCD improves the performance  by approximately 2 dB in contrast to P-SCD and is still 1 dB worse than G-JCNC.  For a high code rate scenario, for example, RC = 0.875, JCNC approaches P-SCD  with a very slight performance degradation as shown in Figure 12.11b, whereas  G-JCNC still achieves tremendous performance gain.  12.4.2  Multiple-Antenna Relay When the relay employs multiple antennas, the common multilayer MIMO detec- tion techniques can be applied in addition to the APP-based schemes to estimate the   cid:22  source messages separately, which is followed by network coding as cR c .  B In Figure 12.12, the FER performance at the relay is presented for several common  multilayer MIMO detection techniques demonstrated in Section 12.3 with J = 2  antennas at the relay. It is shown that MMSE outperforms ZF and SIC outperforms  LE in general. It is also well known and verified in the figure that the MMSE-OSIC  scheme  with  ordering  criterion   12.25   achieves  significant  performance  gain  in   ⊕ cid:22  c A  =  RC = 0.5  RC = 0.875   a   100  R @ R E F  10–1  10–2   b   100  R @ R E F  10–1  10–2  P-SCD S-SCD JCNC GJCNC 4 6  8 SNR  10–3  0  2  10  12  14  16  8  10  12  16  18  20  22  10–3  6  14 SNR  Figure  12.11  FER  performance  of  the  estimated  relay  codeword  for  APP-based  schemes. The relay is equipped with J = 1 antenna. The code rate is RC = 0.5 in  a   and RC = 0.875 in  b .      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  511  RC = 0.5  RC = 0.875   a   100  R @ R E F  10–1  10–2  ZF-LE MMSE-LE ZF-SIC MMSE-SIC ZF-OSIC MMSE-OSIC  10–3  –4  –2  0  6  8  10  10–3  2  2  4  SNR  4  6  8  12  14  16  18  10 SNR  Figure 12.12  FER performance of the estimated relay codeword for common mul- tilayer MIMO detection techniques. The relay is equipped with J = 2 antennas.  The code rate is RC = 0.5 in  a  and RC = 0.875 in  b .  contrast to the other schemes for both the medium and high code rate scenarios,  which is employed for comparison with the APP-based schemes subsequently.  In Figure 12.13, the FER performance of the APP-based schemes is compared  to MMSE-OSIC when the relay is equipped with J = 2 antennas. In contrast to  Figure 12.11, the performance loss of P-SCD to G-JCNC is getting smaller with  increasing number of antennas at the relay. Furthermore, MMSE-OSIC approaches  G-JCNC for the medium code rate case with RC = 0.5 but requires less computa- tional complexity. However, the performance degrades significantly for the high   RC = 0.5  RC = 0.875   b   100  R @ R E F  10–1  10–2   b   100  R @ R E F  10–1  10–2   a   100  R @ R E F  10–1  10–2  P-SCD JCNC G-JCNC MMSE-SIC  2 SNR  10–3  –4  –2  0  4  6  8  2  4  8  10  12  10–3  0  6 SNR  Figure  12.13  FER  performance  of  the  estimated  relay  codeword  for  APP-based  schemes and MMSE-OSIC. The relay is equipped with J = 2 antennas. The code  rate is RC = 0.5 in  a  and RC = 0.875 in  b .      512  ◾  MIMO Processing for 4G and Beyond  rate scenario, which indicates that the code rate results in dramatic influence on the  system performance for different schemes.  Acknowledgment This work was supported in part by the German Research Foundation  DFG  under  grant Wu 499 8-1 within the priority program “Communication in Interference  Limited Networks  COIN ,” SPP 1397.  References Ahlswede,  R.,  Cai,  N.,  Li,  S.-Y.R.,  and  Yeung,  R.W.,  Network  information  flow,  IEEE   Transactions on Information Theory, 46 4 , 1024–1016, July 2000.  Alamouti, S.M., A simple transmit diversity technique for wireless communications, IEEE   Journal on Selected Areas in Communications, 16 8 , 1451–1458, October 1998.  Chung, H.-H., Kuo, S.-H., and Lin, M.-C., A physical-layer network coding scheme based  on  linear  MIMO  detection,  IEEE  75th Vehicular Technology  Conference   VTC’12— Spring , Yokohama, Japan, May 2012.  Davey,  M.C.  and  Mackay,  D.,  Lowe  density  parity  check  codes  over  GF q ,  IEEE   Communications Letters, 2 6 , 165–167, June 1998.  Fragouli,  C.,  Boudec,  J.Y.,  and  Widmer,  J.,  Network  coding:  An  instant  primer,  ACM   SIGCOMM Computer Communication Review, 36 1 , 63–68, March 2006.  Hassibi B. and Hochwald, B.M., High-rate codes that are linear in space and time, IEEE   Transactions on Information Theory, 48 7 , 1804–1824, July 2002.  Hu, X.-Y., Eleftheriou, E., and Arnold, D.M., Regular and irregular progressive edge-growth  tanner  graphs,  IEEE  Transactions  on  Information  Theory,  51 1 ,  386–398,  January  2005.  Katti, S.R., Rahul, H., Hu, W., Katabi, D., Medard, M., and Crowcroft, J., XORs in the air:  Practical wireless network coding, Conference on Applications, Technologies, Architectures,  and Protocols for Computer Communications  ACM SIGCOMM , Pisa, Italy, September  2006.  Koike-Akino,  T.,  Popovski,  P.,  and  Tarokh,  V.,  Optimized  constellations  for  two-way  wireless  relaying  with  physical  network  coding,  IEEE  Journal  on  Selected  Areas  in  Communications, 27 5 , 788–796, October 2009.  Kschischang, F.R., Frey, B.J., and Loeliger, H.A., Factor graphs and the sum-product algo-  rithm, IEEE Transactions on Information Theory, 47 2 , 498–519, February 2001.  Pfletschinger,  S.,  A  practical  physical-layer  network  coding  scheme  for  the  uplink  of  the  two-way  relay  channel,  45th  Asilomar  Conference  on  Signals,  Systems  and  Computers   ASILOMAR’101 , Monterey, California, USA, November 2011.  Popovski, P. and Yomo, H., The antiPackets can increase the achievable throughput of a wire- less multiHop network, IEEE International Conference on Communications  ICC’06 ,  Istanbul, Turkey, June 2006.  Schmidt, A., Gerstacker, W., and Schober, R., Maximum SNR transmit filtering for deci- sion-feedback equalization in physical layer network coding, International Conference  on Systems, Communications and Coding  SCC’13 , Munich, Germany, January 2013a.      Physical-Layer Network Coding with Multiple-Antenna Relays  ◾  513  Schmidt, A., Gerstacker, W., and Schober, R., Optimal Tomlinson–Harashima precoding  for  physical  layer  network  coding,  IEEE  Wireless  Communications  and  Networking  Conference  WCNC’13  Workshop on New Advances for Physical Layer Network Coding,  Shanghai, China, April 2013b.  Tarokh, V., Jafarkhani, H., and Calderbank, A.R., Space-time block codes from orthogonal   designs, IEEE Transactions on Information Theory, 45 5 , 1456–1467, July 1999.  Tarokh, V., Seshadri, N., and Calderbank, A.R., Space-time codes for high data rate wireless  communication: Performance criterion and code construction, IEEE Transactions on  Information Theory, 44 2 , 744–765, March 1998.  To, D. and Choi, J., Convolutional codes in two-way relay networks with physical-layer  network  coding,  IEEE  Transactions  on  Wireless  Communications,  9 9 ,  2724–2729,  September 2010.  Urbanke, R., Degree distribution optimizer for LDPC code ensembles, http:  ipgdemos.epﬂ.  ch ldpcopt , 2010.  Wübben, D., Joint channel decoding and physical-layer network coding in two-way QPSK  relay systems by a generalized sum-product algorithm, 7th International Symposium on  Wireless Communication Systems  ISWCS’10 , York, UK, September 2010.  Wübben, D., Böhnke, R., Kühn, V., and Kammeyer, K.-D., MMSE extension of V-BLAST  based  on  sorted  QR  decomposition,  IEEE  58th  Vehicular  Technology  Conference   VTC’03—Fall , Orlando, Florida, USA, October 2003.  Wübben, D. and Kammeyer, K.-D., Low complexity successive interference cancellation for  per-antenna-coded MIMO-ODFM schemes by applying Parallel-SQRD, IEEE 63th  Vehicular Technology Conference  VTC’06—Spring , Melbourne, Australia, May 2006. Wübben, D. and Lang, Y., Generalized sum-product algorithm for joint channel decoding and  physical-layer network coding in two-way relay systems, IEEE Global Telecommunications  Conference  GLOBECOM’10 , Miami, Florida, USA, December 2010.  Xu, D., Bai, Z., Waadt, A., Bruck, G.H., and Jung, P., Combining MIMO with network  coding:  A  viable  means  to  provide  multiplexing  and  diversity  in  wireless  relay  net- works, IEEE International Conference on Communications  ICC’10 , Cape Town, South  Africa, May 2010.  Zhan, A. and He, C., Joint design of channel coding and physical network coding for wireless  network, International Conference on Neural Networks and Signal Processing, Zhejiang,  China, June 2008.  Zhang, S. and Liew, S.C., Channel coding and decoding in a relay system operated with  physical-layer  network  coding,  IEEE  Journal  on  Selected  Areas  in  Communications,  27 5 , 788–796, October 2009.  Zhang,  S.  and  Liew,  S.C.,  Physical-layer  network  coding  with  multiple  antennas,  IEEE  Wireless Communications and Networking Conference  WCNC’10 , Sydney, Australia,  April 2010.  Zhang, S., Liew, S.C., and Lam, P., Hot topic: Physical layer network coding, International  Conference  on  Mobile  Computing  and  Networking   MobiCom’06 ,  Los  Angeles,  CA,  USA, September 2006.  Zhang,  S.,  Nie,  C.,  Lu,  L.,  Zhang,  S.,  and  Qian,  G.,  MIMO  physical-layer  network  coding  based  on  V-BLAST  detection,  2012  International  Conference  on  Wireless  Communications & Signal Processing  WCSP’12 , Huangshan, China, October 2012.       Index  AMPS, see Advanced mobile phone system   Basic linear algebra subprograms  BLAS ,   A  AAS, see Advanced antenna systems  AAS  Active sets, 28 Adaptive modulation and coding  AMC , 5 Additive white Gaussian noise  AWGN , 49,   494  spectral density function, 260 weight distribution use, 172  ADSL, see Asynchronous digital subscriber line    ADSL   Advanced antenna systems  AAS , 8 Advanced mobile phone system  AMPS , 2 Alamouti scheme, 11, 52  B  IB-DFE for, 396 MIMO, 380–381 STBC scheme, 386–387  AMC, see Adaptive modulation and coding    AMC    AMPS   Angle-of-arrival  AoA , 350, 421  localization, 368  Angle-of-departure  AoD , 421 Antenna switch  AS , 16 A posteriori probability-based detection   APP-based detection , 495;  see also Physical-layer network  coding  PLNC   calculation, 495 element-wise XOR combination, 496 LLR, 498 mapping rules, 497, 498 noise-free receive signal constellation, 496 SCD, 499–501  APP-based detection, see A posteriori   probability-based detection  APP- based detection   ARQ, see Automatic repeat request  ARQ  AS, see Antenna switch  AS  Asynchronous digital subscriber line    ADSL , 7  Automatic repeat request  ARQ , 51, 379  Hybrid-ARQ techniques, 380 soft packet combining, 384–386  AWGN, see Additive white Gaussian noise    AWGN   Backwards transformation, 77 Base station  BS , 5, 212  BS cooperation, 25 CoMP transmission, 25, 26–28 downlink BS, 26 macro-diversity, 28–30  282  BC phase, see Broadcast phase  BC phase  Beamforming  BF , 21, 417  output and input signal, 23 transmitter, 22 weighted elementary signals, 22  Beam pattern, 359, 360  impact on practical systems, 362–363 for UWB antenna array, 361  Belief propagation algorithm, see Iterative sum-  product algorithm  Bell Laboratory layered space–time    BLAST , 212  BER, see Bit error rate  BER  BF, see Beamforming  BF  Binary phase shift keying  BPSK , 261, 345 Bit error rate  BER , 8, 68, 129, 172  for fixed channel, 401  515   516  ◾   Index  Bit error rate   Continued   linear precoders for minimizing, 130 for low-power and high-power users, 242 for MF, 335, 336 for MMSE, 333, 336, 338, 377 performance of WiMedia OFDM   system, 364  of SIC or PIC receiver, 241 for single packet transmission, 397 for uncorrelated channel, 400 for ZF, 325–332, 336, 338, 377 Bits per channel use  BPCU , 484 BLAS, see Basic linear algebra subprograms   BLAST, see Bell Laboratory layered space–time    BLAS    BLAST   BLER, see Block error rate  BLER  Block-circulant matrices, 291 block-diagonal matrix, 292 block-FFT, 294 block-Fourier matrix, 291, 293, 297 Hermitian positive-definite, 297, 299 least squares solution, 293 Q × Q matrix N multiplications, 295 triangular matrix inversion, 296  Block-diagonal system partitioning, 282  block-Fourier algorithm, 306–310 channel changing speeds, 287 without overlapping, 286 with overlapping, 287 pseudo-code for, 288 relative error, 286, 289, 290  Block-fast Fourier transform  Block-FFT , 294 Block-Fourier algorithm, 288; see also Gauss   algorithm  circulant matrices, 288–291 diagonalizing circulant matrices, 288–291 with partitioning, 306–310 pseudo-codes of, 297, 298, 306 for ZF algorithm, 334  Block-Fourier matrix, 291, 319 Block-Fourier partitioned algorithm  constant channels, pseudo-code for,   number of operations, 313–314 for steady channels, 320, 321 unsteady channels, pseudo-code for,   311, 312  315, 316  for unsteady channels, 322, 323  Block error rate  BLER , 418  Es No MIMO, QPSK, urban  macrochannel vs., 421  for MMSE, 333 for SISO QPSK transmission, 206  Block fading model, 71 BPCU, see Bits per channel use  BPCU  BPM, see Burst-position modulation  BPM  BPSK, see Binary phase shift keying  BPSK  Broadcast phase  BC phase , 493 BS, see Base station  BS  Burst-position modulation  BPM , 345  C  C-SPC design, see Conventional SPC design    C-SPC design   Carbon footprint reduction, 39 Carrier–interference ratio  C I , 412 Cauchy–Schwarz inequality, 261 CBR, see Constant bit-rate  CBR  CDF, see Cumulative distribution function   CDMA, see Code division multiple access    CDF    CDMA   Cell-edge performance, 426, 432, 435 Cellular network  advanced, 24–25 conventional, 33 first generation, 2 second generation, 2 virtual, 33  Cellular system evolution; see also Multiple-  input–multiple-output system   MIMO system   cellular network generations, 2 4G, 4 IMT-Advanced, 9 LTE-Advanced, 9 3GPP releases, 3 from 3G systems, 5–6 WiMAX—IEEE802. 16, 7–8  Centralized architecture, 27 Central port, 32 Channel coding, 170  CTC, 170–172 LDPC codes, 172–175  Channel decoder, 179  LDPC decoder, 181–184 turbo decoder, 179–181  Channel estimation, 184; see also Iterative   channel estimation  distortion, 184 frame structure for MIMO-OFDM   transmission, 185      receiver steps, 186 training symbols, 185  Channel hardening, see Channel   orthogonalization  Channel impulse response  CIR , 28, 349,   423  Channel model creation process, 423 Channel orthogonalization, 452 Channel quality indicator  CQI , 334, 431 Channel reciprocity, 121 Channel state information  CSI , 11, 120–121,   Channel state information at receiver   capacity with CSIR, 70–73  Channel state information transmitter   451, 468   CSIR , 70   CSIT , 53  Channel transfer function, 353 ChIR, see Channel impulse response  CIR  C I, see Carrier–interference ratio  C I  CIR, see Channel impulse response  CIR  CLLL algorithm, see Complex-LLL algorithm    CLLL algorithm   Closed subscriber group  CSG , 407 Closest vector problem  CVP , 48, 74 Co-channel deployment, 407 Code division multiple access  CDMA , 2 Code division multiple access  CDMA , 213 Coded pseudorandom-code division multiple   access  CS-CDMA , 254  Code spread  CS , 254 Column-Cholesky algorithm, 279 Communication model, 475  overall achievable rate region, 478 SPC scheme, 477 system model, 476 three-node MIMO two-way relay   Complex-LLL algorithm  CLLL algorithm ,   channel, 475  99, 102  Complex lattice reduction, 100  CLLL, 102 complex channel matrix, 101 round   function, 103  Complex rotation matrices  CRM , 160,   199–200  CoMP transmission, see Coordinated   multipoint transmission  CoMP  transmission   Configurable virtual cell sizes, 32–33 Constant-channel conditions, 304–306 Constant bit-rate  CBR , 431  Index  ◾  517  Control unit  CU , 27 Conventional SPC design  C-SPC design ,   478  Convolutional turbo codes  CTC , 170  BER performance, 172 block pseudorandom interleaver, 171–172 feed-forward and feedback connections,   170, 171  LTE-Advanced turbo encoder scheme, 171 RSC codes, 170  Coordinated multipoint transmission  CoMP   transmission , 24, 25, 160, 414;  see also Multilayer transmission  centralized and distributed  architectures, 27, 28  downlink deployment scenarios, 414–417 with downlink MIMO, 27 intercell interference mitigation, 26 MU-MIMO, 27 network operation categories, 417  Coordinated scheduling and beamforming    CS CB , 417 CP, see Cyclic prefix  CP  CQI, see Channel quality indicator  CQI  Cramer–Rao-lower-bound  CRLB , 367 CRC bits, see Cyclic redundancy check bits   CRLB, see Cramer–Rao-lower-bound    CRC bits    CRLB   CRM, see Complex rotation matrices  CRM  CS-CDMA, see Coded pseudorandom- code division multiple access   CS-CDMA  CS, see Code spread  CS  CS CB, see Coordinated scheduling and   beamforming  CS CB   CSG, see Closed subscriber group  CSG  CSI, see Channel state information  CSI  CSIR, see Channel state information at receiver    CSIR   CSIT, see Channel state information   transmitter  CSIT   CTC, see Convolutional turbo codes  CTC  CU, see Control unit  CU  Cumulative distribution function  CDF , 503  of absolute LLRs, 503, 504 of throughput, 431–432, 434–436, 438  Curse of dimensionality, 75 CVP, see Closest vector problem  CVP  Cyclic lattices, 57 Cyclic prefix  CP , 162, 164, 213, 381 Cyclic redundancy check bits  CRC bits , 420      518  ◾   Index  D  D-BLAST, see Diagonal Bell Labs layered   space–time  D-BLAST   DAC, see Digital-to-analog conversion  DAC  Data multiplexed pilots, 189  frame structure for MIMO-OFDM   transmission, 185  MIMO 16-HQAM transmission   performance, 193  DCS, see Dynamic cell selection  DCS  DC techniques, see Diversity combining   techniques  DC techniques  Decision feedback equalizers  DFE , see   Iterative block–decision feedback  equalization  IB-DFE   Decode-forward-based approach  DF-based   approach , 495  Denoise-and-forward  DNF , 492 Derandomized sampling algorithm, 198 DF-based approach, see Decode-forward-based   approach  DF-based approach   DFE, see Decision feedback equalizers  DFE  DFT, see Discrete Fourier transform  DFT  Diagonal Bell Labs layered space–time    D-BLAST , 53  Different pseudorandom-code division multiple   access  DS-CDMA , 253, 254  MIMO, 265–267 receiver scheme, 255, 257  Digital-to-analog conversion  DAC , 162 Digital video broadcast  DVB , 4, 160 Digital video broadcast Terrestrial    DVB-T , 39 Dirac delta function, 350 Direct-sequence  DS , 251 Dirty paper coding  DPC , see Precoding   lattices, optimal  Discrete Fourier transform  DFT , 13,   288, 382  conjugate transpose, 166 N × N, 165 nonorthonormal, 289, 292, 294 orthonormal, 288  Discrete Gaussian distribution, 104 Distributed architecture, 28 Diversity-multiplexing trade-off  DMT ,   50, 52  Diversity combining techniques  DC   techniques , 18, 380  Diversity order, 49–51 Diversity order factor  DOF , 264  DL-SCH, see Downlink shared channel   DMT, see Diversity-multiplexing trade-off    DL-SCH    DMT   DNF, see Denoise-and-forward  DNF  DOF, see Diversity order factor  DOF  Double-directional channel model, see System-  level simulation  SLS   Downlink shared channel  DL-SCH , 407 DPS, see Dynamic point selection  DPS  DS-CDMA, see Different pseudorandom-  code division multiple access   DS-CDMA   DS, see Direct-sequence  DS  Dual ELR-shortest-longest-basis-aided MMSE   sorted-variance SIC  D-ELR-SLB- aided MMSE SV-SIC , 463  Dual lattice, see Primal lattice DVB-T, see Digital video broadcast Terrestrial    DVB-T   DVB, see Digital video broadcast  DVB  Dynamic cell selection  DCS , 417 Dynamic point selection  DPS , 417  E  E-MBMS, see Evolved multimedia broadcast  and multicast service  E-MBMS   E-UTRAN, see Evolved UTRAN    E-UTRAN   EC, see Equal channels  EC  ECMA, see European Association for  Standardizing Information  and Communication Systems   ECMA   Effective isotropic-radiated power  EIRP , 343  EIRP-constrained radiation, 363 spectral density, 347  EIRP, see Effective isotropic-radiated power    EIRP   Element-based lattice-reduction algorithms    ELR algorithms , 461 Elementary column operations, 60 ELR algorithms, see Element-based lattice-  reduction algorithms  ELR  algorithms  End wireless ports, 32 Energy efficiency in wireless communications,   39–41  EPC network, see Evolved packet core network    EPC network  Equal channels  EC , 397      Equalization matrix  EM ; see also Wideband   Evolved multimedia broadcast and multicast   code division multiple access   W-CDMA   algorithms for exact solution, 275 application to ZF detector, 299–304 block-circulant matrices, 291–299 block-Fourier algorithm, 288, 300, 301,   306–310  circulant matrices, 288–291 column-Cholesky algorithm, 279 constant-channel conditions, 304–306 correlation matrix of EM, 276 EM, 277 enhanced algorithms for solving, 274 floating point operations, 277, 278, 283 Gauss algorithm, 278 LMMSE detector, 314–319, 333 matrix reordering, 274–275 MMSE block-Fourier partitioned   algorithm, 320, 321, 322, 323  optimizations, 277 optimized Cholesky algorithm, 280, 284 partial Cholesky approximation, 282 partitioning, 282–288 relative error, 302, 303 resulting matrix structure, 281 SCA matrix line reordering, 276 T matrix, 302 for two-tap channel, 274 U matrix, 285 for unsteady channel, 310–314 zero-forcing results, 319–333  Equalization techniques, 334  BER for MMSE and ZF, 337 DL BER for MF, 335 MF results, 335 MMSE and ZF results, 335–337 UL BER for MF, 336 UL BER for MMSE and ZF, 338  European Association for Standardizing   Information and  Communication Systems   ECMA , 345  European Telecommunications Standards   Institute  ETSI , 7  Evaluation methodology, 417; see also   Multiple-input and multiple-output   MIMO   LLS, 418–421 MU-MIMO, 417–418 19-cell network topology, 418–419 SLS, 421–424  Index  ◾  519  service  E-MBMS , 6, 35  RNs, 36 television service, 307 transmission gaps in, 36  Evolved packet core network  EPC network ,   33, 406  Evolved UTRAN  E-UTRAN , 5 Exclusive-or  XOR , 492  F  Fade depth scaling, 355 Fairness  criterion of proportional, 445 and SC power split, 480–481  Fair throughput  FT , 431 Fast base station switching  FBSS , 8 Fast cell selection, 30 Fast Fourier transform  FFT , 383 FBSS, see Fast base station switching    FBSS    FCSD    FDD    FDE    FDM    FDMA   FCSD, see Fixed-complexity sphere decoding   FDD, see Frequency division duplexing   FDE, see Frequency-domain equalization   FDM, see Frequency-division multiplexing   FDMA, see Frequency division multiple access   FDM transmission, see Frequency domain   multiplexing transmission  FDM  transmission   FEC, see Forward error correction  FEC  Femtocells, 407 FER, see Frame error rate  FER  FFT, see Fast Fourier transform  FFT  FH, see Frequency hopping  FH  Fincke–Pohst method, 107, 108–109 Finite impulse response  FIR , 186 First generation of cellular networks  1G , 2 Fixed-complexity sphere decoding  FCSD , 108 Fixed assignment, 251 Fixed assignment multiple access techniques, 251  European 3G standard, 253 usage of CDMA advantages, 252 Forward error correction  FEC , 379 Fourth-generation cellular system  4G , 4 Frame error rate  FER , 509 Frequency-division multiplexing  FDM , 185      520  ◾   Index  Frequency-domain detection, iterative  average BER performances, 240, 241 complexity issues, 239 computation of receiver coefficients,   low-power and high-power users,   234–238  242, 243  for MIMO-SC, 232 performance results, 239–243 for pth user, 233 soft decisions, 238–239 system model, 232–234  Frequency domain equalization  FDE ,   Frequency division duplexing  FDD , 7,   160, 212  251, 406  2, 251  Frequency division multiple access  FDMA ,   Frequency domain multiplexing transmission    FDM transmission , 161  Frequency hopping  FH , 251 FT, see Fair throughput  FT   I  G  Gauss algorithm, 101  optimized, 278, 279 standard, 278, 333  Generalized joint channel decoding and  physical-layer network coding   G-JCNC , 505 decoding process, 507 encoding process, 505 LDPC codes, 506 Generator matrix, 137 Geometry factor, 425 Global system for mobile communications    GSM , 2  Golden code, 52 Gram matrix, 59, 71, 133  of dual lattice, 82 of HF, 132  Gram–Schmidt orthogonalization  GS   orthogonalization , 94–97  Grating lobe suppression, 362 Gray mapping  64-QAM with, 224, 228, 230 nonuniform 64-QAM modulation, 231 uniform 4-PAM constellation, 227, 229 uniform 8-PAM constellation, 221, 226  GSM, see Global system for mobile  communications  GSM   GS orthogonalization, see Gram–Schmidt   orthogonalization  GS  orthogonalization   H  Hadamard matrix  HM , 199 Half-power beam width  HPBW , 22 Hard handover  HHO , 8 Hermite–Korkin–Zolotarev  HKZ , 98 Hermite Normal Form  HNF , 61 HHO, see Hard handover  HHO  High-definition television  HDTV , 4 High-speed downlink packet access    HSDPA , 380  High-speed packet access  HSPA , 4 High-speed uplink packet access  HSUPA , 380 Hybrid automatic repeat request  HARQ , 419 Hybrid reuse  HR , 411  IB-DFE, see Iterative block–decision feedback   equalization  IB-DFE   IBI, see Interblock interference  IBI  IC, see Interference canceler  IC  ICIC, see Intercell interference cancelation   IDFT, see Inverse discrete Fourier transform    ICIC    IDFT   IEEE, see Institute of Electrical and Electronics   Engineers  IEEE   IEEE802.15.4 channel model, 352 IEEE 802.16–2004, 7 IEEE 802.16–2005, 7 IEEE 802.16d, see IEEE 802.16–2004 IEEE 802.16e, see IEEE 802.16–2005 IFFT, see Inverse fast Fourier transform  IFFT  IMT-Advanced  IMT-A , 4, 9  for IMT-Advanced candidate technologies   evaluation, 422  ITU-R IMT-Advanced MIMO channel   model, 421  Infinite set, 57 Information rate, 121  constrained capacity for MIMO   channel, 122 MIMO channel, 121 optimal transmission, 123 practical transmission system, 124 Institute of Electrical and Electronics   Engineers  IEEE , 7      Inter-radio access technologies  RAT , 406 Interblock interference  IBI , 163 Intercell interference cancelation  ICIC , 9, 426 Intercell interference coordination schemes,   410–411  Interference canceler  IC , 187 International Telecommunications Union–  Radio communications  ITU-R , 4  Intersymbol interference  ISI , 10, 54, 163,   187, 212, 250, 251, 382  Intracell interference, 5–6 Inverse discrete Fourier transform  IDFT ,   13, 382   ISIC   Inverse fast Fourier transform  IFFT , 162 ISI, see Intersymbol interference  ISI  ISIC, see Iterative soft interference cancelation   Iterative block–decision feedback equalization    IB-DFE , 213, 217, 379  ARQ technique for SC-FDE, 383 average value of bits, 228 coded BER performance, 231 computation of receiver parameters,   225–228  correlation coefficient, 219 evolution of LLR, 227 frequency-domain turbo equalizer, 220 hard decisions, 220 M-PSK constellations, 224–225 mapping, 222–223 multiresolution system, 221, 222 nonuniform 64-QAM modulation, 231 PAM constellations, 223–224 performance results, 228–231 QAM constellations, 224 receiver structure and alternative format, 384 with soft decisions, 219–220, 226 structure, 217, 218 uniform 64-QAM with Gray   mapping, 230  Iterative channel estimation, 189 data multiplexed pilots, 189 frequency channel response, 192–193 implicit pilots, 189–195 MIMO-OFDM transmission, 190 MPB curves, 195 simulation parameters, 194  Iterative soft interference cancelation  ISIC ,   459–460  ITU-R, see International Telecommunications   Union–Radio communications   ITU-R   Index  ◾  521  Joint channel decoding, 501  graphical illustration, 502, 503 LLR calculation for, 502 LLR distributions, 503–505 noise-free receive signal constellation, 504 for PLNC, 501  Joint channel decoding and physical-layer   network coding  JCNC , 501  Joint processing  JP , 417 Joint transmission  JT , 417  K-best detectors, 458–459 Karush–Kuhn–Tucker  KKT , 129 Korkin–Zolotarev reduction  KZ   reduction , 460  Kronecker model, 69  J  K  L  L3 algorithm, see Lenstra–Lenstra–Lovász   algorithm  LLL algorithm   Large-scale parameters  LS parameters , 422 LAST, see Lattice space–time  LAST  Lattice-reduction-aided detection  LRA  detection , 77, 94, 97; see also  Optimal detection and complexity;  Zero-forcing detection  ZF  detection   complex lattice reduction, 100–103 Gauss algorithm, 101 K-best algorithms, 462 LLL, 100 M-QAM constellations, 99 MIMO detection with, 98 orthogonality defect, 98 reduced basis, 97  Lattice-reduction-aided linear detectors  LRA   LD , 460–461  Lattice-reduction-aided receivers, 195; see also   Receivers, iterative  performance results, 197–198 soft metrics from, 195–197  Lattices, 54, 136; see also Multiple-input   multiple-output  MIMO ;  Precoding for MIMO  complex-valued matrices and vectors, 137 discrete Abelian, 57 dual lattice, 62–65      522  ◾   Index  Lattices   Continued   elementary operation, 61 equivalent lattices, 60–61 fundamental region, 58 generator vectors, 56 Gram matrix, 59 hexagonal lattice, 138 names of analogous techniques, 55 orthogonal matrix, 60 precoding, 138–139 rules, 58 shortest vector, 62 squared minimum distance, 137 successive minima, 62 unimodular matrix, 60 unimodular transformations, 61 unitary matrix, 60 volume, 59–60 Voronoi region, 58–59  Lattice space–time  LAST , 52 Layered space–time receivers  LST receivers ,   233  Layers, 53 LD, see Linear detector  LD  LDC, see Linear dispersion code  LDC  LDPC, see Low-density parity-check code    LDPC   LE, see Linear equalization  LE  Lenstra–Lenstra–Lovász algorithm  LLL   algorithm , 56, 100  Limited feedback precoding, 130 Line-of-sight  LOS , 8, 423 Linear channels, precoding for, 124; see also   Lattices  linear precoding, 125–126 multiuser broadcast channel, 126–127 nonlinear precoding, 126–127  Linear detector  LD , 457–458 Linear dispersion code  LDC , 494 Linear equalization  LE , 507 Linear precoders, 127  without CSI, 130–131 for linear receivers, 127–128 for maximizing minimum distance,   131, 136  for minimizing BER, 130 for ML receiver, 128–130  Linear precoding, 125–126 Linear receivers, 77  MMSE, 177 optimal linear precoders for, 127–128  Linear transformation, 77  Link-level simulation  LLS , 418; see also  System-level simulation  SLS   BLER, 420, 421 Es No MIMO, 421 urban macropropagation channel, 419  LLL algorithm, see Lenstra–Lenstra–Lovász   algorithm  LLL algorithm   LMMSE detector, 314  block-circulant version, 314 block-diagonal matrix, 319 using block-Fourier transform, 318  Local neighborhood search methods, 462–463 Log-likelihood ratio  LLR , 180, 182, 219,   385, 498  Long-term evolution  LTE , 2, 4, 406, 450  air interface, 5 all-IP architecture, 6 eMBMS, 6 femtocell concept, 407 LTE-Advanced, 9 relay architecture for, 35 LOS, see Line-of-sight  LOS  Low-density parity-check code  LDPC , 49,   124, 170, 492 Hamming code, 173 parity check matrix, 172 WiMax, 174  LRA detection, see Lattice-reduction-aided   detection  LRA detection   LRA LD, see Lattice-reduction-aided linear   detectors  LRA LD   LS parameters, see Large-scale parameters   LST receivers, see Layered space–time receivers    LS parameters    LST receivers   LTE-Advanced  LTE-A , 4, 9, 160, 170  MU-MIMO, 417–418 performance enhancement techniques, 426 RN architecture, 34, 35 3GPP, 185 turbo encoder scheme, 171  LTE, see Long-term evolution  LTE   M  M-QAM constellations, 99, 196, 224 MA, see Multiple access  MA  MABC protocol, see Multiple access broadcast   protocol  MABC protocol   MAC, see Medium access control  MAC  Macro-diversity, 28  fast cell selection, 30      global CIR, 29 OFDM, 30 two-path channel benefit, 29  Macrodiversity handover  MDHO , 8 MAI, see Multiple access interference  MAI  MANET, see Mobile adhoc networking    MANET   MAP algorithm, see Maximum a posterori   algorithm  MAP algorithm   Massive MIMO, 450  CSI, 468 detection algorithms, 450 distributed, 454, 455 hardware implementation, 467–468 hardware issues, 468–469 MU-MIMO systems, 453, 454 mutual information, 455–456 precoding designs, 456–457 SU-MIMO systems, 452, 453 synchronization, 468 system model, 451–452  Matched-filter  MF , 253, 456 Matrix inversion lemma, 84 Matrix reordering, 274–275 Matrix’s diagonal width  MDW , 274 Matrix’s width  MW , 274 Max C I, see Maximum carrier-interference    MCI   Maximal ratio combining  MRC , 251 Maximum a posterori algorithm  MAP   algorithm , 181  Maximum carrier-interference  MCI , 431 Maximum likelihood-based soft output    MLSO , 178  Maximum likelihood  ML , 73 Maximum likelihood detector  MLD ,   Maximum likelihood sequence estimator   178, 452   MLSE , 20  Maximum ratio combining  MRC , 25, 52 Maximum SINR, see Maximum carrier-  MBMS, see Multimedia broadcast multicast   interference  MCI   service  MBMS   MBSFN, see Multimedia broadcast single   frequency network  MBSFN  MCI, see Maximum carrier-interference   MCS, see Modulation and coding scheme    MCI    MCS    MDHO   Index  ◾  523  MDW, see Matrix’s diagonal width  MDW  Medium access control  MAC , 7 Mercury waterfilling, 129, 151, 155 MF, see Matched-filter  MF  MFN, see Multifrequency network  MFN  Microwave imaging, 369  challenges, 372 electromagnetic properties, 371 limitations, 370–372 skin depth, 371 techniques, 369–370 of UWB MIMO system use, 369  MIMO-DFE, see MIMO decision feedback   equalizers  MIMO-DFE   MIMO, see Multiple-input–multiple-output   MIMO decision feedback equalizers  MIMO-   MIMO   DFE , 212  MIMO detection techniques, 48, 507  arithmetic operations, 465 capacity with CSIR, 70–73 diversity order, 49–51 ISIC, 459–460 K-best detectors, 458–459 with large arrays, 457 lattice-reduction-aided K-best   algorithms, 462  LD, 457–458 LE, 507–508 linear receivers, 77 local neighborhood search methods,   462–463  LRA detection, 97–103, 460–461 in MIMO spatial multiplexing, 73–76 MMSE, 82–89, 507 multiplexing gain, 49–51 optimally OSIC, 89–97 for other channels, 467 performance comparison, 109–110,   463–467  randomized lattice decoding, 103–105 real equivalent model, 69–70 SD, 105–109 SIC, 458–459, 508–509 signal processing, 48 for spatial multiplexing, 52–54 for STC, 51–52 system model, 65–69 traditional receivers, 76 ZF detection, 77–82   MMSE-LD , 458  MDHO, see Macrodiversity handover   Minimum-mean-square-error linear detector       524  ◾   Index  Minimum mean square error  MMSE , 19,  77, 421, 507; see also Wideband  code division multiple access   W-CDMA   block-Fourier partitioned algorithms,   320–323  274  downlink with equal scrambling, 268–269 equalization matrix for two-tap channel,   FDC coefficients, 382 matrix inversion lemma, 84 for MIMO DS-CDMA system, 265 MIMO receiver for W-CDMA, 272 orthogonality principle, 83 projection matrices, 87–89 receiver, 85, 177, 272–274 reception filter, 266 SCA matrix, 271–272 scrambling for transmit antennas, 270–271 system matrices, 267 transformation, 86  MISO, see Multiple input single output   ML, see Maximum likelihood  ML  MLD, see Maximum likelihood detector    MISO    MLD   MLSE, see Maximum likelihood sequence   MLSO, see Maximum likelihood-based soft   estimator  MLSE   output  MLSO   MMS, see Multimedia messaging service   MMSE-LD, see Minimum-mean-square-error   linear detector  MMSE-LD   MMSE, see Minimum mean square error    MMS    MMSE   Mobile adhoc networking  MANET , 40 Mobile terminal  MT , 212 Modulation and coding scheme  MCS , 420 Monte Carlo simulations, 482 Moore–Penrose  inverse  matrix, see Pseudo-  inverse matrix  Moore–Penrose inverse, 78 Moore–Penrose pseudo-inverse, 62 MPI, see Multipath interference  MPI  MPIC, see Multipath interference canceler    MPIC   MRC, see Maximal ratio combining  MRC ;  Maximum ratio combining  MRC   MT, see Mobile terminal  MT  MU-MIMO, see Multiuser multiple-input–  multiple-output  MU-MIMO   Multi-user detection  MUD , 54 Multicell transmission, 6  intra-BS, 30 in SFN, 6  Multifrequency network  MFN , 28 Multihop relay, 31  adaptive relaying, 31–32 configurable virtual cell sizes, 32–33 conventional cellular network, 33 for LTE-Advanced, 35 node in E-UTRAN, 34 using TDD, 31 in 3GPP, 33–37 transmission gaps in E-MBMS, 36 two-hop relaying, 32 virtual cellular network, 33  Multilayer transmission, 17 baseband equivalent, 19 increase of symbol rate, 17 linear detectors, 19 M × N multilayer MIMO, 17, 18 MLSE detector, 20 2 × 2 multilayer MIMO, 18  Multimedia broadcast multicast service   MBMS , 6; see also Evolved  multimedia broadcast and multicast  service  E-MBMS   configurable virtual cell sizes, 32 multiresolution transmission schemes, 37  Multimedia broadcast single frequency   network  MBSFN , 6, 407, 408  properties, 409–410 spatial geometry distribution, 428 spatial signal-to-interference-noise ratio,   429–430  transmissions, 408, 409  Multimedia messaging service  MMS , 4 Multipath fading, 353–356 Multipath interference  MPI , 251 Multipath interference canceler  MPIC , 250 Multiple-antenna relay, 510  APP-based schemes and MMSE-OSIC, 511 FER performance, 511 high rate scenario, 511, 512 MIMO detection techniques, 510 Multiple-input and multiple-output-  orthogonal frequency-division  multiplexing  MIMO-OFDM ,  199; see also Orthogonal frequency- division multiplexing  OFDM   BER performance, 206 BLER performance, 206      Multiple-input–multiple-output  MIMO , 4,   complex rotation matrices, 199–200 lattice-reduction-aided decoders, 205 PDF values, 204 receivers for, 200, 202 supersymbol’s samples, 203 transmitter for, 200, 201  10, 48, 250, 406, 474  advanced MIMO applications, 24 attributes, 406 beamforming, 21–23 BS cooperation, 25–30 C I, 412 CoMP with MU-MIMO, results for,   441–445 E-MBMS, 407 energy efficiency, 39–41 femtocells, 407 geometry factor distribution, 425 hexagonal cellular topology, 413 intercell interference coordination schemes,   410–411  key technologies, 406 MBSFN transmission, 408, 409, 428 MU-MIMO, results for, 437–441 multihop relay, 31–37 multilayer transmission, 17–20 multiple antenna configurations, 10, 11 multipoint transmission, 414–417 multiresolution transmission schemes,   37–39  multiuser, 23–24 open-loop transmitter, 12 PMP scenarios, results for, 426 PtP scenarios, results for, 430–436 SC-PMP transmission, 409 SDMA, 20–21 signals multiple propagation paths, 10 simulation results, 425 soft and hybrid reuse, 411 spatial signal-to-interference-noise ratio,   427–430 STBC, 11, 12–16 STD, 16–17 two-way relay channel, 474  Multiple access  MA , 2  bidirectional relaying systems, 493 communications, 251 fixed assignment, 251–252  Multiple access broadcast protocol  MABC   protocol , 474  Multiple access interference  MAI , 250  Index  ◾  525  Multiple input single output  MISO , 10  space–time coding, 12 STBC, 11  Multiplexing gain, 49–51 Multiresolution system, 221  IB-DFE, 222 transmitter structure for SC-FDE, 221  Multiresolution transmission, 37  in cellular system, 37 64-QAM, 38 QAM constellation, 39 scalable video transmission, 38  Multiuser broadcast channel, 126–127 Multiuser multiple-input–multiple-output   MU-MIMO , 23–24, 120, 232,  453–454  and massive MIMO, 451 MIMO broadcast channel downlink,   417–418  MW, see Matrix’s width  MW   N  O  Nearest vector problem, 49 Noise-free receive signal constellation, 496, 504 Nondeterministic polynomial hard  NP-hard ,   Nonlinear precoding, 126–127 Nonorthonormal rotation matrices  NCRM ,   457  199  Nordic mobile telephony  NMT , 2  OCRM, see Orthonormal rotation matrices    OCRM   OFDM, see Orthogonal frequency-division   multiplexing  OFDM   OFDMA, see Orthogonal frequency division   multiple access  OFDMA   1G, see First generation of cellular networks  1G  Open-loop transmit diversity, 11, 12; see also  Selective transmit diversity  STD   Optimal detection and complexity, 75; see  also Zero-forcing detection  ZF  detection ; Lattice-reduction-aided  detection  LRA detection   curse of dimensionality, 75 CVP, 76 nondeterministic polynomial complexity,   75, 76  NP-hard problems, 76      526  ◾   Index  Optimal Z matrix, 148–150 Optimization problem, 131 Gram matrix, 132, 133 theorem, 133–134  Optimized block-Fourier algorithm, pseudo-  codes for, 300, 301, 307  Optimized Cholesky algorithm; see also Gauss   algorithm  for EM, 280 floating point operations for, 280 Matlab code for, 284  ORBF, see Orthogonal random beamforming    ORBF   Ordered successive interference cancellation    OSIC , 48, 509; see also Successive  interference cancellation  SIC   error events in SIC, 93 GS orthogonalization, 94–97 nearest plane algorithm with sorting, 92 optimally, 89 OSIC implementation, 93 pseudo-inverse, 91 QR decomposition, 94–97 SIC decision region, 92 Voronoi region, 89 ZF matrix, 90  Orthogonal frequency-division multiplexing   OFDM , 160, 212, 344, 378, 494  channel coding, 170–175 iterative receivers, 186–195 lattice-reduction-aided receivers, 195–198 SISO-OFDM, 161–168 transmitter structure, 169–170  Orthogonal frequency division multiple access    OFDMA , 4, 406  Orthogonality principle, 83 Orthogonal matrix, 60 Orthogonal random beamforming  ORBF , 418 Orthogonal space–time block code  OSTBC ,   52, 494  Orthonormal rotation matrices  OCRM , 199 OSIC, see Ordered successive interference   cancellation  OSIC   OSTBC, see Orthogonal space–time block   code  OSTBC   P  P-SCD, see Parallel separated channel decoding   PA, see Power allocation  PA ; Power amplifier    P-SCD    PA   Packet combination with diversity; see  also Ultra wideband-based  communication systems  UWB- based communication systems   Alamouti STBC scheme, 386–389 channel definition, 391 conventional SC-FDE decoding, 390 dealing with fixed channels, 394–395 IB-DFE structure, 393 MIMO Alamouti code, 386 received signals time definition, 391  Packet error rate  PER , 397 PAPR, see Peak-to-average power ratio  PAPR  PAR, see Power ratio  PAR  Parallel interference cancelation receiver  PIC   receiver , 233, 239–241  Parallel separated channel decoding  P-SCD ,   501  Partial candidate of nth layer, 459 Partial Cholesky approximation, 282, 285 Path gain, 348, 367  mean, 354 in UWB wireless channel, 348–349  PDF, see Probability density function  PDF  PDSCH, see Physical downlink shared channel   PDU, see Protocol data unit  PDU  Peak-to-average power ratio  PAPR , 41 Peak-to-mean envelope power ratio  PMEPR ,    PDSCH   213, 378  PEG algorithm, see Progressive edge growth   algorithm  PEG algorithm   PER, see Packet error rate  PER  Per user unitary and rate control  PU2RC , 437 PF, see Proportional fair  PF  Phase shift keying  PSK , 66, 214  constellation, 224, 225  Physical-layer network coding  PLNC , 492  channel coefficients, 494 cooperation, 492 DF-based approach, 495 G-JCNC, 505–507 joint channel decoding and, 501–505 MIMO detection techniques, 507–509 performance analysis, 509–512 two-way relaying network, 493  Physical downlink shared channel  PDSCH ,   407  Physical uplink shared channel  PUSCH , 407 PIC receiver, see Parallel interference   cancelation receiver  PIC receiver   Pilot embedding, 40–41, 189      PLNC, see Physical-layer network coding    PLNC   PMEPR, see Peak-to-mean envelope power   PSK, see Phase shift keying  PSK  PtP, see Point-to-point  PtP  PU2RC, see Per user unitary and rate control   Index  ◾  527  Pulsed radar, 370 PUSCH, see Physical uplink shared channel    PU2RC    PUSCH   Q  QAM, see Quadrature amplitude modulation   QoS, see Quality of service  QoS  QPSK, see Quadrature phase shift keying    QAM    QPSK   QR decomposition  QRD , 508  GS orthogonalization and, 94–96 K-best detector, 458, 462 SIC on, 508 SQRD preprocessing, 463  16-quadrature amplitude modulation    16-QAM , 5, 38, 152  256-quadrature amplitude modulation    256-QAM , 344, 452  64-quadrature amplitude modulation    64-QAM , 5, 38, 228  BER performance, 206, 230, 231, 337 input constellations, 154 M-QAM constellation, 224 ML receiver tests, 153 mutual information per sub-carrier pair, 155  Quadrature amplitude modulation  QAM ,   66, 214  constellations, 224 M-ary, 66 MIMO SM concentration on, 66 multiplexing gain, 50 nonuniform, 39 uplink transmissions with, 457  Quadrature phase shift keying  QPSK , 5, 232,   250, 385 bits blocks, 38 BPSK and, 496, 497 with Gray mapping, 224 IB-DFE implementation, 214 LLR calculation for SCD with, 500 SISO-OFDM transmission with, 205, 206  Quality of service  QoS , 4, 9, 252  R  Radio access network  RAN , 406  ratio  PMEPR   PMP, see Point-to-multipoint  PMP  PN, see Pseudonoise  PN  Point-to-multipoint  PMP , 419 Point-to-point  PtP , 419 Poisson process, 352 Power allocation  PA , 479 Power amplifier  PA , 41, 468 Power ratio  PAR , 168 Power spectral density  PSD , 378 Precoder codebook, 130 Precoding for MIMO  linear channels, 124–127 linear precoder construction, 127–131 optimization problem, 131–134 results on optimal linear precoders, 135 status on precoders, 136 SU-MIMO, 120–124 suboptimal constructions, 134–135  Precoding lattices, optimal, 142, 456  lemma, 143–145 minimum distance region, 142 real-valued case, 142 Schläfli lattice, 145–148  Primal lattice  geometry, 63 hyperplanes identification, 65 Moore–Penrose pseudo-inverse, 62 in n dimensions, 64  Probability density function  PDF , 179, 204 Processing gain, 253 Progressive edge growth algorithm  PEG   algorithm , 509  Projection matrices, 87  orthogonal complement, 88 SNR relation factor, 88, 89  Proportional fair  PF , 437 Protocol data unit  PDU , 419 PSD, see Power spectral density  PSD  Pseudo-code  of block-Fourier algorithms, 297, 306 for block-Fourier partitioned algorithm,   311–312, 315–316  for optimized block-Fourier algorithm,   300, 301, 307  for partitioning with overlapping   algorithm, 288 Pseudo-inverse matrix, 78 Pseudonoise  PN , 164, 257      Received signal strength ranging  RSS   RSRQ, see Reference signal received quality   528  ◾   Index  Radio resource control  RRC , 407 Raised-cosine filter, 68, 239 RAKE receiver, 258, 263, 335 RAN, see Radio access network  RAN  Random access, 251 Randomized lattice decoding, 103  algorithm, 105 discrete Gaussian distribution, 104  RAT, see Inter-radio access technologies    RAT   RB, see Resource block  RB  Real equivalent model, 69–70 Real rotation matrices  RRM , 199 Received signal strength indicator  RSSI ,   406, 407  ranging , 353, 366  Receivers, conventional, 175, 176; see also  Orthogonal frequency-division  multiplexing  OFDM   channel decoder, 179–184 channel estimation, 184–186 MLD, 178 MMSE, 177 PDF values, 179 quantization operation, 178 V-BLAST, 177 ZF, 175  Receivers, iterative, 186  iterative channel estimation, 189–195 signal processing blocks, 186 structure, 188 turbo principle, 187  Recursive systematic convolutional codes    RSC codes , 170, 179, 180  Reduced basis, 97  LR, 98 and skewed basis, 97  Reference signal received power  RSRP , 406 Reference signal received quality  RSRQ , 406 Relative narrowband transmit power    RNTP , 411 Relaying, adaptive, 31–32 Relay node  RN , 31  adaptive, 31 BS and, 31 in E-UTRAN, 34 functionality in PLNC, 501 single-antenna, 492 SPC, 474 3GPP release 9, 33  Remote radio heads  RRHs , 414, 416, 417  Resource block  RB , 410, 411  coordination, 410, 411 PRB, 37  RM, see Rotation matrix  RM  RN, see Relay node  RN  RNTP, see Relative narrowband transmit   power  RNTP   Rotation matrix  RM , 200, 203 RRC, see Radio resource control  RRC  RRHs, see Remote radio heads  RRHs  RRM, see Real rotation matrices  RRM  RSC codes, see Recursive systematic   convolutional codes  RSC codes  RSRP, see Reference signal received power    RSRP    RSRQ    RSSI   RSSI, see Received signal strength indicator   RSS ranging, see Received signal strength   ranging  RSS ranging   S  SA, see Seysen’s algorithm  SA  S and C matrices; see also System matrices  downlink with equal scrambling,   268–269  transmit antennas and uplink  modifications, 270–271  SC-FDE, see Single-carrier with frequency- domain equalization  SC-FDE  SC-FDMA, see Single carrier–frequency   division multiple access   SC-FDMA   SC-PMP transmission, see Single-cell point-to- multipoint transmission  SC-PMP  transmission   SC-PTM, see Single cell–point to multipoint    SC-PTM    SC   SC, see Shifted channels  SC ; Single-carrier   Scalable video transmission, 38, 39 SCD, see Separated channel decoding  SCD  Schläfli lattice, 145–148 Schnorr–Euchner strategy  SE strategy , 107,   462  SCM, see Spatial channel model  SCM  Scrambling, 253  downlink with equal, 268–269 sequence of values, 255 spreading matrix and, 267, 426      transmit antennas and uplink  modifications, 270–271  SD, see Sphere decoding  SD  SDA, see Sphere decoding algorithms  SDA  SDMA, see Space division multiple access    SDMA   SDR, see Software defined radio  SDR  Second generation of cellular networks  2G of   cellular networks , 2  Selective transmit diversity  STD , 11  closed-loop TD, 16 with feedback indication, 17 using WCDMA signals, 16  Semistatic point selection  SSPS , 417 Separated channel decoding  SCD , 499;  see also Joint channel decoding  with BPSK, 500 graphical illustration, 499, 500 MA problem, 499 P-SCD, 501 with QPSK, 500 XOR-based network coding, 501  SER, see Symbol error rate  SER  SE strategy, see Schnorr–Euchner strategy  SE   Seysen’s algorithm  SA , 460–461 SF, see Spreading factor  SF  SFBC, see Space–frequency block codes  SFBC  SFFR, see Soft fractional frequency reuse   SFN, see Single-frequency network  SFN  Shifted channels  SC , 397, 399 Shortest vector problem  SVP , 54 SIC, see Successive interference cancellation    SFFR    SIC   35, 235, 382, 425  Signal-to-noise ratio  SNR , 11, 49, 216, 261,   382, 418, 501  degradation, 25 in SLS, 420 for uplink and downlink, 455 ZF-detected vector, 82  Signal space diversity  SSD , 199  on CRM, 160 MIMO-OFDM with, 199  SIMO, see Single input multiple output    SIMO   Single-antenna relay, 492, 510 Single-carrier  SC , 213 Single-carrier with frequency-domain   equalization  SC-FDE , 215, 378  Index  ◾  529  BER performance for, 217 DFT, 382 IB-DFE, 379, 382 linear FDE, 216 OFDM schemes, 215 SC-based block, 381  Single-cell point-to-multipoint transmission    SC-PMP transmission , 409  and MBSFN transmission, 409 spatial geometry distribution, 426 spatial SINR, 427, 428 Single-cell transmission, 6 Single-frequency network  SFN , 6, 28, 29 Single-user MIMO systems  SU-MIMO   systems , 23, 160, 452, 453  BLER performance, 420 CSI, 120–121 information rate, 121–124 results for PtP with, 431–436  Single carrier–frequency division multiple   access  SC-FDMA , 4, 406  Single cell–point to multipoint  SC-PTM , 6 Single input multiple output  SIMO , 10,   264, 363  OFDM , 161  all-zero guard period, 163 circulant matrix, 166 conjugate transpose operation, 165 using CP, 164 FDM transmission, 161, 162 using FFT, 167 using IFFT, 162 interblock interference, 163  Single input single output  SISO , 10, 49,   Singular-value decomposition  SVD , 70, 478 Singular matrix, 78 SINR, see Signal-to-interference plus noise   ratio  SINR   SISO-OFDM, see Single input single output-  OFDM  SISO-OFDM   SISO, see Single input single output  SISO ;   Soft-in, soft-out  SISO   Slicing, 77 Slow fading model, 71 SLS, see System-level simulation  SLS  SM, see Spatial multiplexing  SM  Small-scale  SS , 421 SNR, see Signal-to-noise ratio  SNR  Soft-in, soft-out  SISO , 220 Soft fractional frequency reuse  SFFR , 411  strategy   Single input single output-OFDM  SISO-  Signal-to-interference plus noise ratio  SINR ,   381, 474      530  ◾   Index  Soft output Viterbi algorithm  SOVA , 181 Soft reuse schemes, see Hybrid reuse  HR  Software defined radio  SDR , 9 Sorted QR decomposition  SQRD , 463 SOVA, see Soft output Viterbi algorithm    SOVA   Space-time trellis code  STTC , 52, 494 Space division multiple access  SDMA , 11  on improving capacity, 20 multiple antennas, 212 multiuser communication scheme, 437 to uplink, 21 V-BLAST detector, 20  Space–frequency block codes  SFBC , 13, 169 Space–time block coding  STBC , 11  Alamouti’s TD, 13 MIMO Alamouti code, 386 in OFDM systems, 169 STBC2, 13–14 STBC4, 14–16 TD technique, 12 with transmit and receive antenna, 387, 389  Space–time codes  STC , 51  detection for, 51–52 diversity providing, 381  Spatial channel model  SCM , 421 Spatial multiplexing  SM , 11, 48  D-BLAST, 53 detection for, 52 detection in MIMO, 73–76 in optimum detection, 54 uncoded, 72  Spatial signal-to-interference-noise ratio  of MBSFN scenario, 429, 430 of SC-PMP scenario, 427, 428  SPC, see Superposition coding  SPC  Sphere decoding  SD , 48, 105  complexity, 107 detection method, 105 FCSD, 108 Fincke–Pohst method, 107, 108–109 MLD solution, 106 receiver, 106 tree exploration of tree, 106  Sphere decoding algorithm  SDA , 452 Spread-spectrum  SS , 251  communication, 253–254 UWB-based system, 378  Spreading factor  SF , 250  bandwidth expansion factor, 253 combined channel–precoder matrix SF, 151 SQRD, see Sorted QR decomposition  SQRD   Squared minimum distance, 137 SS, see Small-scale  SS ; Spread-spectrum  SS  SSD, see Signal space diversity  SSD  SSPS, see Semistatic point selection  SSPS  STBC, see Space–time block coding  STBC  STC, see Space–time codes  STC  STD, see Selective transmit diversity  STD  STTC, see Space-time trellis code  STTC  SU-MIMO systems, see Single-user MIMO   systems  SU-MIMO systems   Suboptimal constructions, 134–135  lattice theoretic approach, 134–135 to minimize BER, 130 on optimal two-dimensional precoder, 134 Successive interference cancellation  SIC , 19, 20  average BER of SIC receiver, 241 error events in, 93 as K-best detector, 458–459 LLL algorithm combination, 195 MMSE-SV-SIC detector, 466, 467 ordered SIC, 509 QR matrix decomposition, 508 used in detection method, 53 users detection, 233, 234  Successive minima, 62 Sum-product algorithm  a posteriori log probability ratios, 183 BER performance, 184 LDPC decoder—SPA, 181, 492 messages, 182 modified SPA, 506 reliability factor, 183 Tanner graphs, 181  Sum-product algorithm, iterative, 181 Superimposed pilots, see Pilot embedding Superposition coding  SPC , 474; see also Two-  way relay channels  C-SPC and WF-SPC scheme, 487 C-SPC without CSI, 478–479 MIMO MABC-SPC protocol, 475,   482–483  optimization, 481–482 SC power split, 480–481 SPC with CSI, 479  SVD, see Singular-value decomposition  SVD  SVP, see Shortest vector problem  SVP  Symbol error rate  SER , 49, 77  multiplexing gain, 50 SNR vs., 50 Synchronization  clock synchronization, 368 of massive MIMO system, 468      System-level simulation  SLS , 418  channel model creation process, 423 ITU-R IMT-Advanced MIMO channel   model, 421  MIMO channel, 422 parameterization for, 424 time-variant impulse response matrix, 422  System matrix, 267  downlink with equal scrambling, 268–269 matrix algebra, 267 for MF and ZF MMSE schemes, 265, 266 receiver schemes using, 272–274 SCA matrix, 271–272 scrambling for transmit antennas, 270–271 uplink modifications, 270–271  System model  distributed massive MIMO, 454–455 massive MIMO downlink, 455–457 MIMO-SC, 232–234 MIMO SM, 65–69 MU-MIMO, 453–454 SU-MIMO, 452–453  T  Tabu search, 463 TACS, see Total access communication system    TACS  Tanner graphs, 173  181  iterative probabilistic decoding algorithm,   linear code characterization, 174  Tapped delay line  TDL , 257 TD, see Transmit diversity  TD  TDD, see Time division duplexing  TDD  TDL, see Tapped delay line  TDL  TDMA, see Time division multiple access    TDMA    TH-MA   TDOA, see Time-different-of-arrival  TDOA  TH-MA, see Time-hopping multiple access   TH, see Time hopping  TH  Third-generation cellular system  3G , 2  European 3G standard, 253 evolution from, 5–6 frequency reuse, 426  Third Generation Partnership Project  3GPP , 2  BER performance, 172 LTE-Advanced, 9, 185 multihop relay in, 33–37 specifications, 11 type comparison, 3  Index  ◾  531  3G, see Third-generation cellular system  3G  3GPP, see Third Generation Partnership   Project  3GPP  Throughput distribution  CDF throughput vs., 435, 436, 438, 440 CoMP geometry, 442, 443, 444 SU-MIMO 4 × 4 geometry vs., 433, 434,   439, 441  Time-different-of-arrival  TDOA , 366 Time-hopping multiple access  TH-MA , 378 Time-of-arrival  TOA , 366  clock synchronization, 368 CRLB for, 367 ranging precision of, 367 TOA-based ranging, 366–367  Time division duplexing  TDD , 7, 406 Time division multiple access  TDMA , 2  fixed assignment MA, 251–252 GSM based, 5  Time hopping  TH , 251  TH-MA, 378 time interval, 254 Time slots  TS , 417 TOA, see Time-of-arrival  TOA  Total access communication system  TACS , 2 Transmit antennas  Alamouti STBC scheme using, 386 downlink with equal scrambling, 268–269 scrambling for, 270–271 STBC2, 13–14 STBC4, 14–16  Transmit diversity  TD , 11  Alamouti scheme, 380 multipath components, 264 open-loop TD, 11 redundant-sent signals, 381 STD, 11, 16–17  TS, see Time slots  TS  Turbo-processing, 187 Turbo decoder  iteration of IB-FDE, 230 MAP algorithm, 181 using single Markov process, 179 soft-input soft-output decoders, 180, 181  2G of cellular networks, see Second generation  of cellular networks  2G of cellular  networks   Two-dimensional lattice precoders, 139;   see also Lattice; Linear channels,  precoding for applications, 150–155 change in Z, 150      532  ◾   Index  Two-dimensional lattice precoders   Continued   ML receiver tests, 153 mutual information for channel, 152,   153, 155  optimal precoding lattices, 142–148 optimal Z matrix, 148–150 QAM constellation, 140 visualization of solution, 141  Two-hop relaying, 32 Two-way relay channels, 473  C-SPC and WF-SPC, 485, 488 communication model, 475–478 cooperative protocols, 474 effects of imperfect channel estimation, 475 max−min achievable user rate, 483, 484 numerical results, 482 optimal fixed power split, 486 simulation examples and parameters, 482 SPC power split impact, 487  U  UB, see Upper bound  UB  UC, see Uncorrelated channels  UC  UE, see User equipment  UE  ULA array, see Uniform linear antenna array    ULA array   342  antenna array, 358–359 antenna impulse responses, 351 antenna selection, 363–365 beam pattern, 360, 361, 362–363 channel impulse response, 349, 357 complexity of MIMO, 365 continuous-wave UWB uplink, 396 contribution of factor, 343 EIRP-constrained radiation, 363 element spacing, 363–365 fade depth scaling, 355 frequency-domain packet combining   technique, 383–384  grating lobes, 363–365 gross BER performance, 364 history and standards, 344–347 IEEE802.15.6 symbol structure, 346 localization, 365–369 microwave imaging, 369–372 MIMO, 356–358 motivation for, 342–344 multipath fading, 353–356 narrowband systems, 359  OFDM systems, 356 path gain, 348–349 plane wave assumption, 358 regulations worldwide, 347, 348 802.15.4a symbol structure, 345 spatial variation of channel energy, 354 spectral emission masks, 347 systematic errors, 349–352 systematic measurement error removal,   352–353  for wireless communication, 342 wireless SISO channel, 348  UMTS, see Universal mobile   telecommunication system  UMTS   Uncorrelated channels  UC , 399 Uniform linear antenna array  ULA array , 21 Unimodular matrix, 60 Unitary matrix, 60  Universal mobile telecommunication system   of optimal precoder, 129 precoding matrix, 477   UMTS , 253, 425  channels, 264 geometry factor using, 432 HSDPA connection, 263 by 3GPP, 2 uplink connection, 262  block-Fourier partitioned algorithm, 315,   316, 317  MMSE block-Fourier partitioned   algorithm, 322, 323 Uplink modification, 270–271 Upper bound  UB , 105 User equipment  UE , 6, 407  cell boundary, 408 data for, 417 relay-UE, 34 RN-UE and eNB-UE, 36 signals from BS, 25 single path, 28 transmission channel estimation, 30  UWB-based communication systems, 378  BER performance, 397, 400, 401 block transmission techniques, 379 characteristics of interference, 386 continuous-wave, 378 conventional FDE receiver, 398 conventional soft packet combining ARQ,   384–386  IB-DFE, 383–384 ideal FDE receiver, 399  Ultrawideband technology  UWB technology ,   Unsteady channel      performance results, 396 SC-FDE, 381–383 soft packet combining techniques, 380  UWB technology, see Ultrawideband   technology  UWB technology   Vector network analyzers  VNA , 349  4-channel, 372 time-domain technique, 370  Vector perturbation, 126 decoding method, 127 in MIMO broadcast channels, 127  Vertical Bell laboratories layered space–time    V-BLAST , 20, 177  detector, 20, 89 predominance, 53  Virtual cellular network, 32, 33 Voronoi region, 58  characteristic of lattice, 59 lattice point, 137 NP-hard, 74 SNR relation factor, 88  V  W  Waterfilling power allocation strategy  WF-PA   strategy , 474  Wideband code division multiple access    W-CDMA , 2, 250  AWGN and square-root, 260 Cauchy–Schwarz inequality, 261 CDMA, 251 CS-CDMA, 253 DOF, 264 DS-CDMA, 253, 255 fixed assignment multiple access   techniques, 251–253  multipath diversity for UMTS channels,   264  narrowband CDMA, 254–257 QPSK modulation, 262 RAKE receiver, 258, 259 received SNR, 261 SIMO with two receivers, 265 spread-spectrum communication, 253–254 TDL model, 257 UMTS HSDPA connection, 263  Wiener filter, 127–128 WiMAX—IEEE802.16, 7–8  Index  ◾  533  Wireless communication benefits for, 450, 468 channel estimation, 184–186 energy efficiency in, 39–41  Wireless metropolitan area network    WMAN , 7  Wireless port, 32 Worldwide Interoperability for Microwave   Access and mobile access   WiMAX , 7  XOR, see Exclusive-or  XOR   X  Z  Zero-forcing beamforming  ZFBF , 437 Zero-forcing detection  ZF detection ,  20, 77, 250; see also Optimal  detection and complexity; Lattice- reduction-aided detection  LRA  detection   algebraic analysis, 81–82 application to ZF detector, 299–304 BER for, 325–333, 337 for channel conditions, 177 constant-channel conditions, 334 decision regions, 80, 81 direct decoding technique, 175 Est algorithm, 320 for extended system, 507 FDE output, 216 filtering interpretation, 79 geometry, 80–81 interpretation of ZF filtering, 79 linear nulling algorithm, 20 linear transformation, 77 operations involving, 80 precoding scheme, 456 pseudo-inverse matrix, 78 receiver, 79 relative error, 285, 286, 290, 305 simulated conditions for, 324 ZF-LD, 457 ZFBF, 437 ZF MMSE scheme, 265–274  Zero-mean circularly symmetric complex   Gaussian  ZMCSCG , 475  Zero-mean spatially white  ZMSW , 66

@highlight

MIMO Processing for 4G and Beyond: Fundamentals and Evolution offers a cutting-edge look at multiple-input multiple-output (MIMO) signal processing, namely its detection (in both time and frequency domains) and precoding. It examines its integration with OFDM, UWB, and CDMA, along with the impact of these combinations at the system level. Massive MIMO and network coding at the physical layer are very recent topics which are also addressed, and which are expected to play an important role in 5G systems. The book brings together contributing authors from first-class institutions who have been working in international research and development (R&D) projects and are highly cited in the MIMO field. These experts examine ongoing R&D activities in the field of MIMO systems and its associated signal processing that is expected to be employed in 4G and 5G systems