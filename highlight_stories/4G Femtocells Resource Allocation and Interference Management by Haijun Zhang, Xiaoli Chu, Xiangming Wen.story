SpringerBriefs in Computer Science  Series Editors Stan Zdonik Peng Ning Shashi Shekhar Jonathan Katz Xindong Wu Lakhmi C. Jain David Padua Xuemin Shen Borko Furht VS Subrahmanian Martial Hebert Katsushi Ikeuchi Bruno Siciliano  For further volumes: http:  www.springer.com series 10028    Haijun Zhang   Xiaoli Chu  cid:129  Xiangming Wen  4G Femtocells  Resource Allocation and Interference Management  123   Xiaoli Chu Department of Electronic  and Electrical Engineering  The University of Shefﬁeld Shefﬁeld, UK  Haijun Zhang College of Information Science  and Technology  Beijing University of Chemical  Technology  Beijing, China, People’s Republic  Xiangming Wen Beijing University of Posts and Telecommunications  Beijing, China, People’s Republic  ISSN 2191-5768 ISBN 978-1-4614-9079-1 DOI 10.1007 978-1-4614-9080-7 Springer New York Heidelberg Dordrecht London  ISSN 2191-5776  electronic  ISBN 978-1-4614-9080-7  eBook   Library of Congress Control Number: 2013947965    The Author s  2013 This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed. Exempted from this legal reservation are brief excerpts in connection with reviews or scholarly analysis or material supplied speciﬁcally for the purpose of being entered and executed on a computer system, for exclusive use by the purchaser of the work. Duplication of this publication or parts thereof is permitted only under the provisions of the Copyright Law of the Publisher’s location, in its current version, and permission for use must always be obtained from Springer. Permissions for use may be obtained through RightsLink at the Copyright Clearance Center. Violations are liable to prosecution under the respective Copyright Law. The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant protective laws and regulations and therefore free for general use. While the advice and information in this book are believed to be true and accurate at the date of publication, neither the authors nor the editors nor the publisher can accept any legal responsibility for any errors or omissions that may be made. The publisher makes no warranty, express or implied, with respect to the material contained herein.  Printed on acid-free paper  Springer is part of Springer Science+Business Media  www.springer.com    Preface  Femtocells have been considered as a promising technology to provide better indoor coverage and spatial reuse gains in the last few years. Femtocells are low power, low cost and user deployed wireless access points that use local broadband connections as backhaul. Not only the users but also the operators beneﬁt from femtocells. On the one hand, users enjoy high-quality links; on the other hand, operators decrease the operational expenditure  OPEX  and capital expenditure  CAPEX  due to the trafﬁc ofﬂoading and user’s self-deployment of femtocell base stations  FBSs . Orthogonal frequency division multiple access  OFDMA  based femtocells have been considered in major wireless communication standards, e.g., LTE LTE-Advanced. Due to spectrum scarcity and implementation difﬁculty, spectrum-sharing, rather than spectrum splitting, between femtocells and macrocells is more preferable from the operator’s perspective. However, co-channel deployed femtocells may lead to severe co-channel interference between femtocells in dense deployment, and cross-tier inference between macro-tier and femto-tier.  Due to the fading coefﬁcients of different subchannels are likely to be indepen- dent for different users, which are known as multiuser diversity  MUD , maximum system spectral efﬁciency can be achieved by selecting the best user for each subchannel and adapting the associated transmit power. Therefore, resource allo- cation is one of the most important techniques for femtocells to maximize spectral efﬁciency and mitigate interference. Power control and subchannel allocation have been widely used to alleviate cross-tier and or co-tier interference and satisfy diverse quality of service  QoS  for co-channel deployment of femtocells. However, there has not been any book speciﬁcally addressing femtocell network resource allocation with various objectives, constraints and optimizing variables taken into consideration.  In this book, we address the foregoing issues and provide an in-depth discussion on the latest resource allocation and interference management issues for femto- cells. The discussion begins with introducing femtocells and their development in Chap. 1. After that, resource allocation in dense deployed femtocells is inves- tigated in Chap. 2. Such techniques include user scheduling and power control to maximize capacity of femtocells. In Chap. 3, an interference-aware pricing-based  v   vi  Preface  resource allocation algorithm for co-channel femtocells is proposed to alleviate their interference to macrocells without degrading the femtocells’ capacity. The subchannel and power allocation problem is modeled as a non-cooperative game. A suboptimal subchannel allocation algorithm and an optimal power allocation algorithm are proposed to implement the resource allocation game. In Chap. 4, resource allocation is investigated in both uplink and downlink for two-tier networks comprising spectrum-sharing femtocells and macrocells. A resource allocation scheme for co-channel femtocells is proposed, aiming to maximize the capacity for both delay-sensitive users and delay-tolerant users subject to delay-sensitive users’ QoS constraints and the interference constraint imposed by the macrocell. The subchannel and power allocation problem is modeled as a mixed integer programming problem, then transformed into a convex optimization problem by relaxing subchannel sharing, and ﬁnally solved by the dual decomposition method. The complexity of the proposed algorithms is analyzed, and the effectiveness of the proposed algorithms is veriﬁed by simulations. In Chap. 5, we propose an energy- aware uplink power control scheme for two-tier femto-macro networks based on non-cooperative game. In Chap. 6, we propose a differentiated-pricing based power allocation algorithm for the uplink of spectrum-sharing femtocells, based on a non- cooperative game framework. Concluding remarks and future trends are provided in Chap. 7.  Beijing, China, People’s Republic Shefﬁeld, UK Beijing, China, People’s Republic  Haijun Zhang Xiaoli Chu Xiangming Wen   Contents  1  Introduction to 4G Femtocells ............................................... 1.1 4G Femtocell Networks.................................................. 1.2 Resource Allocation and Interference Management.................... 1.3 Challenges and Issues .................................................... References ......................................................................  1 1 2 4 4  2 Ant Colony Algorithm  ACA  Based Downlink Resource  Allocation in Femtocells ...................................................... 7 7 2.1 Introduction .............................................................. 8 2.2 System Model and Problem Formulation ............................... 2.2.1 System Model .................................................... 8 2.2.2 Problem Formulation ............................................ 10 2.3 Resource Allocation Using ACA ........................................ 10 2.3.1 Application of ACA in Resource Allocation ................... 11 2.3.2 Algorithm Description ........................................... 12 2.3.3 Parameters and Convergence of ACA .......................... 14 2.4 Performance Evaluation ................................................. 14 2.5 Conclusion ............................................................... 17 References ...................................................................... 17  3 Cross-Tier Interference Pricing Based Uplink Resource  Allocation in Two-Tier Networks............................................ 21 3.1 Introduction .............................................................. 21 3.2 System Model and Problem Formulation ............................... 23 3.2.1 System Model .................................................... 23 3.2.2 Problem Formulation ............................................ 25 3.3 Interference-Aware Resource Allocation ............................... 25 3.3.1 A Game Theoretic Framework .................................. 26 3.3.2 Interference-Aware Subchannel Allocation .................... 27 3.3.3 Interference-Aware Power Allocation .......................... 28 3.3.4 Semi-distributed Implementation ............................... 29 3.4 Simulation Results and Discussion...................................... 30  vii   viii  Contents  3.5 Conclusion ............................................................... 33 References ...................................................................... 35  4 Resource Allocation in Femtocells with Cross-Tier  Interference Limits ........................................................... 37 4.1 Introduction .............................................................. 37 4.2 System Model and Problem Formulation ............................... 39 4.2.1 System Model .................................................... 39 4.2.2 Problem Formulation ............................................ 39 4.3 Subchannel and Power Allocation Algorithm .......................... 40  4.3.1 Transformation of Optimization Problem  by Time-Sharing Relaxation .................................... 41 4.3.2 Dual Decomposition Method.................................... 42 4.3.3 Iterative Resource Allocation Algorithm ....................... 44 4.3.4 Downlink Case ................................................... 45 4.4 Simulation Results and Discussions ............................... 46 4.5 Conclusion ............................................................... 49 References ...................................................................... 49  .... .  5 Energy Efﬁcient Power Control in Femtocells with  Interference Pricing .......................................................... 51 5.1 Introduction .............................................................. 51 5.2 System Model and Problem Formulation ............................... 52 5.2.1 System Model .................................................... 52 5.2.2 Problem Formulation ............................................ 53 5.3 Non-cooperative Power Control Game with Convex Pricing .......... 54 5.3.1 Femtocell Utility Function ...................................... 55 5.3.2 Super-Modular Games........................................... 55 5.3.3 Energy-Aware Power Control NPG-CP ........................ 57 5.4 Performance Evaluation ................................................. 58 5.5 Conclusion ............................................................... 60 References ...................................................................... 61  6 Differentiated-Pricing Based Power Allocation in Dense  Femtocell Networks ........................................................... 63 6.1 Introduction .............................................................. 63 6.2 System Model and Problem Formulation ............................... 64 6.2.1 System Model .................................................... 64 6.2.2 Problem Formulation ............................................ 65 6.3 Differentiated-Pricing Based Power Allocation ........................ 66 6.3.1 Game Theoretic Based on Differentiated Pricing .............. 67 6.3.2 Differentiated-Pricing Function ................................. 69 6.3.3 Dynamic Power Allocation...................................... 70 6.4 Simulation Results and Discussion...................................... 70 6.4.1 Simulation Parameters ........................................... 70 6.4.2 Performance Analysis ........................................... 71   Contents  ix  6.5 Conclusion ............................................................... 72 References ...................................................................... 73  7 Conclusions and Future Works.............................................. 75 7.1 Conclusions .............................................................. 75 7.2 Future Works ............................................................. 76   Chapter 1 Introduction to 4G Femtocells  Abstract Femtocells have been proposed for improving the performance of indoor users to provide better indoor coverage and spatial reuse gains in the 4G networks. On the one hand, users enjoy high-quality links; on the other hand, operators decrease the operational expenditure  OPEX  and capital expenditure  CAPEX  due to the trafﬁc ofﬂoading and user’s self-deployment of femtocell base stations  FBSs . As femtocells can meet users’ demand and indoor coverage requirement well, they have been widely used in many wireless communication standards, such as WiMAX, and LTE LTE-Advanced. However, there are still some challenges in the mass deployed femtocell environment. Interference management is considered as one of the major challenges in femto-macro two-tier networks. In this chapter, we survey different state-of-the-art approaches of resource allocation and interference management in orthogonal frequency division multiple access  OFDMA  femtocell networks. Moreover, some open challenges in interference and resource manage- ment are discussed.  1.1 4G Femtocell Networks  Fourth-generation  4G  mobile networks are expected to provide high capacity and wide coverage. However, since the 4G wireless systems, such as WiMAX and LTE LTE-Advanced, are usually deployed in high frequency band, the penetration loss will be high. Moreover, above 50% of voice services and 70% of data trafﬁcs occur indoors nowadays [1]. The most promising solution to this problem is shortening the distance between the transmitter and the receiver.  Insufﬁcient indoor coverage of macrocells has led to increasing interest in femtocells, which have been proposed for improving the quality of service  QoS  of indoor users [2]. Femtocells usually comprise small size, low-power, low- cost, and short-range home base stations. They work in the licensed frequency bands, and are connected to broadband Internet backhaul. As femtocells can meet  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__1,   The Author s  2013  1   2  1 Introduction to 4G Femtocells  customers’ demands and indoor coverage requirements, femtocells combined with orthogonal frequency division multiple access  OFDMA  have been considered in many wireless communication standards, such as WiMAX and LTE LTE-Advanced [3]. Two-tier OFDMA macrocell and femtocell networks are widely expected to improve coverage and capacity of indoor environments.   or orthogonal   Dedicated-channel deployment of femtocells, where femtocells and macrocells are assigned with different frequency bands, may not be preferred by operators due to the scarcity of spectrum resources and complexities in implementation. While in co-channel deployment, where femtocells and macrocells share the same spectrum, cross-tier interference could be severe [2], especially when femtocell base stations  FBSs  are deployed close to a macrocell base station  MBS  [22]. Due to the fundamental role of macrocells in providing blanket cellular coverage, their capacities and coverage should not be affected by co-channel deployment of femtocells. As a result, resource allocation and interference management have become an important asset to enhance performance and have attracted much attention from the telecommunication industry.  1.2 Resource Allocation and Interference Management  In practice, there are still some technical challenges to be further addressed before extensive deployment of femtocells. A two-tier macrocell and femtocell network is usually implemented by sharing frequency rather than splitting frequency between tiers [4]. Hence, cross-tier interference  CTI  and inter-tier interference  ITI  are the key issues in two-tier macrocell and femtocell networks [1]. Maximization of the total data rate of femtocells with the consideration of cross-tier and inter-tier interference has become an interesting research area. Related works on femtocell networks in the literature are described in the following. Resource allocation algorithms aiming at the inter-cell interference management in femtocell networks are discussed and evaluated in [5]. A resource allocation scheme considering inter-femtocell fairness is proposed in [6]. In [7], a cross-tier interference mit- igation algorithm based on power control is developed. The authors in [27] propose a distributed resource allocation algorithm based on Lagrangian dual method.  Power control has been widely used to mitigate inter-cell interference in co- channel deployment of femtocells. For alleviating uplink interference caused by co-channel femto users to macrocells, a distributed femtocell power control algo- rithm is developed based on non-cooperative game theory in [7], while in [4] femto users are priced for causing interference to macrocells in the power allocation based on a Stackelberg model. In [24], cross-tier interference is mitigated through both open-loop and closed-loop uplink power control. In [16], a distributed power control scheme is proposed based on a supermodular game.   1.2 Resource Allocation and Interference Management  3  A lot of work has also been done on subchannel allocation in co-channel deploy- ment of femtocells. In [25], a hybrid frequency assignment scheme is proposed for femtocells deployed within coverage of a macrocell. In [17], distributed channel selection schemes are proposed for femtocells to avoid inter-cell interference, at the cost of reduced frequency reuse efﬁciency. In [18], a subchannel allocation algorithm based on a potential game model is proposed to mitigate both co-tier and cross-tier interference.  Recently, several studies considering both power and subchannel allocation in femtocells have been reported. In [26], a joint power and subchannel allocation algo- rithm is proposed to maximize the total capacity of densely deployed femtocells, but neither the interference caused by femtocells to macrocells nor the fairness between femto users has been considered. In the collaborative resource allocation scheme proposed in [29], cross-tier interference is approximated as additive white Gaussian noise  AWGN . In the Lagrangian dual decomposition based resource allocation scheme [27], constraints on cross-tier interference are used in power allocation, but subchannels are assigned randomly to femto users. In [28], a distributed downlink resource allocation scheme based on a potential game and convex optimization is proposed to increase the total capacity of macrocells and femtocells, but at the price of reduced femtocell capacity. In [21], the distributed power and subchannel allocation for co-channel deployed femtocells is modeled as a non-cooperative game, for which a Nash Equilibrium is obtained based on a time-sharing subchannel allocation, but the constraint on maximum femto-user transmit power is ignored in solving the non-cooperative game.  Game theory has been considered to mitigate interference in two-tier networks the minimization of co-tier with co-channel deployed femtocells. In [4, 21], and cross-tier interference though power control based on game theory is investigated. In [7], the authors introduce a distributed utility-based SINR adaptation algorithm in order to alleviate cross-tier interference caused by co- channel femtocells to the macrocell. In [19], a decentralized femtocell access strategy based on non-cooperative game is proposed to manage the interference between nearby femtocells and from femtocells to macrocells. The authors in [4] propose a distributed power control algorithm for spectrum-sharing femtocell network using Stackelberg game, which is very effective in distributed power allocation and macrocell protection while requiring minimal network overhead.  Recently, several studies considering pricing techniques together with power controls have been reported. In [21], the distributed cross-tier interference pricing in power allocation for co-channel deployed femtocells is modeled as a non- cooperative game, but the constraint on maximum femto-user transmit power is ignored in solving the non-cooperative game. For alleviating uplink interference caused by co-channel femto users to macrocells, a distributed femtocell power control algorithm is developed based on non-cooperative game theory in [7]; while in [4] femto users are priced for causing interference to macrocells in the power allocation based on a Stackelberg model.   4  1 Introduction to 4G Femtocells  1.3 Challenges and Issues  Interference mitigation based on resource allocation has been widely analyzed to maintain user’s QoS, e.g., signal to interference and noise ratio  SINR  capacity, while alleviating cross-tier interference in two-tier networks. In [7], non-cooperative power allocation with SINR adaptation is used to alleviate the uplink interference suffered by macrocells; while in [4], Stackelberg game based power control is formulated to maximize femtocells’ total capacity under cross-tier interference constraints. However, subchannel allocation is not considered. In [26], a joint subchannel and power allocation algorithm is proposed to maximize total capacity in dense femtocell deployments. While in [27], a Lagrangian dual decomposition based resource allocation scheme with constraints on cross-tier interference in power allocations is used. In [21], the distributed subchannel and power allocation for co-channel deployed femtocells is modeled as a non-cooperative game, for which a Nash Equilibrium is obtained based on a time-sharing subchannel allocation scheme. However, in these works, joint subchannel and power allocation with considerations of users’ QoS and cross-tier interference is not studied. In [20], a distributed modulation and coding scheme in conjunction with subchannel and power allocation that supports different throughput constraints per users is proposed, but it does not consider two-tier networks. There have been very few works in the literature that make efforts to maximize the capacity of a two-tier network while jointly considering cross-tier interference, QoS requirements and the fairness among users in femtocell networks.  Moreover, femtocell networks should support the heterogeneous QoS require- ments of delay sensitive services such as online gaming and video phone calls, while maximizing the throughput of delay tolerant services [32]. However, to the best of our knowledge, resource allocation for heterogeneous QoS users in femtocells has not been studied in previous works. Resource allocation strategies that have been widely studied in spectrum underlay Cognitive Radio  CR  networks [35,36] cannot be directly applied for Interference mitigation in two-tier macrocell and femtocell networks [4].  References  1. D. López-Pérez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Commun. Mag., vol. 47, no. 9, pp. 41–48, 2009.  2. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  3. E-UTRA and E-UTRAN Overall Description, 3GPP Std. TS 36.300 v10.0.0, 2010. 4. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  5. R. Madan, A. Sampath, N. Bhushan, A. Khandekar, J. Borran, and T. Ji, “Impact of coordination delay on distributed scheduling in lte-a femtocell networks,” in Global Telecom- munications Conference  GLOBECOM 2010 , 2010 IEEE, 2010, pp. 1–5.   References  5  6. K.-S. Lee and D.-H. Cho, “Cooperation based resource allocation for improving inter- cell fairness in femtocell systems,” in Personal Indoor and Mobile Radio Communications  PIMRC , 2010 IEEE 21st International Symposium on, 2010, pp. 1168–1172.  7. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328, 2009.  8. J. Zhang, Z. Zhang, K. Wu, andA. Huang, “Optimal distributed subchannel, rate and power allocation algorithm in ofdm-based two-tier femtocell networks,” in IEEE VTC’10 Spring, May, pp. 1–5.  9. M. Dorigo, V. Maniezzo, and A. Colorni, “Ant system: optimization by a colony of cooperating agents,” Systems, Man, and Cybernetics, Part B: Cybernetics, IEEE Transactions on, vol. 26, no. 1, pp. 29–41, 1996.  10. Y. Zhao, X. Xu, Z. Hao, X. Tao, and P. Zhang, “Resource allocation in multiuser ofdm system based on ant colony optimization,” in Wireless Communications and Networking Conference  WCNC , 2010 IEEE, 2010, pp. 1–6.  11. R. Lin, K. Niu, W. Xu, and Z. He, “A two-level distributed sub-carrier allocation algorithm based on ant colony optimization in ofdma systems,” in Vehicular Technology Conference  VTC 2010-Spring , 2010 IEEE 71st, 2010, pp. 1–5.  12. X. Zhang, W. Ye, S. Feng, and H. Zhuang, “Adaptive resource allocation for ofdma system based on ant colony algorithm,” in Information Science and Engineering  ICISE , 2009 1st International Conference on, 2009, pp. 2526–2529.  13. D. Wu and R. Negi, “Effective capacity: a wireless link model for support of quality of service,”  Wireless Communications, IEEE Transactions on, vol. 2, no. 4, pp. 630–643, 2003.  14. T. Stutzle and M. Dorigo, “A short convergence proof for a class of ant colony optimization algorithms,” Evolutionary Computation, IEEE Transactions on, vol. 6, no. 4, pp. 358–365, 2002.  15. R. Jain, D.-M. Chiu, and W. R. Hawe, A quantitative measure of fairness and discrimination Eastern Research Laboratory, Digital  for resource allocation in shared computer system. Equipment Corporation, 1984.  16. E. J. Hong, S. Y. Yun, and D.-H. Cho, “Decentralized power control scheme in femtocell  networks : A game theoretic approach,” in IEEE PIMRC’09, pp. 1–5.  17. C. Lee, J.-H. Huang, and L.-C. Wang, “Distributed channel selection principles for femtocells with two-tier interference,” in Vehicular Technology Conference  VTC 2010-Spring , 2010 IEEE 71st, may 2010, pp. 1–5.  18. I. Mustika, K. Yamamoto, H. Murata, and S. Yoshida, “Potential game approach for self- in closed access femtocell networks,” in Vehicular  organized interference management Technology Conference  VTC Spring , 2011 IEEE 73rd, may 2011, pp. 1–5.  19. S. Barbarossa, S. Sardellitti, A. Carfagna, and P. Vec-chiarelli, “Decentralized interference management in femtocells: A game-theoretic approach,” in IEEE CROWNCOM’10, June 2010, pp. 1–5.  20. D. Lopez-Perez, A. Ladanyi, A. Juttner, H. Rivano, and J. Zhang, “Optimization method for the joint allocation of modulation schemes, coding rates, resource blocks and power in self- organizing lte networks,” in INFOCOM, 2011 Proceedings IEEE, april 2011, pp. 111–115.  21. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co-  channel deployment,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1225–1241, 2011.  22. K. Son, S. Lee, Y. Yi, and S. Chong, “Reﬁm: A practical interference management in heterogeneous wireless access networks,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1260–1272, 2011.  23. M. Yavuz, F. Meshkati, S. Nanda, A. Pokhariyal, N. Johnson, B. Raghothaman, and A. Richard- son, “Interference management and performance analysis of umts hspa+ femtocells,” IEEE Commun. Mag., vol. 47, no. 9, pp. 102–109, Sep. 2009.  24. H.-S. Jo, C. Mun, J. Moon, and J.-G. Yook, “Interference mitigation using uplink power control for two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 10, pp. 4906– 4910, Oct. 2009.   6  1 Introduction to 4G Femtocells  25. I. Guvenc, M.-R. Jeong, F. Watanabe, and H. Inamura, “A hybrid frequency assignment for femtocells and coverage area analysis for co-channel operation,” IEEE Commun. Lett., vol. 12, no. 12, pp. 880–882, Dec. 2008.  26. J. Kim and D.-H. Cho, “A joint power and subchannel allocation scheme maximizing system capacity in indoor dense mobile communication systems,” IEEE Trans. Veh. Technol., vol. 59, no. 9, pp. 4340–4353, 2010.  27. J. Zhang, Z. Zhang, K. Wu, and A. Huang, “Optimal distributed subchannel, rate and power allocation algorithm in ofdm-based two-tier femtocell networks,” in Proc. Veh. Technol. Conf., May 2010, pp. 1–5.  28. L. Giupponi and C. Ibars, “Distributed interference control in ofdma-based femtocells,” in  IEEE PIMRC’10, Sept. 2010, pp. 1201–1206.  29. K. Lee, H. Lee, and D.-H. Cho, “Collaborative resource allocation for self-healing in self-  organizing networks,” in IEEE Int. Conf. Commun., June 2011, pp. 1–5.  30. J. W. Huang and V. Krishnamurthy, “Cognitive base stations in lte 3gpp femtocells: A corre- lated equilibrium game-theoretic approach,” IEEE Trans. Wireless Commun., vol. 59, no. 12, pp. 3485–3493, Dec. 2011.  31. D.-C. Oh, H.-C. Lee, and Y.-H. Lee, “Power control and beamforming for femtocells in the presence of channel uncertainty,” IEEE Trans. Veh. Technol., vol. 60, no. 6, pp. 2545–2554, July 2011.  32. M. Tao, Y.-C. Liang, and F. Zhang, “Resource allocation for delay differentiated trafﬁc in multiuser ofdm systems,” IEEE Trans. Wireless Commun., vol. 7, no. 6, pp. 2190–2201, June 2008.  33. Y. Zhang and C. Leung, “Cross-layer resource allocation for mixed services in multiuser ofdm- based cognitive radio systems,” IEEE Trans. Veh. Technol., vol. 58, no. 8, pp. 4605–4619, Oct. 2009.  34. S. Haykin, “Cognitive radio: brain-empowered wireless communications,” IEEE J. Sel. Areas  in Commun., vol. 23, no. 2, pp. 201–220, Feb. 2005.  35. D. T. Ngo and T. Le-Ngoc, “Distributed resource allocation for cognitive radio networks with spectrum-sharing constraints,” IEEE Trans. Veh. Technol., vol. 60, no. 7, pp. 3436–3449, Sept. 2011.  36. R. Xie, F. R. Yu, and H. Ji, “Dynamic resource allocation for heterogeneous services in cognitive radio networks with imperfect channel sensing,” IEEE Trans. Veh. Technol., no. 99, p. 1, 2011.   Chapter 2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  Abstract This chapter focuses on the resource allocation of femtocells in the Orthogonal Frequency Division Multiple Access  OFDMA  networks. A typical algorithm of swarm intelligence called Ant Colony Optimization  ACO  is adopted to resolve the optimization problem of maximizing the total capacity of femtocells considering the quality of service  QoS  requirement. An ACO based system model for the resource allocation, as well as three different schemes  ACOMAX, ACOPF and ACOCF  that are based on meta-heuristic methods is proposed. Due to the unique characteristics of ACO’s heuristic searching mechanism, the proposed algorithms can guarantee a fast convergence speed. Simulation results show that ACOMAX can signiﬁcantly increase the throughput of the system, and ACOCF as well as ACOPF can satisfy the requirements of throughput and guarantee fairness simultaneously.  2.1 Introduction  Femtocells have been proposed for improving the performance of indoor users [1]. Femtocells are usually comprised of small size, low-power, low-cost, and short- range home base stations. They work in the licensed frequency bands, and are connected to broadband Internet backhaul. As femtocells can meet customer’s demands and indoor coverage requirements well, they have been widely introduced in many wireless communication standards, such as WiMAX, and LTE LTE- Advanced [2]. Therefore, two-tier OFDMA networks comprising macrocells and femtocells are widely expected to improve the coverage and capacity of cellular networks.  In practice, there are still some technical challenges that need to be further addressed before widespread deployment of femtocells. A two-tier network is usually implemented by sharing frequency rather than splitting frequency between tiers [3]. Hence cross-tier interference  CTI  and intra-tier interference  ITI  are the key issues in two-tier networks [4], and maximization of the total data rate  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__2,   The Author s  2013  7   8  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  of femtocells with the consideration of CTI and ITI is a hot research area. The related works on femtocell networks in the literature are described in the following. Resource allocation algorithms aiming at the inter-cell interference management in femtocell networks are discussed and evaluated in [5]. A resource allocation scheme considering inter-femtocell fairness is proposed in [6], and in [7] a CTI mitigation algorithm based on power control is developed. The authors in [23] propose a distributed resource allocation algorithm based on Lagrangian dual method. However, with the consideration of CTI, quality of service  QoS  requirements and the fairness among users in femtocell networks, there is little work has been done related to maximize the capacity of the two-tier network.  Ant Colony Algorithm  ACA  is a typical swarm intelligence algorithm [9], which has been used for resource allocation in OFDM systems [10,11]. The feature of robustness and parallel heuristic in ACA is ﬁt for ﬁnding proper solution for resource allocation.But this approach has not been sufﬁciently explored in the two- tier network literature.  In this chapter, we consider a system model based on ACA in a two-tier network, where femtocells are deployed densely. Our goal is to maximize the total downlink rate of all femtocell users, while considering CTI, QoS requirement and fairness among users. We propose an ACA based algorithms to optimize the sub-channels allocation problem [13], and the performance of these algorithms is evaluated by simulation. Compared with the traditional round robin  RR  algorithm [12], the ACA based algorithm achieves better performance.  The rest of the chapter is organized as follows: Sect. 2.2 introduces the system model and problem formulation. In Sect. 2.3, the resource allocation algorithms based on ACA is presented. Simulation results and performance analysis are provided in Sect. 2.4. Finally, we conclude the chapter in Sect. 2.5.  2.2 System Model and Problem Formulation  2.2.1 System Model  In this chapter, we consider a two-tier OFDMA network as shown in Fig. 2.1, where femtocells are deployed densely [7]. A macrocell base station  MBS  locates in the center of a disc area with a radius of Rm. At a distance Df from the MBS and within the coverage region of the MBS, femtocell base stations  FBS    {Bi} i = √ 1···K   are arranged in a square grid of area D2 K femtocells per dimension, at a distance D f from MBS. The radius of each femtocell is R f . Let D denote the distance between a transmitting mobile and the MBS. All femtocells are assumed to be closed access, and femtocells use the same frequency resource that the macrocell uses.  grid sq.km with   2.2 System Model and Problem Formulation  9  Fig. 2.1 The topology of a two-tier network  It is assumed that there are wired connections for the FBSs to communicate with the MBS. And there is one scheduled active user during each signaling slot in each femtocell. Let k ∈ {1, . . . ,K} denote the scheduled active user connected to its FBS Bi. The system has a total bandwidth B and divides it into N sub-channels, each with a bandwidth of B0 = B N. The channel fading of each subcarrier is assumed the same within a sub-channel, but may vary cross different sub-channels.  to its scheduled user on sub-channel n respectively. Let gi   m  We deﬁne p k,n as the transmission power of the MBS on sub-channel n to one  cid:4   i  i  k,n are the transmission powers of the serving FBS i to user k k,n and p of its users, p  cid:4  and the neighbor FBS i k,n,  cid:4   cid:4   i m,n denote the channel gain from the serving FBS i, the interfering FBS i  cid:4  g k and the MBS on sub-channel n to user k of femtocell i, respectively. We consider the channel model consisting of large scale fading and Rayleigh fading [14]. Therefore, the received signal to interference and noise ratio  SINR  for user k in femtocell i occupying the sub-channel n is given by:  , and gm    ,n     γk,n =  K∑ =1,k   cid:4   k   cid:4  cid:5 =k   cid:4  pi  cid:4  k  ,n  · g  · gi  k,n  pi k,n  cid:4   i  cid:4  k    ,n  + p   m  k,n  · gm m,n + N0· B0   2.1   where  K∑ =1,k   cid:4   k   cid:4  cid:5 =k   cid:4  pi  cid:4  k  ,n  · g   cid:4   i  cid:4  k    ,n  is the interference caused by other co-channel femtocells,  · gm m,n is the interference caused by the macro- that is co-channel interference. p cell, and N0 is the additive white Gaussian noise  AWGN  power spectral density.   m  k,n   10  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  In the following, we consider CTI only because CCI between different femtocells is much smaller than CTI caused by macrocell.  Based on Shannon’s capacity formula, the capacity  i.e., maximum achiev- able data rate  of the user k occupying the sub-channel n in femtocell i is given by:  rk,n = B0 · log2   cid:2  1 + α· γk,n   cid:3    2.2   where α is a constant SINR gap of AWGN channel to meet the target bit error rate  BER , and is deﬁned as α= −1.5  ln 5BER  .  2.2.2 Problem Formulation  Our target is to maximize the total data rate of all users of a femtocell  hereafter we omit the femtocell index i for simplicity , that is:  s.t.  ck,nrk,n  K∑ k=1 N∑ n=1  N∑ n=1 ck,n pk,n ≤ pmax  max K∑ k=1 pk,n ≥ 0, ∀k ∈ {1,2, . . . ,K} ,∀n ∈ {1,2, . . .,N} BERk ≤ BERrequest; ck,n ∈ {0,1} , ∀ k, n   2.3    2.4   where ck,n indicates whether sub-channel n is occupied by user k, and is denoted as follows:   cid:4   1 0  ck,n =  if subchannel n is occupied by user k  otherwise  the total transmission power of an FBS is constrained by pmax, and the power allocated on each sub-channel is nonnegative. The BER of each femtocell user k is upper bounded by the limit BERrequest, which is set according to user’s QoS requirement deﬁnes a sub-channel can only be used by one user at a time in each cell.  2.3 Resource Allocation Using ACA  In this section, ACA based resource allocation schemes are proposed in femtocells co-existing with a macrocell. We ﬁrst present a scenario that apply ACA in the resource allocation process for system, and then propose algorithms based on ACA. The algorithms allocate the sub-channels to users under the consideration of cross- tier interference and fairness among users.   2.3 Resource Allocation Using ACA  11  Fig. 2.2 Application of ACA for sub-channel allocation  2.3.1 Application of ACA in Resource Allocation  Traveling Salesman Problem  TSP  [9] is chosen as the basic model for resource allocation. As shown in Fig. 2.2, each node represents a state in the process of solution building by ants. Each node in the kth row denotes active user k  k ∈ 1,2, . . . ,K . Each node in the nth column denotes sub-channel n and  n∈ 1,2, . . . ,N . It is assumed that all the ants depart from the ﬁrst unoccupied sub-channel at the beginning. The selected routes  in terms of passed nodes  are recorded in a matrix. When node is selected more times, more guideline information will be provided and ant would like to choose it next time. The probability of ant m on sub-channel n choosing user k is given by  ⎧ ⎨ ⎩  0  pm k,n  =  τα k,n  · ηβ k,n     ∑ l∈Nm n  τα l,n  · ηβ l,n     i f k ∈ K  otherwise   2.5   where τk,n and ηk,n denote the pheromone trail and the heuristic information that ant m on sub-channel n chooses user k, respectively [10]. α and β are the parameters that determine the relative importance of pheromone trail versus heuristic information. If α is bigger, the solution process will stop at a route which likely a good solution; if β is bigger, it is likely that the system will ﬁnd a good solution but the convergence time may be long. So a proper setting of α and β is important for a good trade-off between the convergence time and system performance. Nm n denotes the set of available users for ant m on sub-channel n to traverse, which can be updated after each user has been selected.   12  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  The heuristic value is deﬁned as follows:  ηk,n = rk,n   ∑ l∈Nm  n  rl,n   Then ant m on sub-channel n will select user k with the following probability   cid:8   argmaxl∈Nm pk,n  n   cid:9    cid:10   τl,n  ηl,n   cid:12   cid:11 β  ,  i f q ≤ q0 else  where q is a random variable uniformly distributed in [0,1], q0 0 ≤ q0 ≤ 1  is an adjusting coefﬁcient, which means the probability of an ant choosing the best possible node at the current time. Equation  2.7  provides a way to control the convergence rate in acquiring the solution of the optimization problem in  2.3 . In general, ants are more likely to choose nodes that have larger pheromone and heuristic values. When each ant arrives at the destination, the local pheromone is updated according to  τk,n ←  1− ρ τk,n + ρτ0   2.8   where 0 < ρ < 1 is a variable that controls the evaporation of local pheromone, and can make the system forget the bad route and quickly converge to a good solution; τ0 is the initial value of local pheromone. The local updating changes pheromone on each node and inspires the selection of nodes whose pheromones change dynamically. When all the ants have traversed all the sub-channels, then the global pheromone updates according to  where θ is the pheromone evaporation parameter, 0 < θ < 1, and Δτ c pheromone on the best path that an ant chooses, which is given by  k,n denotes the  τk,n ←  1− θ τk,n + θΔτ c  k,n  Δτ c k,n  = Q Lgb   2.6    2.7    2.9    2.10   where Lgb is the global optimal path. Q is a positive coefﬁcient of Δτ c k,n, and the pheromone concentration will be accelerated if Q is bigger. Pheromone evaporation and receiving reinforcement are carried out on the nodes of the best path, which makes the process of searching for the best solution more efﬁcient and direct.  2.3.2 Algorithm Description  In this section, we present different dynamic resource allocation schemes based on ACA, including ACA based Maximizing Capacity with Modiﬁed Fairness  ACA- MF , ACA based Maximizing Capacity with Further Fairness  ACA-FF , and ACA based Maximizing Capacity  ACA-MC .   2.3 Resource Allocation Using ACA  13  The algorithm ACA-MF is proposed to maintain proportional fairness while increasing overall capacity. ACA-MF ﬁrst assigns the corresponding optimal sub- channels to each user, and allocates, the remaining sub-channels following a greedy policy. In practical systems, the underlying premise is that a rough proportional fairness is achievable, the throughput is improved and the computational complexity is low. The pseudo code of ACA-MF is given as Algorithm 1.  Algorithm 1 ACA-MF 1: ACA-MF parameters initialization: the initial value of pheromone on each node is set as τ0;  heuristic information is set according to  2.6 ;  2: sort the sub-channels in decreasing order according to the channel gain gk,n; 3: set the number of sub-channels Nk that will be allocated to user k in the beginning, here we  design Nk = K for any k, and assign these sub-channels to each user in the following way.  4: for k = 1 to K do 5:  n = arg maxn cid:4 ∈N ck,n = 1, Nk = Nk − 1, N = N\{n}   cid:13   cid:13 gk,n cid:4    cid:13   cid:13   6: end for 7: for the rest sub-channels, each ant starts from the ﬁrst unoccupied sub-channel to traverse, and will select users for the current sub-channel according to  2.7 , where the pheromone and heuristic information are the subset from step 1 on the rest numbers in N;  8: carry out the local pheromone updating for each sub-channel according to  2.8 ; 9: carry out the global pheromone updating when complete solutions are acquired according  10: when it achieves the maximum iteration number or convergence, the algorithm ends; else go  to  2.9 ;  to step 1, calculate  16 ;  Compared with ACA-MF, ACA-FF provides improved proportional fairness among users, but has a lower capacity. The pseudo code of ACA-FF is given as Algorithm 2.  Algorithm 2 ACA-FF 1: Starting from the ﬁrst unoccupied sub-channel, ants select users for the current sub-channel  according to  ηk,n =  log 1 + rk,n + Rk − log 1 + Rk   log 1 + rk,n + Rl − log 1 + Rl    ∑ l∈Nm n  where the heuristic value is deﬁned as in [10], Rk indicates the transmission rate of user k at current time.  2: the local pheromone updates according to  2.8 ; 3: the global pheromone updates according to  2.9 ; 4: if the algorithm achieves the maximum number of iteration or convergence, the algorithm ends;  else go to step 1.  ACA-MC consists of only steps 4–7 of Algorithm 1, aiming to maximize the  capacity of the system.   14  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  2.3.3 Parameters and Convergence of ACA  The parameter τ0 is the initial setting of pheromone trail. If τ0 is too small, the search will end up with a local-best solution; otherwise, many iterations at the beginning in the starting will be wasted. The parameter ηk,n plays a guiding role in ants’ search for solution at the beginning when the values of pheromone are set the same for all nodes. The deﬁnition of heuristic information inﬂuences the solution process and the fairness among users. The function of parameters α and β has been illustrated in Sect. 2.3.1.  The convergence of ACA has been proved in [15]. With the use of parallel  processors, the convergence time can be reduced signiﬁcantly.  2.4 Performance Evaluation  In order to evaluate the performance of the algorithms based on ACA, Monte-Carlo simulation is used. The simulation parameters are summarized in Table 2.1. System capacity, fairness among users and the throughput improvement of the presented schemes are evaluated and compared with RR algorithm. We consider the system model described in Sect. 2.2. The number of femtocells is chosen from the set Fn = {4,9,16,25,36,49}.  Table 2.1 System parameters used in simulation  Parameter Macrocell femtocell radius Grid size Dgrid Carrier frequency fc,MHz System bandwidth B MBS  FBS TX power Channel model Number of the sub-channels Thermal noise density Out- In-door path loss  exponent  ACA parameters Monte-Carlo times  Value 288 5 m 100 m 2 GHz 10 MHz 46 20 dBm Large scale Fading and Rayleigh 50 174 dBm Hz 4 3  τ0 = 1, α= 1, β = 3 100  Figure 2.3 shows the total capacity of the femtocells versus the number of femtocells. As can be seen from the ﬁgure, the proposed ACA-MF algorithm improves the total capacity of the femtocells over the RR algorithm signiﬁcantly. Apparently, ACA-MC achieves the best throughput among the four algorithms for it   2.4 Performance Evaluation  15  Fig. 2.3 Capacity comparison of different algorithms  x 108  1.8    s p b   m e  t s y s   l l  e c o t m e  f   f  o    y t i c a p a c   l  a  t  o  t  1.6  1.4  1.2  1  0.8  4  ACA−MF ACA−MC ACA−FF RR  8  12  16  20  24  28  32  36  40  44  48 50  femtocells per cellsite  always distributes the optimal sub-channels to the users, followed by ACA-MF. The capacity that RR achieves is the most unstable, because of the mutual independence of the sub-channels when allocated to the users in a round robin fashion. It can also be seen that in ACA-MF and ACA-FF algorithms, the total capacity of femtocells decreases a little when the number of femtocells is larger than 25. This is mainly because the interference caused by users is too much while the number of iterations is insufﬁcient. The capacity obtained by ACA-MC always increases with the number of femtocells because it always allocate the optimal sub-channels to users.  Figure 2.4 illustrates the capacity improvements of ACA algorithms when the number of femtocells is 9. It can be seen that the ACA based algorithms can converge within a limited number of iterations, and all the ACA based algorithms improve the capacity greatly versus RR. In the early iterations, ACA-MF scheme can obtain higher capacity than ACA-MC, because it distributes the optimal sub- channels to each user at the beginning when the ACA-MC hasn’t found the global optimal solution yet. ACA-MF achieves a good solution a little later than ACA-MC, but still holds a higher capacity than ACA-FF and RR.  To compare the user-fairness performance of the four considered schemes, we use the Raj Jain Fairness Index [16] to measure the fairness among users, which is deﬁned as:  F r1,r2, . . . ,rK  =    K∑  rk 2  K · K∑  2   rk  k=1  k=1   2.11    16  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  x 108  1.55    s p b   m e t y s y s   l l  e c o t m e  f   f  o    y t i c a p a c   l  a  t  o  t  1.5  1.45  1.4  1.35  1.3  1.25  1  0.8  0.6  0.4  0.2  r o  t c a  f   s s e n r i a  f  5  10  15  20 the iteration times  25  30  Fig. 2.4 Capacity improvements of different algorithms  Fig. 2.5 Fairness comparison of different algorithms  ACA−MF ACA−MC ACA−MC RR  ACA−MF ACA−MC ACA−FF RR  0  4  8  12  16  20  28  24  32 femtocells per cellsite  36  40  44  48 50  where rk is the already assigned rate of the corresponding user k, and K is the total number of femto users. The bigger the fairness index, the better the fairness among users.  As shown in Fig. 2.5, the conventional RR provides the best fairness because it minimizes the variance of sub-channel resources allocated to different users. However, in practice, there’s no need for users to occupy similar amounts of sub- channels. The ACA-FF algorithm provides proportional fairness among users that   References  17  is close to that of RR but is much better than ACA-MC schemes. The fairness index of ACA-MF ﬁrst decreases and then increases with the number of femtocells, and reaches a similar value as the RR and ACO-FF schemes when the number of femtocells is 49.  2.5 Conclusion  Sub-channel allocation algorithms based on Ant Colony Algorithm are presented in this chapter. As a typical meta-heuristic method, ACA provides simple and robust way for resource-allocation optimization. We formulate the resource allocation problem as path searching in a graph, and use the pheromone trail and the heuristic information to guide the construction of solution construction. In comparison with the traditional RR algorithm, better throughput can be achieved by ACA based algorithms. ACA-MF and ACA-FF can guarantee the fairness among users while meeting rate requirements.  Acknowledgements The authors would like to thank Ms. Deli Liu for her contribution and helpful discussions. This research has been supported by National Key Technology R&D Program of China  2010ZX03003-001-01, 2011ZX03003-002-01 , National Natural Science Foundation of China  61101109 , Co-building Project of Beijing Municipal Education Commission “G- RAN based Experimental Platform for Future Mobile Communications”, “Research on Resource Allocation and Scheduling Strategy of Future Wireless Communication System” and “Cooperative Communications Platform for Multi-agent Multimedia Communications”, Key Fund of Beijing Key Laboratory on Future Network Research.  References  1. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  2. E-UTRA and E-UTRAN Overall Description, 3GPP Std. TS 36.300 v10.0.0, 2010. 3. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  4. D. López-Pérez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Commun. Mag., vol. 47, no. 9, pp. 41–48, 2009.  5. R. Madan, A. Sampath, N. Bhushan, A. Khandekar, J. Borran, and T. Ji, “Impact of coordination delay on distributed scheduling in lte-a femtocell networks,” in Global Telecom- munications Conference  GLOBECOM 2010 , 2010 IEEE, 2010, pp. 1–5.  6. K.-S. Lee and D.-H. Cho, “Cooperation based resource allocation for improving inter- cell fairness in femtocell systems,” in Personal Indoor and Mobile Radio Communications  PIMRC , 2010 IEEE 21st International Symposium on, 2010, pp. 1168–1172.  7. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328, 2009.  8. J. Zhang, Z. Zhang, K. Wu, and A. Huang, “Optimaldistributed subchannel, rate and power allocation algorithm in ofdm-based two-tier femtocell networks,” in IEEE VTC’10 Spring, May, pp. 1–5.   18  2 Ant Colony Algorithm  ACA  Based Downlink Resource Allocation in Femtocells  9. M. Dorigo, V. Maniezzo, and A. Colorni, “Ant system: optimization by a colony of cooperating agents,” Systems, Man, and Cybernetics, Part B: Cybernetics, IEEE Transactions on, vol. 26, no. 1, pp. 29–41, 1996.  10. Y. Zhao, X. Xu, Z. Hao, X. Tao, and P. Zhang, “Resource allocation in multiuser ofdm system based on ant colony optimization,” in Wireless Communications and Networking Conference  WCNC , 2010 IEEE, 2010, pp. 1–6.  11. R. Lin, K. Niu, W. Xu, and Z. He, “A two-level distributed sub-carrier allocation algorithm based on ant colony optimization in ofdma systems,” in Vehicular Technology Conference  VTC 2010-Spring , 2010 IEEE 71st, 2010, pp. 1–5.  12. X. Zhang, W. Ye, S. Feng, and H. Zhuang, “Adaptive resource allocation for ofdma system based on ant colony algorithm,” in Information Science and Engineering  ICISE , 2009 1st International Conference on, 2009, pp. 2526–2529.  13. D. Liu, H. Zhang, W. Zheng, X. Wen, L. Li, “The Sub-channel Allocation Algorithm in  Femtocell Networks Based on Ant Colony Optimization,” accepted by MILCOM 2012.  14. D. Wu and R. Negi, “Effective capacity: a wireless link model for support of quality of service,”  Wireless Communications, IEEE Transactions on, vol. 2, no. 4, pp. 630–643, 2003.  15. T. Stutzle and M. Dorigo, “A short convergence proof for a class of ant colony optimization algorithms,” Evolutionary Computation, IEEE Transactions on, vol. 6, no. 4, pp. 358–365, 2002.  16. R. Jain, D.-M. Chiu, and W. R. Hawe, A quantitative measure of fairness and discrimination Eastern Research Laboratory, Digital  for resource allocation in shared computer system. Equipment Corporation, 1984.  17. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co-  channel deployment,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1225–1241, 2011.  18. K. Son, S. Lee, Y. Yi, and S. Chong, “Reﬁm: A practical interference management in heterogeneous wireless access networks,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1260–1272, 2011.  19. M. Yavuz, F. Meshkati, S. Nanda, A. Pokhariyal, N. Johnson, B. Raghothaman, and A. Richard- son, “Interference management and performance analysis of umts hspa+ femtocells,” IEEE Commun. Mag., vol. 47, no. 9, pp. 102–109, Sep. 2009.  20. H.-S. Jo, C. Mun, J. Moon, and J.-G. Yook, “Interference mitigation using uplink power control for two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 10, pp. 4906– 4910, Oct. 2009.  21. I. Guvenc, M.-R. Jeong, F. Watanabe, and H. Inamura, “A hybrid frequency assignment for femtocells and coverage area analysis for co-channel operation,” IEEE Commun. Lett., vol. 12, no. 12, pp. 880–882, Dec. 2008.  22. J. Kim and D.-H. Cho, “A joint power and subchannel allocation scheme maximizing system capacity in indoor dense mobile communication systems,” IEEE Trans. Veh. Technol., vol. 59, no. 9, pp. 4340–4353, 2010.  23. J. Zhang, Z. Zhang, K. Wu, and A. Huang, “Optimal distributed subchannel, rate and power allocation algorithm in ofdm-based two-tier femtocell networks,” in Proc. Veh. Technol. Conf., May 2010, pp. 1–5.  24. L. Giupponi and C. Ibars, “Distributed interference control in ofdma-based femtocells,” in  IEEE PIMRC’10, Sept. 2010, pp. 1201–1206.  25. K. Lee, H. Lee, and D.-H. Cho, “Collaborative resource allocation for self-healing in self-  organizing networks,” in IEEE Int. Conf. Commun., June 2011, pp. 1–5.  26. J. W. Huang and V. Krishnamurthy, “Cognitive base stations in lte 3gpp femtocells: A correlated equilibrium game-theoretic approach,” IEEE Trans. Wireless Commun., vol. 59, no. 12, pp. 3485–3493, Dec. 2011.  27. D.-C. Oh, H.-C. Lee, and Y.-H. Lee, “Power control and beamforming for femtocells in the presence of channel uncertainty,” IEEE Trans. Veh. Technol., vol. 60, no. 6, pp. 2545–2554, July 2011.  28. M. Tao, Y.-C. Liang, and F. Zhang, “Resource allocation for delay differentiated trafﬁc in multiuser ofdm systems,” IEEE Trans. Wireless Commun., vol. 7, no. 6, pp. 2190–2201, June 2008.   References  19  29. Y. Zhang and C. Leung, “Cross-layer resource allocation for mixed services in multiuser ofdm- based cognitive radio systems,” IEEE Trans. Veh. Technol., vol. 58, no. 8, pp. 4605–4619, Oct. 2009.  30. S. Haykin, “Cognitive radio: brain-empowered wireless communications,” IEEE J. Sel. Areas  in Commun., vol. 23, no. 2, pp. 201–220, Feb. 2005.  31. D. T. Ngo and T. Le-Ngoc, “Distributed resource allocation for cognitive radio networks with spectrum-sharing constraints,” IEEE Trans. Veh. Technol., vol. 60, no. 7, pp. 3436–3449, Sept. 2011.  32. R. Xie, F. R. Yu, and H. Ji, “Dynamic resource allocation for heterogeneous services in cognitive radio networks with imperfect channel sensing,” IEEE Trans. Veh. Technol., no. 99, p. 1, 2011.  33. K. W. Choi, E. Hossain, and D. I. Kim, “Downlink subchannel and power allocation in multi- cell ofdma cognitive radio networks,” IEEE Trans. Wireless Commun., vol. 10, no. 7, pp. 2259– 2271, July 2011.  34. Y. Ma, D. I. Kim, and Z. Wu, “Optimization of ofdma-based cellular cognitive radio networks,”  IEEE Trans. Commun., vol. 58, no. 8, pp. 2265–2276, Aug. 2010.  35. Way forward proposal for  H eNB to HeNB mobility, 3GPP Std. R3-101 849, 2010. 36. H.-S. Jo, C. Mun, J. Moon, and J.-G. Yook, “Interference mitigation using uplink power control for two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 10, pp. 4906– 4910, Oct. 2009.  37. S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004. 38. D. W. K. Ng and R. Schober, “Resource allocation and scheduling in multi-cell ofdma systems with decode-and-forward relaying,” IEEE Trans. Wireless Commun., vol. 10, no. 7, pp. 2246– 2258, July 2011.  39. C. Y. Wong, R. Cheng, K. Lataief, and R. Murch, “Multiuser ofdm with adaptive subcarrier, bit, and power allocation,” IEEE J. Sel. Areas in Commun., vol. 17, no. 10, pp. 1747–1758, Oct. 1999.  40. W. Yu and R. Lui, “Dual methods for nonconvex spectrum optimization of multicarrier  systems,” IEEE Trans. Commun., vol. 54, no. 7, pp. 1310–1322, July 2006.  41. J. K. Chen, G. de Veciana, and T. S. Rappaport, “Site-speciﬁc knowledge and interference measurement for improving frequency allocations in wireless networks,” IEEE Trans. Veh. Technol., vol. 58, no. 5, pp. 2366–2377, June 2009.  42. Further Advancements for E-UTRA, Physical Layer Aspects, 3GPP Std. TR 36.814 v9.0.0,  2010.  43. Z. Shen, J. G. Andrews, and B. L. Evans, “Adaptive resource allocation in multiuser ofdm systems with proportional rate constraints,” IEEE Trans. Wireless Commun., vol. 4, no. 6, pp. 2726–2737, Nov. 2005.   Chapter 3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier Networks  Abstract Femtocells have been considered as a promising technology to provide better indoor coverage and spatial reuse gains. However, the co-channel deployment of macrocells and femtocells is still facing challenges arising from potentially severe inter-cell interference. In this paper, we investigate the uplink resource allocation problem of femtocells in co-channel deployment with macrocells. We ﬁrst model the uplink power and subchannel allocation in femtocells as a non-cooperative game, where inter-cell interference is taken into account in maximizing the femtocell capacity and uplink femto-to-macro interference is alleviated by charging each femto user a price proportional to the interference that it causes to the macrocell. Based on the non-cooperative game, we then devise a semi-distributed algorithm for each femtocell to ﬁrst assign subchannels to femto users and then allocate power to subchannels. Simulation results show that the proposed interference- aware femtocell uplink resource allocation algorithm is able to provide improved capacities for not only femtocells but also the macrocell, as well as comparable or even better tiered fairness in the two-tier network, as compared with existing unpriced subchannel assignment algorithm and modiﬁed iterative water ﬁlling based power allocation algorithm.  3.1 Introduction  Nowadays above 50% of voice services and 70% of data trafﬁcs occur indoors [1]. Insufﬁcient indoor coverage of macrocells has led to increasing interest in femtocells, which have been considered in major wireless communication standards such as 3GPP LTE LTE-Advanced [2]. Dedicated-channel deployment of femto- cells, where femtocells and macrocells are assigned with different  or orthogonal  frequency bands, may not be preferred by operators due to the scarcity of spectrum resources and difﬁculties in implementation. While in co-channel deployment, where femtocells and macrocells share the same spectrum, cross-tier interference could be severe [3], especially when femtocell base stations  FBSs  are deployed  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__3,   The Author s  2013  21   22  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  close to a macrocell base station  MBS  [5]. Due to the fundamental role of macrocells in providing blanket cellular coverage, their capacities and coverage should not be affected by co-channel deployment of femtocells.  Power control has been widely used to mitigate inter-cell interference in co- channel deployment of femtocells. For alleviating uplink interference caused by co-channel femto users to macrocells, a distributed femtocell power control algo- rithm is developed based on non-cooperative game theory in [6], while in [7] femto users are priced in power allocation for causing interference to macrocells based on a Stackelberg model. In [8], cross-tier interference is mitigated through both open-loop and closed-loop uplink power control. In [9], a distributed power control scheme is proposed based on a supermodular game.  A lot of work has also been done on subchannel allocation in co-channel deploy- ment of femtocells. In [10], a hybrid frequency assignment scheme is proposed for femtocells deployed within coverage of a macrocell. In [11], distributed channel selection schemes are proposed for femtocells to avoid inter-cell interference, at the cost of reduced frequency reuse efﬁciency. In [12], a subchannel allocation algorithm based on a potential game model is proposed to mitigate both co-tier and cross-tier interference.  Recently, several studies considering both power and subchannel allocation in femtocells have been reported. In [13], a joint power and subchannel allocation algorithm is proposed to maximize the total capacity of densely deployed femto- cells, but the interference caused by femtocells to macrocells is not considered. In the collaborative resource allocation scheme [14], cross-tier interference is approximated as additive white Gaussian noise  AWGN . In the Lagrangian dual decomposition based resource allocation scheme [15], constraints on cross-tier interference are used in power allocation, but subchannels are assigned randomly to femto users. In [16], a distributed downlink resource allocation scheme based on a potential game and convex optimization is proposed to increase the total capacity of macrocells and femtocells, but at the price of reduced femtocell capacity. In [17], the distributed power and subchannel allocation for co-channel deployed femtocells is modeled as a non-cooperative game, for which a Nash Equilibrium is obtained based on a time-sharing subchannel allocation, but the constraint on maximum femto-user transmit power is ignored in solving the non-cooperative game.  In this chapter, we focus on the uplink power and subchannel allocation problem of orthogonal frequency division multiple access  OFDMA  based femtocells in co-channel deployment with macrocells [18, 19]. We ﬁrst model the uplink power and subchannel allocation in femtocells as a non-cooperative game, where inter- cell interference is taken into account in maximizing femtocell capacity and uplink interference from femto users to the macrocell is alleviated by charging each femto user a price proportional to the amount of interference that it causes to the macrocell. Based on the non-cooperative game, we then devise a semi-distributed algorithm for each femtocell to ﬁrst assign subchannels to femto users and then allocate power to subchannels accordingly. Simulation comparisons with existing unpriced subchannel assignment and modiﬁed iterative water ﬁlling  MIWF  based power allocation algorithms show that the proposed interference-aware femtocell uplink   3.2 System Model and Problem Formulation  23  resource allocation algorithm is able to provide improved capacities for not only femtocells but also the macrocell, as well as comparable or even better tiered fairness in a co-channel two-tier network.  The rest of this chapter is organized as follows. The system model and problem formulation are presented in Sect. 3.2. In Sect. 3.3, the interference-aware femtocell uplink resource allocation algorithm is proposed. Performance of the proposed algorithm is evaluated by simulations in Sect. 3.4. Finally, Sect. 3.5 concludes the paper.  3.2 System Model and Problem Formulation  3.2.1 System Model  As shown in Fig. 3.1, we consider a two-tier OFDMA network where K co-channel FBSs are randomly overlaid on a macrocell. We focus on resource allocation in the uplink of femtocells, that is, the subchannel assignment to femto users and the power allocation on subchannels in femtocells. Let M and F denote the numbers of active macro users camping on the macrocell and active femto users camping on each femtocell, respectively. Users are uniformly distributed in the coverage area of their serving cell. All femtocells are assumed to be closed access [20]. The OFDMA system has a bandwidth of B, which is divided into N subchannels. Channel fading  Fig. 3.1 Topology of the two-tier network comprising by a macrocell and K co-channel femtocells   24  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  k,u,n and gFF  We denote gMF  on each subcarrier is assumed the same within a subchannel, but may vary across different subchannels. We assume that channel fading is composed of path loss and frequency-ﬂat Rayleigh fading. j,k,u,n as the channel gains on subchannel n from femto user u in femtocell k to the MBS and FBS j, respectively, where j,k ∈ {1,2, . . .,K}, u ∈ {1,2, . . . ,F}, and n ∈ {1,2, . . .,N}; denote gM k,w,n as the channel gains on subchannel n from macro user w ∈ {1,2, . . .,M}  to the MBS and FBS k, respectively; denote pF w,n as the transmit power levels on subchannel n of femto user u in femtocell k and macro user w, respectively. Then we deﬁne ]K×F as the power allocation matrix of the K femtocells on subchannel Pn = [pF n, and An = [ak,u,n]K×F as the subchannel assignment indication matrix for the K femtocells on subchannel n, where ak,u,n = 1 if subchannel n is assigned to femto user u in femtocell k, and ak,u,n = 0 otherwise.  k,u,n and pM  w,n and gFM  k,u,n  The received signal to interference plus noise ratio  SINR  for femto user u on  the nth subchannel in the kth femtocell is given by  γF k,u,n  =   K,F  ∑    j,v  cid:5 = k,u   ak,u,n pF  k,u,ngFF  k,k,u,n  a j,v,n pF  j,v,ngFF  k, j,v,n  + pM  w,ngFM k,w,n  + σ2  where   K,F  ∑    j,v  cid:5 = k,u   a j,v,n pF  j,v,ngFF  k, j,v,n  =  a j,v,n pF  j,v,ngFF  k, j,v,n  K∑ j=1  F∑ v=1  interference caused by other co-channel femtocells, pM caused by the macrocell, and σ2 is the AWGN power.  −ak,u,n pF w,ngFM k,w,n is the interference  k,k,u,n is the  k,u,ngFF  The SINR for macro user w using the nth subchannel is given by  Based on Shannon’s capacity formula, the capacities on subchannel n of femto  user u in femtocell k and macro user w are given respectively by  γM w,n =  pM w,ngM w,n j,v,ngMF j,v,n  a j,v,n pF  + σ2  K∑ j=1  F∑ v=1  CF k,u,n  CM w,n  = B N = B N  log2   1 + γF  k,u,n     log2   1 + γM w,n      3.1    3.2    3.3    3.4    25   3.5    3.6    3.7    3.8   3.3 Interference-Aware Resource Allocation  3.2.2 Problem Formulation  The maximization of the total capacity of the K femtocells is formulated as follows.  where a femto user’s total transmit power is constrained by pmax, the power allocated to each subchannel is nonnegative, and each subchannel is assigned to no more than one user per femtocell.  It is assumed that the user assignment and power allocation can be performed independently for each subchannel, then the maximization of the total capacity of K femtocells is equivalent to the maximization of the total capacity of the K femtocells on one subchannel, and  3.5  and  3.6  can be simpliﬁed to  max  K∑  F∑  N∑  k=1  u=1  n=1  CF k,u,n  ⎧  ⎪⎪⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎪⎪⎩  s.t.  ≤ pmax,∀k,u  k,u,n  ak,u,n pF  ≥ 0,∀k,u,n  N∑ n=1 pF k,u,n ak,u,n ∈ {0,1},∀k,u,n ak,u,n ∈ {0,1},∀k,n F∑ u=1  k=1  u=1  max  , ∀n K∑ F∑ CF k,u,n ≤ pmax ,∀k,u,n pF k,u,n ≥ 0,∀k,u,n pF k,u,n ak,u,n ∈ {0,1},∀k,u,n ak,u,n ∈ {0,1},∀k,n F∑ u=1  n  ⎧ ⎪⎪⎪⎪⎨ ⎪⎪⎪⎪⎩  s.t.  where pmax Without loss of generality, we assume that pmax  n  is the transmit power constraint on subchannel n for a femto user.  n = pmax  N.   cid:15   3.3 Interference-Aware Resource Allocation  In this section, we ﬁrst model the uplink power and subchannel allocation problem in femtocells using a non-cooperative game theory framework [21, 22], where a pricing scheme is imposed on femto users to mitigate the uplink interference caused by femto users to the macrocell. Then based on the non-cooperative game frame- work, we propose a semi-distributed algorithm for femtocells to assign subchannels to femto users assuming an arbitrary power allocation, and then optimize the power allocation on subchannels based on the obtained subchannel assignment.   26  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  3.3.1 A Game Theoretic Framework  Based on the microeconomic theory [23], we model the femtocell uplink resource allocation problem as a femtocell non-cooperative resource allocation game  FNRAG . The K femtocells are considered as selﬁsh, rational players. Each of them tries to maximize its utility without considering the impact on other players. The FNRAG for subchannel n can be expressed as Gn =  cid:10 K,{An,Pn}, μ c   3.9  where K = {1, . . . ,k, . . . ,K},∀n ∈ {1,2, . . . ,N} is the set of femtocells playing the game; {An,Pn} is the strategy space of the players, with An and Pn being the subchannel assignment space and the power allocation strategy space, respectively; } is the set of net utility functions of the K = {μ c and μ c 1,n n players, in which  , . . . , μ c  , μ c 2,n   cid:11  ,∀n  K,n  n  μ c k,n  =  F∑  u=1   CF  k,u,n  − αak,u,ngMF  k,u,n pF  k,u,n      3.10   where α ∈ R +   bps Watt  is the pricing factor, and the price charged on a femto user is proportional to the uplink interference that it causes to the macrocell. If without the pricing part in the utility function, then a player will tend to maximize its utility by using the maximum transmit power, because CF k,u,n monotonically increases with pF k,u,n according to  3.1  and  3.3 . This will lead to severe uplink interference to the macrocell.  Given the power and subchannel allocation in all other co-channel femtocells,  the net utility function of femtocell k can be rewritten as  μ c k,n   pk,n,ak,nP−k,n,A−k,n =  F∑ u=1  [ B N log2   1 + ak,u,n pF  k,u,ngFF Ik,u,n  k,k,u,n   − αak,u,ngMF  k,u,n pF  k,u,n  ]   3.11  where pk,n = {pF }, ak,n = {ak,1,n,ak,2,n, . . . ,ak,F,n}, P−k,n is the  K − 1 × F matrix  K − 1 × F matrix obtained by removing the kth row from Pn, A−k,n is the  K − 1  × F matrix obtained by removing the kth row from An, and Ik,u,n =  a j,v,n pF  , . . . , pF  + σ2.   K,F  ∑  + pM  , pF  k,F,n  k,1,n  k,2,n  j,v,ngFF  w,ngFM k,w,n  k, j,v,n    j,v  cid:5 = k,u   Deﬁnition 1. Given the uplink power allocation and subchannel assignment of all other co-channel femtocells, the best response of femtocell k is given by    ˆpk,n, ˆak,n  =arg max pk,n,ak,n  μ c k,n   pk,n,ak,nP−k,n,A−k,n  ,∀k   3.12    3.3 Interference-Aware Resource Allocation  27  In the following subsections, in order to solve the non-cooperative femtocell uplink resource allocation game in a semi-distributed manner, we devise a semi- distributed algorithm for each femtocell to ﬁrst assign subchannels to its femto users for given power and subchannel allocation in all other femtocells and assuming an arbitrary power allocation of its own, and then optimize the power allocation based on the obtained subchannel assignment.  3.3.2 Interference-Aware Subchannel Allocation  In this subsection, we improve the subchannel allocation method in [24, 25] by pricing femto users according to their interference to macrocell in femtocell subchannel allocation.  Assuming that the kth row of the matrix Pn contains an arbitrary power allocation of femtocell k on subchannel n, and given the power allocation and subchannel assignment of all other femtocells on subchannel n, then the best assignment of subchannel n in femtocell k is given by  ˆak,n =argmax ak,n  μ c k,n   ak,nPn,A−k,n  ,∀k   3.13   According to  3.8 , at most one element of ak,n can take value of 1. Therefore,  based on  3.11 , the problem in  3.13  is equivalent to   cid:16    cid:17   ˆuk,n = argmax  u  B N log2   1 + pF  k,u,ngFF Ik,u,n  k,k,u,n   − αgMF  k,u,n pF  k,u,n  ,∀k,n   3.14   where ˆuk,n is the best user for channel n in femtocell k to assign, and the assignment of subchannel n in femtocell k is indicated by ˆak,n = { ˆak,1,n, ˆak,2,n, . . . , ˆak,F,n}, where   cid:4   ˆak,u,n =  1, if u = ˆuk,n, 0, otherwise.  In order to remove the dependence of the subchannel assignment on the assumed  arbitrary power allocation, we let ˆγk,n = max of femto user u corresponding to ˆγk,n is given by ˆγk,nIk,u,n rewritten as  gFF k,k,u,n  k,u,ngFF pF Ik,u,n  k,k,u,n  u   cid:16    cid:17   , and then the transmit power  . Accordingly,  3.14  can be  ˆuk,n = argmax  u  B N log2   1 + ˆγk,n − αgMF  k,u,n  ˆγk,nIk,u,n gFF k,k,u,n  = argmin u  gMF k,u,n gFF k,k,u,n  Ik,u,n ,∀k,n   3.15    3.16    28  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  3.3.3 Interference-Aware Power Allocation  Once the uplink subchannel assignment has been determined by using  3.15  and  3.16  in each femtocell, the FNRAG in  3.9  can be reduced to a femtocell  cid:11  ,∀n. Since non-cooperative power allocation game  FNPAG : Gn subchannels have been assigned to speciﬁc femto users in each cell, we will drop the subscript u for simplicity hereafter. } as the optimal transmit power Deﬁnition 2. Denote ˆpn = { ˆpF , ˆpF 2,n vector of the K co-channel femto users allocated to subchannel n under Nash  cid:4  Equilibrium in the FNPAG Gn   cid:4  =  cid:10 K,Pn, μ c  , . . . , ˆpF  , if  K,n  1,n  n  k,n   pF k,n    ˆpF k,n   ˆp−k,n,An  ≥ μ c   ˆp−k,n,An ,∀pF μ c  3.17  k,n where ˆp−k,n = { ˆpF } is the optimal transmit power vec- tor of the K − 1 co-channel femto users using subchannel n under Nash Equilibrium except for the co-channel femto user in femtocell k, and Nash Equilibrium is deﬁned as the ﬁxed points where no player can improve its utility by changing its strategy unilaterally [23].  , . . . , ˆpF  , . . . , ˆpF  ≥ 0  k−1,n  , ˆpF  k+1,n  K,n  1,n  k,n  Theorem 1. A Nash Equilibrium exists in the FNPAG: Gn Proof. According to [23], a Nash Equilibrium exists in Gn conditions are satisﬁed: 1. Pn is non-empty, convex and compact in the ﬁnite Euclidean space ℜK×F . 2. μ c  n is continuous and concave with respect to Pn.  n   cid:4  =  cid:10 K,Pn, μ c  cid:4    cid:11  ,∀n.  if the following two  Since the power allocated on each subchannel is constrained between zero and , the power allocation matrix Pn is convex and compact,  the maximum power pmax and condition 1 is satisﬁed.  n  For condition 2, it can be seen from  3.11  that μ c  n is continuous with respect to Pn. To prove the quasi-concave property of  3.11 , we take the derivative of  3.11  with respect to pF  k,n, and get  Taking the second-order derivative of  3.11  with respect to pF  k,n yields  ∂μ c k,n ∂pF k,n  = B  N ln 2   cid:18   gFF k,k,n Ik,n + pF k,ngFF k,k,n   cid:19  − αgMF  k,n  ∂2μ c k,n ∂2 pF k,n  = − B N ln2   2   gFF k,k,n  Ik,n + pF k,ngFF k,k,n   2  ≤ 0   3.18    3.19    3.3 Interference-Aware Resource Allocation  29  Therefore, μ c  k,n is a quasi-concave function of pF  hold, a Nash Equilibrium exists in the FNPAG. This completes the proof.  k,n. Since both conditions 1 and 2  cid:2   Lemma 1. The best response of femtocell k to the FNPAG is given by   3.20    3.21    3.22    cid:2   ˆpk,n = ˆpF k,n ˆak,n  cid:20   ˆpF k,n  =  B  N ln 2  ·  1  αgMF k,n  − Ik,n gFF k,k,n   cid:21   pmax n  0  a = min{max{a,x},b}.  where [x]b Proof. The ˆpF resulting equation for pF  k,n in  3.21  is obtained by setting  3.18  to zero and solving the  cid:2  Since  3.21  should be nonnegative, and the interference price factor α is  k,n.  nonnegative too, we get  0 ≤ α≤ B N ln2  · gFF k,k,n gMF k,n Ik,n  Theorem 2. The FNPAG has a unique Nash Equilibrium.  Proof. It can be proved following similar proof in [6, 27].  3.3.4 Semi-distributed Implementation  Since only local information, such as uplink interference and channel gains seen by femto users, is needed in calculating  3.16  and  3.21 , the interference- aware femtocell uplink subchannel allocation scheme and power allocation scheme proposed in Sects. 3.3.2 and 3.3.3 can be implemented in a distributed and semi- distributed manner, respectively, as outlined in Algorithm 1.  Note that, gFF  k, j,v,n and gFM  k,w,n for the uplink can be estimated at femto user u in femtocell k by measuring the downlink channel gain of subchannel n from femtocell j and the macrocell, respectively, and utilizing the symmetry between uplink and downlink channels, or by using the site speciﬁc knowledge [6]. Furthermore, it can be assumed that there is a direct wire connection between an FBS and the MBS for the FBS to coordinate with the central MBS [5, 7], according to a candidate scheme proposed for 3GPP HeNB mobility enhancement [28].   30  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  Algorithm 1 can be implemented by each FBS, which only utilizes local information and has limited interaction with the MBS, therefore, Algorithm 1 is semi-distributed and the practicability is guaranteed.  k,u,n, gFF  k,k,u,n and Ik,u,n, ∀k, u, n;  Algorithm 3 Semi-distributed algorithm to solve FNRAG 1: FBS set: K = {1, 2, . . .K}; Femto user set per femtocell: F = {1, 2, . . .F}. 2: Interference-Aware Subchannel Allocation 3: Allocate the same power to each subchannel; 4: Femto user u in femtocell k measures gMF 5: ak,u,n = 0, ∀k, u, n; 6: for each FBS do 7: 8: 9: 10: 11: 12: 13:  Subchannel set: N = {1, 2, . . ., N} for u = 1 to F do  a  ﬁnd n b  ak,u,n∗ = 1; c  N = N −{n  ∗ = arg min n∈N ∗};  gMF k,u,n gFF k,k,u,n  Ik,u,n;  ∗  = arg min u∈F ,n∈N  gMF k,u,n gFF k,k,u,n  Ik,u,n;  14:  end for while N  cid:5 = φ do ∗, n a  ﬁnd  u b  ak,u∗,n∗ = 1; c  N = N −{n  ∗};  end while  15: 16: 17: 18: end for 19: Interference-Aware Power Allocation 20: for each FBS do 21: 22: 23: 24: end for  calculate  3.20  and  3.21 ;  for n = 1 to N do  end for  3.4 Simulation Results and Discussion  In this section, we present simulation results to evaluate the performance of the proposed interference-aware FNRAG algorithm, as compared with the unpriced suboptimal subchannel allocation  USSA  and MIWF-based power allocation algorithm [5, 29], which are outlined in Algorithm 2. Both the system capacity and the fairness between femto-tier and macro-tier are evaluated in the simulations.  In the simulations, the macrocell has a coverage radius of 500 m. Each femtocell has a coverage radius of 10 m. K FBSs and 50 macro users are randomly distributed in the macrocell coverage area. The minimum distance between the MBS and a macro user  or an FBS  is 50 m. The minimum distance between FBSs is 40 m. Femto users are uniformly distributed in the coverage area of their serving femtocell. Both macro and femto cells employ a carrier frequency of 2 GHz, B = 10 MHz, and N = 50. The AWGN variance is given by σ2 = B N N0, where   3.4 Simulation Results and Discussion  31  k,k,u,n and Ik,u,n, ∀k, u, n;  Algorithm 4 USSA and MIWF algorithm 1: FBS set: K = {1, 2, . . .K}; Femto user set per femtocell: F = {1, 2, . . .F}. 2: USSA 3: Allocate the same power to each subchannel; 4: Femto user u in femtocell k measures gFF 5: ak,u,n = 0, ∀k, u, n; 6: for k = 1 to K do 7: 8: 9: 10: 11: 12: 13:  Subchannel set: N = {1, 2, . . ., N} for u = 1 to F do  a  ﬁnd n b  ak,u,n∗ = 1; c  N = N −{n  ∗ = arg max n∈N ∗};  gFF k,k,u,n Ik,u,n  ;  14:  end for while N  cid:5 = φ do ∗, n a  ﬁnd  u b  ak,u∗,n∗ = 1; c  N = N −{n  ∗  = arg max u∈F ,n∈N  gFF k,k,u,n Ik,u,n  ;  ∗};  end while  15: 16: 17: 18: end for 19: MIWF-Based Power Allocation 20: Implement the MIWF algorithm using bisection search [29].  N0 = −174 dBm Hz. The Rayleigh-fading channel gains are modeled as unit-mean exponentially distributed random variables. The average channel gain  including pathloss and antenna gains  for indoor femto user and outdoor macro user are −4[6]. Besides, α modeled as λd is selected as 4 × 104 using the try-and-error method through simulations. The maximum transmit powers of a femto user and a macro user are set as 20 and 30 dBm, respectively.  −3, respectively, where λ = 2 × 10  −4 and λd  Figure 3.2 shows the capacity of the macrocell when the number of femto users per femtocell increases from 1 to 6, for K = 20, 30, and 50. It can be observed that the proposed interference-aware FNRAG algorithm outperforms the USSA and MIWF based algorithm by up to a 23% increase in macrocell capacity. As the number of femtocells K increases, the advantage of the FNRAG algorithm becomes more noticeable, because the increased uplink interference caused by femtocells to the macrocell can be effectively mitigated by the pricing scheme imposed on femto users in the FNRAG algorithm, but not by the unpriced USSA and MIWF based algorithm. As the number of femto users increases, the potential interferers will be more because of the co-channel deployed femtocells, but the number of available channels is constant. Therefore, the proposed algorithm will be more and more superior compared with the USSA and MIWF based algorithm. It also can be seen from the ﬁgure, the capacity of the macrocells increases as the number of the femto users per femtocell increases. This is because, all of the N subchannels will be assigned to F femto users in each femtocell, when F increases, Algorithm 1 will have more choice for each subchannel in subchannel allocation part, which can be seen as multiuser diversity.   32  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  x 107  5.5    s p b   l l  e c o r c a M    f  o    y t i c a p a C  4.5  5  4  3  2  3.5  2.5  1.5  1  1  Proposed FNRAG, K=20 USSA+MIWF, K=20 Proposed FNRAG, K=30 USSA+MIWF, K=30 Proposed FNRAG, K=50 USSA+MIWF, K=50  2  3  4  5  6  Number of Femto Users per Femtocell  Fig. 3.2 Capacity of macrocell versus the number of femto users per femtocell F with the number of macro users M = 50  Figure 3.3 shows the total capacity of K femtocells and macrocell when the number of femto users per femtocell increases from 1 to 6, for K = 20, 30, and 50. We can see that the proposed FNRAG algorithm improves the total capacity of femtocells and macrocell over the USSA and MIWF based algorithm by 5 ∼ 10% when the number of femto users per femtocell is larger than 3. More gain is obtained as K increases, indicating that the proposed interference-aware FNRAG algorithm can also effectively mitigate interference between neighboring femtocells, and hence is more applicable in dense deployment of co-channel femtocells than the USSA and MIWF based algorithm. As the number of femto users increases, the co-tier interference between femtocells is more severe, the interference-aware subchannel assignment will be more effective in co-tier interference mitigation.  In order to evaluate the fairness between the macro tier and femto tier, we use the  tiered fairness index  TFI  [30], which is deﬁned as  fT FI =  CM w + F   cid:22   M∑ M  cid:16  w=1 M∑ w=1   cid:23 2  K∑ k=1  2 +  F∑ u=1 K∑ k=1  CF k,u F∑ u=1   cid:17    FCF k,u   2   M + FK    MCM w   3.23    Proposed FNRAG, K=20 USSA+MIWF, K=20 Proposed FNRAG, K=30 USSA+MIWF, K=30 Proposed FNRAG, K=50 USSA+MIWF, K=50  3.5 Conclusion  x 109  12    s p b   m e  t s y S    l l  t  e c o m e F    f  o    y t i c a p a C    l  a  t  o T  10  8  6  4  2  0  1  33  K=50  K=30  K=20  2  3  4  5  6  Number of Femto Users per Femtocell  Fig. 3.3 Capacity of macrocell and femtocells versus the number of femto users per femtocell F with the number of macro users M = 50  where CM k, respectively.  w and CF  k,u are the capacities of macro user w and femto user u in femtocell  Figure 3.4 compares the tiered fairness performance between the proposed FNRAG algorithm and the USSA and MIWF based algorithm. It can be observed that the tiered fairness of the proposed FNRAG algorithm gets close to or becomes even better than that of the USSA and MIWF based algorithm, as the number of femto users per femtocell goes beyond 3. This is because the proposed FNRAG algorithm alleviates the uplink interference generated by femto users to the macro- cell by charging each femto user a price proportional to the interference that it causes to the macrocell, and the macrocell capacity and consequently the tiered fairness can be guaranteed. Since the USSA used in Algorithm 2 considers the fairness among femto users in each femtocell, the tiered fairness of Algorithm 2 is better than the proposed FNRAG algorithm when F is less than 3. The tiered fairness improves as K increases, because the spatial reuse gain increases with K.  3.5 Conclusion  In this chapter, we have proposed a semi-distributed interference-aware resource allocation algorithm for the uplink of co-channel deployed femtocells, based on a   34  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  s s e n r i a F  0.8  0.7  0.6  0.5  0.4  0.3  0.2  0.1  0  1  Proposed FNRAG, K=20 USSA+MIWF, K=20 Proposed FNRAG, K=30 USSA+MIWF, K=30 Proposed FNRAG, K=50 USSA+MIWF, K=50  K=50  K=30  K=20  2  3  4  5  6  Number of Femto Users per Femtocell  Fig. 3.4 Tiered fairness versus the number of femto users F in each femtocell with the number of macro users M = 50  non-cooperative game framework. Using the proposed algorithm, each femtocell can maximize its capacity through resource allocation, taking into account inter- cell interference reported by its femto users, and with uplink femto-to-macro interference alleviated by a pricing scheme imposed on femto users. It has been shown through simulations that the proposed interference-aware resource allocation algorithm is able to provide improved capacities of both macrocell and femtocells, together with comparable tiered fairness, as compared with the existing unpriced subchannel allocation and MIWF based power allocation algorithm.  Acknowledgements The authors would like to thank Dr. David López-Pérez and Prof. Arumugam Nallanathan for their helpful discussions. This work was supported by the Sci-tech Projects of the Committee on Science and Technology of Beijing  D08080100620802, Z101101004310002 , the National Natural Science Foundation of China  61101109 , and National Key Technology R&D Program of China  2010ZX03003-001-01, 2011ZX03003-002-01 , Co-building Project of Beijing Municipal Education Commission “G-RAN based Experimental Platform for Future Mobile Communications”, “Research on Resource Allocation and Scheduling Strategy of Future Wireless Communication System” and “Cooperative Communications Platform for Multi-agent Multimedia Communications”, Key Fund of Beijing Key Laboratory on Future Network Research. This work was also partially supported by the UK EPSRC Grants EP H020268 1, CASE CNA 07 106, and EP G042713 1.   References  References  35  1. D. Lopez-Perez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Communications Magazine, vol. 47, no. 9, pp. 41–48, 2009.  2. E-UTRA and E-UTRAN Overall Description, 3GPP Std. TS 36.300 v10.0.0, 2010. 3. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  4. V. Chandrasekhar, J. Andrews, andA. Gatherer, “Femtocell networks: a survey,” Communica-  tions Magazine, IEEE, vol. 46, no. 9, pp. 59–67, september 2008.  5. K. Son, S. Lee, Y. Yi, and S. Chong, “Reﬁm: A practical interference management in heterogeneous wireless access networks,” IEEE Journal on Selected Areas in Communications, vol. 29, no. 6, pp. 1260–1272, 2011.  6. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Transactions on Wireless Communications, vol. 8, no. 8, pp. 4316–4328, 2009.  7. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  8. H.-S. Jo, C. Mun, J. Moon, and J.-G. Yook, “Interference mitigation using uplink power control for two-tier femtocell networks,” Wireless Communications, IEEE Transactions on, vol. 8, no. 10, pp. 4906–4910, october 2009.  9. E. J. Hong, S. Y. Yun, and D.-H. Cho, “Decentralized power control scheme in femtocell  networks : A game theoretic approach,” in IEEE PIMRC’09, pp. 1–5.  10. I. Guvenc, M.-R. Jeong, F. Watanabe, and H. Inamura, “A hybrid frequency assignment for femtocells and coverage area analysis for co-channel operation,” Communications Letters, IEEE, vol. 12, no. 12, pp. 880 –882, december 2008.  11. C. Lee, J.-H. Huang, and L.-C. Wang, “Distributed channel selection principles for femtocells with two-tier interference,” in Vehicular Technology Conference  VTC 2010-Spring , 2010 IEEE 71st, may 2010, pp. 1–5.  12. I. Mustika, K. Yamamoto, H. Murata, and S. Yoshida, “Potential game approach for self- in closed access femtocell networks,” in Vehicular  organized interference management Technology Conference  VTC Spring , 2011 IEEE 73rd, may 2011, pp. 1–5.  13. J. Kim and D.-H. Cho, “A joint power and subchannel allocation scheme maximizing system capacity in indoor dense mobile communication systems,” IEEE Transactions on Vehicular Technology, vol. 59, no. 9, pp. 4340–4353, 2010.  14. K. Lee, H. Lee, and D.-H. Cho, “Collaborative resource allocation for self-healing in self-  organizing networks,” in IEEE ICC’11, pp. 1–5.  15. J. Zhang, Z. Zhang, K. Wu, and A. Huang, “Optimal distributed subchannel, rate and power  allocation algorithm in ofdm-based two-tier femtocell networks,” in IEEE VTC’10, pp. 1–5.  16. L. Giupponi and C. Ibars, “Distributed interference control in ofdma-based femtocells,” in  IEEE PIMRC’10, pp. 1201–1206.  17. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co- channel deployment,” IEEE Journal on Selected Areas in Communications, vol. 29, no. 6, pp. 1225–1241, 2011.  18. H. Zhang, X. Chu, W. Ma, W. Zheng and X. Wen, “Resource Allocation with Interference Mitigation in OFDMA Femtocells for Co-channel Deployment,” EURASIP Journal on Wire- less Communications and Networking: Special Issue on Femtocells in 4G Systems, 2012:289, doi:10.1186 1687-1499-2012-289.  19. H. Zhang, X. Chu, W. Zheng and X. Wen, “Interference-Aware Resource Allocation in Two- Tier OFDMA Co-Channel Deployed Femtocell Networks,” to appear in Proc. of IEEE ICC’12, Ottawa, Canada, June 2012.  20. S. Yun, Y. Yi, D.-H. Cho, and J. Mo, “Open or close: On the sharing of femtocells,” in IEEE  INFOCOM’11, pp. 116–120.   36  3 Cross-Tier Interference Pricing Based Uplink Resource Allocation in Two-Tier. . .  21. H. Kwon and B. G. Lee, “Distributed resource allocation through noncooperative game  approach in multi-cell ofdma systems,” in IEEE ICC’06, pp. 4345–4350.  22. Z. Liang, Y. H. Chew, and C. C. Ko, “On the modeling of a non-cooperative multicell ofdma  resource allocation game with integer bit-loading,” in IEEE Globecom’09, pp. 1–5.  23. D. Fudenberg and J. Tirole, Game Theory. MIT Press, 1993. 24. C. U. Saraydar, N. B. Mandayam, and D. J. Goodman, “pricing and power control in a multicell wireless data network,” IEEE Journal on Selected Areas in Communications, vol. 19, no. 10, pp. 1883–1892, 2001.  25. F. Wang, M. Krunz, and S. Cui, “Price-based spectrum management in cognitive radio networks,” IEEE Journal of Selected Topics in Signal Processing, vol. 2, no. 1, pp. 74–87, 2008.  26. C. Zhong, C. Li, and L. Yang, “Dynamic resource allocation algorithm for multi-cell ofdma systems based on noncoomperative game theory,” Journal of Electronics & Information Technology, vol. 31, no. 8, pp. 1935–1940, 2009.  27. C. Tan, T. Chuah, and S. Tan, “Fair subcarrier and power allocation for multiuser orthogonal frequency-division multiple access cognitive radio networks using a colonel blotto game,” IET Communications, vol. 5, no. 11, pp. 1607–1618, 2011.  28. Way forward proposal for  H eNB to HeNB mobility, 3GPP Std. R3-101 849, 2010. 29. W. Yu, “Sum-capacity computation for the gaussian vector broadcast channel via dual decomposition,” IEEE Transactions on Information Theory, vol. 52, no. 2, pp. 754–759, 2006. 30. M. C. Erturk, H. Aki, I. Guvenc, and H. Arslan, “Fair and qos-oriented spectrum splitting in  macrocell-femtocell networks,” in IEEE Globecom’10, pp. 1–6.   Chapter 4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  Abstract In this chapter, we consider the joint subchannel and power allocation problem in both the uplink and the downlink for two-tier networks comprising spectrum-sharing macrocells and femtocells. A joint subchannel and power allo- cation scheme for co-channel femtocells is proposed, aiming to maximize the capacity for delay-tolerant users subject to delay-sensitive users’ quality of service and interference constraints imposed by macrocells. The joint subchannel and power allocation problem is modeled as a mixed integer programming problem, then transformed into a convex optimization problem by relaxing subchannel sharing, and ﬁnally solved by a dual decomposition approach. The effectiveness of the proposed approach is veriﬁed by simulations and compared with existing scheme.  4.1 Introduction  Femtocells are low power, low cost, user deployed wireless access points that use local broadband connections as backhaul and compensate macrocells’ drawbacks on indoor coverage [1]. Orthogonal frequency division multiple access  OFDMA  based femtocells have been already considered in major wireless communication standards, e.g., LTE LTE-Advanced [1]. Due to the scarcity of spectrum, operators prefer spectrum sharing between macrocells and femtocells rather than orthogonal deployments [2]. However, cross-tier interference could be severe in spectrum sharing two-tier networks [3]. As a result, resource allocation considering cross-tier interference has become an important asset to enhance performance and has attracted much attention within the telecommunication industry.  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__4,   The Author s  2013  37   38  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  Interference mitigation based on resource allocation has been widely analyzed to maintain user’s quality of service  QoS , e.g., signal to interference and noise ratio  SINR  capacity, while alleviating cross-tier interference in two-tier networks. In [4], a non-cooperative power allocation with SINR adaptation is used to alleviate the uplink interference suffered by macrocells; while in [5], a Stackelberg game based power control is formulated to maximize femtocell’s capacity under cross- tier interference constraints. However, subchannel allocation is not considered. In [6], a joint subchannel and power allocation algorithm is proposed to maximize total capacity in dense femtocell deployments. While in [7], a Lagrangian dual decomposition based resource allocation scheme with constraints on cross-tier inter- ference in power allocations is used. In [2], the distributed subchannel and power allocation for co-channel deployed femtocells is modeled as a non-cooperative game, for which a Nash Equilibrium is obtained based on a time-sharing subchannel allocation. However, in these works, joint subchannel and power allocation with users’ QoS and cross-tier interference considerations is not studied. In [8], a distributed modulation and coding scheme, subchannel and power allocation that supports different throughput constraints per users is proposed, but it does not consider two-tier networks.  Femtocell networks should support the heterogeneous QoS for the delay sensitive services such as online gaming and video phone calls, while maximizing the throughput of delay tolerant services [9]. However, to the best of our knowledge, resource allocation for heterogeneous QoS users in femtocell has not been studied in previous works. Indeed, interference mitigation via resource allocation strategies have been widely studied in spectrum underlay Cognitive Radio  CR  networks [10, 11], but cannot be directly applied in femtocells [5].  In this chapter, we focus on the subchannel and power allocation problem in OFDMA based two-tier femtocell networks, in which a central macrocell is underlaid with spectrum-sharing deployed femtocells. Heterogeneous QoS require- ment for femto users is considered, where delay sensitive users have a minimum data rate requirement and delay tolerant users do not have. After introducing the interference temperature limit, the resource allocation problem is formulated into a mixed integer non-convex programming problem. To transform this non- convex problem into a convex one, time-sharing subchannel scheme is introduced. Next, we solve the joint subchannel and power allocation problem using Lagrange dual decomposition approach, and devise a distributed joint power and subchannel allocation algorithm. Furthermore, a low-complexity approach is proposed to trade the performance for computational complexity, a signiﬁcant reduction in computational burden is achieved by the proposed algorithm [12]. The complexity of the proposed algorithm is analyzed, and the performance of the approach is veriﬁed by simulations.  The rest of this chapter is organized as follows. Section 4.2 provides the system model and the problem formulation of resource allocation. In Sect. 4.3, the subchannel and power allocation algorithm based on dual decomposition method is proposed. In Sect. 4.4, performance of the proposed algorithm is evaluated by simulations. Finally, Sect. 4.5 concludes the chapter.   4.2 System Model and Problem Formulation  39  4.2 System Model and Problem Formulation  4.2.1 System Model  We consider a two-tier OFDMA network where K co-channel Femto Base Stations  FBSs  are overlaid on a macrocell. All femtocells are assumed to be closed access and deployed in suburban residential houses [13]. We focus on the resource allocation in the uplink of femtocells, and then extend it to the downlink case. Let M and F denote the numbers of active macro users camping on the macrocell and femto users camping on each femtocell, respectively. The OFDMA system has a bandwidth of B, which is divided into N subchannels. The channel fading of each subcarrier is assumed the same within a subchannel, but may vary cross different subchannels. Channel fading is composed of large-scale fading  path loss  and small-scale fading  frequency-selective Rayleigh fading . k,u,n at the kth FBS from its femto user u with  u ∈ {1,2, . . .,F}  in the nth subchannel  n ∈ {1,2, . . .,N}  is modeled as:  The received signal-to-interference-plus-noise ratio  SINR  γF  γF k,u,n  =  pF k,u,ngF w,ngFM pM k,w,n  k,u,n + σ2  ,   4.1   k,u,n is the channel gain on subchannel n from femto user u u ∈{1,2, . . . ,F}  where gF to its serving femtocell k; gFM k,w,n is the channel gain on subchannel n from macro user w w ∈ {1,2, . . .,M}  to femtocell k; pF k,u,n is femto user u’s transmit power on subchannel n in femtocell k; pM w,n is macro user w’s transmit power on subchannel n in the macrocell; and σ2 is the additive white Gaussian noise  AWGN  power. In this case, co-channel interference between femtocells is assumed as part of the thermal noise due to the severe wall penetration loss and low power of FBSs [7, 14]. Especially, in sparse deployment of femtocells in suburban environments [5], co-tier inter-femtocell interference is negligible as compared with cross-tier interference [14, 15].  Based on Shannon’s capacity formula, the uplink capacity of femto user u in  femtocell k on subchannel n is modeled by:  CF k,u,n  = log2   1 + γF  k,u,n    .   4.2   4.2.2 Problem Formulation  Our target is to maximize the total capacity of delay-tolerant users in the K femtocells under macrocell’s interference constraints and delay-sensitive users’ QoS   40  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  constraints. The corresponding problem for the uplink can be formulated as the following non-convex mixed integer programming problem:  K∑  ∑ u∈D Tk  N∑  n=1  k,u,n  k=1  ak,u,nCF  k,u,n  ≤ Pmax,∀k,u  k,u,n  ak,u,n pF ≥ 0,∀k,u,n  k,u,n  s.t. C1 :  max ak,u,n,pF N∑  n=1 C2 : pF N∑  C3 :  n=1  ak,u,nCF  k,u,n  ≥ Ru,∀k,∀u ∈ DSk  C4 :  K∑  F∑  k=1  u=1  ak,u,n pF  k,u,ngMF k,u,n  ≤ Ith  n ,∀n  F∑  ak,u,n ≤ 1,∀k,n  C5 : C6 : ak,u,n ∈ {0,1},∀k,u,n ,  u=1   4.3    4.4   k,u,n  where DS k and DT k are the sets of delay-sensitive and delay-tolerant users camping on FBS k, respectively, where DSk + DTk = F, DSk ∩ DTk = φ, and delay-sensitive femto user u has a minimum throughput requirement Ru; gMF k,u,n is the channel gain on subchannel n from user u in femtocell k to the MBS; ]K×F×N is the power allocation matrix of the K femtocells; and A = P = [pF [ak,u,n]K×F×N is the subchannel indication matrix, being ak,u,n = 1 if subchannel n is assigned to femto user u in femtocell k, and ak,u,n = 0 otherwise; constraint C1 limits the transmit power of each femto user to be below Pmax; C2 represents the non-negative power constraint of the transmit power on each subchannel; C3 guarantees the QoS requirement Ru of delay-sensitive femto user u in femtocell k; C4 represents the tolerable interference temperature level on each subchannel of macrocell, with Ith n as the interference threshold; C5 and C6 guarantee that each subchannel can only be assigned to at most one user in each femtocell.  4.3 Subchannel and Power Allocation Algorithm  In this section, in order to reduce complexity, ﬁrstly, we transform the non-convex mixed integer programming problem in  4.3 – 4.4  into a convex optimization by relaxing subchannel allocations. Then, we solve the resulting subchannel and power allocation problem using the Lagrangian dual decomposition method [16, 17].   4.3 Subchannel and Power Allocation Algorithm  41  4.3.1 Transformation of Optimization Problem  by Time-Sharing Relaxation  The optimization problem in  4.3  is a non-convex mixed integer programming problem due to the integer constraint in C6. The optimal solution of  4.3  under constraints of  4.4  can be obtained by brute-force or using integer linear program- ming solvers. However, their running times may be unpredictable  exponential in the worse case . To make the problem tractable, we relax ak,u,n to a continuous real variable in the range [0,1], where ak,u,n can be considered as a time-sharing factor for subchannel n, and can be interpreted as the fraction of time that subchannel n is assigned to femto user k during one transmission frame. The time-sharing relaxation was ﬁrst proposed in [18], which has been proved to result in a zero-duality gap [19] and has been widely used to transform non- convex combinatorial optimization problems into convex optimization problems for OFDMA systems [2, 9]. For notational brevity, let us denote sk,u,n = ak,u,n pF k,u,n as the actual power allocated to user u in femtocell k on subchannel n. and Ik,u,n = pM w,ngFM as the received interference and k,w,n capacity of user u on subchannel n in femtocell k, respectively. As a result, the original problem can be converted into:   cid:22  1 + sk,u,ngF k,u,n ak,u,nIk,u,n  + σ2 and ˜CF  = log2  k,u,n   cid:23   max ak,u,n,sF  K∑  ∑ u∈DTk  N∑  n=1  k,u,n  k=1  ak,u,n ˜CF  k,u,n  s.t. C1 :  sk,u,n ≤ Pmax,∀k,u  C2 : sk,u,n ≥ 0,∀k,u,n  N∑  n=1  N∑  n=1  C3 :  ak,u,n ˜CF  k,u,n  ≥ Ru,∀u ∈ DSk,∀k  C4 :  K∑  F∑  k=1  u=1  sk,u,ngMF k,u,n  ≤ Ith  n ,∀n  F∑  ak,u,n ≤ 1,∀k,n  C5 : C6 : ak,u,n ∈ [0,1],∀k,u,n .  u=1   4.5    4.6   Since the Hessian matrix of every element ak,u,n ˜CF  k,u,n in the summations of  4.5  with respect to sk,u,n and ak,u,n is negative semi-deﬁnite, the objective function  4.5  is concave [16]. As the inequality constraints in  4.6  are convex, the feasible set   42  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  of the objective function is convex. Being a convex optimization problem, the transformed optimization problem in  4.5  has a unique optimal solution, which may be obtained in polynomial time.  4.3.2 Dual Decomposition Method  In the following, the subchannel and power allocation optimization in  4.5  is solved by using the Lagrangian dual decomposition method. The Lagrangian function is given by  L {ak,u,n},{sk,u,n},λ,ν, μ ,η  K∑ k=1  ak,u,n ˜CF  cid:22   k,u,n  +  =  K∑ k=1 K∑ k=1 K∑ k=1  ∑ u∈DTk ∑ u∈DSk N∑ n=1  N∑ n=1 N∑ νk,u  cid:22  n=1 1− F∑  ηk,n  u=1  ak,u,n ˜CF k,u,n  cid:23   ak,u,n  ,  +  +  F∑ λk,u  cid:23  u=1 − Ru   cid:22  Pmax − N∑  cid:22  n=1 N∑ Ith n n=1  μ n  +   cid:23   sk,u,n − K∑  k=1  F∑ u=1   cid:23    4.7   sk,u,ngMF k,u,n  where λ, ν, μ and ηare the Lagrange multipliers  also called dual variables  vectors for the constraints C1, C3, C4 and C5 in  4.6 , respectively, and the boundary constraints C2 and C6 in  4.6  will be absorbed in the Karush-Kuhn-Tucker  KKT  conditions [16], as it will be shown later. As a result, the Lagrangian dual function is deﬁned as:  g λ,ν, μ ,η  {ak,u,n},{sk,u,n} L {ak,u,n},{sk,u,n},λ,ν, μ ,η  =  max  The dual problem can be expressed as:  g λ,ν, μ ,η   min λ,ν,μ ,η  s.t. λ,ν, μ ,η≥ 0   4.8    4.9    4.10   We decompose the Lagrangian dual function in  4.7  into a master problem and K × N subproblems. The dual problem can be solved iteratively with each FBS solving the corresponding local subproblem via local information in each iteration. Accordingly, the Lagrangian function in  4.7  is rewritten as:   4.3 Subchannel and Power Allocation Algorithm  L {ak,u,n},{sk,u,n},λ,ν, μ ,η   K∑ = k=1 − K∑  k=1  Lk,n {ak,u,n},{sk,u,n},λ,ν, μ ,η  + N∑ n=1 ηk,n ∑  νk,uRu +  μ nIth n  +  K∑ k=1  N∑ n=1  N∑ n=1  u∈D Sk  K∑ k=1  F∑ u=1  λk,uPmax  where Lk,n {ak,u,n},{sk,u,n},λ,ν, μ ,η  = ∑ u∈DTk − F∑  ak,u,n ˜CF  − F∑  ηk,nak,u,n .  k,u,n  u=1  u=1  λk,usk,u,n+ ∑ u∈DSk  νk,uak,u,n ˜CF  k,u,n  − F∑  u=1  μ nsk,u,ngMF k,u,n   4.12   According to the KKT conditions, the optimal solutions of the subproblems,  denoted by { ˆak,u,n} and { ˆsk,u,n}, can be obtained as:  We can obtain the optimal transmit power allocation to femto user u in femtocell  k at subchannel n by setting  4.13  equal to 0:   cid:4   ∂Lk,n . . .  ∂ˆsk,u,n  = 0, ˆsk,u,n > 0 < 0, ˆsk,u,n = 0  ∀k,n  ⎧ ⎨ ⎩  ∂Lk,n . . .  ∂ˆak,u,n  < 0, ˆak,u,n = 0 = 0,0 < ˆak,u,n < 1 > 0, ˆak,u,n = 1  ∀k,n .   cid:24    cid:24   =  =  = ˆsk,u,n ˆpF k,u,n ak,u,n ∀u ∈ DSk  = ˆsk,u,n ˆpF k,u,n ak,u,n ∀u ∈ DTk ,  ·   cid:18   1 ln 2  νk,u  λk,u+μ ngMF k,u,n   cid:19  − Ik,u,n gF k,u,n  ·   cid:18   1 ln 2  1  λk,u+μ ngMF k,u,n   cid:19  − Ik,u,n gF k,u,n   cid:25 +   cid:25 +  ,  ,  where  x + = max 0,x .  We can obtain the optimal subchannel allocation as follows. In  4.14 , the partial  derivative of Lagrangian function can be expressed as: = Hk,u,n − ηk,n  ∂Lk,n . . .  ∂ˆak,u,n  43   4.11    4.13    4.14    4.15    4.16    4.17    4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  44  where   cid:22   Hk,u,n = ˜νk,u log2 −λk,u pF  k,u,n   cid:22  1 + ˆpF − μ n pF  k,u,n  k,u,ngF Ik,u,n k,u,ngMF k,u,n  ,   cid:23    cid:22   − 1  ln2   cid:23  cid:23   ˆpF k,u,ngF ˆpF k,u,ngF k,u,n  k,u,n +Ik,u,n   4.18   being ˜νk,u = νk,u,∀u ∈ DSk and ˜νk,u = 1,∀u ∈ DTk. Then, subchannel n is assigned to the user u with the largest Hk,u,n in femtocell k: ˆak∗,u∗,n = 1 k∗,u∗ =max  ,∀n ,   4.19   Hk,u,n  k,u  Finally, based on the subgradient method, the dual variables are updated accord-  ing to the following expressions:  − β i   1  cid:24   N∑ n=1  cid:24    cid:20  ν i  k,u   cid:20    cid:20  λ i  k,u  λ i+1  k,u  =   cid:24  Pmax − N∑   cid:25  cid:21 +  ,∀k,u  n=1  sk,u,n  cid:25  cid:21 +  ν i+1  k,u  =  − β i   2  ˜CF k,u,n  − Ru  ,∀k,u ∈ DSk  μ  i+1  n  =  n − β i  μ  i   3  Ith n  − K∑  F∑  k=1  u=1  sk,u,ngMF k,u,n   cid:25  cid:21 +  ,∀n  where β i  the maximum number of iterations, and the step size should satisfy:  3 are the step sizes of iteration i i ∈ {1,2, . . .,Imax} , Imax is  2 and β i   1 ,β i   ∞∑  i=1  β i  l  = ∞, lim i→∞  β i  l  = 0,∀l ∈ {1,2,3}.  4.3.3 Iterative Resource Allocation Algorithm  Equations  4.15 – 4.23  give a solution to the joint subchannel and power allocation problem. The following algorithm implements the solution.   4.20    4.21    4.22    4.23    4.3 Subchannel and Power Allocation Algorithm  45  for u = 1 to F do  for k = 1 to K do  for n = 1 to N do  Algorithm 5 Iterative resource allocation algorithm 1: Initialize Imax and Lagrangian variables vectors λ,ν, μ , set i = 0 2: Initialize pk,u,n with a uniform power distribution among all subchannels 3: Initialize ak,u,n with subchannel allocation method in [20], ∀k, u, n 4: repeat 5: 6: 7: 8: 9: 10: 11: 12: 13: 14: 15: 16: MBS update μ according to  4.22 , and broadcast those values to all FBSs via backhaul,  a  Delay-sensitive users update ˆpF b  Delay-tolerant users update ˆpF c  Calculate Hk,u,n according to  4.18 ; d  FBSs update ˆak,u∗,n according to  4.19 , and perform allocation; e  FBSs update λ,νaccording to  4.20  and  4.21 .  k,u,n according to  4.15 ; k,u,n according to  4.16 ;  end for  end for  end for  i = i + 1.  17: until Convergence or i = Imax  The proposed algorithm can be implemented in each FBS, using only local  information and limited interactions with the MBS. As a result, it is distributed.  Note that gMF  k,u,n required in  4.15 – 4.16 ,  4.18  and  4.22  for the uplink can be estimated at femto user u in femtocell k by measuring the downlink channel gain of subchannel n from the macrocell and assuming the symmetry between uplink and downlink channels, or by using the site speciﬁc knowledge [21]. Moreover, it could be assumed that there is a wired connection between an FBS and the MBS for coordination purposes [3, 5], according to a candidate scheme proposed for 3GPP HeNB mobility enhancement [22].  4.3.4 Downlink Case  Although the above proposed subchannel and power allocation scheme was pre- sented for the uplink, the algorithm derived for the uplink can also be applied in the downlink with some modiﬁcations. The major modiﬁcations include replacing channel gains of the reverse link with those of the forward link, replacing the total power constraint for a femto user in  4.4  and  4.6  with the power budget of an FBS, and replacing  4.20  with the following dual variable update:   cid:20    cid:24    cid:25  cid:21 +  λ i+1  k  =  λ i  k  − β i   1  Pk,max− F∑  N∑  sk,u,n  ,∀k   4.24   u=1  n=1  where Pk,max is the maximal transmit power of FBS k. Moreover, when the MBS updates cross-tier interference dual variables according to  4.22 , cross-tier interference can be obtained from macro users’ feedback.   46  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  4.4 Simulation Results and Discussions  Simulation results are given in this section to evaluate the performance of the proposed resource allocation algorithms. In the simulations, spectrum-sharing femtocells and macro users are randomly distributed in the macrocell coverage area, and femto users are uniformly distributed within the coverage area of their serving femtocell. The coverage radius of the macrocell is 500 m, while that of a femtocell is 10 m. Macro and femto users’ maximum transmit powers are set at 23 dBm. The carrier frequency is 2 GHz, B = 10 MHz, N = 50, M = 50, and σ2 = B N N0, where N0 = −174 dBm Hz is the AWGN power spectral density. The path loss models for indoor femto users and outdoor macro users are based on [23], and block-fading channel gains are modeled as i.i.d. unit-mean exponentially distributed random variables. The standard deviation of shadow fading between the MBS and users is 8 dB, while that between an FBS and users is 10 dB. The “Existing Algorithm” included in simulations for comparison is the subchannel allocation scheme in [20] in conjunction with the optimal power allocation scheme proposed in this chapter. Figure 4.1 shows the convergence of the average capacity per femtocell of the proposed algorithm versus the number of iterations for both the uplink and downlink cases, where F = 4, K = 10, Ru = 9 bps Hz  for any u , Pmax = 23 dBm, Pk,max = −14 w  −101.2 dBm . From the results, it can 20 dBm  for any k  and Ith be seen that the proposed algorithm takes only a few iterations to converge to stable solutions. After 6 iterations it is almost stable, and after 40 iterations it is stable. This result together with former analysis proves that the proposed algorithm converges, is practical and can be applied to two-tier networks.  n = 7.5× 10  Figure 4.2 shows the total capacity of K femtocells when the number of femtocells increases from 10 to 50, for the proposed algorithm and the existing algorithm. The simulation parameters are set as F = 2, Ru = 9 bps Hz, Pmax = −14 w  −101.2 dBm . From the 23 dBm, Pk,max = 20 dBm  for any k , and 7.5× 10 results, it can be seen that the proposed algorithm improves the total capacity of femtocells for the uplink over the existing algorithm by 10 ∼ 25 % when the number of femtocells is larger than 20. While in the downlink, a similar performance is observed but with a lower capacity, because the maximal downlink power of FBS is 3 dB lower than the maximal uplink power of a femto user.  Figure 4.3 shows the total capacity of delay sensitive users in all femtocells when the number of femtocells increases from 10 to 50, for the proposed and existing algorithms. The simulation settings of F, Ru, Pmax, Pk,max and Ith n are same as Fig. 4.2. It can be seen that the existing algorithm provides a higher capacity than the proposed algorithm for delay-sensitive users, because the subchannel allocation in the proposed algorithm maximizes the capacity of delay-torrent users while ensuring a certain level capacity for delay-sensitive users. However, the subchannel allocation in the existing algorithm maximizes the total capacity of all the users and maintains users’ fairness by allocating at least a subchannel to each user.  Figure 4.4 shows the total uplink capacity of K femtocells employing the proposed algorithm versus the interference temperature limit, which increases from   4.4 Simulation Results and Discussions  47  Average Capacity of each Femtocell, Uplink Average Capacity of each Femtocell, Downlink  0  0  10  20 30 Iteration index t  40  50  Fig. 4.1 Convergence in terms of average capacity of each femtocell over the number of iterations  Proposed Algorithm, F=2, Uplink Existing Algorithm, F=2, Uplink Proposed Algorithm, F=2, Downlink Existing Algorithm, F=2, Downlink  30  25  20  15  10  5    z H   s p b     l l  e c o t m e  f    h c a e    f  o    y t i c a p a c    e g a e v A  1200  1000  800  600  400  200    z H   s p b     s r e s U T D       f  o    y t i c a p a C    l  t  a o T  0 10  15  20  30  25 35 Number of Femtocells  40  45  50  Fig. 4.2 Total capacity of all femtocells versus the number of femtocells K   48  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  Proposed Algorithm, F=2, Uplink Existing Algorithm, F=2, Uplink Proposed Algorithm, F=2, Downlink Existing Algorithm, F=2, Downlink  0 10  15  20  30  25 35 Number of Femtocells  40  45  50  Fig. 4.3 Total capacity of all delay sensitive users in all femtocells versus the number of femtocells  250  200  150  100  50  240  238  236  234  232  230  228  226  224  222    z H   s p b     s r e s U S D       f  o    y t i c a p a C    l  a  t  o T    z H   s p b     s  l l  t  e c o m e F    f  o    y t i c a p a C   k n  i l  p U    l  a  t  o T  Proposed Algorithm, Pmax =23dBm, F=4 Proposed Algorithm, Pmax =20dBm, F=4 Proposed Algorithm, Pmax =23dBm, F=2 Proposed Algorithm, Pmax =20dBm, F=2  220 −120  −115  −110  −105  −100  −95  −90  Interference Temperature Limit  dBm   Fig. 4.4 Total capacity of all femtocells versus the interference temperature limit   References  49  −120 to −90 dBm, for Pmax = 23 or 20 dBm, F = 2 or F = 4, Ru = 9 bps Hz, and K = 10. It can be seen that as the interference temperature limit increases, the total uplink capacity of femtocells increases, because the tolerable interference caused by femtocells to the macrocell is increased. Moreover, for the proposed algorithm, increasing Pmax from 20 to 23 dBm increases by up to 5 % the total uplink femtocell capacity, while increasing F from 2 to 4 increases by up to 6 % the femtocell uplink capacity because of multi-user diversity.  4.5 Conclusion  In this chapter, we have investigated the joint subchannel and power allocation for spectrum-sharing femtocells taking heterogeneous femto-user QoS requirements and a cross-tier interference limit into account. The proposed distributed resource allocation algorithm properly allocates resources to users according to their het- erogeneous QoS requirements, so as to increase the throughout in the network. Simulation results have shown that the proposed algorithm provides more efﬁcient solutions compared with cutting-edge algorithms in the literature.  Acknowledgements The authors would like to thank Dr. David López-Pérez, Prof. Meixia Tao and Prof. Arumugam Nallanathan for their contributions and helpful discussions. This work was supported by the Co-building Project of Beijing Municipal Education Commission “Research on Resource Allocation and Scheduling Strategy of Future Wireless Communication System” and “Multi-Agent Multimedia Cooperative Communications Platform”, Key Fund of Beijing Key Laboratory on Future Network Research, the National Natural Science Foundation of China  61101109 , and National Key Technology R&D Program of China  2010ZX03003-001-01, 2011ZX03003-002-01 .  References  1. D. López-Pérez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Commun. Mag., vol. 47, no. 9, pp. 41–48, 2009.  2. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co-  channel deployment,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1225–1241, 2011.  3. K. Son, S. Lee, Y. Yi, and S. Chong, “Reﬁm: A practical interference management in heterogeneous wireless access networks,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1260–1272, 2011.  4. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328, 2009.  5. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  6. J. Kim and D.-H. Cho, “A joint power and subchannel allocation scheme maximizing system capacity in indoor dense mobile communication systems,” IEEE Trans. Veh. Technol., vol. 59, no. 9, pp. 4340–4353, 2010.   50  4 Resource Allocation in Femtocells with Cross-Tier Interference Limits  7. J. Zhang, Z. Zhang, K. Wu, and A. Huang, “Optimal distributed subchannel, rate and power allocation algorithm in ofdm-based two-tier femtocell networks,” in Proc. Veh. Technol. Conf., May 2010, pp. 1–5.  8. D. Lopez-Perez, A. Ladanyi, A. Juttner, H. Rivano, and J. Zhang, “Optimization method for the joint allocation of modulation schemes, coding rates, resource blocks and power in self- organizing lte networks,” in INFOCOM, 2011 Proceedings IEEE, april 2011, pp. 111–115.  9. M. Tao, Y.-C. Liang, and F. Zhang, “Resource allocation for delay differentiated trafﬁc in multiuser ofdm systems,” IEEE Trans. Wireless Commun., vol. 7, no. 6, pp. 2190–2201, June 2008.  10. D. T. Ngo and T. Le-Ngoc, “Distributed resource allocation for cognitive radio networks with spectrum-sharing constraints,” IEEE Trans. Veh. Technol., vol. 60, no. 7, pp. 3436–3449, Sept. 2011.  11. R. Xie, F. R. Yu, and H. Ji, “Dynamic resource allocation for heterogeneous services in cognitive radio networks with imperfect channel sensing,” IEEE Trans. Veh. Technol., no. 99, p. 1, 2011.  12. H. Zhang, W. Zheng, X. Chu, X. Wen, M. Tao, A. Nallanathan and D. López-Pérez, “Joint Subchannel and Power Allocation in Interference-Limited OFDMA Femtocells with Heterogeneous QoS Guarantee”, to appear in Proc. of IEEE Globecom 2012.  13. G. de la Roche, A. Valcarce, D. Lopez-Perez, and J. Zhang, “Access control mechanisms for  femtocells,” Communications Magazine, IEEE, vol. 48, no. 1, pp. 33–39, january 2010.  14. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  15. H.-S. Jo, C. Mun, J. Moon, and J.-G. Yook, “Interference mitigation using uplink power control for two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 10, pp. 4906–4910, Oct. 2009.  16. S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004. 17. D. W. K. Ng and R. Schober, “Resource allocation and scheduling in multi-cell ofdma systems with decode-and-forward relaying,” IEEE Trans. Wireless Commun., vol. 10, no. 7, pp. 2246–2258, July 2011.  18. C. Y. Wong, R. Cheng, K. Lataief, and R. Murch, “Multiuser ofdm with adaptive subcarrier, bit, and power allocation,” IEEE J. Sel. Areas in Commun., vol. 17, no. 10, pp. 1747–1758, Oct. 1999.  19. W. Yu and R. Lui, “Dual methods for nonconvex spectrum optimization of multicarrier  systems,” IEEE Trans. Commun., vol. 54, no. 7, pp. 1310–1322, July 2006.  20. Z. Shen, J. G. Andrews, and B. L. Evans, “Adaptive resource allocation in multiuser ofdm systems with proportional rate constraints,” IEEE Trans. Wireless Commun., vol. 4, no. 6, pp. 2726–2737, Nov. 2005.  21. J. K. Chen, G. de Veciana, and T. S. Rappaport, “Site-speciﬁc knowledge and interference measurement for improving frequency allocations in wireless networks,” IEEE Trans. Veh. Technol., vol. 58, no. 5, pp. 2366–2377, June 2009.  22. Way forward proposal for  H eNB to HeNB mobility, 3GPP Std. R3-101 849, 2010. 23. Further Advancements for E-UTRA, Physical Layer Aspects, 3GPP Std. TR 36.814 v9.0.0,  2010.   Chapter 5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing  Abstract In two-tier femtocell networks, femtocells cause serious cross-tier interference and consume large amounts of energy for its large-scale deployment. In this chapter, we investigate the power control problem for the co-channel deployed femtocells. We ﬁrst model the uplink power control problem as a non-cooperative game, where co-channel interference is taken into account in maximizing the energy-aware utility. After introducing a price proportional to the cross-tier interference, Pareto improvement can be obtained. Furthermore, based on the non-cooperative game, we devise a distributed power allocation algorithm together with an optimal price seeking algorithm. Simulation results show that the proposed algorithm can improve users’ utilities signiﬁcantly, compared with existing power control algorithms.  5.1 Introduction  Recently, more and more data services occur in indoor environments [1], where the coverage of macrocells may not be good enough because of the wall penetration losses and long transmission distances from the outdoor macrocell base stations. Thanks to femtocells, the shortcoming of macrocells in providing indoor coverage can be overcome.  In practice, there are still some technical challenges to be further addressed before widespread deployment of femtocells. A two-tier macrocell and femtocell network is usually implemented by sharing frequency rather than splitting frequency between the two tiers [6]. Hence cross-tier interference  CTI  and inter-tier inter- ference  ITI  are the key issues in two-tier macrocell and femtocell networks [2]. The mitigation of cross-tier and inter-cell interference has become an interesting research area. Relevant existing works in the literature will be reviewed in the following.  Game theory has been considered to mitigate interference in two-tier networks with co-channel deployment of femtocells. In [3,6], the minimization of co-tier and cross-tier interference though power control based on game theory is investigated.  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__5,   The Author s  2013  51   52  5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing  In [5], the authors introduce a distributed utility-based signal-to-interference-plus- noise ratio  SINR  adaptation algorithm in order to alleviate cross-tier interference caused by co-channel femtocells to the macrocell. In [7], a decentralized femtocell access strategy based on non-cooperative game is proposed to manage the interfer- ence between nearby femtocells and from femtocells to macrocells. The authors in [6] propose a distributed power control algorithm for spectrum-sharing two- tier networks using Stackelberg game, which is very effective in distributed power allocation and macrocell protection while requiring minimal network overhead.  In this chapter, we propose an energy-aware power optimization algorithm for uplink power control in two-tier macrocell and femtocell networks [10], which is based on non-cooperative game with cross-tier interference pricing where each femtocell maximizes its own utility. We employ the super-modularity theory to show the existence of Nash equilibrium. The power optimization algorithm allows a distributed implementation where the cross-tier interference pricing can be broadcast by the base station to all the terminals.  The rest of this chapter is organized as follows. Section 5.2 provides the system model of a two-tier macrocell and femtocell network and the problem formulation. In Sect. 5.3, we discuss the non-cooperative power control game with convex pricing and propose a distributed interference-aware power control algorithm. Performance improvement of the proposed algorithm compared with existing schemes is evaluated by simulation in Sect. 5.4. Finally, Sect. 5.5 concludes the chapter.  5.2 System Model and Problem Formulation  5.2.1 System Model  grid sq.km with  In this chapter, we consider a two-tier femtocell network in Fig. 5.1, where femtocells are densely deployed [5]. A macrocell base station  MBS  B0 locates in the center of its coverage area, which is a disc area with a radius of Rm. Within the coverage area of the MBS, femtocell base stations  FBSs   {Bi} i = 1···N   are √ located in a square grid of area D2 N femtocells per dimension, at a distance D f from the MBS. The coverage radius of each femtocell is R f . Let Di, j denote the distance between transmitting mobile terminal j and BS Bi  i = 0···N . For simplicity, the channel gains are represented by gi, j, and the simpliﬁed path loss model in [5] is adopted. It is assumed that femtocells and macrocell use the same frequency spectrum, and there is only one scheduled active user during each signaling slot in each cell. Let i ∈ {0,1, . . . ,N} denotes the scheduled active user connected to its BS Bi. User i’s transmit power is represented by pi Watts. The variance of additive white Gaussian noise  AWGN  is σ2. Consequently, the received SINR γi of femtocell user i at FBS Bi  i = 1···N  can be expressed as   5.2 System Model and Problem Formulation  53  Fig. 5.1 The topology of two-tier femtocell networks  γi=  N∑  j=1, j cid:5 =i  pigi,i  ,  p jgi, j + p0gi,0 + σ2  where  p jgi, j is the interference caused by other co-channel femtocells, and  p0gi,0 is the interference caused by the macrocell.  Based on the sigmoid function [8], the UQS function of femtocell user i is  N∑  j=1, j cid:5 =i  deﬁned as  where αi and βi are the UQS parameters [8].  Given interfering powers p−i and the desired transmit power pi, we model the  utility function of user i as  fi γi  =  1  1 + eαi βi−γi   ,  ui  pi, p−i  = fi γi  pi   5.1    5.2    5.3   where ui is the energy efﬁciency of user i.  5.2.2 Problem Formulation  Since a central controller would require complete information of the network, including interference channel gains, it is impractical to use centralized power   54  5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing  control. Hence, we consider distributed power optimization, and propose a non- cooperative game theory based power allocation. Let G = [N ,{Pi} ,{ui  · }] denotes the non-cooperative power control game  NPG , where N = {0,1, . . . ,N} refers to the index set of the users currently active in the network. Pi is the strategy space describing the domain of transmission power for user i. We assume that the strategy space Pi of each user is a compact, convex set with minimum and maximum power constraints denoted by pi and pi, that is Pi = [pi  In power control, our target is that each user maximizes its own utility in a  , _ pi].  distributed manner, which can be expressed as  ui  pi, p−i  , for all i ∈ N ,  max pi∈Pi   5.4   where ui is given in  5.3 . The transmit power that optimizes the utility of a femtocell depends on the transmit power levels of all the other terminals in the system. It is necessary to characterize a set of power levels, with which the users are satisﬁed with the utility they receive given the transmit power levels of other users. Such an operating point is called an equilibrium point.  5.3 Non-cooperative Power Control Game  with Convex Pricing  The Nash equilibrium of NPG exists and is unique, which has been proved in [10]. In fact, the Nash equilibrium is inefﬁcient in general [10]. In non-cooperative power control game, each terminal selﬁshly optimizes its own utility, but the interference caused by the terminal will be imposed on other terminals. Thus, the Nash equilibrium is not Pareto efﬁcient. Consequently, we propose a pricing strategy for the power control game by adding a penalty price to each femtocell user’s transmission cost. Through pricing, we can depress femtocell users’ aggressive behavior and achieve the Pareto improvement by implicitly inducing cooperation, and yet we maintain the non-cooperative nature of the resulting power control solution.  In the existing literature, linear pricing mechanisms with respect to user’s uplink transmission power [11–14] have been applied, in order to move the Nash equilibrium solution to a Pareto optimal one. The idea of convex pricing mechanism derives from the observation that the harm a user imposes on other users is not equivalent within the whole range of transmission power, in contrast to the linear pricing mechanism. The main arguments of adopting nonlinear pricing have been summarized in [15].  Based on the nonlinear pricing strategy, we develop a non-cooperative power control game with convex pricing  NPG-CP . We assume that all users participate in a N + 1 player non-cooperative power control game Gc = [N ,{Pi} ,{uc   · }].  i   5.3 Non-cooperative Power Control Game with Convex Pricing  55  5.3.1 Femtocell Utility Function  Each femtocell user seeks to maximize its individual utility, although transmitting with too much power will cause unacceptable cross-tier and co-tier interference. In order to achieve Pareto improvement and reduce the cross-tier interference, given interfering powers p−i and user i’s current transmit power pi, we model the utility function for femtocell user i as  i  pi, p−i  = fi γi  uc  − ci  pi, p−i   pi  where ci  pi, p−i  is the pricing function for femtocell user i  i = 1,2 . . . ,N .  As described above, the pricing function monotonically increases with the transmit power of the user. Considering cross-tier interference mitigation, we deﬁne the convex pricing function as follows  where c is a positive scalar. Then,  5.5  can be rewritten as  ci  pi, p−i  = c· eg0,i pi,   pi, p−i  = fi γi  pi  uc i  − c· eg0,ipi.   5.5    5.6    5.7   The pricing discourages femtocell user i from decreasing cellular SINR by transmitting at high power. It is not straightforward to verify whether the Nash equilibrium point exists in NPG-CP, because the femtocell utility functions of NPG- CP are not quasi-concave. Thus, we employ super-modularity theory to prove the existence of Nash equilibrium.  5.3.2 Super-Modular Games  Super-modular game has particular characteristics which can be applied to imple- ment power control schemes. A formal deﬁnition of a super-modular game can be found in [16]. Deﬁnition 1. A game Gε = [N ,{Pi} ,{uε modular if, for all i.   · }] with parameter εis said to be super-  cid:19  ≥ 0   cid:19  ≥ 0 for all j  cid:5 = i and   cid:18  ∂uε i   cid:18  ∂uε i  ∂pi∂p j  ∂pi∂ε  2  pi   2  pi    cid:26    cid:26   i  The signiﬁcance of this characteristic is that there exists a ﬁxed point which  · }] implies a Nash equilibrium point. However, the NPG-CP Gc = [N ,{Pi} ,{uc is not a super-modular game. Next we modify the strategy spaces to transform denote the game into a super-modular game. Let the compact set   cid:27    cid:28   i  ˆPi =  , pi  pi   56  5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing   cid:26   the modiﬁed strategy space. Using the condition given in Deﬁnition 1,  cid:18  ∂uε i   cid:19  ≥ 0 for all j  cid:5 = i, we have  ∂pi∂p j  2  pi   i.e.,  ∂ui  pi, p−i   ∂pi  = 1  pi 2     ∂fi γi  ∂γi  · γi − fi γi  − cg0,i· eg0,i pi.   5.8   Then,  Obviously, from 0, and  ∂2ui  pi, p−i   ∂pi∂p j   cid:18  ∂uε i   cid:26   2  pi   ∂pi∂p j  · γi.  · ∂γi ∂p j  ∂2 fi γi  ∂2γi  = 1  pi 2  cid:19  ≥ 0 for all j  cid:5 = i, we can obtain that   5.9   ≤  ∂2 fi γi  ∂2γi  ∂2 fi γi  ∂2γi  =  2 · eαi βi−γi  ·  eαi βi−γi  − 1   αi  .   1 + eαi βi−γi  3   5.10   Then we can obtain that γi ≥ βi, and the smallest power in the modiﬁed strategy space pi can be derived from γi ≥ βi. We assume that the largest power pi is larger than pi.  cid:29  Theorem 1. The modiﬁed game ˆGc = ˆPi super-modular game. 2 pi  ∂pi∂p j  ≥ 0 has been satisﬁed Proof. As discussed above, the condition  ∂uε in the modiﬁed strategy space ˆPi. Performing a change of variables from c to −ε, we i get  ∂uε 2 p0  ∂p0∂ε  = 0 for i = 0. Therefore, the modiﬁed game ˆGc = [N ,{ ˆPi},{uc  · }] is a super-modular i game.  2 pi  ∂pi∂ε  = g0,i·eg0,i pi ≥ 0 for i = 1,2 . . . ,N and  ∂uε  with parameter c is a   · } cid:11   ,{uc  N ,   cid:30    cid:10   0  i  i  The set of Nash equilibrium of a super-modular game is nonempty. Furthermore, the Nash-equilibrium set has a largest element and a smallest element. It has been proved in [9]. As discussed above, there exists a Nash equilibrium in the modiﬁed game. Let E denote the set of Nash equilibrium and pS and pL denote the largest and the smallest elements of E. Note that for two vectors x,y ∈ Rn, x > y if and only if xi > yi for all i = 1,2, . . .n. Theorem 2. In the modiﬁed NPG-CP, if p ≥ pS, where p, pS ∈ E and pS is the smallest elements of E, uc for all i is pS the Pareto dominant i equilibrium. Proof. We can observe that, if pi and c are ﬁxed, utility uc increasing p−i for all i. Since p−i ≥ pS−i, we have i   pi, p−i  decreases with   p  ≤ uc  pS   cid:2    cid:3   i   pi, p−i  ≤ uc  i  uc i   cid:2   pi, pS−i   cid:3   .   5.11     5.12    5.13    5.14   5.3 Non-cooperative Power Control Game with Convex Pricing  57  According to the deﬁnition of Nash equilibrium and since pS is a Nash  equilibrium of NPG-CP, we have  cid:2   uc i  pi, pS−i   cid:2    cid:3  ≤ uc  i  ps i , pS−i   cid:3   .  From  5.9  and  5.10 , we obtain that   p  ≤ uc  i  uc i   cid:2    cid:3   pS  .  It is clear that the best-response of a user terminal is the Nash equilibrium with  the minimum total transmission power.  In a super-modular game, if the users’ best responses are single-valued, and each user updates starting from the smallest element of its strategy space, then the strategies monotonically converge to the smallest Nash equilibrium, which has been proved in [9]. We denote the smallest Nash equilibrium point as  ∗ i  p  = min{min  pi    argmax   uc i  pi    , pi}.  5.3.3 Energy-Aware Power Control NPG-CP  In this section, we present a distributed power control algorithm that is based on NPG-CP.  k = 1;  Algorithm 6 Iterative distributed power control 1: Initialize the power vector p  0  = p at the beginning and the iteration index of power update 2: For all the iteration times, that is when it satisﬁes k ≤ Kmax, the power update process will go on according to the following processes: i  For all the femtocell user i, given power vector, compute γi k  and update its power according to  i  k  = min{min ∗ p    argmax  pi  pi  i   , pi}  uc  i = 1, 2 . . ., N  ∗ ii  Assign transmission power according to p i ; 3: Iteration index of update increases: k = k + 1. 4: If the index exceeds the maximum value Kmax or convergence obtains, the power update ends;  The algorithm can be implemented in a distributed manner, that is, each femtocell i , the pricing factor c and its channel gain  user i only needs to know its own utility uc to B0 and Bi.   58  5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing  The searching process for the optimal pricing factor value is given as following. First, we implement the Proposed Algorithm  power update  with no pricing c = 0. When the equilibrium with no pricing is obtained, we go on implementing power update with pricing Δ c, which is a positive value, and then get a set of utilities at equilibrium. Compared with the previous utilities, if the utilities at this new equilibrium increase, then the pricing factor is incremented and the procedure is repeated until the utility is lower than the previous utility for at least one user. The algorithm is summarized in Algorithm 2.  Algorithm 7 Optimal pricing scheme 1: Initialize the pricing factor at the beginning: c = 0 that will be known by all femtocell users; 2: Set Δ c > 0 and implement the power update process; 3: Get ui for all i ∈ N at equilibrium, then increase the pricing factor value: c = c + Δ c, which for all i ∈ N return to step 2, else, that is, if there is one utility worse than the 4: If uc i  is also known by each user;  ≤ uc+Δ c  previous utility, the seeking update will stop, and the optimal pricing value is: coptimal = c.  i  5.4 Performance Evaluation  Simulation results are given in this section. A non-pricing power control algorithm  NPG-NP , power optimization with cellular link protection  POCP  [5], and equal power allocation scheme  EPA  are compared with the proposed interference-aware power control algorithm with convex pricing  NPG-CP . In the POCP algorithm, the transmission power of each user is based on their target SINRs. The values of their target SINRs are set to 5 dB. The simulation parameters are summarized in Table 5.1. Transmit power, users’ utilities and energy efﬁciency of the proposed scheme are veriﬁed, compared with existing schemes.  Figure 5.2 shows that the total user utilities increase as the number of femtocell increases. The corresponding equilibrium transmission power consumption of NPG  Table 5.1 Simulation parameters of system  Parameter Macrocell radius Rm Femtocell radius R f Grid size Dgrid Carrier frequency fc,MHz System bandwidth w MBS  FBS TX power Thermal noise density Out In-door path loss exponent UQS parameters  Value 288 m 5 m 100 m 2 GHz 10 MHz 1 0.1 W 174 dBm Hz 4 3 αi = 8, βi = 1.2   5.4 Performance Evaluation  59  Fig. 5.2 Utilities of different schemes  schemes and power consumption of the other two schemes is displayed in Fig. 5.3. It can be seen from Fig. 5.2 that NPG-NP scheme has obvious advantage in user utility than POCP and EPA schemes. This illustrates that the user utility deﬁnition of UQS and individual transmission power is more efﬁcient in our proposed schemes. What’s more, when the number of femtocell users per cellsite is bigger, the advantage in utility of NPG-CP is more obvious than NPG-NP scheme. And the not so big difference in user utilities between NPG-CP and NPG-NP is owing to the function form of user utility. In other words, our proposed scheme can improve the sum of user utilities signiﬁcantly.  Figure 5.3 represents comparison of the total transmission power of the femtocell network among different power control schemes. Obviously, the scheme NPG-NP consumes much lesser transmission power than POCP and EPA schemes. As a result of pricing, the transmit power at equilibrium in our proposed scheme NPG-CP is lower than that without pricing scheme NPG-NP. Compared with others schemes, our proposed scheme NPG-CP is most energy saving.  More detailed power consumption comparison of single user is illustrated in Fig. 5.4. The solid lines indicate the transmission power of user in NPG-CP scheme with the optimal pricing factor. And the dotted lines present the power consume of single user in NPG-NP scheme. Almost all the users consume less power in NPG- CP than NPG-NP scheme, which is consistent with the theoretical analysis. The optimal power allocation can be ﬁnished in about ﬁve iterations.   60  5 Energy Efﬁcient Power Control in Femtocells with Interference Pricing  Fig. 5.3 Transmission power of different schemes  Fig. 5.4 Comparison of single user’s transmission power of convex pricing scheme and unpriced scheme  5.5 Conclusion  In this chapter, we have proposed an energy-aware uplink power control scheme for two-tier femtocell networks based on non-cooperative game. We can obtain Pareto   References  61  improvement of the non-cooperative power control game via cross-tier interference pricing. Based on the proposed power optimization scheme each femto user can reduce the system power, while mitigating uplink inter-cell interference. It has been shown through simulations that the proposed power allocation algorithm is able to not only maintain good user utilities but also improve energy efﬁciency, as compared with existing power allocation schemes.  Acknowledgements The authors would like to thank Ms. Deli Liu for her contribution and helpful discussions.  References  1. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  2. D. López-Pérez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Commun. Mag., vol. 47, no. 9, pp. 41–48, 2009.  3. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co-  4. K. Son, S. Lee,Y. Yi, and S. Chong, “Reﬁm: A practical  channel deployment,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1225–1241, 2011. interference management  in heterogeneous wireless access networks,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1260–1272, 2011.  5. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328, 2009.  6. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  7. S. Barbarossa, S. Sardellitti, A. Carfagna, and P. Vec-chiarelli, “Decentralized interference management in femtocells: A game-theoretic approach,” in IEEE CROWNCOM’10, June 2010, pp. 1–5.  8. Z. Jiang, Y. Li, “Max-utility wireless resource management for best effort trafﬁc,” IEEE Trans.  on Wireless Communications, vol. 4, no. 1, pp. 100–111, 2005.  9. C. U. Saraydar, N. B. Mandayam, and D. J. Goodman, “Efﬁcient power control via pricing in wireless data networks,” Communications, IEEE Transactions on, vol. 50, no. 2, pp. 291–303, 2002.  10. D. Liu, W. Zheng, H. Zhang, et al., “Energy efﬁcient power optimization in two-tier femtocell  networks with interference pricing,” in IEEE ICCNT’12, 2012, pp. 247–252.  11. J.-W. Lee, R. R. Mazumdar, and N. B. Shroff, “Opportunistic power scheduling for dynamic multi-server wireless systems,” Wireless Communications, IEEE Transactions on, vol. 5, no. 6, pp. 1506–1515, 2006.  12. M. Rasti, A. R. Sharafat, and B. Seyfe, “Pareto-efﬁcient and goal-driven power control in wireless networks: a game-theoretic approach with a novel pricing scheme,” IEEE ACM Transactions on Networking  TON , vol. 17, no. 2, pp. 556–569, 2009.  13. P. Liu, P. Zhang, S. Jordan, and M. L. Honig, “Single-cell forward link power allocation using pricing in wireless networks,” Wireless Communications, IEEE Transactions on, vol. 3, no. 2, pp. 533–543, 2004.  14. T. Alpcan, L. Pavel, and N. Stefanovic, “A control theoretic approach to noncooperative game design,” in Decision and Control, 2009 held jointly with the 2009 28th Chinese Control Conference. CDC CCC 2009. Proceedings of the 48th IEEE Conference on. IEEE, 2009, pp. 8575–8580.  15. R. Wilson, “Nonlinear pricing,” OUP Catalogue, 2001. 16. D. Fudenberg and J. Tirole, Game Theory. MIT Press, 1993.   Chapter 6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  Abstract Femtocells, combined with orthogonal frequency division multiple access  OFDMA , can improve cellular coverage and ofﬂoad trafﬁcs from existing macrocells. However, the co-channel deployment of femtocells is still facing challenges arising from potentially severe co-channel interference in dense femtocells. In this chapter, we investigate the uplink power allocation problem in dense deployed femtocells. We ﬁrst model the uplink power allocation in femtocells as a non-cooperative game, where co-channel interference is taken into account in maximizing the femtocell capacity and uplink femto-to-femto interference is alleviated by charging each femto user a price proportional to the signal to interference and noise ratio  SINR . Based on the non-cooperative game, we then devise a distributed power allocation algorithm with differentiated pricing update. Simulation results show that the proposed power allocation algorithm is not only able to provide improved capacities for femtocells, but also can improve users’ fairness, as compared with existing unpriced water ﬁlling power allocation algorithm.  6.1 Introduction  Femtocell has attracted a lot of attention for its potential in improving coverage and capacity for indoor environments. This is because most of the voice services and data trafﬁcs occur indoors, where however the coverage of macrocells is not sufﬁcient [1]. Femtocells combined with orthogonal frequency division multiple access  OFDMA  have been considered in major wireless communication standards such as 3GPP LTE LTE-Advanced [2]. Spectrum partition among femtocells, where femtocells are assigned with different  or orthogonal  frequency bands, may not be preferred by operators due to the scarcity of spectrum resources and difﬁculties in implementation. While in spectrum-sharing deployment, where femtocells share the same spectrum, co-tier interference could be severe [3], especially when femtocell base stations  FBSs  are densely deployed close to each other [4]. To mitigate the  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__6,   The Author s  2013  63   64  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  co-channel interference between femtocells, resource allocation has been widely used in dense femtocells.  Power control has also been widely used to mitigate inter-femtocell interference in co-channel deployment of femtocells. In [4], a power control algorithm is proposed to maximize the total capacity of densely deployed femtocells while controlling the co-tier interference, but the fairness between femto users is not considered.  Recently, several studies considering pricing techniques together with power controls have been reported. In [5], the distributed cross-tier interference pric- ing power allocation for co-channel deployed femtocells is modeled as a non- cooperative game, but the constraint on maximum femto-user transmit power is ignored in solving the non-cooperative game. For alleviating uplink interference caused by co-channel femto users to macrocells, a distributed femtocell power control algorithm is developed based on non-cooperative game theory in [6]; while in [7] femto users are priced for causing interference to macrocells in the power allocation based on a Stackelberg model.  In this chapter, different from the previous work in [8], we focus on the uplink power allocation problem in dense deployed femtocells [9]. Moreover, each femto user is charged with a dynamically optimized price proportional to the amount of femto user’s signal to interference and noise ratio  SINR . Based on the non- cooperative game, we then devise a distributed algorithm for each femtocell. Simulation comparisons with modiﬁed iterative water ﬁlling  MIWF  based power allocation show that the proposed distributed femtocell power allocation algorithm is able to provide not only improved capacities but also improved fairness in femtocell networks.  The rest of this chapter is organized as follows. The system model and problem formulation are presented in Sect. 6.2. In Sect. 6.3, the differentiated-pricing based power allocation algorithm is proposed. Performance of the proposed algorithm is evaluated by simulations in Sect. 6.4. Finally, Sect. 6.5 concludes the chapter.  6.2 System Model and Problem Formulation  6.2.1 System Model  In this chapter, a two-tier OFDMA femtocell and macrocell network is considered, in which K FBSs overlaid by a central Macro Base Station  MBS  as shown in Fig. 6.1. We focus on the power allocation in the uplink of femtocells. It is assumed that the total bandwidth B is divided into N equal-bandwidth sub-channels. Let M and F denote the numbers of macro users and femto users, respectively. Let fk,n ∈ {1,2, . . . ,F} denote the user in the kth  k ∈ {1,2, . . . ,K}  femtocell using the nth  n ∈ {1,2, . . . ,N}  subchannel and mn ∈ {1,2, . . . ,M} denote the user in the central macrocell using the nth subchannel.   6.2 System Model and Problem Formulation  65  Fig. 6.1 The topology of two-tier femtocell networks  The received SINR of user fk,n can be expressed as:  γfk,n  =  p fk,ngk, fk,n + σ2 I fk,n  ,  where p fk,n is the power of femtocell user fk,n, gk, fk,n is the channel gain from the transmitting user fk,n to the receiving FBS k, σ2 is the additive white Gaussian noise power, and I fk,n is the interference which can be written as:  I fk,n  =  p f j,ngk, f j,n  + pmngk,mn  ,   6.2   K∑ j=1, j cid:5 =k  where pmn is the power of macrocell user mn and gk,mn is the channel gain from the transmitting mn user to the central receiving MBS. Moreover, the ﬁrst component on the right-hand side of the equation is the interference caused by other co-channel femtocells, and the second component is caused by the central macrocell.  The capacity that indicates the achievable instantaneous data rate of the femtocell  user fk,n based on Shannon’s formula can be expressed as:  Cfk,n  = B N  log2   1 + γfk,n   .  6.2.2 Problem Formulation  We deﬁne Ctot as the capacity of K femtocells, which can be formulated as:   6.1    6.3    6.4   Ctot =  K∑  N∑  k=1  n=1  Cfk,n   s.t.  s.t.   6.5    6.6    6.7    6.8    6.9    6.10   66  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  Our target is to maximize the total capacity under system constraints:  Ctot =  K∑  N∑  k=1  n=1  Cfk,n  ≤ pmax, ∀n ∈ {1,2, . . . ,N} ,∀k ∈ {1,2, . . . ,K} ≥ 0, ∀n ∈ {1,2, . . . ,N} ,∀k ∈ {1,2, . . . ,K}  p fk,n  p fk,n  where the constraint in  6.6  means that a femto user’s total transmit power can’t be more than pmax, and the constraint in  6.7  indicates that the power allocated to each user should be nonnegative.  Moreover, the optimization problem  6.5  under constraints  6.6  and  6.7  can  be converted to:  Ctot =  Cfk,n  ,  K∑  k=1  ∀n ∈ {1,2, . . . ,N}  p fk,n,n ≤ pn,max, ∀n ∈ {1,2, . . . ,N} ,∀k ∈ {1,2, . . . ,K} 0 ≤ p fk,n,n, ∀n ∈ {1,2, . . . ,N} ,∀k ∈ {1,2, . . . ,K}  That is because the total capacity maximization is equivalent to the maximization of the total capacity of K femtocells on each subchannel, since the power allocation is independent for each subchannel.  6.3 Differentiated-Pricing Based Power Allocation  Firstly, we propose a non-cooperative power allocation scheme based on game theory for given subchannel allocation [10]. Secondly, based on a differentiated pricing mechanism, a power allocation scheme by pricing the femtocell users according to their SINR is developed. Moreover, a dynamic power allocation algorithm is formulated.   6.3 Differentiated-Pricing Based Power Allocation  67  6.3.1 Game Theoretic Based on Differentiated Pricing  Users in each coordination cell are considered as selﬁsh and rational players. Each of them tries to maximize their individual utility without considering the corresponding interference to other co-channel users. To balance the contradiction between them, pricing mechanism is used in our proposed scheme.  Deﬁnition 1. The power allocation problem is modeled as a femtocell non- cooperative power allocation game  NPAG :  G =< Γn,Pn, μ  >,  n   6.11   where Γn = { f1,n, f1,n, . . . , fK,n} , ∀n ∈ {1,2, . . . .N}, denotes the set of the femto users  i.e., the players set  using the nth subchannel of all FBSs, Pn =  cid:9  , ∀n ∈ {1,2, . . . .N} is the power allocation strategy space of  cid:9  , ∀n ∈ {1,2, . . . .N} is the net utility μ  p f1,n the players, and μ set based on the differentiated pricing mechanism.  , . . . , p fK,n =  , p f2,n  , . . . , μ  fK,n  f1,n  f2,n  , μ   cid:12    cid:12   n  We assume different users are charged at different prices according to the variable channel conditions, considering that the femtocell has complete information about the network. Under the differentiated pricing rule, we denote the pricing function of user fk,n as:  Therefore, the utility of user fk,n can be given as follows:  Bγfk,n  c fk,n  =  N ln2 1 + γfk,n     .  μ  fK,n  = Cfk,n  − c fk,n  ,  where c fk,n with respect to the corresponding SINR.  γfk,n, and αfk,n  = αfk,n  > 0 is the price coefﬁcient charged on femto user  Deﬁnition 2. Player fk,n’s best response given the power allocation of all other co- channel femtocell users is expressed as:  ˆp fk,n  = argmax  μ   p fk,n  fk,n  p fk,n   cid:19   ,   cid:13   cid:13  cid:13 p− fk,n  cid:12    cid:9   =  where p− fk,n is the power vector of co- channel femto users other than fk,n of subchannel n in all femtocells except for femtocell k.  , . . . , p fk−1,n  , . . . , p fK,n  , p fk+1,n  , p f2,n  p f1,n   6.12    6.13    6.14    68  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  Deﬁnition 3. Denote   cid:9    cid:2   ˆp f1,n  Pn =  , ˆp f2,n   ≥ μ , ˆp− fk,n   ˆp fk,n  cid:12  ,··· , ˆp fk,n  μ  fK,n   cid:9    cid:2    cid:12   ,··· , ˆp fk,n  , if condition  6.15  is met:  , ∀p fk,n  ∈ Pn,   6.15    p fk,n  , ˆp− fk,n  fK,n  Pn =  , ˆp f2,n  ˆp f1,n  is the optimal Nash Equilibrium  NE  transmitting then power vector of the co-channel users. NE is deﬁned as the ﬁxed point where no player can improve their utility by changing its strategy unilaterally [10].  In the following, we will prove the existence and uniqueness of NE in the NPAG.  Theorem 1. An NE exists in the NPAG.  Proof. A NE exists in the NPAG if the following two conditions are satisﬁed according to the Nash theorem: 1. In the ﬁnite Euclidean space RK, Pn is non-empty, convex and compact. 2. μ  n is continuous and concave with Pn.  Since the allocated power on each subchannel should be more than zero and less  than the maximum pmax, condition 1 is obviously satisﬁed.  Next we will prove the condition 2. Equation  6.13  can be rewritten as:  ⎡ ⎢ ⎣log2  μ  = B N  fK,n   1+  K∑  j=1, j cid:5 =k  p fk,n  gk, fk,n   −  p f j,n gk, f j,n  +pmn gk,mn  +σ2  ln2   K∑  j=1, j cid:5 =k  p fk,n  αfk,n p f j,n gk, f j,n  gk, fk,n +pmn gk,mn  +σ2   It is obvious that μ  fK,n is continuous with Pn. And the ﬁrst order derivative of the  femto user fk,n’s utility function with respect to p fk,n is as follows:  ∂μ fk,n ∂p fk,n  = B  N ln 2  [  gk, fk,n  +pmn gk,mn  +σ2+p fk,n  gk, fk,n  K∑  j=1, j cid:5 =k  p f j,n gk, f j,n αfk,n gk, fk,n p f j,n gk, f j,n  −  K∑  j=1, j cid:5 =k  ]  +pmn gk,mn  +σ2  If  ∂μ fk,n ∂p fk,n  ≥ 0, then we can get:  ≤  αfk,n  ⎛ ⎜ ⎝1 +  N ln 2  B  p fk,n gk, fk,n  K∑  j=1, j cid:5 =k  p f j,n gk, f j,n  +pmn gk,mn  +σ2  ⎞ ⎟ ⎠  ⎤ ⎥ ⎦   6.16    6.17    6.18    69   6.19   ⎞ ⎟ ⎠   cid:25   2  6.3 Differentiated-Pricing Based Power Allocation  Note that, αfk,n  ∈ +, therefore:  0 ≤ αfk,n  ≤  ⎛ ⎜ ⎝1 +  N ln2  B  p fk,n  gk, fk,n  K∑  j=1, j cid:5 =k  p f j,n gk, f j,n  +pmn gk,mn  +σ2  The second order derivative can be formulated as:  = −  ∂2μ fk,n ∂2 p fk,n  ≤ 0   cid:24   N ln 2  K∑  j=1, j cid:5 =k  Bg2  k, fk,n  p f j,n gk, f j,n  +pmn gk,mn  +σ2+p fk,n  gk, fk,n   6.20   It is seen that the second order derivative is nonpositive. Therefore, μ  fK,n is a  quasi-concave function of p fk,n.  Both 1 and 2 are satisﬁed, we can know that a NE exists in the NPAG.  Theorem 2. The NPAG has a unique NE.  The detailed proof can be found in [10]. Based on the above analysis, we can say a NE exists in the NPAG. That is to say,   cid:2   Pn is the optimal power allocation solution.  6.3.2 Differentiated-Pricing Function  Differentiated pricing is also referred to as price discrimination in the economics literature [11]. As mentioned above, different users are charged at different prices. Moreover, it is depending on SINR which can indicate the variable channel conditions. In the following analysis we will give the detail expression of αfk,n. Proof. Assume that αn = {αf1,n } is the differentiated pricing vector, which can be expressed in terms of the corresponding allocated power and the variable channel conditions as follows:  , . . . ,αfK,n  ,αf2,n  αfk,n  =  ⎛ ⎜ ⎝1 +  N ln 2  B  p fk,n gk, fk,n  K∑  j=1, j cid:5 =k  p f j,n gk, f j,n  +pmn gk,mn  +σ2  ⎞ ⎟ ⎠   6.21   Proof. From  6.19 , we know the value range of αfk,n. It is obvious that the value of αfk,n in  6.21  is the maximum value in  6.19 . Therefore, Proposition 6.3.2 is proved.   70  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  Lemma 1. The best power allocation response of the NPAG in  6.14  can be expressed as: ⎡ ⎢ ⎣  +pmn gk,mn  +pmn gk,mn  j=1, j cid:5 =k  j=1, j cid:5 =k  ⎤ ⎥ ⎦  +σ2   +σ2  −  pmax  =  B   K∑  K∑  ˆp fk,n  p f j,n gk, f j,n N ln 2αfk,n gk, fk,n  p f j,n gk, f j,n gk, fk,n   6.22  Proof. Given the corresponding αfk,n according to  6.21 , by seeing  6.17  equal to 0, we can get the optimal power allocated to femto user fk,n in femtocell k at subchannel n as expressed in  6.22 . In the formulation, [c]b a means minmaxa, c, b.  0  6.3.3 Dynamic Power Allocation  The uniqueness of NE is proved in the above analysis. In this subsection, an optimal dynamic iterative power allocation algorithm is proposed to converge to NE, as shown in algorithm 1.  Algorithm 8 Iterative algorithm for dynamic power allocation 1: Initialize subchannel set: N = {1, 2, . . ., N}, Femto User set: F = {1, 2, . . ., F}, FBS set: K =  {1, 2, . . ., K} gk, fk,n ∀n ∈ N,∀k ∈ K , the channel gain from the transmitting user fk,n to the receiving FBS k; gk,mn ∀n ∈ N,∀k ∈ K , the channel gain from the transmitting mn user to the central receiving MBS.  2: Collect the channel gain:  3: Calculate SINR based on the channel gain for each user; 4: Each femtocell compute its optimal power based on the received price αfk,n by  6.22 ; 5: Each femtocell update its price according to  6.21 ; 6: Step  6.4  and Step  6.5  are repeated until convergence.  6.4 Simulation Results and Discussion  6.4.1 Simulation Parameters  In the subsection, we present simulation results to evaluate the performance of the proposed NPAG algorithm, as compared with MIWF power control algorithm [12]. Both the system capacity and the fairness are evaluated in the simulations.  In the simulations, the macrocell has a coverage radius of 500 m. Each femtocell has a coverage radius of 10 m. K FBSs and 50 macro users are randomly distributed in the macrocell coverage area. The minimum distance between the MBS and a macro user  or an FBS  is 50 m. The minimum distance between FBSs is 40 m. Femto users are uniformly distributed in the coverage area of their serving femtocell.   6.4 Simulation Results and Discussion  71  x 108    s p b     s  l l  e c o m e  t  f   f  o   y t i c a p a c   l  a  t  o T  9  8  7  6  5  4  3  2  1  0  NPAG, K=3 NPAG, K=6 NPAG, K=9  0  2  4  6  8  10  12  14  16  Iteration index  Fig. 6.2 Convergence versus the number of iterations  Both macro and femto cells employ a carrier frequency of 2 GHz, B = 10 MHz, and N = 50. The AWGN variance is given by σ2 = B Rayleigh-fading channel gains are modeled as unit-mean exponentially distributed random variables. The average channel gain  including pathloss and antenna gains  −3, for indoor femto user and outdoor macro user are modeled as λd respectively, where λ= 2× 10 −4[6]. The maximum uplink transmission powers of a femto user and a macro user is set as 20 and 30 dBm, respectively.  N N0, where N0 = −174 dBm Hz. The  −4 and λd  6.4.2 Performance Analysis  Figure 6.2 shows the convergence of the proposed algorithm in terms of the average capacity per femtocell versus iterations. We can see that the proposed algorithm takes only 10 iterations to converge, indicating that it is suitable for real-time implementation.  Figure 6.3 shows the total capacity of the femtocell when the number of femto users per femtocell increases from 1 to 6, for K = 20, 30, and 50. It can be observed that the proposed NPAG algorithm outperforms the MIWF algorithm by up to a 10 %   72  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  x 109  NPAG, K=20 MIWF, K=20 NPAG, K=30 MIWF, K=30 NPAG, K=50 MIWF, K=50    s p b     s  l l  t  e c o m e F    f  o    y t i c a p a C    l  a  t  o T  14  12  10  8  6  4  2  0  1  K=50  K=30  K=20  2  3  4  5  Number of Femto Users per Femtocell  6  Fig. 6.3 Total capacity of femtocells  increase in total femtocell capacity. As the number of femtocells K increases, the advantage of the NPAG algorithm becomes more noticeable, because the increased co-tier uplink interference can be effectively mitigated by the differentiated pricing scheme imposed on femto users in the NPAG algorithm, but not by the MIWF based algorithm.  Figure 6.4 compares the average fairness between femto users in each femtocell between the proposed NPAG algorithm and the MIWF algorithm. The fairness metric is based on the classic Jain’s fairness index  JFI  [13]. It can be seen from the ﬁgure, as the number of the users in each femtocell increases, the fairness in FPAG is better than MIWF method.  6.5 Conclusion  In this chapter, we proposed a differentiated-pricing based power allocation algo- rithm for the uplink frequency-sharing femtocells, based on the non-cooperative game framework. Using the proposed algorithm, each femtocell can maximize its   References  73  1  0.9  0.8  0.7  0.6  0.5  0.4  s s e n r i a F  NPAG, N=20 MIWF, N=20 NPAG, N=30 MIWF, N=30 NPAG, N=50 MIWF, N=50  1  2  3  4  5  6  Number of Femto users per Femtocell  Fig. 6.4 Total capacity of all delay sensitive users of all femtocells versus the number of femtocells K  capacity through power allocation, and with uplink femto-to-femto interference alleviated by differentiated pricing functions imposed on femto users. It has been shown through simulations that the proposed power allocation algorithm is able to provide improved capacities of femtocells, together with better fairness, as compared with the existing unpriced MIWF based power allocation algorithm.  Acknowledgements The authors would like to thank Ms. Wenmin Ma and Dr. Wei Zheng for their contributions and helpful discussions. This research has been supported by National Key Technology R&D Program of China  2010ZX03003-001-01, 2011ZX03003-002-01 , the National Natural Science Foundation of China  61101109 , the Co-building Project of Beijing Municipal Education Commission “G-RAN based Experimental Platform for Future Mobile Communications” and “Research on Resource Allocation and Scheduling Strategy of Future Wireless Communication System” and Key Fund of Beijing Key Laboratory on Future Network Research.  References  1. D. López-Pérez, A. Valcarce, G. de la Roche, and J. Zhang, “Ofdma femtocells: A roadmap on  interference avoidance,” IEEE Commun. Mag., vol. 47, no. 9, pp. 41–48, 2009.  2. E-UTRA and E-UTRAN Overall Description, 3GPP Std. TS 36.300 v10.0.0, 2010.   74  6 Differentiated-Pricing Based Power Allocation in Dense Femtocell Networks  3. V. Chandrasekhar and J. G. Andrews, “Femtocell networks: A survey,” IEEE Commun. Mag.,  vol. 46, no. 9, pp. 59–67, 2008.  4. J. Kim and D.-H. Cho, “A joint power and subchannel allocation scheme maximizing system capacity in indoor dense mobile communication systems,” IEEE Transactions on Vehicular Technology, vol. 59, no. 9, pp. 4340–4353, 2010.  5. J.-H. Yun and K. G. Shin, “Adaptive interference management of ofdma femtocells for co-  channel deployment,” IEEE J. Sel. Areas in Commun., vol. 29, no. 6, pp. 1225–1241, 2011.  6. V. Chandrasekhar, J. G. Andrews, T. Muharemovic, Z. Shen, and A. Gatherer, “Power control in two-tier femtocell networks,” IEEE Trans. Wireless Commun., vol. 8, no. 8, pp. 4316–4328, 2009.  7. X. Kang, R. Zhang, and M. Motani, “Price-based resource allocation for spectrum-sharing  femtocell networks: a stackelberg game approach,” IEEE J. Sel. Areas in Commun., 2012.  8. H. Zhang X. Chu, W. Zheng and X. Wen, “Optimization method for the joint allocation of modulation schemes, coding rates, resource blocks and power in self-organizing lte networks,” in ICC, 2012 Proceedings IEEE, 2012.  9. W. Ma, H. Zhang, W. Zheng, X. Wen, “Differentiated-Pricing Based Power Allocation in Dense  Femtocell Networks”, to appear in Proc. of IEEE WPMC 2012. 10. D. Fudenberg and J. Tirole, Game Theory. MIT Press, 1993. 11. S. Ren and M. van der Schaar, “Pricing and distributed power control in wireless relay  networks,” IEEE Trans. Sig. Proc., vol. 59, no. 6, pp. 2913–2926, June 2011.  12. W. Yu, “Sum-capacity computation for the gaussian vector broadcast channel via dual  decomposition,” IEEE Trans. Inf. Theory, vol. 52, no. 2, pp. 754–759, Feb. 2006.  13. M. C. Erturk, H. Aki, I. Guvenc, , and H. Arslan, “Fair and qos-oriented spectrum splitting in  macrocell-femtocell networks,” in IEEE Globecom’10, pp. 1–6.   Chapter 7 Conclusions and Future Works  Abstract In this book, we investigate resource allocation and interference man- agement in femtocell networks. A subchannel allocation algorithm based on the ant colony optimization is proposed in dense deployed femtocells. To explore the multi-dimensional diversity in resource allocation, we propose a semi-distributed interference-aware resource allocation algorithm for the uplink of co-channel deployed femtocells, based on a non-cooperative game framework. Furthermore, a joint subchannel and power allocation scheme for spectrum-sharing femtocells is investigated taking heterogeneous femto-user QoS requirements and a cross- tier interference limit into account. In Chap. 5, we have proposed an energy-aware uplink power control scheme for two-tier femtocell networks based on non- cooperative game. In Chap. 6, we have proposed a differentiated-pricing based power allocation algorithm for the uplink frequency-sharing femtocells, based on the non-cooperative game framework.  7.1 Conclusions  In this book, we investigate resource management and interference mitigation in femtocell networks. In Chap. 1, we give a introduction for 4G femtocells, where we give a survey for the research of resource allocation and interference management. Interference mitigation based on power control and subchannel scheduling is sur- veyed. Moreover, resource allocation based on game theory and convex optimization is also surveyed in Chap. 1, where challenges in resource allocation and interference management are given.  In Chap. 2, subchannel allocation algorithms based on Ant Colony Algorithm are presented. As a typical meta-heuristic method, ACA provides simple and robust way for resource allocation optimization. We formulate the resource allocation problem as path searching in a graph, and use the pheromone trail and the heuristic  H. Zhang et al., 4G Femtocells: Resource Allocation and Interference Management, SpringerBriefs in Computer Science, DOI 10.1007 978-1-4614-9080-7__7,   The Author s  2013  75   76  7 Conclusions and Future Works  information to guide the construction of solution construction. In comparison with the traditional RR algorithm, better throughput can be achieved by ACA based algorithms. ACA-MF and ACA-FF can guarantee the fairness among users while meeting rate requirements.  In Chap. 3, we have proposed a semi-distributed interference-aware resource allocation algorithm for the uplink of co-channel deployed femtocells, based on a non-cooperative game framework. Using the proposed algorithm, each femtocell can maximize its capacity through resource allocation, taking into account inter- cell interference reported by its femto users, and with uplink femto-to-macro interference alleviated by a pricing scheme imposed on femto users. It has been shown through simulations that the proposed interference-aware resource allocation algorithm is able to provide improved capacities of both macrocell and femtocells, together with comparable tiered fairness, as compared with the existing unpriced subchannel allocation and MIWF based power allocation algorithm.  In Chap. 4, we have investigated the joint subchannel and power allocation for spectrum-sharing femtocells taking heterogeneous femto-user QoS requirements and a cross-tier interference limit into account. The proposed distributed resource allocation algorithm properly allocates resources to users according to their het- erogeneous QoS requirements, so as to increase the throughout in the network. Simulation results have shown that the proposed algorithm provides more efﬁcient solutions compared with cutting-edge algorithms in the literature.  In Chap. 5, we have proposed an energy-aware uplink power control scheme for two-tier femtocell networks based on non-cooperative game. We can obtain Pareto improvement of the non-cooperative power control game via cross-tier interference pricing. Based on the proposed power optimization scheme each femto user can reduce the system power, while mitigating uplink inter-cell interference. It has been shown through simulations that the proposed power allocation algorithm is able to not only maintain good user utilities but also improve energy efﬁciency, as compared with existing power allocation schemes.  In Chap. 6, we proposed a differentiated-pricing based power allocation algo- rithm for the uplink frequency-sharing femtocells, based on the non-cooperative game framework. Using the proposed algorithm, each femtocell can maximize its capacity through power allocation, and with uplink femto-to-femto interference alleviated by differentiated pricing functions imposed on femto users. It has been shown through simulations that the proposed power allocation algorithm is able to provide improved capacities of femtocells, together with better fairness, as compared with the existing unpriced MIWF based power allocation algorithm.  7.2 Future Works  Though we have done some works in resource allocation and interference manage- ment in femtocell networks, there are still some challenges and open questions.   7.2 Future Works  77  For the future works, we will investigate the other techniques for interference management in macro-femto networks, such as beamforming, clustering method to mitigate the co-tier and cross-tier interference in heterogenous femtocell networks. Moreover, the cross-tier interference temperature can be extended to the co-tier interference mitigation. For the resource allocation aspects, cross-layer resource scheduling involving the Modulation and Coding Scheme  MCS  at the PHY layer, together with the power and subchannel allocation will be jointly optimized in femtocell networks. Moreover, resource allocation and interference mitigation based on inter-femtocell coordination will be promising. Finally, the resource allocation and interference management proposed in the book can be easily extended to the other small cell networks, such as picocells or cognitive relay networks.

@highlight

This brief examines resource allocation and interference management for 4G femtocells. It introduces 4G femtocells in the context of 4G mobile networks and discusses related technical challenges in resource allocation and interference management. Topics include ant colony algorithm based downlink resource allocation, intelligent scheduling and power control, uplink and downlink for two-tier networks, quality of service (QoS) constraints and the cross-tier interference constraint. The authors present algorithms to alleviate common femtocell-related problems such as subchannel power allocation. The complexity of the proposed resource allocation algorithms is analyzed, and the effectiveness of the proposed algorithms is verified by simulations. This concise and practical book directly addresses common problems relating to femtocells and resource management. It serves as a useful tool for researchers in the field. Advanced-level students or professionals interested in femtocells and networks will also find the content helpful